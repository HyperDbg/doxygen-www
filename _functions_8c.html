<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/script-eval/code/Functions.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_functions_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Functions.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Script engine functions implementations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:add7975ffafcc4340f289092638222d9c" id="r_add7975ffafcc4340f289092638222d9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add7975ffafcc4340f289092638222d9c">GetValue</a> (<a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs, <a class="el" href="_script_engine_common_definitions_8h.html#a7afb70efbbc123180260563957758cdf">PACTION_BUFFER</a> ActionBuffer, <a class="el" href="_basic_types_8h.html#a31d689027f2f9713d9659a3bcb72acbc">SCRIPT_ENGINE_VARIABLES_LIST</a> *VariablesList, <a class="el" href="_script_engine_common_definitions_8h.html#a2a27f43201a2da17c5602965ac8feab2">PSYMBOL</a> Symbol, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ReturnReference, <a class="el" href="struct_s_y_m_b_o_l___b_u_f_f_e_r.html">SYMBOL_BUFFER</a> *StackBuffer, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *StackIndx, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *StackBaseIndx, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *ReturnValue)</td></tr>
<tr class="separator:add7975ffafcc4340f289092638222d9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae5324ab914487cba0248f2b41babae8" id="r_aae5324ab914487cba0248f2b41babae8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae5324ab914487cba0248f2b41babae8">ScriptEngineFunctionEq</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="el" href="_basic_types_8h.html#a6fe04fdd875bcad282f702bb818897b6">QWORD</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:aae5324ab914487cba0248f2b41babae8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of eq function.  <br /></td></tr>
<tr class="separator:aae5324ab914487cba0248f2b41babae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4852c9c360e94ccc388a65d63a40e03e" id="r_a4852c9c360e94ccc388a65d63a40e03e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4852c9c360e94ccc388a65d63a40e03e">ScriptEngineFunctionEd</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="el" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a4852c9c360e94ccc388a65d63a40e03e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of ed function.  <br /></td></tr>
<tr class="separator:a4852c9c360e94ccc388a65d63a40e03e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add624b429cdd05ae37b0f973acd1b99f" id="r_add624b429cdd05ae37b0f973acd1b99f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add624b429cdd05ae37b0f973acd1b99f">ScriptEngineFunctionEb</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="el" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:add624b429cdd05ae37b0f973acd1b99f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of eb function.  <br /></td></tr>
<tr class="separator:add624b429cdd05ae37b0f973acd1b99f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e351a0b8d7c0869e31d59be606fd695" id="r_a6e351a0b8d7c0869e31d59be606fd695"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6e351a0b8d7c0869e31d59be606fd695">ScriptEngineFunctionCheckAddress</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Length)</td></tr>
<tr class="memdesc:a6e351a0b8d7c0869e31d59be606fd695"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether the address is valid or not.  <br /></td></tr>
<tr class="separator:a6e351a0b8d7c0869e31d59be606fd695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee0b6f2504f52d818e54764555d7008b" id="r_aee0b6f2504f52d818e54764555d7008b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aee0b6f2504f52d818e54764555d7008b">ScriptEngineFunctionMemcpy</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Destination, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Source, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Num, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:aee0b6f2504f52d818e54764555d7008b"><td class="mdescLeft">&#160;</td><td class="mdescRight">A VMX-compatible equivalent of memcpy function in C.  <br /></td></tr>
<tr class="separator:aee0b6f2504f52d818e54764555d7008b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d5d9ebeb23eedc368058b30b6e10e1" id="r_a73d5d9ebeb23eedc368058b30b6e10e1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73d5d9ebeb23eedc368058b30b6e10e1">ScriptEngineFunctionVirtualToPhysical</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>)</td></tr>
<tr class="separator:a73d5d9ebeb23eedc368058b30b6e10e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a512d364d2dd0d34a9204f87e5751cee1" id="r_a512d364d2dd0d34a9204f87e5751cee1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a512d364d2dd0d34a9204f87e5751cee1">ScriptEngineFunctionPhysicalToVirtual</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>)</td></tr>
<tr class="memdesc:a512d364d2dd0d34a9204f87e5751cee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert physical address to virtual address.  <br /></td></tr>
<tr class="separator:a512d364d2dd0d34a9204f87e5751cee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9dc74b6fd3820807219338b324f05aa" id="r_ac9dc74b6fd3820807219338b324f05aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9dc74b6fd3820807219338b324f05aa">ScriptEngineFunctionPrint</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ImmediateMessagePassing, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>)</td></tr>
<tr class="memdesc:ac9dc74b6fd3820807219338b324f05aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of print function.  <br /></td></tr>
<tr class="separator:ac9dc74b6fd3820807219338b324f05aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adff9d56d78f06954aeae9787afdefcc0" id="r_adff9d56d78f06954aeae9787afdefcc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adff9d56d78f06954aeae9787afdefcc0">ScriptEngineFunctionTestStatement</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ImmediateMessagePassing, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>)</td></tr>
<tr class="memdesc:adff9d56d78f06954aeae9787afdefcc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of test_statement function.  <br /></td></tr>
<tr class="separator:adff9d56d78f06954aeae9787afdefcc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578e17ddd2ca66885cae243fdb855745" id="r_a578e17ddd2ca66885cae243fdb855745"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a578e17ddd2ca66885cae243fdb855745">ScriptEngineFunctionSpinlockLock</a> (volatile LONG *Lock, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a578e17ddd2ca66885cae243fdb855745"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of spinlock_lock function.  <br /></td></tr>
<tr class="separator:a578e17ddd2ca66885cae243fdb855745"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14fccaac626f8c4e06b93eb18b4460ea" id="r_a14fccaac626f8c4e06b93eb18b4460ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14fccaac626f8c4e06b93eb18b4460ea">ScriptEngineFunctionSpinlockUnlock</a> (volatile LONG *Lock, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a14fccaac626f8c4e06b93eb18b4460ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of spinlock_unlock function.  <br /></td></tr>
<tr class="separator:a14fccaac626f8c4e06b93eb18b4460ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8104e193459a08b27785e0ba0c4db600" id="r_a8104e193459a08b27785e0ba0c4db600"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8104e193459a08b27785e0ba0c4db600">ScriptEngineFunctionSpinlockLockCustomWait</a> (volatile long *Lock, unsigned MaxWait, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a8104e193459a08b27785e0ba0c4db600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of spinlock_lock_custom_wait function.  <br /></td></tr>
<tr class="separator:a8104e193459a08b27785e0ba0c4db600"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38b032f4233a9a61273452558df7430" id="r_aa38b032f4233a9a61273452558df7430"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa38b032f4233a9a61273452558df7430">ScriptEngineFunctionStrlen</a> (const char *<a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>)</td></tr>
<tr class="memdesc:aa38b032f4233a9a61273452558df7430"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of strlen function.  <br /></td></tr>
<tr class="separator:aa38b032f4233a9a61273452558df7430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21b2d7c45183686341089fa29c239dd" id="r_aa21b2d7c45183686341089fa29c239dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa21b2d7c45183686341089fa29c239dd">ScriptEngineFunctionDisassembleLen</a> (PVOID <a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> Is32Bit)</td></tr>
<tr class="memdesc:aa21b2d7c45183686341089fa29c239dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of disassemble_len function.  <br /></td></tr>
<tr class="separator:aa21b2d7c45183686341089fa29c239dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1e9fcb833d5b004ca633b2f40fa9639" id="r_ac1e9fcb833d5b004ca633b2f40fa9639"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1e9fcb833d5b004ca633b2f40fa9639">ScriptEngineFunctionWcslen</a> (const wchar_t *<a class="el" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>)</td></tr>
<tr class="memdesc:ac1e9fcb833d5b004ca633b2f40fa9639"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of wcslen function.  <br /></td></tr>
<tr class="separator:ac1e9fcb833d5b004ca633b2f40fa9639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73487cc08273f0270836b867160af273" id="r_a73487cc08273f0270836b867160af273"><td class="memItemLeft" align="right" valign="top">long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a73487cc08273f0270836b867160af273">ScriptEngineFunctionInterlockedExchange</a> (long long volatile *Target, long long <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a73487cc08273f0270836b867160af273"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of interlocked_exchange function.  <br /></td></tr>
<tr class="separator:a73487cc08273f0270836b867160af273"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4d1ace162cfc47daeed724cc6ea4981" id="r_ae4d1ace162cfc47daeed724cc6ea4981"><td class="memItemLeft" align="right" valign="top">long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae4d1ace162cfc47daeed724cc6ea4981">ScriptEngineFunctionInterlockedExchangeAdd</a> (long long volatile *Addend, long long <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:ae4d1ace162cfc47daeed724cc6ea4981"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of interlocked_exchange_add function.  <br /></td></tr>
<tr class="separator:ae4d1ace162cfc47daeed724cc6ea4981"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00c3aad01f2f22b1bad488ce616af7c0" id="r_a00c3aad01f2f22b1bad488ce616af7c0"><td class="memItemLeft" align="right" valign="top">long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a00c3aad01f2f22b1bad488ce616af7c0">ScriptEngineFunctionInterlockedIncrement</a> (long long volatile *Addend, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a00c3aad01f2f22b1bad488ce616af7c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of interlocked_exchange_increment function.  <br /></td></tr>
<tr class="separator:a00c3aad01f2f22b1bad488ce616af7c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d5f3e2a17e9497bd96c5cefe4c4ee70" id="r_a1d5f3e2a17e9497bd96c5cefe4c4ee70"><td class="memItemLeft" align="right" valign="top">long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1d5f3e2a17e9497bd96c5cefe4c4ee70">ScriptEngineFunctionInterlockedDecrement</a> (long long volatile *Addend, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a1d5f3e2a17e9497bd96c5cefe4c4ee70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of interlocked_exchange_decrement function.  <br /></td></tr>
<tr class="separator:a1d5f3e2a17e9497bd96c5cefe4c4ee70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa831db6212f2c35614b07381807256b2" id="r_aa831db6212f2c35614b07381807256b2"><td class="memItemLeft" align="right" valign="top">long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa831db6212f2c35614b07381807256b2">ScriptEngineFunctionInterlockedCompareExchange</a> (long long volatile *Destination, long long ExChange, long long Comperand, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:aa831db6212f2c35614b07381807256b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of interlocked_compare_exchange function.  <br /></td></tr>
<tr class="separator:aa831db6212f2c35614b07381807256b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1fa7a0901c41583885c051da97c95bf" id="r_aa1fa7a0901c41583885c051da97c95bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa1fa7a0901c41583885c051da97c95bf">ScriptEngineFunctionEventEnable</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EventId)</td></tr>
<tr class="memdesc:aa1fa7a0901c41583885c051da97c95bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_enable function.  <br /></td></tr>
<tr class="separator:aa1fa7a0901c41583885c051da97c95bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a895626a4574c8489afb2855c0c399da3" id="r_a895626a4574c8489afb2855c0c399da3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a895626a4574c8489afb2855c0c399da3">ScriptEngineFunctionEventDisable</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EventId)</td></tr>
<tr class="memdesc:a895626a4574c8489afb2855c0c399da3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_disable function.  <br /></td></tr>
<tr class="separator:a895626a4574c8489afb2855c0c399da3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ad79144ac0a5a2b11135baab5e5ad2" id="r_ad1ad79144ac0a5a2b11135baab5e5ad2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1ad79144ac0a5a2b11135baab5e5ad2">ScriptEngineFunctionEventClear</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EventId)</td></tr>
<tr class="memdesc:ad1ad79144ac0a5a2b11135baab5e5ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_clear function.  <br /></td></tr>
<tr class="separator:ad1ad79144ac0a5a2b11135baab5e5ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66a74f0eaf8812a3ad903518f3f82eac" id="r_a66a74f0eaf8812a3ad903518f3f82eac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66a74f0eaf8812a3ad903518f3f82eac">ScriptEngineFunctionPause</a> (<a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *ActionDetail, <a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs)</td></tr>
<tr class="memdesc:a66a74f0eaf8812a3ad903518f3f82eac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of pause function.  <br /></td></tr>
<tr class="separator:a66a74f0eaf8812a3ad903518f3f82eac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab48cb2504fb17c34607d006bfa29a56c" id="r_ab48cb2504fb17c34607d006bfa29a56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab48cb2504fb17c34607d006bfa29a56c">ScriptEngineFunctionFlush</a> ()</td></tr>
<tr class="memdesc:ab48cb2504fb17c34607d006bfa29a56c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of flush function.  <br /></td></tr>
<tr class="separator:ab48cb2504fb17c34607d006bfa29a56c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56dd53bf47d024da78865d469d02f4b3" id="r_a56dd53bf47d024da78865d469d02f4b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56dd53bf47d024da78865d469d02f4b3">ScriptEngineFunctionShortCircuitingEvent</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> State, <a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *ActionDetail)</td></tr>
<tr class="memdesc:a56dd53bf47d024da78865d469d02f4b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_ignore function.  <br /></td></tr>
<tr class="separator:a56dd53bf47d024da78865d469d02f4b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae79b8c05c117b13727b5308297aefc29" id="r_ae79b8c05c117b13727b5308297aefc29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae79b8c05c117b13727b5308297aefc29">ScriptEngineFunctionFormats</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ImmediateMessagePassing, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>)</td></tr>
<tr class="memdesc:ae79b8c05c117b13727b5308297aefc29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of formats function.  <br /></td></tr>
<tr class="separator:ae79b8c05c117b13727b5308297aefc29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a673be4c4c8d110389f3ee5e26e2fce7e" id="r_a673be4c4c8d110389f3ee5e26e2fce7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a673be4c4c8d110389f3ee5e26e2fce7e">CustomStrlen</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> StrAddr, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsWstring)</td></tr>
<tr class="memdesc:a673be4c4c8d110389f3ee5e26e2fce7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Custom VMX-root compatible strlen.  <br /></td></tr>
<tr class="separator:a673be4c4c8d110389f3ee5e26e2fce7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ee2cedee42ef138ba9425c59063a9d" id="r_a17ee2cedee42ef138ba9425c59063a9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a17ee2cedee42ef138ba9425c59063a9d">CheckIfStringIsSafe</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> StrAddr, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsWstring)</td></tr>
<tr class="memdesc:a17ee2cedee42ef138ba9425c59063a9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if string is safe to be accessed or not (in vmx-root mode)  <br /></td></tr>
<tr class="separator:a17ee2cedee42ef138ba9425c59063a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2de4e26af9bd9b702c5bbd8f4f0d94b" id="r_af2de4e26af9bd9b702c5bbd8f4f0d94b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2de4e26af9bd9b702c5bbd8f4f0d94b">ApplyFormatSpecifier</a> (const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *CurrentSpecifier, <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *FinalBuffer, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CurrentProcessedPositionFromStartOfFormat, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CurrentPositionInFinalBuffer, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Val, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> SizeOfFinalBuffer)</td></tr>
<tr class="memdesc:af2de4e26af9bd9b702c5bbd8f4f0d94b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply format specifiers (d, x, llx, etc.)  <br /></td></tr>
<tr class="separator:af2de4e26af9bd9b702c5bbd8f4f0d94b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88be33f07f4e7e7bd3d55609c53dee08" id="r_a88be33f07f4e7e7bd3d55609c53dee08"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88be33f07f4e7e7bd3d55609c53dee08">WcharToChar</a> (const wchar_t *src, char *dest, size_t dest_len)</td></tr>
<tr class="memdesc:a88be33f07f4e7e7bd3d55609c53dee08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert WCHAR* to CHAR*.  <br /></td></tr>
<tr class="separator:a88be33f07f4e7e7bd3d55609c53dee08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a08cdea3c62ad35619e0da43108db1" id="r_ab0a08cdea3c62ad35619e0da43108db1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0a08cdea3c62ad35619e0da43108db1">ApplyStringFormatSpecifier</a> (const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *CurrentSpecifier, <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *FinalBuffer, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CurrentProcessedPositionFromStartOfFormat, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CurrentPositionInFinalBuffer, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Val, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsWstring, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> SizeOfFinalBuffer)</td></tr>
<tr class="memdesc:ab0a08cdea3c62ad35619e0da43108db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply string format specifiers (s, ws, etc.)  <br /></td></tr>
<tr class="separator:ab0a08cdea3c62ad35619e0da43108db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a806788132ce3f168c1f3bfe188078bb7" id="r_a806788132ce3f168c1f3bfe188078bb7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a806788132ce3f168c1f3bfe188078bb7">ScriptEngineFunctionPrintf</a> (<a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs, <a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *ActionDetail, <a class="el" href="_basic_types_8h.html#a31d689027f2f9713d9659a3bcb72acbc">SCRIPT_ENGINE_VARIABLES_LIST</a> *VariablesList, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ImmediateMessagePassing, char *Format, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ArgCount, <a class="el" href="_script_engine_common_definitions_8h.html#a2a27f43201a2da17c5602965ac8feab2">PSYMBOL</a> FirstArg, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *HasError, <a class="el" href="struct_s_y_m_b_o_l___b_u_f_f_e_r.html">SYMBOL_BUFFER</a> *StackBuffer, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *StackIndx, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *StackBaseIndx, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *ReturnValue)</td></tr>
<tr class="memdesc:a806788132ce3f168c1f3bfe188078bb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of printf function.  <br /></td></tr>
<tr class="separator:a806788132ce3f168c1f3bfe188078bb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acade8592fda90744feaaa98ea2ebc6c3" id="r_acade8592fda90744feaaa98ea2ebc6c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acade8592fda90744feaaa98ea2ebc6c3">ScriptEngineFunctionEventInject</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> InterruptionType, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Vector, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:acade8592fda90744feaaa98ea2ebc6c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_inject function.  <br /></td></tr>
<tr class="separator:acade8592fda90744feaaa98ea2ebc6c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c88a02e25a6857ac603500c6426fdf2" id="r_a1c88a02e25a6857ac603500c6426fdf2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1c88a02e25a6857ac603500c6426fdf2">ScriptEngineFunctionEventInjectErrorCode</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> InterruptionType, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Vector, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ErrorCode, <a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *HasError)</td></tr>
<tr class="memdesc:a1c88a02e25a6857ac603500c6426fdf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_inject_error_code function.  <br /></td></tr>
<tr class="separator:a1c88a02e25a6857ac603500c6426fdf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c70a959fac5e45d04e5dc850c54ab92" id="r_a6c70a959fac5e45d04e5dc850c54ab92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c70a959fac5e45d04e5dc850c54ab92">ScriptEngineFunctionStrcmp</a> (const char *Address1, const char *Address2)</td></tr>
<tr class="memdesc:a6c70a959fac5e45d04e5dc850c54ab92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of strcmp function.  <br /></td></tr>
<tr class="separator:a6c70a959fac5e45d04e5dc850c54ab92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1469432da99eef8a934d8197cbf5df2" id="r_ae1469432da99eef8a934d8197cbf5df2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1469432da99eef8a934d8197cbf5df2">ScriptEngineFunctionStrncmp</a> (const char *Address1, const char *Address2, size_t Num)</td></tr>
<tr class="memdesc:ae1469432da99eef8a934d8197cbf5df2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of strcmp function.  <br /></td></tr>
<tr class="separator:ae1469432da99eef8a934d8197cbf5df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a732a6b41466254895c0ad905679b64fa" id="r_a732a6b41466254895c0ad905679b64fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a732a6b41466254895c0ad905679b64fa">ScriptEngineFunctionWcscmp</a> (const wchar_t *Address1, const wchar_t *Address2)</td></tr>
<tr class="memdesc:a732a6b41466254895c0ad905679b64fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of wcscmp function.  <br /></td></tr>
<tr class="separator:a732a6b41466254895c0ad905679b64fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a746a5947d63d8d2c8bfd3e0bc148f18b" id="r_a746a5947d63d8d2c8bfd3e0bc148f18b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a746a5947d63d8d2c8bfd3e0bc148f18b">ScriptEngineFunctionWcsncmp</a> (const wchar_t *Address1, const wchar_t *Address2, size_t Num)</td></tr>
<tr class="memdesc:a746a5947d63d8d2c8bfd3e0bc148f18b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of wcsncmp function.  <br /></td></tr>
<tr class="separator:a746a5947d63d8d2c8bfd3e0bc148f18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab632685e8ca1b9aa06ed5e484cd1553d" id="r_ab632685e8ca1b9aa06ed5e484cd1553d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab632685e8ca1b9aa06ed5e484cd1553d">ScriptEngineFunctionMemcmp</a> (const char *Address1, const char *Address2, size_t Count)</td></tr>
<tr class="memdesc:ab632685e8ca1b9aa06ed5e484cd1553d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of memcmp function.  <br /></td></tr>
<tr class="separator:ab632685e8ca1b9aa06ed5e484cd1553d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2efe52647d234b6314ed20ad4937c3" id="r_a0e2efe52647d234b6314ed20ad4937c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e2efe52647d234b6314ed20ad4937c3">ScriptEngineFunctionEventTraceInstrumentationStep</a> ()</td></tr>
<tr class="memdesc:a0e2efe52647d234b6314ed20ad4937c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_trace_instrumentation_step function.  <br /></td></tr>
<tr class="separator:a0e2efe52647d234b6314ed20ad4937c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a4e2b05a7223ed3cfdeedf16167383" id="r_ad5a4e2b05a7223ed3cfdeedf16167383"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5a4e2b05a7223ed3cfdeedf16167383">ScriptEngineFunctionEventTraceStepIn</a> ()</td></tr>
<tr class="memdesc:ad5a4e2b05a7223ed3cfdeedf16167383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of event_trace_step_in function.  <br /></td></tr>
<tr class="separator:ad5a4e2b05a7223ed3cfdeedf16167383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Script engine functions implementations. </p>
<dl class="section author"><dt>Author</dt><dd>M.H. Gholamrezaei (<a href="#" onclick="location.href='mai'+'lto:'+'mh@'+'hy'+'per'+'db'+'g.o'+'rg'; return false;">mh@hy<span class="obfuscator">.nosp@m.</span>perd<span class="obfuscator">.nosp@m.</span>bg.or<span class="obfuscator">.nosp@m.</span>g</a>) </dd>
<dd>
Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-06-29</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af2de4e26af9bd9b702c5bbd8f4f0d94b" name="af2de4e26af9bd9b702c5bbd8f4f0d94b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2de4e26af9bd9b702c5bbd8f4f0d94b">&#9670;&#160;</a></span>ApplyFormatSpecifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ApplyFormatSpecifier </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>CurrentSpecifier</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>FinalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CurrentProcessedPositionFromStartOfFormat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CurrentPositionInFinalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>SizeOfFinalBuffer</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply format specifiers (d, x, llx, etc.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CurrentSpecifier</td><td></td></tr>
    <tr><td class="paramname">FinalBuffer</td><td></td></tr>
    <tr><td class="paramname">CurrentProcessedPositionFromStartOfFormat</td><td></td></tr>
    <tr><td class="paramname">CurrentPositionInFinalBuffer</td><td></td></tr>
    <tr><td class="paramname">Val</td><td></td></tr>
    <tr><td class="paramname">SizeOfFinalBuffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1032</span>{</div>
<div class="line"><span class="lineno"> 1033</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TempBufferLen      = 0;</div>
<div class="line"><span class="lineno"> 1034</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>   TempBuffer[50 + 1] = {</div>
<div class="line"><span class="lineno"> 1035</span>        0}; <span class="comment">// Maximum uint64_t is 18446744073709551615 + 1 thus its 20 character</span></div>
<div class="line"><span class="lineno"> 1036</span>              <span class="comment">// for maximum buffer + 1 end char null but we alloc 50 to be sure</span></div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>    *CurrentProcessedPositionFromStartOfFormat =</div>
<div class="line"><span class="lineno"> 1039</span>        *CurrentProcessedPositionFromStartOfFormat + (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen(CurrentSpecifier);</div>
<div class="line"><span class="lineno"> 1040</span>    sprintf(TempBuffer, CurrentSpecifier, Val);</div>
<div class="line"><span class="lineno"> 1041</span>    TempBufferLen = (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen(TempBuffer);</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1044</span>    <span class="comment">// Check final buffer capacity</span></div>
<div class="line"><span class="lineno"> 1045</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1046</span>    <span class="keywordflow">if</span> (*CurrentPositionInFinalBuffer + TempBufferLen &gt; SizeOfFinalBuffer)</div>
<div class="line"><span class="lineno"> 1047</span>    {</div>
<div class="line"><span class="lineno"> 1048</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1049</span>        <span class="comment">// Over passed buffer</span></div>
<div class="line"><span class="lineno"> 1050</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1051</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1052</span>    }</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>    memcpy(&amp;FinalBuffer[*CurrentPositionInFinalBuffer], TempBuffer, TempBufferLen);</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>    *CurrentPositionInFinalBuffer = *CurrentPositionInFinalBuffer + TempBufferLen;</div>
<div class="line"><span class="lineno"> 1057</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_basic_types_8h_html_aebb9e13210d88d43e32e735ada43a425"><div class="ttname"><a href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a></div><div class="ttdeci">char CHAR</div><div class="ttdef"><b>Definition</b> BasicTypes.h:31</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0a08cdea3c62ad35619e0da43108db1" name="ab0a08cdea3c62ad35619e0da43108db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0a08cdea3c62ad35619e0da43108db1">&#9670;&#160;</a></span>ApplyStringFormatSpecifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ApplyStringFormatSpecifier </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>CurrentSpecifier</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>FinalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CurrentProcessedPositionFromStartOfFormat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CurrentPositionInFinalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsWstring</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>SizeOfFinalBuffer</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply string format specifiers (s, ws, etc.) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CurrentSpecifier</td><td></td></tr>
    <tr><td class="paramname">FinalBuffer</td><td></td></tr>
    <tr><td class="paramname">CurrentProcessedPositionFromStartOfFormat</td><td></td></tr>
    <tr><td class="paramname">CurrentPositionInFinalBuffer</td><td></td></tr>
    <tr><td class="paramname">Val</td><td></td></tr>
    <tr><td class="paramname">IsWstring</td><td></td></tr>
    <tr><td class="paramname">SizeOfFinalBuffer</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1111</span>{</div>
<div class="line"><span class="lineno"> 1112</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  StringSize;</div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordtype">wchar_t</span> WstrBuffer[50];</div>
<div class="line"><span class="lineno"> 1114</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>    AsciiBuffer[<span class="keyword">sizeof</span>(WstrBuffer) / 2];</div>
<div class="line"><span class="lineno"> 1115</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  StringSizeInByte; <span class="comment">/* because of wide-char */</span></div>
<div class="line"><span class="lineno"> 1116</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CountOfBlocks;</div>
<div class="line"><span class="lineno"> 1117</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CopiedBlockLen;</div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1120</span>    <span class="comment">// First we have to check if string is valid or not</span></div>
<div class="line"><span class="lineno"> 1121</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1122</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="#a17ee2cedee42ef138ba9425c59063a9d">CheckIfStringIsSafe</a>(Val, IsWstring))</div>
<div class="line"><span class="lineno"> 1123</span>    {</div>
<div class="line"><span class="lineno"> 1124</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1125</span>    }</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1128</span>    <span class="comment">// get the length of the string (format) identifier</span></div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1130</span>    *CurrentProcessedPositionFromStartOfFormat += (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen(CurrentSpecifier);</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1133</span>    <span class="comment">// Get string len</span></div>
<div class="line"><span class="lineno"> 1134</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1135</span>    StringSize = <a class="code hl_function" href="#a673be4c4c8d110389f3ee5e26e2fce7e">CustomStrlen</a>(Val, IsWstring);</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1138</span>    <span class="comment">// Check final buffer capacity</span></div>
<div class="line"><span class="lineno"> 1139</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keywordflow">if</span> (*CurrentPositionInFinalBuffer + StringSize &gt; SizeOfFinalBuffer)</div>
<div class="line"><span class="lineno"> 1141</span>    {</div>
<div class="line"><span class="lineno"> 1142</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1143</span>        <span class="comment">// Over passed buffer</span></div>
<div class="line"><span class="lineno"> 1144</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1145</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1146</span>    }</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1149</span>    <span class="comment">// Move the buffer string into the target buffer</span></div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1151</span>    <span class="keywordflow">if</span> (IsWstring)</div>
<div class="line"><span class="lineno"> 1152</span>    {</div>
<div class="line"><span class="lineno"> 1153</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1154</span>        <span class="comment">// Parse wstring</span></div>
<div class="line"><span class="lineno"> 1155</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1156</span>        StringSizeInByte = StringSize * 2; <span class="comment">/* because of wide-char */</span></div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1159</span>        <span class="comment">// compute the ceiling</span></div>
<div class="line"><span class="lineno"> 1160</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1161</span>        <span class="keywordflow">if</span> (StringSizeInByte % <span class="keyword">sizeof</span>(WstrBuffer) == 0)</div>
<div class="line"><span class="lineno"> 1162</span>        {</div>
<div class="line"><span class="lineno"> 1163</span>            CountOfBlocks = StringSizeInByte / <span class="keyword">sizeof</span>(WstrBuffer);</div>
<div class="line"><span class="lineno"> 1164</span>        }</div>
<div class="line"><span class="lineno"> 1165</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1166</span>        {</div>
<div class="line"><span class="lineno"> 1167</span>            CountOfBlocks = (StringSizeInByte / <span class="keyword">sizeof</span>(WstrBuffer)) + 1;</div>
<div class="line"><span class="lineno"> 1168</span>        }</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; CountOfBlocks; i++)</div>
<div class="line"><span class="lineno"> 1171</span>        {</div>
<div class="line"><span class="lineno"> 1172</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1173</span>            <span class="comment">// Zero the buffers</span></div>
<div class="line"><span class="lineno"> 1174</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1175</span>            RtlZeroMemory(WstrBuffer, <span class="keyword">sizeof</span>(WstrBuffer));</div>
<div class="line"><span class="lineno"> 1176</span>            RtlZeroMemory(AsciiBuffer, <span class="keyword">sizeof</span>(AsciiBuffer));</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1179</span>            <span class="comment">// Check for the last block</span></div>
<div class="line"><span class="lineno"> 1180</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1181</span>            <span class="keywordflow">if</span> (i == CountOfBlocks - 1)</div>
<div class="line"><span class="lineno"> 1182</span>            {</div>
<div class="line"><span class="lineno"> 1183</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1184</span>                <span class="comment">// A portion of block</span></div>
<div class="line"><span class="lineno"> 1185</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1188</span>                memcpy(WstrBuffer, (<span class="keywordtype">void</span> *)(Val + (i * <span class="keyword">sizeof</span>(WstrBuffer))), StringSizeInByte % <span class="keyword">sizeof</span>(WstrBuffer));</div>
<div class="line"><span class="lineno"> 1189</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1192</span>                <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(</div>
<div class="line"><span class="lineno"> 1193</span>                    (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)(Val + (i * <span class="keyword">sizeof</span>(WstrBuffer))),</div>
<div class="line"><span class="lineno"> 1194</span>                    WstrBuffer,</div>
<div class="line"><span class="lineno"> 1195</span>                    StringSizeInByte % <span class="keyword">sizeof</span>(WstrBuffer));</div>
<div class="line"><span class="lineno"> 1196</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1197</span>            }</div>
<div class="line"><span class="lineno"> 1198</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1199</span>            {</div>
<div class="line"><span class="lineno"> 1200</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1201</span>                <span class="comment">// A complete block</span></div>
<div class="line"><span class="lineno"> 1202</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1205</span>                memcpy(WstrBuffer, (<span class="keywordtype">void</span> *)(Val + (i * <span class="keyword">sizeof</span>(WstrBuffer))), <span class="keyword">sizeof</span>(WstrBuffer));</div>
<div class="line"><span class="lineno"> 1206</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1207</span> </div>
<div class="line"><span class="lineno"> 1208</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1209</span>                <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(</div>
<div class="line"><span class="lineno"> 1210</span>                    (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)(Val + (i * <span class="keyword">sizeof</span>(WstrBuffer))),</div>
<div class="line"><span class="lineno"> 1211</span>                    WstrBuffer,</div>
<div class="line"><span class="lineno"> 1212</span>                    <span class="keyword">sizeof</span>(WstrBuffer));</div>
<div class="line"><span class="lineno"> 1213</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1214</span>            }</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1217</span>            <span class="comment">// Here we have the filled WstrBuffer</span></div>
<div class="line"><span class="lineno"> 1218</span>            <span class="comment">// We should convert WstrBuffer to AsciiBuffer</span></div>
<div class="line"><span class="lineno"> 1219</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1220</span>            CopiedBlockLen =</div>
<div class="line"><span class="lineno"> 1221</span>                (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)<a class="code hl_function" href="#a88be33f07f4e7e7bd3d55609c53dee08">WcharToChar</a>(WstrBuffer, AsciiBuffer, <span class="keyword">sizeof</span>(AsciiBuffer) + 1);</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1224</span>            <span class="comment">// Now we should move the AsciiBuffer to the target buffer</span></div>
<div class="line"><span class="lineno"> 1225</span>            <span class="comment">// (when we filled AsciiBuffer the memory here is safe so we</span></div>
<div class="line"><span class="lineno"> 1226</span>            <span class="comment">// can use memcpy in both user-mode and vmx-root mode)</span></div>
<div class="line"><span class="lineno"> 1227</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1228</span>            memcpy(&amp;FinalBuffer[*CurrentPositionInFinalBuffer], (<span class="keywordtype">void</span> *)AsciiBuffer, CopiedBlockLen + 1);</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>            *CurrentPositionInFinalBuffer += CopiedBlockLen + 1;</div>
<div class="line"><span class="lineno"> 1231</span>        }</div>
<div class="line"><span class="lineno"> 1232</span>    }</div>
<div class="line"><span class="lineno"> 1233</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1234</span>    {</div>
<div class="line"><span class="lineno"> 1235</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1236</span>        <span class="comment">// Parse string</span></div>
<div class="line"><span class="lineno"> 1237</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1238</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1239</span>        memcpy(&amp;FinalBuffer[*CurrentPositionInFinalBuffer], (<span class="keywordtype">void</span> *)Val, StringSize);</div>
<div class="line"><span class="lineno"> 1240</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1243</span>        <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(</div>
<div class="line"><span class="lineno"> 1244</span>            Val,</div>
<div class="line"><span class="lineno"> 1245</span>            &amp;FinalBuffer[*CurrentPositionInFinalBuffer],</div>
<div class="line"><span class="lineno"> 1246</span>            StringSize);</div>
<div class="line"><span class="lineno"> 1247</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>        *CurrentPositionInFinalBuffer += StringSize;</div>
<div class="line"><span class="lineno"> 1250</span>    }</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1253</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_functions_8c_html_a17ee2cedee42ef138ba9425c59063a9d"><div class="ttname"><a href="#a17ee2cedee42ef138ba9425c59063a9d">CheckIfStringIsSafe</a></div><div class="ttdeci">BOOLEAN CheckIfStringIsSafe(UINT64 StrAddr, BOOLEAN IsWstring)</div><div class="ttdoc">Check if string is safe to be accessed or not (in vmx-root mode)</div><div class="ttdef"><b>Definition</b> Functions.c:997</div></div>
<div class="ttc" id="a_functions_8c_html_a673be4c4c8d110389f3ee5e26e2fce7e"><div class="ttname"><a href="#a673be4c4c8d110389f3ee5e26e2fce7e">CustomStrlen</a></div><div class="ttdeci">UINT32 CustomStrlen(UINT64 StrAddr, BOOLEAN IsWstring)</div><div class="ttdoc">Custom VMX-root compatible strlen.</div><div class="ttdef"><b>Definition</b> Functions.c:963</div></div>
<div class="ttc" id="a_functions_8c_html_a88be33f07f4e7e7bd3d55609c53dee08"><div class="ttname"><a href="#a88be33f07f4e7e7bd3d55609c53dee08">WcharToChar</a></div><div class="ttdeci">size_t WcharToChar(const wchar_t *src, char *dest, size_t dest_len)</div><div class="ttdoc">Convert WCHAR* to CHAR*.</div><div class="ttdef"><b>Definition</b> Functions.c:1068</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4b9c8387e09821a8668975ec6119782e"><div class="ttname"><a href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1120</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17ee2cedee42ef138ba9425c59063a9d" name="a17ee2cedee42ef138ba9425c59063a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17ee2cedee42ef138ba9425c59063a9d">&#9670;&#160;</a></span>CheckIfStringIsSafe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> CheckIfStringIsSafe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>StrAddr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsWstring</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if string is safe to be accessed or not (in vmx-root mode) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">StrAddr</td><td></td></tr>
    <tr><td class="paramname">IsWstring</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  998</span>{</div>
<div class="line"><span class="lineno">  999</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1000</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1001</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1004</span> </div>
<div class="line"><span class="lineno"> 1005</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1006</span>    <span class="comment">// At least two chars (wchar_t is 4 byte)</span></div>
<div class="line"><span class="lineno"> 1007</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(StrAddr, IsWstring ? 4 : 2))</div>
<div class="line"><span class="lineno"> 1009</span>    {</div>
<div class="line"><span class="lineno"> 1010</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1011</span>    }</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1013</span>    {</div>
<div class="line"><span class="lineno"> 1014</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1015</span>    }</div>
<div class="line"><span class="lineno"> 1016</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1017</span>}</div>
<div class="ttc" id="a_address_check_8c_html_aec71cec56c29db61a23b2997ee8e2059"><div class="ttname"><a href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a></div><div class="ttdeci">BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition</b> AddressCheck.c:156</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a673be4c4c8d110389f3ee5e26e2fce7e" name="a673be4c4c8d110389f3ee5e26e2fce7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a673be4c4c8d110389f3ee5e26e2fce7e">&#9670;&#160;</a></span>CustomStrlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CustomStrlen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>StrAddr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsWstring</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Custom VMX-root compatible strlen. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">StrAddr</td><td></td></tr>
    <tr><td class="paramname">IsWstring</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT32 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  964</span>{</div>
<div class="line"><span class="lineno">  965</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  966</span> </div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordflow">if</span> (IsWstring)</div>
<div class="line"><span class="lineno">  968</span>    {</div>
<div class="line"><span class="lineno">  969</span>        <span class="keywordflow">return</span> (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)wcslen((<span class="keyword">const</span> <span class="keywordtype">wchar_t</span> *)StrAddr);</div>
<div class="line"><span class="lineno">  970</span>    }</div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  972</span>    {</div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">return</span> (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen((<span class="keyword">const</span> <span class="keywordtype">char</span> *)StrAddr);</div>
<div class="line"><span class="lineno">  974</span>    }</div>
<div class="line"><span class="lineno">  975</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">if</span> (IsWstring)</div>
<div class="line"><span class="lineno">  979</span>    {</div>
<div class="line"><span class="lineno">  980</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="_export_8c.html#a8b5f68e9b7ab5207aa40649b889664f8">VmFuncVmxCompatibleWcslen</a>((<span class="keyword">const</span> <span class="keywordtype">wchar_t</span> *)StrAddr);</div>
<div class="line"><span class="lineno">  981</span>    }</div>
<div class="line"><span class="lineno">  982</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  983</span>    {</div>
<div class="line"><span class="lineno">  984</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="_export_8c.html#a6f7c37ac0853860564a7e2967eaa3bc0">VmFuncVmxCompatibleStrlen</a>((<span class="keyword">const</span> <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *)StrAddr);</div>
<div class="line"><span class="lineno">  985</span>    }</div>
<div class="line"><span class="lineno">  986</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  987</span>}</div>
<div class="ttc" id="a_export_8c_html_a6f7c37ac0853860564a7e2967eaa3bc0"><div class="ttname"><a href="_export_8c.html#a6f7c37ac0853860564a7e2967eaa3bc0">VmFuncVmxCompatibleStrlen</a></div><div class="ttdeci">UINT32 VmFuncVmxCompatibleStrlen(const CHAR *s)</div><div class="ttdoc">VMX-root compatible strlen.</div><div class="ttdef"><b>Definition</b> Export.c:599</div></div>
<div class="ttc" id="a_export_8c_html_a8b5f68e9b7ab5207aa40649b889664f8"><div class="ttname"><a href="_export_8c.html#a8b5f68e9b7ab5207aa40649b889664f8">VmFuncVmxCompatibleWcslen</a></div><div class="ttdeci">UINT32 VmFuncVmxCompatibleWcslen(const wchar_t *s)</div><div class="ttdoc">VMX-root compatible strlen.</div><div class="ttdef"><b>Definition</b> Export.c:611</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add7975ffafcc4340f289092638222d9c" name="add7975ffafcc4340f289092638222d9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add7975ffafcc4340f289092638222d9c">&#9670;&#160;</a></span>GetValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GetValue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a></td>          <td class="paramname"><span class="paramname"><em>GuestRegs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_common_definitions_8h.html#a7afb70efbbc123180260563957758cdf">PACTION_BUFFER</a></td>          <td class="paramname"><span class="paramname"><em>ActionBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a31d689027f2f9713d9659a3bcb72acbc">SCRIPT_ENGINE_VARIABLES_LIST</a> *</td>          <td class="paramname"><span class="paramname"><em>VariablesList</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_common_definitions_8h.html#a2a27f43201a2da17c5602965ac8feab2">PSYMBOL</a></td>          <td class="paramname"><span class="paramname"><em>Symbol</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>ReturnReference</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_s_y_m_b_o_l___b_u_f_f_e_r.html">SYMBOL_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>StackBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>StackIndx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>StackBaseIndx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>ReturnValue</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6e351a0b8d7c0869e31d59be606fd695" name="a6e351a0b8d7c0869e31d59be606fd695"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e351a0b8d7c0869e31d59be606fd695">&#9670;&#160;</a></span>ScriptEngineFunctionCheckAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ScriptEngineFunctionCheckAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Length</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether the address is valid or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
    <tr><td class="paramname">Length</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  169</span>{</div>
<div class="line"><span class="lineno">  170</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, Length))</div>
<div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, Length))</div>
<div class="line"><span class="lineno">  182</span>    {</div>
<div class="line"><span class="lineno">  183</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  189</span>}</div>
<div class="ttc" id="a_hyper_dbg_script_imports_8h_html_a3f7c5b71d899e923be0a80d4ac7902fe"><div class="ttname"><a href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> HyperDbgScriptImports.h:67</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa21b2d7c45183686341089fa29c239dd" name="aa21b2d7c45183686341089fa29c239dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21b2d7c45183686341089fa29c239dd">&#9670;&#160;</a></span>ScriptEngineFunctionDisassembleLen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionDisassembleLen </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>Is32Bit</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of disassemble_len function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
    <tr><td class="paramname">Is32Bit</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  525</span>{</div>
<div class="line"><span class="lineno">  526</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno">  527</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  528</span>    Result = <a class="code hl_function" href="disassembler_8cpp.html#afb62b377dc161aa67af8b4d0e72e62e2">HyperDbgLengthDisassemblerEngine</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <a class="code hl_define" href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>, Is32Bit ? <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a> : <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  529</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  532</span>    Result = <a class="code hl_function" href="_disassembler_8c.html#a387718dcee35d796938ad5f9b9fb1820">DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, Is32Bit);</div>
<div class="line"><span class="lineno">  533</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  536</span>}</div>
<div class="ttc" id="a_constants_8h_html_abc19f528c1665033d9ac7f477a26c608"><div class="ttname"><a href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a></div><div class="ttdeci">#define MAXIMUM_INSTR_SIZE</div><div class="ttdoc">maximum instruction size in Intel</div><div class="ttdef"><b>Definition</b> Constants.h:468</div></div>
<div class="ttc" id="a_disassembler_8c_html_a387718dcee35d796938ad5f9b9fb1820"><div class="ttname"><a href="_disassembler_8c.html#a387718dcee35d796938ad5f9b9fb1820">DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess</a></div><div class="ttdeci">UINT32 DisassemblerLengthDisassembleEngineInVmxRootOnTargetProcess(PVOID Address, BOOLEAN Is32Bit)</div><div class="ttdoc">Disassembler length disassembler engine.</div><div class="ttdef"><b>Definition</b> Disassembler.c:297</div></div>
<div class="ttc" id="adisassembler_8cpp_html_afb62b377dc161aa67af8b4d0e72e62e2"><div class="ttname"><a href="disassembler_8cpp.html#afb62b377dc161aa67af8b4d0e72e62e2">HyperDbgLengthDisassemblerEngine</a></div><div class="ttdeci">UINT32 HyperDbgLengthDisassemblerEngine(unsigned char *BufferToDisassemble, UINT64 BuffLength, BOOLEAN Isx86_64)</div><div class="ttdoc">Length Disassembler engine based on Zydis.</div><div class="ttdef"><b>Definition</b> disassembler.cpp:856</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add624b429cdd05ae37b0f973acd1b99f" name="add624b429cdd05ae37b0f973acd1b99f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add624b429cdd05ae37b0f973acd1b99f">&#9670;&#160;</a></span>ScriptEngineFunctionEb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ScriptEngineFunctionEb </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of eb function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{</div>
<div class="line"><span class="lineno">  132</span>    UNREFERENCED_PARAMETER(HasError);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>)))</div>
<div class="line"><span class="lineno">  137</span>    {</div>
<div class="line"><span class="lineno">  138</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">// Instead of indicating an error, just return false</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">// to assign it as a return result to a variable</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  142</span>        <span class="comment">// *HasError = TRUE;</span></div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  145</span>    }</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  150</span>    *(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a> *)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>;</div>
<div class="line"><span class="lineno">  151</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, &amp;<a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>));</div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  158</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a4ae1dab0fb4b072a66584546209e7d58"><div class="ttname"><a href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a></div><div class="ttdeci">unsigned char BYTE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:24</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a7c9eb4ee4fb121c661b36f36908f3a50"><div class="ttname"><a href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperWriteMemorySafeOnTargetProcess(UINT64 Destination, PVOID Source, SIZE_T Size)</div><div class="ttdoc">Write memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1165</div></div>
<div class="ttc" id="ainstance__info_8hex_8txt_html_a1068e3543230ebb8ef661f6f6cce7f8f"><div class="ttname"><a href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a></div><div class="ttdeci">RequestedActionOfThePacket Value(0x1) 00000000</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4852c9c360e94ccc388a65d63a40e03e" name="a4852c9c360e94ccc388a65d63a40e03e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4852c9c360e94ccc388a65d63a40e03e">&#9670;&#160;</a></span>ScriptEngineFunctionEd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ScriptEngineFunctionEd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of ed function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   92</span>{</div>
<div class="line"><span class="lineno">   93</span>    UNREFERENCED_PARAMETER(HasError);</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>)))</div>
<div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">// Instead of indicating an error, just return false</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">// to assign it as a return result to a variable</span></div>
<div class="line"><span class="lineno">  102</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  103</span>        <span class="comment">// *HasError = TRUE;</span></div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  111</span>    *(<a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> *)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>;</div>
<div class="line"><span class="lineno">  112</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, &amp;<a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>));</div>
<div class="line"><span class="lineno">  116</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  119</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ad342ac907eb044443153a22f964bf0af"><div class="ttname"><a href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a></div><div class="ttdeci">unsigned long DWORD</div><div class="ttdef"><b>Definition</b> BasicTypes.h:22</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae5324ab914487cba0248f2b41babae8" name="aae5324ab914487cba0248f2b41babae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae5324ab914487cba0248f2b41babae8">&#9670;&#160;</a></span>ScriptEngineFunctionEq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ScriptEngineFunctionEq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a6fe04fdd875bcad282f702bb818897b6">QWORD</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of eq function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   53</span>{</div>
<div class="line"><span class="lineno">   54</span>    UNREFERENCED_PARAMETER(HasError);</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a6fe04fdd875bcad282f702bb818897b6">QWORD</a>)))</div>
<div class="line"><span class="lineno">   59</span>    {</div>
<div class="line"><span class="lineno">   60</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   61</span>        <span class="comment">// Instead of indicating an error, just return false</span></div>
<div class="line"><span class="lineno">   62</span>        <span class="comment">// to assign it as a return result to a variable</span></div>
<div class="line"><span class="lineno">   63</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   64</span>        <span class="comment">// *HasError = TRUE;</span></div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   67</span>    }</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">   72</span>    *(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>;</div>
<div class="line"><span class="lineno">   73</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, &amp;<a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#a6fe04fdd875bcad282f702bb818897b6">QWORD</a>));</div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   80</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a6fe04fdd875bcad282f702bb818897b6"><div class="ttname"><a href="_basic_types_8h.html#a6fe04fdd875bcad282f702bb818897b6">QWORD</a></div><div class="ttdeci">unsigned long long QWORD</div><div class="ttdef"><b>Definition</b> BasicTypes.h:20</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1ad79144ac0a5a2b11135baab5e5ad2" name="ad1ad79144ac0a5a2b11135baab5e5ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1ad79144ac0a5a2b11135baab5e5ad2">&#9670;&#160;</a></span>ScriptEngineFunctionEventClear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventClear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>EventId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_clear function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EventId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  762</span>{</div>
<div class="line"><span class="lineno">  763</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  764</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, disabling events is not possible in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  765</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PoolManagerAllocatedMemory = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> &amp;&amp; <a class="code hl_define" href="_configuration_8h.html#a20082a4cb18bad79b8ce796fae71ce1f">EnableInstantEventMechanism</a>)</div>
<div class="line"><span class="lineno">  772</span>    {</div>
<div class="line"><span class="lineno">  773</span>        PoolManagerAllocatedMemory = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  774</span>    }</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_debugger_8c.html#ad3c39d2eb9a9459886cd5794fba6bb84">DebuggerClearEvent</a>(EventId + <a class="code hl_define" href="_constants_8h.html#ae44f1306f64b26e78346c23a0ea8a7d9">DebuggerEventTagStartSeed</a>, <a class="code hl_function" href="_export_8c.html#a661e93cb9bae66f67ebef08fb9122fff">VmFuncVmxGetCurrentExecutionMode</a>(), PoolManagerAllocatedMemory))</div>
<div class="line"><span class="lineno">  777</span>    {</div>
<div class="line"><span class="lineno">  778</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Invalid tag id (%x)&quot;</span>, EventId);</div>
<div class="line"><span class="lineno">  779</span>    }</div>
<div class="line"><span class="lineno">  780</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  781</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_configuration_8h_html_a20082a4cb18bad79b8ce796fae71ce1f"><div class="ttname"><a href="_configuration_8h.html#a20082a4cb18bad79b8ce796fae71ce1f">EnableInstantEventMechanism</a></div><div class="ttdeci">#define EnableInstantEventMechanism</div><div class="ttdoc">Enable or disable the instant event mechanism.</div><div class="ttdef"><b>Definition</b> Configuration.h:75</div></div>
<div class="ttc" id="a_constants_8h_html_ae44f1306f64b26e78346c23a0ea8a7d9"><div class="ttname"><a href="_constants_8h.html#ae44f1306f64b26e78346c23a0ea8a7d9">DebuggerEventTagStartSeed</a></div><div class="ttdeci">#define DebuggerEventTagStartSeed</div><div class="ttdoc">The seeds that user-mode codes use as the starter of their events' tag.</div><div class="ttdef"><b>Definition</b> Constants.h:222</div></div>
<div class="ttc" id="a_debugger_8c_html_ad3c39d2eb9a9459886cd5794fba6bb84"><div class="ttname"><a href="_debugger_8c.html#ad3c39d2eb9a9459886cd5794fba6bb84">DebuggerClearEvent</a></div><div class="ttdeci">BOOLEAN DebuggerClearEvent(UINT64 Tag, BOOLEAN InputFromVmxRoot, BOOLEAN PoolManagerAllocatedMemory)</div><div class="ttdoc">Clear an event by tag.</div><div class="ttdef"><b>Definition</b> Debugger.c:2400</div></div>
<div class="ttc" id="a_export_8c_html_a661e93cb9bae66f67ebef08fb9122fff"><div class="ttname"><a href="_export_8c.html#a661e93cb9bae66f67ebef08fb9122fff">VmFuncVmxGetCurrentExecutionMode</a></div><div class="ttdeci">BOOLEAN VmFuncVmxGetCurrentExecutionMode()</div><div class="ttdoc">Get the current VMX operation state.</div><div class="ttdef"><b>Definition</b> Export.c:552</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a97b0adbd65790fb90734daa8e5245a04"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a></div><div class="ttdeci">#define LogInfo(format,...)</div><div class="ttdoc">Define log variables.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:71</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_ae4b5afa957e3e26377135b91b60eda4e"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a></div><div class="ttdeci">BOOLEAN g_KernelDebuggerState</div><div class="ttdoc">shows whether the kernel debugger is enabled or disabled</div><div class="ttdef"><b>Definition</b> Global.h:103</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a21c3c06b34d716c4680695c2b28127da"><div class="ttname"><a href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a></div><div class="ttdeci">VOID ShowMessages(const char *Fmt,...)</div><div class="ttdoc">Show messages.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:96</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a895626a4574c8489afb2855c0c399da3" name="a895626a4574c8489afb2855c0c399da3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a895626a4574c8489afb2855c0c399da3">&#9670;&#160;</a></span>ScriptEngineFunctionEventDisable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventDisable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>EventId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_disable function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EventId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  740</span>{</div>
<div class="line"><span class="lineno">  741</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  742</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, disabling events is not possible in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  743</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_debugger_8c.html#a80484d0a5b060724315e4aac0a732671">DebuggerDisableEvent</a>(EventId + <a class="code hl_define" href="_constants_8h.html#ae44f1306f64b26e78346c23a0ea8a7d9">DebuggerEventTagStartSeed</a>))</div>
<div class="line"><span class="lineno">  747</span>    {</div>
<div class="line"><span class="lineno">  748</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Invalid tag id (%x)&quot;</span>, EventId);</div>
<div class="line"><span class="lineno">  749</span>    }</div>
<div class="line"><span class="lineno">  750</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  751</span>}</div>
<div class="ttc" id="a_debugger_8c_html_a80484d0a5b060724315e4aac0a732671"><div class="ttname"><a href="_debugger_8c.html#a80484d0a5b060724315e4aac0a732671">DebuggerDisableEvent</a></div><div class="ttdeci">BOOLEAN DebuggerDisableEvent(UINT64 Tag)</div><div class="ttdoc">Disable an event by tag.</div><div class="ttdef"><b>Definition</b> Debugger.c:2363</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1fa7a0901c41583885c051da97c95bf" name="aa1fa7a0901c41583885c051da97c95bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1fa7a0901c41583885c051da97c95bf">&#9670;&#160;</a></span>ScriptEngineFunctionEventEnable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventEnable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>EventId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_enable function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EventId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  718</span>{</div>
<div class="line"><span class="lineno">  719</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  720</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, enabling events is not possible in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  721</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  724</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_debugger_8c.html#ad01633c5f92dfb1414a969734e739e4b">DebuggerEnableEvent</a>(EventId + <a class="code hl_define" href="_constants_8h.html#ae44f1306f64b26e78346c23a0ea8a7d9">DebuggerEventTagStartSeed</a>))</div>
<div class="line"><span class="lineno">  725</span>    {</div>
<div class="line"><span class="lineno">  726</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Invalid tag id (%x)&quot;</span>, EventId);</div>
<div class="line"><span class="lineno">  727</span>    }</div>
<div class="line"><span class="lineno">  728</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  729</span>}</div>
<div class="ttc" id="a_debugger_8c_html_ad01633c5f92dfb1414a969734e739e4b"><div class="ttname"><a href="_debugger_8c.html#ad01633c5f92dfb1414a969734e739e4b">DebuggerEnableEvent</a></div><div class="ttdeci">BOOLEAN DebuggerEnableEvent(UINT64 Tag)</div><div class="ttdoc">Enable an event by tag.</div><div class="ttdef"><b>Definition</b> Debugger.c:2302</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acade8592fda90744feaaa98ea2ebc6c3" name="acade8592fda90744feaaa98ea2ebc6c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acade8592fda90744feaaa98ea2ebc6c3">&#9670;&#160;</a></span>ScriptEngineFunctionEventInject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventInject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>InterruptionType</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Vector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_inject function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InterruptionType</td><td></td></tr>
    <tr><td class="paramname">Vector</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1505</span>{</div>
<div class="line"><span class="lineno"> 1506</span>    UNREFERENCED_PARAMETER(HasError);</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, event_inject is not supported in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1511</span> </div>
<div class="line"><span class="lineno"> 1512</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1513</span> </div>
<div class="line"><span class="lineno"> 1514</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1517</span>    <span class="comment">// Validate the arguments</span></div>
<div class="line"><span class="lineno"> 1518</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1519</span>    <span class="keywordflow">if</span> (Vector &gt;= 256 || InterruptionType &gt;= 8)</div>
<div class="line"><span class="lineno"> 1520</span>    {</div>
<div class="line"><span class="lineno"> 1521</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Err, invalid event vector or interruption type is specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 1522</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1523</span>    }</div>
<div class="line"><span class="lineno"> 1524</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1525</span>    {</div>
<div class="line"><span class="lineno"> 1526</span>        <a class="code hl_function" href="_export_8c.html#a779c75a59121ddf7078fb0e8d74b0766">VmFuncEventInjectInterruption</a>(InterruptionType, Vector, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, 0);</div>
<div class="line"><span class="lineno"> 1527</span>    }</div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1530</span>}</div>
<div class="ttc" id="a_export_8c_html_a779c75a59121ddf7078fb0e8d74b0766"><div class="ttname"><a href="_export_8c.html#a779c75a59121ddf7078fb0e8d74b0766">VmFuncEventInjectInterruption</a></div><div class="ttdeci">VOID VmFuncEventInjectInterruption(UINT32 InterruptionType, UINT32 Vector, BOOLEAN DeliverErrorCode, UINT32 ErrorCode)</div><div class="ttdoc">Inject interrupt/faults/exceptions.</div><div class="ttdef"><b>Definition</b> Export.c:662</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1c88a02e25a6857ac603500c6426fdf2" name="a1c88a02e25a6857ac603500c6426fdf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c88a02e25a6857ac603500c6426fdf2">&#9670;&#160;</a></span>ScriptEngineFunctionEventInjectErrorCode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventInjectErrorCode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>InterruptionType</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Vector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ErrorCode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_inject_error_code function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InterruptionType</td><td></td></tr>
    <tr><td class="paramname">Vector</td><td></td></tr>
    <tr><td class="paramname">ErrorCode</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1543</span>{</div>
<div class="line"><span class="lineno"> 1544</span>    UNREFERENCED_PARAMETER(HasError);</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, event_inject is not supported in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1555</span>    <span class="comment">// Validate the arguments</span></div>
<div class="line"><span class="lineno"> 1556</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1557</span>    <span class="keywordflow">if</span> (Vector &gt;= 256 || InterruptionType &gt;= 8)</div>
<div class="line"><span class="lineno"> 1558</span>    {</div>
<div class="line"><span class="lineno"> 1559</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Err, invalid event vector or interruption type is specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 1560</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1561</span>    }</div>
<div class="line"><span class="lineno"> 1562</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1563</span>    {</div>
<div class="line"><span class="lineno"> 1564</span>        <a class="code hl_function" href="_export_8c.html#a779c75a59121ddf7078fb0e8d74b0766">VmFuncEventInjectInterruption</a>(InterruptionType, Vector, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, ErrorCode);</div>
<div class="line"><span class="lineno"> 1565</span>    }</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1568</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e2efe52647d234b6314ed20ad4937c3" name="a0e2efe52647d234b6314ed20ad4937c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e2efe52647d234b6314ed20ad4937c3">&#9670;&#160;</a></span>ScriptEngineFunctionEventTraceInstrumentationStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventTraceInstrumentationStep </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_trace_instrumentation_step function. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1694</span>{</div>
<div class="line"><span class="lineno"> 1695</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1696</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, it&#39;s not possible to call event_trace_instrumentation_step function in the user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1697</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno"> 1702</span> </div>
<div class="line"><span class="lineno"> 1703</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1704</span>    <span class="comment">// Call instrumentation step in</span></div>
<div class="line"><span class="lineno"> 1705</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1706</span>    <a class="code hl_function" href="_tracing_8c.html#a216009aa3e9b4c164cfe020723a6c375">TracingPerformInstrumentationStepIn</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CurrentCore]);</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1709</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_tracing_8c_html_a216009aa3e9b4c164cfe020723a6c375"><div class="ttname"><a href="_tracing_8c.html#a216009aa3e9b4c164cfe020723a6c375">TracingPerformInstrumentationStepIn</a></div><div class="ttdeci">VOID TracingPerformInstrumentationStepIn(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Perform tracing of instructions (instrumentation step-in)</div><div class="ttdef"><b>Definition</b> Tracing.c:22</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition</b> Global.h:17</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5a4e2b05a7223ed3cfdeedf16167383" name="ad5a4e2b05a7223ed3cfdeedf16167383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5a4e2b05a7223ed3cfdeedf16167383">&#9670;&#160;</a></span>ScriptEngineFunctionEventTraceStepIn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionEventTraceStepIn </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_trace_step_in function. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1718</span>{</div>
<div class="line"><span class="lineno"> 1719</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1720</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, it&#39;s not possible to call event_trace_instrumentation_step function in the user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1721</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1722</span> </div>
<div class="line"><span class="lineno"> 1723</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1724</span> </div>
<div class="line"><span class="lineno"> 1725</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1728</span>    <span class="comment">// Call instrumentation step in</span></div>
<div class="line"><span class="lineno"> 1729</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1730</span>    <a class="code hl_function" href="_tracing_8c.html#a25b77b19c50828123afc3bfdc469cf23">TracingPerformRegularStepInInstruction</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CurrentCore]);</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1733</span>}</div>
<div class="ttc" id="a_tracing_8c_html_a25b77b19c50828123afc3bfdc469cf23"><div class="ttname"><a href="_tracing_8c.html#a25b77b19c50828123afc3bfdc469cf23">TracingPerformRegularStepInInstruction</a></div><div class="ttdeci">VOID TracingPerformRegularStepInInstruction(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Regular step-in | step one instruction to the debuggee.</div><div class="ttdef"><b>Definition</b> Tracing.c:113</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab48cb2504fb17c34607d006bfa29a56c" name="ab48cb2504fb17c34607d006bfa29a56c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab48cb2504fb17c34607d006bfa29a56c">&#9670;&#160;</a></span>ScriptEngineFunctionFlush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionFlush </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of flush function. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  867</span>{</div>
<div class="line"><span class="lineno">  868</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  869</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, it&#39;s not possible to flush buffers in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  870</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  875</span>    <span class="comment">// Mark all buffers as read</span></div>
<div class="line"><span class="lineno">  876</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  877</span>    <a class="code hl_function" href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  878</span>    <a class="code hl_function" href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  881</span>}</div>
<div class="ttc" id="a_logging_8c_html_a480d59927ef95ff8c6aa39a77e88ccc2"><div class="ttname"><a href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a></div><div class="ttdeci">UINT32 LogMarkAllAsRead(BOOLEAN IsVmxRoot)</div><div class="ttdoc">Mark all buffers as read.</div><div class="ttdef"><b>Definition</b> Logging.c:558</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae79b8c05c117b13727b5308297aefc29" name="ae79b8c05c117b13727b5308297aefc29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae79b8c05c117b13727b5308297aefc29">&#9670;&#160;</a></span>ScriptEngineFunctionFormats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionFormats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>ImmediateMessagePassing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of formats function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tag</td><td></td></tr>
    <tr><td class="paramname">ImmediateMessagePassing</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  930</span>{</div>
<div class="line"><span class="lineno">  931</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>    <a class="code hl_function" href="#adff9d56d78f06954aeae9787afdefcc0">ScriptEngineFunctionTestStatement</a>(<a class="code hl_variable" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, ImmediateMessagePassing, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  938</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a>)</div>
<div class="line"><span class="lineno">  939</span>    {</div>
<div class="line"><span class="lineno">  940</span>        <a class="code hl_function" href="_kd_8c.html#a0af968467072898abb6bbd25495a06eb">KdSendFormatsFunctionResult</a>(<a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  941</span>    }</div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  943</span>    {</div>
<div class="line"><span class="lineno">  944</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  945</span>        <span class="comment">// Prepare a buffer to bypass allocating a huge stack space for logging</span></div>
<div class="line"><span class="lineno">  946</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  947</span>        <span class="keywordtype">char</span>   TempBuffer[20] = {0};</div>
<div class="line"><span class="lineno">  948</span>        <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TempBufferLen  = sprintf(TempBuffer, <span class="stringliteral">&quot;%llx\n&quot;</span>, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a3e7108505d1e3f1398efa43c2ab75a72">LogSimpleWithTag</a>((<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)<a class="code hl_variable" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, ImmediateMessagePassing, TempBuffer, TempBufferLen + 1);</div>
<div class="line"><span class="lineno">  951</span>    }</div>
<div class="line"><span class="lineno">  952</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  953</span>}</div>
<div class="ttc" id="a_functions_8c_html_adff9d56d78f06954aeae9787afdefcc0"><div class="ttname"><a href="#adff9d56d78f06954aeae9787afdefcc0">ScriptEngineFunctionTestStatement</a></div><div class="ttdeci">VOID ScriptEngineFunctionTestStatement(UINT64 Tag, BOOLEAN ImmediateMessagePassing, UINT64 Value)</div><div class="ttdoc">Implementation of test_statement function.</div><div class="ttdef"><b>Definition</b> Functions.c:392</div></div>
<div class="ttc" id="a_hooks_8h_html_aba7c9f3767dcc5232354d3d17ceedb61"><div class="ttname"><a href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a></div><div class="ttdeci">POOL_TYPE SIZE_T ULONG Tag</div><div class="ttdef"><b>Definition</b> Hooks.h:168</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a3e7108505d1e3f1398efa43c2ab75a72"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a3e7108505d1e3f1398efa43c2ab75a72">LogSimpleWithTag</a></div><div class="ttdeci">#define LogSimpleWithTag(tag, isimmdte, buffer, len)</div><div class="ttdoc">Log without any prefix and bypass the stack problem (getting two temporary stacks in preparing phase)</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:142</div></div>
<div class="ttc" id="a_kd_8c_html_a0af968467072898abb6bbd25495a06eb"><div class="ttname"><a href="_kd_8c.html#a0af968467072898abb6bbd25495a06eb">KdSendFormatsFunctionResult</a></div><div class="ttdeci">VOID KdSendFormatsFunctionResult(UINT64 Value)</div><div class="ttdoc">Notify user-mode to unload the debuggee and close the connections.</div><div class="ttdef"><b>Definition</b> Kd.c:900</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa831db6212f2c35614b07381807256b2" name="aa831db6212f2c35614b07381807256b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa831db6212f2c35614b07381807256b2">&#9670;&#160;</a></span>ScriptEngineFunctionInterlockedCompareExchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long ScriptEngineFunctionInterlockedCompareExchange </td>
          <td>(</td>
          <td class="paramtype">long long volatile *</td>          <td class="paramname"><span class="paramname"><em>Destination</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long</td>          <td class="paramname"><span class="paramname"><em>ExChange</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long</td>          <td class="paramname"><span class="paramname"><em>Comperand</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of interlocked_compare_exchange function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Destination</td><td></td></tr>
    <tr><td class="paramname">ExChange</td><td></td></tr>
    <tr><td class="paramname">Comperand</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long long </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  691</span>{</div>
<div class="line"><span class="lineno">  692</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> Result = 0;</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Destination, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)))</div>
<div class="line"><span class="lineno">  697</span>    {</div>
<div class="line"><span class="lineno">  698</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  699</span>        <span class="keywordflow">return</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  700</span>    }</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    Result = InterlockedCompareExchange64(Destination, ExChange, Comperand);</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  707</span>}</div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d5f3e2a17e9497bd96c5cefe4c4ee70" name="a1d5f3e2a17e9497bd96c5cefe4c4ee70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d5f3e2a17e9497bd96c5cefe4c4ee70">&#9670;&#160;</a></span>ScriptEngineFunctionInterlockedDecrement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long ScriptEngineFunctionInterlockedDecrement </td>
          <td>(</td>
          <td class="paramtype">long long volatile *</td>          <td class="paramname"><span class="paramname"><em>Addend</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of interlocked_exchange_decrement function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Addend</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long long </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  658</span>{</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> Result = 0;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Addend, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)))</div>
<div class="line"><span class="lineno">  664</span>    {</div>
<div class="line"><span class="lineno">  665</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">return</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    Result = InterlockedDecrement64(Addend);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  674</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a73487cc08273f0270836b867160af273" name="a73487cc08273f0270836b867160af273"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73487cc08273f0270836b867160af273">&#9670;&#160;</a></span>ScriptEngineFunctionInterlockedExchange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long ScriptEngineFunctionInterlockedExchange </td>
          <td>(</td>
          <td class="paramtype">long long volatile *</td>          <td class="paramname"><span class="paramname"><em>Target</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long</td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of interlocked_exchange function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Target</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long long </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  572</span>{</div>
<div class="line"><span class="lineno">  573</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> Result = 0;</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Target, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)))</div>
<div class="line"><span class="lineno">  578</span>    {</div>
<div class="line"><span class="lineno">  579</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  580</span>        <span class="keywordflow">return</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  581</span>    }</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    Result = InterlockedExchange64(Target, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  588</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4d1ace162cfc47daeed724cc6ea4981" name="ae4d1ace162cfc47daeed724cc6ea4981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4d1ace162cfc47daeed724cc6ea4981">&#9670;&#160;</a></span>ScriptEngineFunctionInterlockedExchangeAdd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long ScriptEngineFunctionInterlockedExchangeAdd </td>
          <td>(</td>
          <td class="paramtype">long long volatile *</td>          <td class="paramname"><span class="paramname"><em>Addend</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long</td>          <td class="paramname"><span class="paramname"><em>Value</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of interlocked_exchange_add function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Addend</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long long </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  602</span>{</div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> Result = 0;</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Addend, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)))</div>
<div class="line"><span class="lineno">  608</span>    {</div>
<div class="line"><span class="lineno">  609</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">return</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  611</span>    }</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    Result = InterlockedExchangeAdd64(Addend, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  618</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a00c3aad01f2f22b1bad488ce616af7c0" name="a00c3aad01f2f22b1bad488ce616af7c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00c3aad01f2f22b1bad488ce616af7c0">&#9670;&#160;</a></span>ScriptEngineFunctionInterlockedIncrement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long long ScriptEngineFunctionInterlockedIncrement </td>
          <td>(</td>
          <td class="paramtype">long long volatile *</td>          <td class="paramname"><span class="paramname"><em>Addend</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of interlocked_exchange_increment function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Addend</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>long long </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  630</span>{</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> Result = 0;</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Addend, <span class="keyword">sizeof</span>(<span class="keywordtype">long</span> <span class="keywordtype">long</span>)))</div>
<div class="line"><span class="lineno">  636</span>    {</div>
<div class="line"><span class="lineno">  637</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  638</span>        <span class="keywordflow">return</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  639</span>    }</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    Result = InterlockedIncrement64(Addend);</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  646</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab632685e8ca1b9aa06ed5e484cd1553d" name="ab632685e8ca1b9aa06ed5e484cd1553d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab632685e8ca1b9aa06ed5e484cd1553d">&#9670;&#160;</a></span>ScriptEngineFunctionMemcmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionMemcmp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Count</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of memcmp function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Count</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1674</span>{</div>
<div class="line"><span class="lineno"> 1675</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno"> 1676</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1677</span>    Result = memcmp(Address1, Address2, Count);</div>
<div class="line"><span class="lineno"> 1678</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1681</span>    Result = <a class="code hl_function" href="_export_8c.html#a0be34d4146b0346f25599d1b9b5e24d4">VmFuncVmxCompatibleMemcmp</a>(Address1, Address2, Count);</div>
<div class="line"><span class="lineno"> 1682</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1683</span> </div>
<div class="line"><span class="lineno"> 1684</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1685</span>}</div>
<div class="ttc" id="a_export_8c_html_a0be34d4146b0346f25599d1b9b5e24d4"><div class="ttname"><a href="_export_8c.html#a0be34d4146b0346f25599d1b9b5e24d4">VmFuncVmxCompatibleMemcmp</a></div><div class="ttdeci">INT32 VmFuncVmxCompatibleMemcmp(const CHAR *Address1, const CHAR *Address2, size_t Count)</div><div class="ttdoc">VMX-root compatible memcmp.</div><div class="ttdef"><b>Definition</b> Export.c:787</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee0b6f2504f52d818e54764555d7008b" name="aee0b6f2504f52d818e54764555d7008b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee0b6f2504f52d818e54764555d7008b">&#9670;&#160;</a></span>ScriptEngineFunctionMemcpy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionMemcpy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Destination</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A VMX-compatible equivalent of memcpy function in C. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Destination</td><td></td></tr>
    <tr><td class="paramname">Source</td><td></td></tr>
    <tr><td class="paramname">Num</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  202</span>{</div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> PrevReadLen                                              = 0;</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a4ae1dab0fb4b072a66584546209e7d58">BYTE</a>   MovingBuffer[<a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>] = {0};</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment">// Check the destination address</span></div>
<div class="line"><span class="lineno">  210</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(Destination, Num))</div>
<div class="line"><span class="lineno">  212</span>    {</div>
<div class="line"><span class="lineno">  213</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  215</span>    }</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">// Check the source address</span></div>
<div class="line"><span class="lineno">  219</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(Source, Num))</div>
<div class="line"><span class="lineno">  221</span>    {</div>
<div class="line"><span class="lineno">  222</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="comment">// Address is valid, perform the memcpy in user-mode</span></div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  229</span>    memcpy((<span class="keywordtype">void</span> *)Destination, (<span class="keywordtype">void</span> *)Source, Num);</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>    <span class="comment">// Check the destination address</span></div>
<div class="line"><span class="lineno">  237</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(Destination, Num))</div>
<div class="line"><span class="lineno">  239</span>    {</div>
<div class="line"><span class="lineno">  240</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  242</span>    }</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="comment">// Check the source address</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(Source, Num))</div>
<div class="line"><span class="lineno">  248</span>    {</div>
<div class="line"><span class="lineno">  249</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  250</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  251</span>    }</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">// Address is valid, perform the memcpy in kernel-mode (VMX-root mode)</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">while</span> (Num &gt; 0)</div>
<div class="line"><span class="lineno">  257</span>    {</div>
<div class="line"><span class="lineno">  258</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>        <span class="comment">// Check the target buffer size</span></div>
<div class="line"><span class="lineno">  260</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  261</span>        <span class="keywordflow">if</span> (Num &gt; <a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>)</div>
<div class="line"><span class="lineno">  262</span>        {</div>
<div class="line"><span class="lineno">  263</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  264</span>            <span class="comment">// *** The size of read buffer is greater to maximum the moving buffer size ***</span></div>
<div class="line"><span class="lineno">  265</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  268</span>            <span class="comment">// Read memory into the buffer</span></div>
<div class="line"><span class="lineno">  269</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  270</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(Source + PrevReadLen, MovingBuffer, <a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>);</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  273</span>            <span class="comment">// Write the moving buffer into the target buffer</span></div>
<div class="line"><span class="lineno">  274</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  275</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>(Destination + PrevReadLen, MovingBuffer, <a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>);</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  278</span>            <span class="comment">// Computing the bytes that we read</span></div>
<div class="line"><span class="lineno">  279</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  280</span>            PrevReadLen += <a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>;</div>
<div class="line"><span class="lineno">  281</span>            Num -= <a class="code hl_define" href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a>;</div>
<div class="line"><span class="lineno">  282</span>        }</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  284</span>        {</div>
<div class="line"><span class="lineno">  285</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  286</span>            <span class="comment">// *** The size of read buffer is lower than or equal to the moving buffer size ***</span></div>
<div class="line"><span class="lineno">  287</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  290</span>            <span class="comment">// Read memory into the buffer</span></div>
<div class="line"><span class="lineno">  291</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  292</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(Source + PrevReadLen, MovingBuffer, Num);</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  295</span>            <span class="comment">// Write the moving buffer into the target buffer</span></div>
<div class="line"><span class="lineno">  296</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>(Destination + PrevReadLen, MovingBuffer, Num);</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  300</span>            <span class="comment">// Computing the bytes that we gonna read</span></div>
<div class="line"><span class="lineno">  301</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  302</span>            PrevReadLen += Num;</div>
<div class="line"><span class="lineno">  303</span>            Num = 0; <span class="comment">// or Num -= Num;</span></div>
<div class="line"><span class="lineno">  304</span>        }</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  308</span>}</div>
<div class="ttc" id="a_constants_8h_html_ac14f64f3ac5ff93c4b71ec62019abaf2"><div class="ttname"><a href="_constants_8h.html#ac14f64f3ac5ff93c4b71ec62019abaf2">DebuggerScriptEngineMemcpyMovingBufferSize</a></div><div class="ttdeci">#define DebuggerScriptEngineMemcpyMovingBufferSize</div><div class="ttdoc">The size of each chunk of memory used in the 'memcpy' function of the script engine for transferring ...</div><div class="ttdef"><b>Definition</b> Constants.h:250</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66a74f0eaf8812a3ad903518f3f82eac" name="a66a74f0eaf8812a3ad903518f3f82eac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66a74f0eaf8812a3ad903518f3f82eac">&#9670;&#160;</a></span>ScriptEngineFunctionPause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionPause </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>ActionDetail</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a></td>          <td class="paramname"><span class="paramname"><em>GuestRegs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of pause function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ActionDetail</td><td></td></tr>
    <tr><td class="paramname">GuestRegs</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  795</span>{</div>
<div class="line"><span class="lineno">  796</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  797</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, breaking is not possible in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  798</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">// pause(); function is only working when kernel debugger is working</span></div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">// it&#39;s not designed to work on vmi-mode (local debugging)</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> &amp;&amp; <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#acf21790b2fc221ed28789a132d509cb7">g_DebuggeeHaltReason</a> == <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba8b9a5f96451ae93d2751c8e1990a82da">DEBUGGEE_PAUSING_REASON_NOT_PAUSED</a>)</div>
<div class="line"><span class="lineno">  807</span>    {</div>
<div class="line"><span class="lineno">  808</span>        <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> TriggeredEventDetail = {0};</div>
<div class="line"><span class="lineno">  809</span>        <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                            CurrentCore          = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  812</span>        <span class="comment">// Make the details of context</span></div>
<div class="line"><span class="lineno">  813</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  814</span>        TriggeredEventDetail.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a>     = ActionDetail-&gt;<a class="code hl_variable" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a17e7061743d6772171767e53cfbcca88">Tag</a>;</div>
<div class="line"><span class="lineno">  815</span>        TriggeredEventDetail.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = (PVOID)ActionDetail-&gt;<a class="code hl_variable" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a065ba4b6004ad87cc33ae2b74613f248">Context</a>;</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>        <span class="keywordflow">if</span> (ActionDetail-&gt;<a class="code hl_variable" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a559696a8dcd6f46488decb62fdb96c7c">CallingStage</a> == 1)</div>
<div class="line"><span class="lineno">  818</span>        {</div>
<div class="line"><span class="lineno">  819</span>            TriggeredEventDetail.Stage = <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>;</div>
<div class="line"><span class="lineno">  820</span>        }</div>
<div class="line"><span class="lineno">  821</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  822</span>        {</div>
<div class="line"><span class="lineno">  823</span>            TriggeredEventDetail.Stage = <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>;</div>
<div class="line"><span class="lineno">  824</span>        }</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="_export_8c.html#a661e93cb9bae66f67ebef08fb9122fff">VmFuncVmxGetCurrentExecutionMode</a>() == <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno">  827</span>        {</div>
<div class="line"><span class="lineno">  828</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  829</span>            <span class="comment">// The guest is already in vmx-root mode</span></div>
<div class="line"><span class="lineno">  830</span>            <span class="comment">// Halt other cores</span></div>
<div class="line"><span class="lineno">  831</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>            <a class="code hl_function" href="_kd_8c.html#a3dd81f890bc081d3920c2f8ed8dcaf58">KdHandleBreakpointAndDebugBreakpointsCallback</a>(</div>
<div class="line"><span class="lineno">  834</span>                CurrentCore,</div>
<div class="line"><span class="lineno">  835</span>                <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba3383c140e8f057914f0b271a144b418c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_EVENT_TRIGGERED</a>,</div>
<div class="line"><span class="lineno">  836</span>                &amp;TriggeredEventDetail);</div>
<div class="line"><span class="lineno">  837</span>        }</div>
<div class="line"><span class="lineno">  838</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  839</span>        {</div>
<div class="line"><span class="lineno">  840</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  841</span>            <span class="comment">// The guest is on vmx non-root mode, the first parameter</span></div>
<div class="line"><span class="lineno">  842</span>            <span class="comment">// is context and the second parameter is tag</span></div>
<div class="line"><span class="lineno">  843</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  844</span>            <a class="code hl_function" href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a52336e1b3a49f31dc98f48dcc0e786ad">DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM_AS_A_RESULT_OF_TRIGGERING_EVENT</a>,</div>
<div class="line"><span class="lineno">  845</span>                            (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)&amp;TriggeredEventDetail,</div>
<div class="line"><span class="lineno">  846</span>                            (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)GuestRegs,</div>
<div class="line"><span class="lineno">  847</span>                            (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL);</div>
<div class="line"><span class="lineno">  848</span>        }</div>
<div class="line"><span class="lineno">  849</span>    }</div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  851</span>    {</div>
<div class="line"><span class="lineno">  852</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;The &#39;pause();&#39; function is either called from the vmi-mode or is &quot;</span></div>
<div class="line"><span class="lineno">  853</span>                <span class="stringliteral">&quot;evaluated by the &#39;?&#39; command. It&#39;s not allowed to use it on vmi-mode &quot;</span></div>
<div class="line"><span class="lineno">  854</span>                <span class="stringliteral">&quot;(local debugging) or by the &#39;?&#39; command&quot;</span>);</div>
<div class="line"><span class="lineno">  855</span>    }</div>
<div class="line"><span class="lineno">  856</span> </div>
<div class="line"><span class="lineno">  857</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  858</span>}</div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba3383c140e8f057914f0b271a144b418c"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba3383c140e8f057914f0b271a144b418c">DEBUGGEE_PAUSING_REASON_DEBUGGEE_EVENT_TRIGGERED</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_EVENT_TRIGGERED</div><div class="ttdef"><b>Definition</b> Connection.h:35</div></div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba8b9a5f96451ae93d2751c8e1990a82da"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba8b9a5f96451ae93d2751c8e1990a82da">DEBUGGEE_PAUSING_REASON_NOT_PAUSED</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_NOT_PAUSED</div><div class="ttdef"><b>Definition</b> Connection.h:24</div></div>
<div class="ttc" id="a_data_types_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf"><div class="ttname"><a href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</div><div class="ttdef"><b>Definition</b> DataTypes.h:93</div></div>
<div class="ttc" id="a_data_types_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e"><div class="ttname"><a href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</div><div class="ttdef"><b>Definition</b> DataTypes.h:94</div></div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a52336e1b3a49f31dc98f48dcc0e786ad"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a52336e1b3a49f31dc98f48dcc0e786ad">DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM_AS_A_RESULT_OF_TRIGGERING_EVENT</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM_AS_A_RESULT_OF_TRIGGERING_EVENT</div><div class="ttdoc">VMCALL to cause vm-exit and halt the system because of triggering an event.</div><div class="ttdef"><b>Definition</b> DebuggerVmcalls.h:29</div></div>
<div class="ttc" id="a_export_8c_html_a12ce0403e6a293853c4f103d73403b07"><div class="ttname"><a href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a></div><div class="ttdeci">NTSTATUS VmFuncVmxVmcall(unsigned long long VmcallNumber, unsigned long long OptionalParam1, unsigned long long OptionalParam2, unsigned long long OptionalParam3)</div><div class="ttdoc">Export for running VMX VMCALLs.</div><div class="ttdef"><b>Definition</b> Export.c:683</div></div>
<div class="ttc" id="a_kd_8c_html_a3dd81f890bc081d3920c2f8ed8dcaf58"><div class="ttname"><a href="_kd_8c.html#a3dd81f890bc081d3920c2f8ed8dcaf58">KdHandleBreakpointAndDebugBreakpointsCallback</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleBreakpointAndDebugBreakpointsCallback(UINT32 CoreId, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition</b> Kd.c:1124</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_acf21790b2fc221ed28789a132d509cb7"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#acf21790b2fc221ed28789a132d509cb7">g_DebuggeeHaltReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON g_DebuggeeHaltReason</div><div class="ttdoc">Reason that the debuggee is halted.</div><div class="ttdef"><b>Definition</b> Global.h:127</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">_DEBUGGER_TRIGGERED_EVENT_DETAILS</a></div><div class="ttdoc">The structure of detail of a triggered event in HyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:192</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition</b> DataTypes.h:193</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_aed232a35a0d0d95aa4ca77dc50fc6fae"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition</b> DataTypes.h:194</div></div>
<div class="ttc" id="astruct_a_c_t_i_o_n___b_u_f_f_e_r_html_a065ba4b6004ad87cc33ae2b74613f248"><div class="ttname"><a href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a065ba4b6004ad87cc33ae2b74613f248">ACTION_BUFFER::Context</a></div><div class="ttdeci">long long unsigned Context</div><div class="ttdef"><b>Definition</b> ScriptEngineCommonDefinitions.h:38</div></div>
<div class="ttc" id="astruct_a_c_t_i_o_n___b_u_f_f_e_r_html_a17e7061743d6772171767e53cfbcca88"><div class="ttname"><a href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a17e7061743d6772171767e53cfbcca88">ACTION_BUFFER::Tag</a></div><div class="ttdeci">long long unsigned Tag</div><div class="ttdef"><b>Definition</b> ScriptEngineCommonDefinitions.h:35</div></div>
<div class="ttc" id="astruct_a_c_t_i_o_n___b_u_f_f_e_r_html_a559696a8dcd6f46488decb62fdb96c7c"><div class="ttname"><a href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a559696a8dcd6f46488decb62fdb96c7c">ACTION_BUFFER::CallingStage</a></div><div class="ttdeci">char CallingStage</div><div class="ttdef"><b>Definition</b> ScriptEngineCommonDefinitions.h:39</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a512d364d2dd0d34a9204f87e5751cee1" name="a512d364d2dd0d34a9204f87e5751cee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a512d364d2dd0d34a9204f87e5751cee1">&#9670;&#160;</a></span>ScriptEngineFunctionPhysicalToVirtual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionPhysicalToVirtual </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert physical address to virtual address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  339</span>{</div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">// There is no conversion in user-mode</span></div>
<div class="line"><span class="lineno">  344</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  346</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_conversion_8c.html#a512f6b5eb5218445aa58489b8f9d8593">PhysicalAddressToVirtualAddressOnTargetProcess</a>((PVOID)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  353</span>}</div>
<div class="ttc" id="a_conversion_8c_html_a512f6b5eb5218445aa58489b8f9d8593"><div class="ttname"><a href="_conversion_8c.html#a512f6b5eb5218445aa58489b8f9d8593">PhysicalAddressToVirtualAddressOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 PhysicalAddressToVirtualAddressOnTargetProcess(PVOID PhysicalAddress)</div><div class="ttdoc">Converts Physical Address to Virtual Address based on current process's kernel cr3.</div><div class="ttdef"><b>Definition</b> Conversion.c:137</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9dc74b6fd3820807219338b324f05aa" name="ac9dc74b6fd3820807219338b324f05aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9dc74b6fd3820807219338b324f05aa">&#9670;&#160;</a></span>ScriptEngineFunctionPrint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionPrint </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>ImmediateMessagePassing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of print function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tag</td><td></td></tr>
    <tr><td class="paramname">ImmediateMessagePassing</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  365</span>{</div>
<div class="line"><span class="lineno">  366</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  367</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%llx\n&quot;</span>, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  368</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  373</span>    <span class="comment">// Prepare a buffer to bypass allocating a huge stack space for logging</span></div>
<div class="line"><span class="lineno">  374</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  375</span>    <span class="keywordtype">char</span>   TempBuffer[20] = {0};</div>
<div class="line"><span class="lineno">  376</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TempBufferLen  = sprintf(TempBuffer, <span class="stringliteral">&quot;%llx&quot;</span>, <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a3e7108505d1e3f1398efa43c2ab75a72">LogSimpleWithTag</a>((<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)<a class="code hl_variable" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, ImmediateMessagePassing, TempBuffer, TempBufferLen + 1);</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  381</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a806788132ce3f168c1f3bfe188078bb7" name="a806788132ce3f168c1f3bfe188078bb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a806788132ce3f168c1f3bfe188078bb7">&#9670;&#160;</a></span>ScriptEngineFunctionPrintf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionPrintf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a></td>          <td class="paramname"><span class="paramname"><em>GuestRegs</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>ActionDetail</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a31d689027f2f9713d9659a3bcb72acbc">SCRIPT_ENGINE_VARIABLES_LIST</a> *</td>          <td class="paramname"><span class="paramname"><em>VariablesList</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>ImmediateMessagePassing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>Format</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>ArgCount</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_script_engine_common_definitions_8h.html#a2a27f43201a2da17c5602965ac8feab2">PSYMBOL</a></td>          <td class="paramname"><span class="paramname"><em>FirstArg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_s_y_m_b_o_l___b_u_f_f_e_r.html">SYMBOL_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>StackBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>StackIndx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>StackBaseIndx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>ReturnValue</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of printf function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">GuestRegs</td><td></td></tr>
    <tr><td class="paramname">ActionDetail</td><td></td></tr>
    <tr><td class="paramname">VariablesList</td><td></td></tr>
    <tr><td class="paramname">Tag</td><td></td></tr>
    <tr><td class="paramname">ImmediateMessagePassing</td><td></td></tr>
    <tr><td class="paramname">Format</td><td></td></tr>
    <tr><td class="paramname">ArgCount</td><td></td></tr>
    <tr><td class="paramname">FirstArg</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1283</span>{</div>
<div class="line"><span class="lineno"> 1284</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1285</span>    <span class="comment">// *** The printf function ***</span></div>
<div class="line"><span class="lineno"> 1286</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>    <span class="keywordtype">char</span>    FinalBuffer[<a class="code hl_define" href="_constants_8h.html#aa6dceff1a2945f6daa01c13d9da8e65f">PacketChunkSize</a>]              = {0};</div>
<div class="line"><span class="lineno"> 1289</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CurrentPositionInFinalBuffer              = 0;</div>
<div class="line"><span class="lineno"> 1290</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CurrentProcessedPositionFromStartOfFormat = 0;</div>
<div class="line"><span class="lineno"> 1291</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> WithoutAnyFormatSpecifier                 = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  Val;</div>
<div class="line"><span class="lineno"> 1294</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  Position;</div>
<div class="line"><span class="lineno"> 1295</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  LenOfFormats = (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen(Format) + 1;</div>
<div class="line"><span class="lineno"> 1296</span>    <a class="code hl_struct" href="struct_s_y_m_b_o_l.html">PSYMBOL</a> Symbol;</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span>    *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; ArgCount; i++)</div>
<div class="line"><span class="lineno"> 1301</span>    {</div>
<div class="line"><span class="lineno"> 1302</span>        WithoutAnyFormatSpecifier = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1303</span>        Symbol                    = FirstArg + i;</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1306</span>        <span class="comment">// Address is either wstring (%ws) or string (%s)</span></div>
<div class="line"><span class="lineno"> 1307</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>        Position = (Symbol-&gt;<a class="code hl_variable" href="struct_s_y_m_b_o_l.html#af2114bd68c39d4c77d2636c71cf6c903">Type</a> &gt;&gt; 32) + 1;</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>        <a class="code hl_struct" href="struct_s_y_m_b_o_l.html">SYMBOL</a> TempSymbol = {0};</div>
<div class="line"><span class="lineno"> 1312</span>        memcpy(&amp;TempSymbol, Symbol, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_s_y_m_b_o_l.html">SYMBOL</a>));</div>
<div class="line"><span class="lineno"> 1313</span>        TempSymbol.<a class="code hl_variable" href="struct_s_y_m_b_o_l.html#af2114bd68c39d4c77d2636c71cf6c903">Type</a> &amp;= 0x7fffffff;</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>        Val = <a class="code hl_function" href="#add7975ffafcc4340f289092638222d9c">GetValue</a>(GuestRegs, ActionDetail, VariablesList, &amp;TempSymbol, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, StackBuffer, StackIndx, StackBaseIndx, ReturnValue);</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>        <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> PercentageChar = Format[Position];</div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1320</span><span class="comment">    printf(&quot;position = %d is %c%c \n&quot;, Position, PercentageChar,</span></div>
<div class="line"><span class="lineno"> 1321</span><span class="comment">           IndicatorChar1);</span></div>
<div class="line"><span class="lineno"> 1322</span><span class="comment">           */</span></div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>        <span class="keywordflow">if</span> (CurrentProcessedPositionFromStartOfFormat != Position)</div>
<div class="line"><span class="lineno"> 1325</span>        {</div>
<div class="line"><span class="lineno"> 1326</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1327</span>            <span class="comment">// There is some strings before this format specifier</span></div>
<div class="line"><span class="lineno"> 1328</span>            <span class="comment">// we should move it to the buffer</span></div>
<div class="line"><span class="lineno"> 1329</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1330</span>            <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> StringLen = Position - CurrentProcessedPositionFromStartOfFormat;</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1333</span>            <span class="comment">// Check final buffer capacity</span></div>
<div class="line"><span class="lineno"> 1334</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1335</span>            <span class="keywordflow">if</span> (CurrentPositionInFinalBuffer + StringLen &lt; <span class="keyword">sizeof</span>(FinalBuffer))</div>
<div class="line"><span class="lineno"> 1336</span>            {</div>
<div class="line"><span class="lineno"> 1337</span>                memcpy(&amp;FinalBuffer[CurrentPositionInFinalBuffer],</div>
<div class="line"><span class="lineno"> 1338</span>                       &amp;Format[CurrentProcessedPositionFromStartOfFormat],</div>
<div class="line"><span class="lineno"> 1339</span>                       StringLen);</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>                CurrentProcessedPositionFromStartOfFormat += StringLen;</div>
<div class="line"><span class="lineno"> 1342</span>                CurrentPositionInFinalBuffer += StringLen;</div>
<div class="line"><span class="lineno"> 1343</span>            }</div>
<div class="line"><span class="lineno"> 1344</span>        }</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1347</span>        <span class="comment">// Double check and apply</span></div>
<div class="line"><span class="lineno"> 1348</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1349</span>        <span class="keywordflow">if</span> (PercentageChar == <span class="charliteral">&#39;%&#39;</span>)</div>
<div class="line"><span class="lineno"> 1350</span>        {</div>
<div class="line"><span class="lineno"> 1351</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1352</span>            <span class="comment">// Set first character of specifier</span></div>
<div class="line"><span class="lineno"> 1353</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1354</span>            <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> FormatSpecifier[5] = {0};</div>
<div class="line"><span class="lineno"> 1355</span>            FormatSpecifier[0]      = <span class="charliteral">&#39;%&#39;</span>;</div>
<div class="line"><span class="lineno"> 1356</span> </div>
<div class="line"><span class="lineno"> 1357</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1358</span>            <span class="comment">// Read second char</span></div>
<div class="line"><span class="lineno"> 1359</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1360</span>            <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> IndicatorChar2 = Format[Position + 1];</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1363</span>            <span class="comment">// Check if IndicatorChar2 is 2 character long or more</span></div>
<div class="line"><span class="lineno"> 1364</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1365</span>            <span class="keywordflow">if</span> (IndicatorChar2 == <span class="charliteral">&#39;l&#39;</span> || IndicatorChar2 == <span class="charliteral">&#39;w&#39;</span> ||</div>
<div class="line"><span class="lineno"> 1366</span>                IndicatorChar2 == <span class="charliteral">&#39;h&#39;</span>)</div>
<div class="line"><span class="lineno"> 1367</span>            {</div>
<div class="line"><span class="lineno"> 1368</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1369</span>                <span class="comment">// Set second char in format specifier</span></div>
<div class="line"><span class="lineno"> 1370</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1371</span>                FormatSpecifier[1] = IndicatorChar2;</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>                <span class="keywordflow">if</span> (IndicatorChar2 == <span class="charliteral">&#39;l&#39;</span> &amp;&amp; Format[Position + 2] == <span class="charliteral">&#39;l&#39;</span>)</div>
<div class="line"><span class="lineno"> 1374</span>                {</div>
<div class="line"><span class="lineno"> 1375</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1376</span>                    <span class="comment">// Set third character in format specifier &quot;ll&quot;</span></div>
<div class="line"><span class="lineno"> 1377</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1378</span>                    FormatSpecifier[2] = <span class="charliteral">&#39;l&#39;</span>;</div>
<div class="line"><span class="lineno"> 1379</span> </div>
<div class="line"><span class="lineno"> 1380</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1381</span>                    <span class="comment">// Set last character</span></div>
<div class="line"><span class="lineno"> 1382</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1383</span>                    FormatSpecifier[3] = Format[Position + 3];</div>
<div class="line"><span class="lineno"> 1384</span>                }</div>
<div class="line"><span class="lineno"> 1385</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1386</span>                {</div>
<div class="line"><span class="lineno"> 1387</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1388</span>                    <span class="comment">// Set last character</span></div>
<div class="line"><span class="lineno"> 1389</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1390</span>                    FormatSpecifier[2] = Format[Position + 2];</div>
<div class="line"><span class="lineno"> 1391</span>                }</div>
<div class="line"><span class="lineno"> 1392</span>            }</div>
<div class="line"><span class="lineno"> 1393</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1394</span>            {</div>
<div class="line"><span class="lineno"> 1395</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1396</span>                <span class="comment">// It&#39;s a one char specifier (Set last character)</span></div>
<div class="line"><span class="lineno"> 1397</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1398</span>                FormatSpecifier[1] = IndicatorChar2;</div>
<div class="line"><span class="lineno"> 1399</span>            }</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1402</span>            <span class="comment">// Apply the specifier</span></div>
<div class="line"><span class="lineno"> 1403</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1404</span>            <span class="keywordflow">if</span> (!strncmp(FormatSpecifier, <span class="stringliteral">&quot;%s&quot;</span>, 2))</div>
<div class="line"><span class="lineno"> 1405</span>            {</div>
<div class="line"><span class="lineno"> 1406</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1407</span>                <span class="comment">// for string</span></div>
<div class="line"><span class="lineno"> 1408</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1409</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="#ab0a08cdea3c62ad35619e0da43108db1">ApplyStringFormatSpecifier</a>(</div>
<div class="line"><span class="lineno"> 1410</span>                        <span class="stringliteral">&quot;%s&quot;</span>,</div>
<div class="line"><span class="lineno"> 1411</span>                        FinalBuffer,</div>
<div class="line"><span class="lineno"> 1412</span>                        &amp;CurrentProcessedPositionFromStartOfFormat,</div>
<div class="line"><span class="lineno"> 1413</span>                        &amp;CurrentPositionInFinalBuffer,</div>
<div class="line"><span class="lineno"> 1414</span>                        Val,</div>
<div class="line"><span class="lineno"> 1415</span>                        <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,</div>
<div class="line"><span class="lineno"> 1416</span>                        <span class="keyword">sizeof</span>(FinalBuffer)))</div>
<div class="line"><span class="lineno"> 1417</span>                {</div>
<div class="line"><span class="lineno"> 1418</span>                    *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1419</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1420</span>                }</div>
<div class="line"><span class="lineno"> 1421</span>            }</div>
<div class="line"><span class="lineno"> 1422</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strncmp(FormatSpecifier, <span class="stringliteral">&quot;%ls&quot;</span>, 3) ||</div>
<div class="line"><span class="lineno"> 1423</span>                     !strncmp(FormatSpecifier, <span class="stringliteral">&quot;%ws&quot;</span>, 3))</div>
<div class="line"><span class="lineno"> 1424</span>            {</div>
<div class="line"><span class="lineno"> 1425</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1426</span>                <span class="comment">// for wide string (not important if %ls or %ws , only the length is</span></div>
<div class="line"><span class="lineno"> 1427</span>                <span class="comment">// important)</span></div>
<div class="line"><span class="lineno"> 1428</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1429</span>                <span class="keywordflow">if</span> (!<a class="code hl_function" href="#ab0a08cdea3c62ad35619e0da43108db1">ApplyStringFormatSpecifier</a>(</div>
<div class="line"><span class="lineno"> 1430</span>                        <span class="stringliteral">&quot;%ws&quot;</span>,</div>
<div class="line"><span class="lineno"> 1431</span>                        FinalBuffer,</div>
<div class="line"><span class="lineno"> 1432</span>                        &amp;CurrentProcessedPositionFromStartOfFormat,</div>
<div class="line"><span class="lineno"> 1433</span>                        &amp;CurrentPositionInFinalBuffer,</div>
<div class="line"><span class="lineno"> 1434</span>                        Val,</div>
<div class="line"><span class="lineno"> 1435</span>                        <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,</div>
<div class="line"><span class="lineno"> 1436</span>                        <span class="keyword">sizeof</span>(FinalBuffer)))</div>
<div class="line"><span class="lineno"> 1437</span>                {</div>
<div class="line"><span class="lineno"> 1438</span>                    *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1439</span>                    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1440</span>                }</div>
<div class="line"><span class="lineno"> 1441</span>            }</div>
<div class="line"><span class="lineno"> 1442</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1443</span>            {</div>
<div class="line"><span class="lineno"> 1444</span>                <a class="code hl_function" href="#af2de4e26af9bd9b702c5bbd8f4f0d94b">ApplyFormatSpecifier</a>(FormatSpecifier, FinalBuffer, &amp;CurrentProcessedPositionFromStartOfFormat, &amp;CurrentPositionInFinalBuffer, Val, <span class="keyword">sizeof</span>(FinalBuffer));</div>
<div class="line"><span class="lineno"> 1445</span>            }</div>
<div class="line"><span class="lineno"> 1446</span>        }</div>
<div class="line"><span class="lineno"> 1447</span>    }</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>    <span class="keywordflow">if</span> (WithoutAnyFormatSpecifier)</div>
<div class="line"><span class="lineno"> 1450</span>    {</div>
<div class="line"><span class="lineno"> 1451</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1452</span>        <span class="comment">// Means that it&#39;s just a simple print without any format specifier</span></div>
<div class="line"><span class="lineno"> 1453</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1454</span>        <span class="keywordflow">if</span> (LenOfFormats &lt; <span class="keyword">sizeof</span>(FinalBuffer))</div>
<div class="line"><span class="lineno"> 1455</span>        {</div>
<div class="line"><span class="lineno"> 1456</span>            memcpy(FinalBuffer, Format, LenOfFormats);</div>
<div class="line"><span class="lineno"> 1457</span>        }</div>
<div class="line"><span class="lineno"> 1458</span>    }</div>
<div class="line"><span class="lineno"> 1459</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1460</span>    {</div>
<div class="line"><span class="lineno"> 1461</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1462</span>        <span class="comment">// Check if there is anything after the last format specifier</span></div>
<div class="line"><span class="lineno"> 1463</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1464</span>        <span class="keywordflow">if</span> (LenOfFormats &gt; CurrentProcessedPositionFromStartOfFormat)</div>
<div class="line"><span class="lineno"> 1465</span>        {</div>
<div class="line"><span class="lineno"> 1466</span>            <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> RemainedLen =</div>
<div class="line"><span class="lineno"> 1467</span>                LenOfFormats - CurrentProcessedPositionFromStartOfFormat;</div>
<div class="line"><span class="lineno"> 1468</span> </div>
<div class="line"><span class="lineno"> 1469</span>            <span class="keywordflow">if</span> (CurrentPositionInFinalBuffer + RemainedLen &lt; <span class="keyword">sizeof</span>(FinalBuffer))</div>
<div class="line"><span class="lineno"> 1470</span>            {</div>
<div class="line"><span class="lineno"> 1471</span>                memcpy(&amp;FinalBuffer[CurrentPositionInFinalBuffer],</div>
<div class="line"><span class="lineno"> 1472</span>                       &amp;Format[CurrentProcessedPositionFromStartOfFormat],</div>
<div class="line"><span class="lineno"> 1473</span>                       RemainedLen);</div>
<div class="line"><span class="lineno"> 1474</span>            }</div>
<div class="line"><span class="lineno"> 1475</span>        }</div>
<div class="line"><span class="lineno"> 1476</span>    }</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1479</span><span class="comment">// Print final result</span></div>
<div class="line"><span class="lineno"> 1480</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1481</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1482</span>    printf(<span class="stringliteral">&quot;%s&quot;</span>, FinalBuffer);</div>
<div class="line"><span class="lineno"> 1483</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1485</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1488</span>    <span class="comment">// Prepare a buffer to bypass allocating a huge stack space for logging</span></div>
<div class="line"><span class="lineno"> 1489</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1490</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a3e7108505d1e3f1398efa43c2ab75a72">LogSimpleWithTag</a>((<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)<a class="code hl_variable" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>, ImmediateMessagePassing, FinalBuffer, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)strlen(FinalBuffer) + 1);</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1493</span>}</div>
<div class="ttc" id="a_constants_8h_html_aa6dceff1a2945f6daa01c13d9da8e65f"><div class="ttname"><a href="_constants_8h.html#aa6dceff1a2945f6daa01c13d9da8e65f">PacketChunkSize</a></div><div class="ttdeci">#define PacketChunkSize</div><div class="ttdoc">Size of each packet.</div><div class="ttdef"><b>Definition</b> Constants.h:179</div></div>
<div class="ttc" id="a_functions_8c_html_ab0a08cdea3c62ad35619e0da43108db1"><div class="ttname"><a href="#ab0a08cdea3c62ad35619e0da43108db1">ApplyStringFormatSpecifier</a></div><div class="ttdeci">BOOLEAN ApplyStringFormatSpecifier(const CHAR *CurrentSpecifier, CHAR *FinalBuffer, PUINT32 CurrentProcessedPositionFromStartOfFormat, PUINT32 CurrentPositionInFinalBuffer, UINT64 Val, BOOLEAN IsWstring, UINT32 SizeOfFinalBuffer)</div><div class="ttdoc">Apply string format specifiers (s, ws, etc.)</div><div class="ttdef"><b>Definition</b> Functions.c:1110</div></div>
<div class="ttc" id="a_functions_8c_html_add7975ffafcc4340f289092638222d9c"><div class="ttname"><a href="#add7975ffafcc4340f289092638222d9c">GetValue</a></div><div class="ttdeci">UINT64 GetValue(PGUEST_REGS GuestRegs, PACTION_BUFFER ActionBuffer, SCRIPT_ENGINE_VARIABLES_LIST *VariablesList, PSYMBOL Symbol, BOOLEAN ReturnReference, SYMBOL_BUFFER *StackBuffer, UINT64 *StackIndx, UINT64 *StackBaseIndx, UINT64 *ReturnValue)</div></div>
<div class="ttc" id="a_functions_8c_html_af2de4e26af9bd9b702c5bbd8f4f0d94b"><div class="ttname"><a href="#af2de4e26af9bd9b702c5bbd8f4f0d94b">ApplyFormatSpecifier</a></div><div class="ttdeci">VOID ApplyFormatSpecifier(const CHAR *CurrentSpecifier, CHAR *FinalBuffer, PUINT32 CurrentProcessedPositionFromStartOfFormat, PUINT32 CurrentPositionInFinalBuffer, UINT64 Val, UINT32 SizeOfFinalBuffer)</div><div class="ttdoc">Apply format specifiers (d, x, llx, etc.)</div><div class="ttdef"><b>Definition</b> Functions.c:1031</div></div>
<div class="ttc" id="astruct_s_y_m_b_o_l_html"><div class="ttname"><a href="struct_s_y_m_b_o_l.html">SYMBOL</a></div><div class="ttdef"><b>Definition</b> ScriptEngineCommonDefinitions.h:6</div></div>
<div class="ttc" id="astruct_s_y_m_b_o_l_html_af2114bd68c39d4c77d2636c71cf6c903"><div class="ttname"><a href="struct_s_y_m_b_o_l.html#af2114bd68c39d4c77d2636c71cf6c903">SYMBOL::Type</a></div><div class="ttdeci">long long unsigned Type</div><div class="ttdef"><b>Definition</b> ScriptEngineCommonDefinitions.h:7</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56dd53bf47d024da78865d469d02f4b3" name="a56dd53bf47d024da78865d469d02f4b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56dd53bf47d024da78865d469d02f4b3">&#9670;&#160;</a></span>ScriptEngineFunctionShortCircuitingEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionShortCircuitingEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>State</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html">ACTION_BUFFER</a> *</td>          <td class="paramname"><span class="paramname"><em>ActionDetail</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of event_ignore function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">State</td><td></td></tr>
    <tr><td class="paramname">ActionDetail</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  892</span>{</div>
<div class="line"><span class="lineno">  893</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  894</span>    <a class="code hl_function" href="libhyperdbg_8cpp.html#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, it&#39;s not possible to short-circuit events in user-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno">  895</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>    <span class="keywordflow">if</span> (ActionDetail-&gt;<a class="code hl_variable" href="struct_a_c_t_i_o_n___b_u_f_f_e_r.html#a559696a8dcd6f46488decb62fdb96c7c">CallingStage</a> == 1)</div>
<div class="line"><span class="lineno">  900</span>    {</div>
<div class="line"><span class="lineno">  901</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a>(<span class="stringliteral">&quot;Warning, calling the &#39;event_sc&#39; function in the &#39;post&#39; calling stage doesn&#39;t make sense as the emulation is already performed!\n&quot;</span></div>
<div class="line"><span class="lineno">  902</span>                   <span class="stringliteral">&quot;You can use this function in the &#39;pre&#39; calling stage&quot;</span>);</div>
<div class="line"><span class="lineno">  903</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  904</span>    }</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>    <span class="keywordflow">if</span> (State != 0)</div>
<div class="line"><span class="lineno">  909</span>    {</div>
<div class="line"><span class="lineno">  910</span>        <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CurrentCore].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#acf5445adacbfe4e72c2c2df05deb191d">ShortCircuitingEvent</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  911</span>    }</div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  913</span>    {</div>
<div class="line"><span class="lineno">  914</span>        <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CurrentCore].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#acf5445adacbfe4e72c2c2df05deb191d">ShortCircuitingEvent</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  915</span>    }</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  918</span>}</div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_abf506c814a6f717a87b5d808b828ef56"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a></div><div class="ttdeci">#define LogWarning(format,...)</div><div class="ttdoc">Log in the case of warning.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:99</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_acf5445adacbfe4e72c2c2df05deb191d"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#acf5445adacbfe4e72c2c2df05deb191d">_PROCESSOR_DEBUGGING_STATE::ShortCircuitingEvent</a></div><div class="ttdeci">BOOLEAN ShortCircuitingEvent</div><div class="ttdef"><b>Definition</b> State.h:170</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a578e17ddd2ca66885cae243fdb855745" name="a578e17ddd2ca66885cae243fdb855745"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a578e17ddd2ca66885cae243fdb855745">&#9670;&#160;</a></span>ScriptEngineFunctionSpinlockLock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionSpinlockLock </td>
          <td>(</td>
          <td class="paramtype">volatile LONG *</td>          <td class="paramname"><span class="paramname"><em>Lock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of spinlock_lock function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Lock</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  415</span>{</div>
<div class="line"><span class="lineno">  416</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <a class="code hl_function" href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a>(Lock);</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Lock, <span class="keyword">sizeof</span>(LONG)))</div>
<div class="line"><span class="lineno">  425</span>    {</div>
<div class="line"><span class="lineno">  426</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  427</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  428</span>    }</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_function" href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a>(Lock);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  433</span>}</div>
<div class="ttc" id="a_spinlock_8c_html_a08984f739349991eab67c45376a990bc"><div class="ttname"><a href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a></div><div class="ttdeci">void SpinlockLock(volatile LONG *Lock)</div><div class="ttdoc">Tries to get the lock and won't return until successfully get the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:52</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8104e193459a08b27785e0ba0c4db600" name="a8104e193459a08b27785e0ba0c4db600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8104e193459a08b27785e0ba0c4db600">&#9670;&#160;</a></span>ScriptEngineFunctionSpinlockLockCustomWait()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionSpinlockLockCustomWait </td>
          <td>(</td>
          <td class="paramtype">volatile long *</td>          <td class="paramname"><span class="paramname"><em>Lock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned</td>          <td class="paramname"><span class="paramname"><em>MaxWait</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of spinlock_lock_custom_wait function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Lock</td><td></td></tr>
    <tr><td class="paramname">MaxWait</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  474</span>{</div>
<div class="line"><span class="lineno">  475</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <a class="code hl_function" href="_spinlock_8c.html#a38b874427b0ec6e86720b6aff4f76dbc">SpinlockLockWithCustomWait</a>(Lock, MaxWait);</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Lock, <span class="keyword">sizeof</span>(LONG)))</div>
<div class="line"><span class="lineno">  484</span>    {</div>
<div class="line"><span class="lineno">  485</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  487</span>    }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    <a class="code hl_function" href="_spinlock_8c.html#a38b874427b0ec6e86720b6aff4f76dbc">SpinlockLockWithCustomWait</a>(Lock, MaxWait);</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  492</span>}</div>
<div class="ttc" id="a_spinlock_8c_html_a38b874427b0ec6e86720b6aff4f76dbc"><div class="ttname"><a href="_spinlock_8c.html#a38b874427b0ec6e86720b6aff4f76dbc">SpinlockLockWithCustomWait</a></div><div class="ttdeci">void SpinlockLockWithCustomWait(volatile LONG *Lock, unsigned MaximumWait)</div><div class="ttdoc">Tries to get the lock and won't return until successfully get the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:125</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a14fccaac626f8c4e06b93eb18b4460ea" name="a14fccaac626f8c4e06b93eb18b4460ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14fccaac626f8c4e06b93eb18b4460ea">&#9670;&#160;</a></span>ScriptEngineFunctionSpinlockUnlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionSpinlockUnlock </td>
          <td>(</td>
          <td class="paramtype">volatile LONG *</td>          <td class="paramname"><span class="paramname"><em>Lock</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> *</td>          <td class="paramname"><span class="paramname"><em>HasError</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of spinlock_unlock function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Lock</td><td></td></tr>
    <tr><td class="paramname">HasError</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  444</span>{</div>
<div class="line"><span class="lineno">  445</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(Lock);</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Lock, <span class="keyword">sizeof</span>(LONG)))</div>
<div class="line"><span class="lineno">  454</span>    {</div>
<div class="line"><span class="lineno">  455</span>        *HasError = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  457</span>    }</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(Lock);</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  462</span>}</div>
<div class="ttc" id="a_spinlock_8c_html_a529db917026601c47af458af0154bfa1"><div class="ttname"><a href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a></div><div class="ttdeci">void SpinlockUnlock(volatile LONG *Lock)</div><div class="ttdoc">Release the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:158</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c70a959fac5e45d04e5dc850c54ab92" name="a6c70a959fac5e45d04e5dc850c54ab92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c70a959fac5e45d04e5dc850c54ab92">&#9670;&#160;</a></span>ScriptEngineFunctionStrcmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionStrcmp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of strcmp function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1580</span>{</div>
<div class="line"><span class="lineno"> 1581</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno"> 1582</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1583</span>    Result = strcmp(Address1, Address2);</div>
<div class="line"><span class="lineno"> 1584</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1585</span> </div>
<div class="line"><span class="lineno"> 1586</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1587</span>    Result = <a class="code hl_function" href="_export_8c.html#aa95007b9e40b2bb097f73f790a97d132">VmFuncVmxCompatibleStrcmp</a>(Address1, Address2);</div>
<div class="line"><span class="lineno"> 1588</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1591</span>}</div>
<div class="ttc" id="a_export_8c_html_aa95007b9e40b2bb097f73f790a97d132"><div class="ttname"><a href="_export_8c.html#aa95007b9e40b2bb097f73f790a97d132">VmFuncVmxCompatibleStrcmp</a></div><div class="ttdeci">INT32 VmFuncVmxCompatibleStrcmp(const CHAR *Address1, const CHAR *Address2)</div><div class="ttdoc">VMX-root compatible strcmp.</div><div class="ttdef"><b>Definition</b> Export.c:732</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa38b032f4233a9a61273452558df7430" name="aa38b032f4233a9a61273452558df7430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa38b032f4233a9a61273452558df7430">&#9670;&#160;</a></span>ScriptEngineFunctionStrlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionStrlen </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of strlen function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  502</span>{</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno">  504</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  505</span>    Result = strlen(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  506</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  509</span>    Result = <a class="code hl_function" href="_export_8c.html#a6f7c37ac0853860564a7e2967eaa3bc0">VmFuncVmxCompatibleStrlen</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  510</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  513</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1469432da99eef8a934d8197cbf5df2" name="ae1469432da99eef8a934d8197cbf5df2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1469432da99eef8a934d8197cbf5df2">&#9670;&#160;</a></span>ScriptEngineFunctionStrncmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionStrncmp </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Num</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of strcmp function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Num</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1604</span>{</div>
<div class="line"><span class="lineno"> 1605</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno"> 1606</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1607</span>    Result = strncmp(Address1, Address2, Num);</div>
<div class="line"><span class="lineno"> 1608</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1611</span>    Result = <a class="code hl_function" href="_export_8c.html#a1839101eb1d009c1074b062ec4a50e0d">VmFuncVmxCompatibleStrncmp</a>(Address1, Address2, Num);</div>
<div class="line"><span class="lineno"> 1612</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1615</span>}</div>
<div class="ttc" id="a_export_8c_html_a1839101eb1d009c1074b062ec4a50e0d"><div class="ttname"><a href="_export_8c.html#a1839101eb1d009c1074b062ec4a50e0d">VmFuncVmxCompatibleStrncmp</a></div><div class="ttdeci">INT32 VmFuncVmxCompatibleStrncmp(const CHAR *Address1, const CHAR *Address2, SIZE_T Num)</div><div class="ttdoc">VMX-root compatible strncmp.</div><div class="ttdef"><b>Definition</b> Export.c:746</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adff9d56d78f06954aeae9787afdefcc0" name="adff9d56d78f06954aeae9787afdefcc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adff9d56d78f06954aeae9787afdefcc0">&#9670;&#160;</a></span>ScriptEngineFunctionTestStatement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ScriptEngineFunctionTestStatement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Tag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>ImmediateMessagePassing</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of test_statement function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Tag</td><td></td></tr>
    <tr><td class="paramname">ImmediateMessagePassing</td><td></td></tr>
    <tr><td class="paramname">Value</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  393</span>{</div>
<div class="line"><span class="lineno">  394</span>    UNREFERENCED_PARAMETER(<a class="code hl_variable" href="_hooks_8h.html#aba7c9f3767dcc5232354d3d17ceedb61">Tag</a>);</div>
<div class="line"><span class="lineno">  395</span>    UNREFERENCED_PARAMETER(ImmediateMessagePassing);</div>
<div class="line"><span class="lineno">  396</span>    UNREFERENCED_PARAMETER(<a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>);</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_variable" href="script-engine-wrapper_8cpp.html#addd210289ab44e2c5b5e275c17e3d61a">g_CurrentExprEvalResult</a>         = <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>;</div>
<div class="line"><span class="lineno">  401</span>    <a class="code hl_variable" href="script-engine-wrapper_8cpp.html#a63aed86a66786384314d6fc325055e54">g_CurrentExprEvalResultHasError</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  404</span>}</div>
<div class="ttc" id="ascript-engine-wrapper_8cpp_html_a63aed86a66786384314d6fc325055e54"><div class="ttname"><a href="script-engine-wrapper_8cpp.html#a63aed86a66786384314d6fc325055e54">g_CurrentExprEvalResultHasError</a></div><div class="ttdeci">BOOLEAN g_CurrentExprEvalResultHasError</div><div class="ttdoc">global variable to detect if there was an error in the result of script-engine statement tests</div><div class="ttdef"><b>Definition</b> globals.h:671</div></div>
<div class="ttc" id="ascript-engine-wrapper_8cpp_html_addd210289ab44e2c5b5e275c17e3d61a"><div class="ttname"><a href="script-engine-wrapper_8cpp.html#addd210289ab44e2c5b5e275c17e3d61a">g_CurrentExprEvalResult</a></div><div class="ttdeci">UINT64 g_CurrentExprEvalResult</div><div class="ttdoc">global variable to save the result of script-engine statement tests</div><div class="ttdef"><b>Definition</b> globals.h:664</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a73d5d9ebeb23eedc368058b30b6e10e1" name="a73d5d9ebeb23eedc368058b30b6e10e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d5d9ebeb23eedc368058b30b6e10e1">&#9670;&#160;</a></span>ScriptEngineFunctionVirtualToPhysical()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionVirtualToPhysical </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Address</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  315</span>{</div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">// There is no conversion in user-mode</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  322</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_conversion_8c.html#a63eff86102e697567fec147fc04f6248">VirtualAddressToPhysicalAddressOnTargetProcess</a>((PVOID)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  329</span>}</div>
<div class="ttc" id="a_conversion_8c_html_a63eff86102e697567fec147fc04f6248"><div class="ttname"><a href="_conversion_8c.html#a63eff86102e697567fec147fc04f6248">VirtualAddressToPhysicalAddressOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 VirtualAddressToPhysicalAddressOnTargetProcess(PVOID VirtualAddress)</div><div class="ttdoc">Converts Virtual Address to Physical Address based on the current process's kernel cr3.</div><div class="ttdef"><b>Definition</b> Conversion.c:258</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a732a6b41466254895c0ad905679b64fa" name="a732a6b41466254895c0ad905679b64fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a732a6b41466254895c0ad905679b64fa">&#9670;&#160;</a></span>ScriptEngineFunctionWcscmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionWcscmp </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of wcscmp function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1627</span>{</div>
<div class="line"><span class="lineno"> 1628</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno"> 1629</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1630</span>    Result = wcscmp(Address1, Address2);</div>
<div class="line"><span class="lineno"> 1631</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1634</span>    Result = <a class="code hl_function" href="_export_8c.html#a00093876f7dae069802bb54b3b0f7e17">VmFuncVmxCompatibleWcscmp</a>(Address1, Address2);</div>
<div class="line"><span class="lineno"> 1635</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1638</span>}</div>
<div class="ttc" id="a_export_8c_html_a00093876f7dae069802bb54b3b0f7e17"><div class="ttname"><a href="_export_8c.html#a00093876f7dae069802bb54b3b0f7e17">VmFuncVmxCompatibleWcscmp</a></div><div class="ttdeci">INT32 VmFuncVmxCompatibleWcscmp(const wchar_t *Address1, const wchar_t *Address2)</div><div class="ttdoc">VMX-root compatible wcscmp.</div><div class="ttdef"><b>Definition</b> Export.c:759</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1e9fcb833d5b004ca633b2f40fa9639" name="ac1e9fcb833d5b004ca633b2f40fa9639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1e9fcb833d5b004ca633b2f40fa9639">&#9670;&#160;</a></span>ScriptEngineFunctionWcslen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionWcslen </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of wcslen function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  546</span>{</div>
<div class="line"><span class="lineno">  547</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  550</span>    Result = wcslen(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  551</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  554</span>    Result = <a class="code hl_function" href="_export_8c.html#a8b5f68e9b7ab5207aa40649b889664f8">VmFuncVmxCompatibleWcslen</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>);</div>
<div class="line"><span class="lineno">  555</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  558</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a746a5947d63d8d2c8bfd3e0bc148f18b" name="a746a5947d63d8d2c8bfd3e0bc148f18b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a746a5947d63d8d2c8bfd3e0bc148f18b">&#9670;&#160;</a></span>ScriptEngineFunctionWcsncmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ScriptEngineFunctionWcsncmp </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Num</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of wcsncmp function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Num</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT64 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1651</span>{</div>
<div class="line"><span class="lineno"> 1652</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Result = 0;</div>
<div class="line"><span class="lineno"> 1653</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1654</span>    Result = wcsncmp(Address1, Address2, Num);</div>
<div class="line"><span class="lineno"> 1655</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_USER_MODE</span></div>
<div class="line"><span class="lineno"> 1656</span> </div>
<div class="line"><span class="lineno"> 1657</span><span class="preprocessor">#ifdef SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1658</span>    Result = <a class="code hl_function" href="_export_8c.html#a2c0756a0957084f0af80e4524a588680">VmFuncVmxCompatibleWcsncmp</a>(Address1, Address2, Num);</div>
<div class="line"><span class="lineno"> 1659</span><span class="preprocessor">#endif </span><span class="comment">// SCRIPT_ENGINE_KERNEL_MODE</span></div>
<div class="line"><span class="lineno"> 1660</span> </div>
<div class="line"><span class="lineno"> 1661</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1662</span>}</div>
<div class="ttc" id="a_export_8c_html_a2c0756a0957084f0af80e4524a588680"><div class="ttname"><a href="_export_8c.html#a2c0756a0957084f0af80e4524a588680">VmFuncVmxCompatibleWcsncmp</a></div><div class="ttdeci">INT32 VmFuncVmxCompatibleWcsncmp(const wchar_t *Address1, const wchar_t *Address2, SIZE_T Num)</div><div class="ttdoc">VMX-root compatible wcsncmp.</div><div class="ttdef"><b>Definition</b> Export.c:773</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a88be33f07f4e7e7bd3d55609c53dee08" name="a88be33f07f4e7e7bd3d55609c53dee08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88be33f07f4e7e7bd3d55609c53dee08">&#9670;&#160;</a></span>WcharToChar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t WcharToChar </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>src</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>dest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>dest_len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert WCHAR* to CHAR*. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td></td></tr>
    <tr><td class="paramname">dest</td><td></td></tr>
    <tr><td class="paramname">dest_len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size_t </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1069</span>{</div>
<div class="line"><span class="lineno"> 1070</span>    <span class="keywordtype">wchar_t</span> Code;</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordtype">size_t</span>  i;</div>
<div class="line"><span class="lineno"> 1072</span> </div>
<div class="line"><span class="lineno"> 1073</span>    i = 0;</div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span>    <span class="keywordflow">while</span> ((src[i] != <span class="charliteral">&#39;\0&#39;</span>) &amp;&amp; i &lt; (dest_len - 1))</div>
<div class="line"><span class="lineno"> 1076</span>    {</div>
<div class="line"><span class="lineno"> 1077</span>        Code = src[i];</div>
<div class="line"><span class="lineno"> 1078</span>        <span class="keywordflow">if</span> (Code &lt; 128)</div>
<div class="line"><span class="lineno"> 1079</span>            dest[i] = (char)Code;</div>
<div class="line"><span class="lineno"> 1080</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1081</span>        {</div>
<div class="line"><span class="lineno"> 1082</span>            dest[i] = <span class="charliteral">&#39;?&#39;</span>;</div>
<div class="line"><span class="lineno"> 1083</span>            <span class="keywordflow">if</span> (Code &gt;= 0xD800 &amp;&amp; Code &lt;= 0xD8FF)</div>
<div class="line"><span class="lineno"> 1084</span>            {</div>
<div class="line"><span class="lineno"> 1085</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1086</span>                <span class="comment">// Lead surrogate, skip the next code unit, which is the trail</span></div>
<div class="line"><span class="lineno"> 1087</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1088</span>                i++;</div>
<div class="line"><span class="lineno"> 1089</span>            }</div>
<div class="line"><span class="lineno"> 1090</span>        }</div>
<div class="line"><span class="lineno"> 1091</span>        i++;</div>
<div class="line"><span class="lineno"> 1092</span>    }</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordflow">return</span> i - 1;</div>
<div class="line"><span class="lineno"> 1095</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_843f0a8d4f2403e9bc85f942c3571641.html">script-eval</a></li><li class="navelem"><a class="el" href="dir_cbb4b06dae836761980f96bffa191416.html">code</a></li><li class="navelem"><a class="el" href="_functions_8c.html">Functions.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
