<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperkd/header/debugger/user-level/ThreadHolder.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_thread_holder_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ThreadHolder.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>User debugger's thread holder headers.  
<a href="#details">More...</a></p>

<p><a href="_thread_holder_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Details of each thread in process.  <a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The holder for detail of each thread in process.  <a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a08ef4f3c9f895f6f6c7e28fd29c1c156" id="r_a08ef4f3c9f895f6f6c7e28fd29c1c156"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a08ef4f3c9f895f6f6c7e28fd29c1c156">USERMODE_DEBUGGING_THREAD_DETAILS</a></td></tr>
<tr class="memdesc:a08ef4f3c9f895f6f6c7e28fd29c1c156"><td class="mdescLeft">&#160;</td><td class="mdescRight">Details of each thread in process.  <br /></td></tr>
<tr class="separator:a08ef4f3c9f895f6f6c7e28fd29c1c156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfafd6862ce9b62e3351c15dbd8b089d" id="r_adfafd6862ce9b62e3351c15dbd8b089d"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td></tr>
<tr class="separator:adfafd6862ce9b62e3351c15dbd8b089d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a3d37d8b8fbfaa07c7173f6b97e4f57" id="r_a6a3d37d8b8fbfaa07c7173f6b97e4f57"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a3d37d8b8fbfaa07c7173f6b97e4f57">USERMODE_DEBUGGING_THREAD_HOLDER</a></td></tr>
<tr class="memdesc:a6a3d37d8b8fbfaa07c7173f6b97e4f57"><td class="mdescLeft">&#160;</td><td class="mdescRight">The holder for detail of each thread in process.  <br /></td></tr>
<tr class="separator:a6a3d37d8b8fbfaa07c7173f6b97e4f57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56364843bae53c353b504338b783f5d2" id="r_a56364843bae53c353b504338b783f5d2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56364843bae53c353b504338b783f5d2">PUSERMODE_DEBUGGING_THREAD_HOLDER</a></td></tr>
<tr class="separator:a56364843bae53c353b504338b783f5d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a437f8737b54482ae346eb1bcacd672d0" id="r_a437f8737b54482ae346eb1bcacd672d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a437f8737b54482ae346eb1bcacd672d0">ThreadHolderAllocateThreadHoldingBuffers</a> ()</td></tr>
<tr class="memdesc:a437f8737b54482ae346eb1bcacd672d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pre allocate buffer for thread holder.  <br /></td></tr>
<tr class="separator:a437f8737b54482ae346eb1bcacd672d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d845e6ff080bbb13aa08176a8c81fa7" id="r_a2d845e6ff080bbb13aa08176a8c81fa7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2d845e6ff080bbb13aa08176a8c81fa7">ThreadHolderAssignThreadHolderToProcessDebuggingDetails</a> (<a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail)</td></tr>
<tr class="memdesc:a2d845e6ff080bbb13aa08176a8c81fa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assign a thread holder to process debugging details.  <br /></td></tr>
<tr class="separator:a2d845e6ff080bbb13aa08176a8c81fa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1b9edf45c36db1744c2253b4e84a34" id="r_afd1b9edf45c36db1744c2253b4e84a34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afd1b9edf45c36db1744c2253b4e84a34">ThreadHolderIsAnyPausedThreadInProcess</a> (<a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail)</td></tr>
<tr class="memdesc:afd1b9edf45c36db1744c2253b4e84a34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if there is any thread paused by checking process debugging details.  <br /></td></tr>
<tr class="separator:afd1b9edf45c36db1744c2253b4e84a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae54fde00233fd8e30b197ab1a64a555" id="r_aae54fde00233fd8e30b197ab1a64a555"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ThreadId)</td></tr>
<tr class="memdesc:aae54fde00233fd8e30b197ab1a64a555"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the active threads of the process from process id.  <br /></td></tr>
<tr class="separator:aae54fde00233fd8e30b197ab1a64a555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab07678c8fe445f2a876f6bee3b42dcd8" id="r_ab07678c8fe445f2a876f6bee3b42dcd8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab07678c8fe445f2a876f6bee3b42dcd8">ThreadHolderGetProcessFirstThreadDetailsByProcessId</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:ab07678c8fe445f2a876f6bee3b42dcd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the first active threads of the process from process id.  <br /></td></tr>
<tr class="separator:ab07678c8fe445f2a876f6bee3b42dcd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acba2daedbfe8905ff43917a1ccf7c401" id="r_acba2daedbfe8905ff43917a1ccf7c401"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acba2daedbfe8905ff43917a1ccf7c401">ThreadHolderGetProcessDebuggingDetailsByThreadId</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ThreadId)</td></tr>
<tr class="memdesc:acba2daedbfe8905ff43917a1ccf7c401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the active process debugging detail from the thread id.  <br /></td></tr>
<tr class="separator:acba2daedbfe8905ff43917a1ccf7c401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac752176641e6314d84738f2f323cec68" id="r_ac752176641e6314d84738f2f323cec68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ThreadId, <a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail)</td></tr>
<tr class="memdesc:ac752176641e6314d84738f2f323cec68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find or create user-mode debugging details for threads.  <br /></td></tr>
<tr class="separator:ac752176641e6314d84738f2f323cec68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a090fda3da0d1eaee5abdaf2fe8d6079c" id="r_a090fda3da0d1eaee5abdaf2fe8d6079c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a> (<a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails, <a class="el" href="_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a> ActionRequest)</td></tr>
<tr class="memdesc:a090fda3da0d1eaee5abdaf2fe8d6079c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the action of the user debugger to a specific thread or all threads.  <br /></td></tr>
<tr class="separator:a090fda3da0d1eaee5abdaf2fe8d6079c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b4a9b1b679bae96959ca1f7a8a8d2aa" id="r_a3b4a9b1b679bae96959ca1f7a8a8d2aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b4a9b1b679bae96959ca1f7a8a8d2aa">ThreadHolderFreeHoldingStructures</a> (<a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail)</td></tr>
<tr class="memdesc:a3b4a9b1b679bae96959ca1f7a8a8d2aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free all of thread holder structures.  <br /></td></tr>
<tr class="separator:a3b4a9b1b679bae96959ca1f7a8a8d2aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affb7e7920935c0f6e29a3401242b155b" id="r_affb7e7920935c0f6e29a3401242b155b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#affb7e7920935c0f6e29a3401242b155b">ThreadHolderQueryCountOfActiveDebuggingThreadsAndProcesses</a> ()</td></tr>
<tr class="memdesc:affb7e7920935c0f6e29a3401242b155b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query count of active debugging threads and processes.  <br /></td></tr>
<tr class="separator:affb7e7920935c0f6e29a3401242b155b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abefefca1094887640b64fb4405d1504e" id="r_abefefca1094887640b64fb4405d1504e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abefefca1094887640b64fb4405d1504e">ThreadHolderQueryDetailsOfActiveDebuggingThreadsAndProcesses</a> (<a class="el" href="_request_structures_8h.html#ac7aac921d83411cb9ae91f8fe3fba401">USERMODE_DEBUGGING_THREAD_OR_PROCESS_STATE_DETAILS</a> *BufferToStoreDetails, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> MaxCount)</td></tr>
<tr class="memdesc:abefefca1094887640b64fb4405d1504e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query details of active debugging threads and processes.  <br /></td></tr>
<tr class="separator:abefefca1094887640b64fb4405d1504e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5f373c61acb9fe386b8b8b975c5ca094" id="r_a5f373c61acb9fe386b8b8b975c5ca094"><td class="memItemLeft" align="right" valign="top">volatile LONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a></td></tr>
<tr class="memdesc:a5f373c61acb9fe386b8b8b975c5ca094"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vmx-root lock for thread holding.  <br /></td></tr>
<tr class="separator:a5f373c61acb9fe386b8b8b975c5ca094"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>User debugger's thread holder headers. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-01-28</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="adfafd6862ce9b62e3351c15dbd8b089d" name="adfafd6862ce9b62e3351c15dbd8b089d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfafd6862ce9b62e3351c15dbd8b089d">&#9670;&#160;</a></span>PUSERMODE_DEBUGGING_THREAD_DETAILS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a> * <a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a56364843bae53c353b504338b783f5d2" name="a56364843bae53c353b504338b783f5d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56364843bae53c353b504338b783f5d2">&#9670;&#160;</a></span>PUSERMODE_DEBUGGING_THREAD_HOLDER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a> * <a class="el" href="#a56364843bae53c353b504338b783f5d2">PUSERMODE_DEBUGGING_THREAD_HOLDER</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a08ef4f3c9f895f6f6c7e28fd29c1c156" name="a08ef4f3c9f895f6f6c7e28fd29c1c156"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08ef4f3c9f895f6f6c7e28fd29c1c156">&#9670;&#160;</a></span>USERMODE_DEBUGGING_THREAD_DETAILS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a> <a class="el" href="#a08ef4f3c9f895f6f6c7e28fd29c1c156">USERMODE_DEBUGGING_THREAD_DETAILS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Details of each thread in process. </p>

</div>
</div>
<a id="a6a3d37d8b8fbfaa07c7173f6b97e4f57" name="a6a3d37d8b8fbfaa07c7173f6b97e4f57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3d37d8b8fbfaa07c7173f6b97e4f57">&#9670;&#160;</a></span>USERMODE_DEBUGGING_THREAD_HOLDER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a> <a class="el" href="#a6a3d37d8b8fbfaa07c7173f6b97e4f57">USERMODE_DEBUGGING_THREAD_HOLDER</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The holder for detail of each thread in process. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a437f8737b54482ae346eb1bcacd672d0" name="a437f8737b54482ae346eb1bcacd672d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437f8737b54482ae346eb1bcacd672d0">&#9670;&#160;</a></span>ThreadHolderAllocateThreadHoldingBuffers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ThreadHolderAllocateThreadHoldingBuffers </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pre allocate buffer for thread holder. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{</div>
<div class="line"><span class="lineno">   23</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="comment">// Request to allocate two buffer for holder of threads</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   26</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>), 2, <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a>);</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">// As it might be called from an attaching request and never find a</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">// a chance to allocate it, we allocate it here as it&#39;s safe at PASSIVE_LEVEL</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_function" href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a>();</div>
<div class="line"><span class="lineno">   33</span>}</div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a></div><div class="ttdeci">@ PROCESS_THREAD_HOLDER</div><div class="ttdef"><b>Definition</b> DataTypes.h:46</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a03e9f251a31e86dcac849bd9d681aa6d"><div class="ttname"><a href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a></div><div class="ttdeci">BOOLEAN PoolManagerCheckAndPerformAllocationAndDeallocation()</div><div class="ttdoc">This function performs allocations from VMX non-root based on g_RequestNewAllocation.</div><div class="ttdef"><b>Definition</b> PoolManager.c:302</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a3660fd340db1240d410e847fb1ffe3d8"><div class="ttname"><a href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a></div><div class="ttdeci">BOOLEAN PoolManagerRequestAllocation(SIZE_T Size, UINT32 Count, POOL_ALLOCATION_INTENTION Intention)</div><div class="ttdoc">Request to allocate new buffers.</div><div class="ttdef"><b>Definition</b> PoolManager.c:415</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a></div><div class="ttdoc">The holder for detail of each thread in process.</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:46</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a090fda3da0d1eaee5abdaf2fe8d6079c" name="a090fda3da0d1eaee5abdaf2fe8d6079c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a090fda3da0d1eaee5abdaf2fe8d6079c">&#9670;&#160;</a></span>ThreadHolderApplyActionToPausedThreads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ThreadHolderApplyActionToPausedThreads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a></td>          <td class="paramname"><span class="paramname"><em>ActionRequest</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the action of the user debugger to a specific thread or all threads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">ActionRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Shows whether the command is applied or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  366</span>{</div>
<div class="line"><span class="lineno">  367</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails;</div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                            CommandApplied = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">if</span> (!ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a46479ce366b8fe5fc2bf38d899238b9d">ApplyToAllPausedThreads</a>)</div>
<div class="line"><span class="lineno">  371</span>    {</div>
<div class="line"><span class="lineno">  372</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  373</span>        <span class="comment">// *** only the active thread ***</span></div>
<div class="line"><span class="lineno">  374</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>        ThreadDebuggingDetails = <a class="code hl_function" href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a>(ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ace267a6473505408e798a827e1b244f0">ProcessId</a>,</div>
<div class="line"><span class="lineno">  377</span>                                                                                           ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a2c14041e668efd4190f8c2ab9d1fa4c7">TargetThreadId</a>);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  380</span>        <span class="comment">// Apply the command</span></div>
<div class="line"><span class="lineno">  381</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a>; i++)</div>
<div class="line"><span class="lineno">  383</span>        {</div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">if</span> (ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>)</div>
<div class="line"><span class="lineno">  385</span>            {</div>
<div class="line"><span class="lineno">  386</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  387</span>                <span class="comment">// Set the action</span></div>
<div class="line"><span class="lineno">  388</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  389</span>                ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a>;</div>
<div class="line"><span class="lineno">  390</span>                ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a>;</div>
<div class="line"><span class="lineno">  391</span>                ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a>;</div>
<div class="line"><span class="lineno">  392</span>                ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a>;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  395</span>                <span class="comment">// At last we set the action type to make it valid</span></div>
<div class="line"><span class="lineno">  396</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  397</span>                ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a>;</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  400</span>                <span class="comment">// Command is applied</span></div>
<div class="line"><span class="lineno">  401</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  402</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  403</span>            }</div>
<div class="line"><span class="lineno">  404</span>        }</div>
<div class="line"><span class="lineno">  405</span>    }</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  407</span>    {</div>
<div class="line"><span class="lineno">  408</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  409</span>        <span class="comment">// *** apply to all paused threads ***</span></div>
<div class="line"><span class="lineno">  410</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  411</span>        PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>        TempList = &amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  416</span>        {</div>
<div class="line"><span class="lineno">  417</span>            TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  418</span>            <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  419</span>                CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  422</span>            {</div>
<div class="line"><span class="lineno">  423</span>                <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> != <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  424</span>                    ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">  425</span>                {</div>
<div class="line"><span class="lineno">  426</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code hl_define" href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a>; j++)</div>
<div class="line"><span class="lineno">  427</span>                    {</div>
<div class="line"><span class="lineno">  428</span>                        <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>)</div>
<div class="line"><span class="lineno">  429</span>                        {</div>
<div class="line"><span class="lineno">  430</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  431</span>                            <span class="comment">// Set the action</span></div>
<div class="line"><span class="lineno">  432</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  433</span>                            ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a>;</div>
<div class="line"><span class="lineno">  434</span>                            ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a>;</div>
<div class="line"><span class="lineno">  435</span>                            ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a>;</div>
<div class="line"><span class="lineno">  436</span>                            ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a>;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  439</span>                            <span class="comment">// At last we set the action type to make it valid</span></div>
<div class="line"><span class="lineno">  440</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  441</span>                            ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[j].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> = ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">UdAction</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a>;</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>                            CommandApplied = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  444</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  445</span>                        }</div>
<div class="line"><span class="lineno">  446</span>                    }</div>
<div class="line"><span class="lineno">  447</span>                }</div>
<div class="line"><span class="lineno">  448</span>            }</div>
<div class="line"><span class="lineno">  449</span>        }</div>
<div class="line"><span class="lineno">  450</span>    }</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  453</span>    <span class="comment">// Return the result of applying the command</span></div>
<div class="line"><span class="lineno">  454</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">return</span> CommandApplied;</div>
<div class="line"><span class="lineno">  456</span>}</div>
<div class="ttc" id="a_attaching_8h_html_a0c6e13c5d1c8b877d7e31b6f5065b1e3"><div class="ttname"><a href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a></div><div class="ttdeci">#define MAX_THREADS_IN_A_PROCESS_HOLDER</div><div class="ttdoc">Maximum threads that a process thread holder might have.</div><div class="ttdef"><b>Definition</b> Attaching.h:28</div></div>
<div class="ttc" id="a_attaching_8h_html_a71a7b969b4769247f9e1c54276f6514f"><div class="ttname"><a href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a></div><div class="ttdeci">#define MAX_USER_ACTIONS_FOR_THREADS</div><div class="ttdoc">Maximum actions in paused threads storage.</div><div class="ttdef"><b>Definition</b> Attaching.h:22</div></div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_basic_types_8h_html_a32ab457827837bf5ac123dd0fd8326ae"><div class="ttname"><a href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a></div><div class="ttdeci">#define NULL_ZERO</div><div class="ttdef"><b>Definition</b> BasicTypes.h:51</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a"><div class="ttname"><a href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:867</div></div>
<div class="ttc" id="a_thread_holder_8c_html_aae54fde00233fd8e30b197ab1a64a555"><div class="ttname"><a href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId(UINT32 ProcessId, UINT32 ThreadId)</div><div class="ttdoc">Find the active threads of the process from process id.</div><div class="ttdef"><b>Definition</b> ThreadHolder.c:109</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a0342fbe7f03915834f74d7154874145f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">_DEBUGGER_UD_COMMAND_ACTION::ActionType</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:880</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a479258f824cfd17a0f610d9bcefce1a1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam1</a></div><div class="ttdeci">UINT64 OptionalParam1</div><div class="ttdef"><b>Definition</b> RequestStructures.h:881</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5bd4a1a8d6a407cf98eb4f84597fa233"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam3</a></div><div class="ttdeci">UINT64 OptionalParam3</div><div class="ttdef"><b>Definition</b> RequestStructures.h:883</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5e2412025f8524952d364840ba658829"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam4</a></div><div class="ttdeci">UINT64 OptionalParam4</div><div class="ttdef"><b>Definition</b> RequestStructures.h:884</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_ad76de86942302644cd6c27e446bb9b4a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam2</a></div><div class="ttdeci">UINT64 OptionalParam2</div><div class="ttdef"><b>Definition</b> RequestStructures.h:882</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_a05dbb7c96d0ef20e46da95a573c28f67"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a05dbb7c96d0ef20e46da95a573c28f67">_DEBUGGER_UD_COMMAND_PACKET::UdAction</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION UdAction</div><div class="ttdef"><b>Definition</b> RequestStructures.h:894</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_a2c14041e668efd4190f8c2ab9d1fa4c7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a2c14041e668efd4190f8c2ab9d1fa4c7">_DEBUGGER_UD_COMMAND_PACKET::TargetThreadId</a></div><div class="ttdeci">UINT32 TargetThreadId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:896</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_a46479ce366b8fe5fc2bf38d899238b9d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#a46479ce366b8fe5fc2bf38d899238b9d">_DEBUGGER_UD_COMMAND_PACKET::ApplyToAllPausedThreads</a></div><div class="ttdeci">BOOLEAN ApplyToAllPausedThreads</div><div class="ttdef"><b>Definition</b> RequestStructures.h:897</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_aa599a0813df15b4250895e755bc484b9"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">_USERMODE_DEBUGGING_PROCESS_DETAILS::ThreadsListHead</a></div><div class="ttdeci">LIST_ENTRY ThreadsListHead</div><div class="ttdef"><b>Definition</b> Attaching.h:67</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ace267a6473505408e798a827e1b244f0"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ace267a6473505408e798a827e1b244f0">_USERMODE_DEBUGGING_PROCESS_DETAILS::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> Attaching.h:61</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a></div><div class="ttdoc">Details of each thread in process.</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:33</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a726606b3498458de98f6cb19e6873df0"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:34</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a9b52613ecdffc1e60ac1ca9e956d1416"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">_USERMODE_DEBUGGING_THREAD_DETAILS::UdAction</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION UdAction[MAX_USER_ACTIONS_FOR_THREADS]</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:37</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_afcd7f63e2118dbfefdac3e7c79fda7fc"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">_USERMODE_DEBUGGING_THREAD_DETAILS::IsPaused</a></div><div class="ttdeci">BOOLEAN IsPaused</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:36</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r_html_a60f23a7a2c69e25768792a6626fb73a6"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">_USERMODE_DEBUGGING_THREAD_HOLDER::Threads</a></div><div class="ttdeci">USERMODE_DEBUGGING_THREAD_DETAILS Threads[MAX_THREADS_IN_A_PROCESS_HOLDER]</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:48</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d845e6ff080bbb13aa08176a8c81fa7" name="a2d845e6ff080bbb13aa08176a8c81fa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d845e6ff080bbb13aa08176a8c81fa7">&#9670;&#160;</a></span>ThreadHolderAssignThreadHolderToProcessDebuggingDetails()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ThreadHolderAssignThreadHolderToProcessDebuggingDetails </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetail</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Assign a thread holder to process debugging details. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessDebuggingDetail</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   43</span>{</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// Initialize the list entry of threads</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_function" href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a>(&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>);</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="comment">// Add a thread holder here</span></div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   54</span>    ThreadHolder = (<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a> *)</div>
<div class="line"><span class="lineno">   55</span>        <a class="code hl_function" href="_pool_manager_8c.html#a065841edb44331344b1a71a2ea397923">PoolManagerRequestPool</a>(<a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a>, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>));</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordflow">if</span> (!ThreadHolder)</div>
<div class="line"><span class="lineno">   58</span>    {</div>
<div class="line"><span class="lineno">   59</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   60</span>    }</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// Add it to thread holder of the structure</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_function" href="_windows_8h.html#ad311db6648e5e4e2860aab6164cdb6c1">InsertHeadList</a>(&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>, &amp;(ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#ab819b34b5ec3d24e71ab3927e24b4aa4">ThreadHolderList</a>));</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   68</span>}</div>
<div class="ttc" id="a_pool_manager_8c_html_a065841edb44331344b1a71a2ea397923"><div class="ttname"><a href="_pool_manager_8c.html#a065841edb44331344b1a71a2ea397923">PoolManagerRequestPool</a></div><div class="ttdeci">UINT64 PoolManagerRequestPool(POOL_ALLOCATION_INTENTION Intention, BOOLEAN RequestNewPool, UINT32 Size)</div><div class="ttdoc">This function should be called from vmx-root in order to get a pool from the list.</div><div class="ttdef"><b>Definition</b> PoolManager.c:212</div></div>
<div class="ttc" id="a_windows_8h_html_ad211c1678754ed394322f51a9e909c4a"><div class="ttname"><a href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a></div><div class="ttdeci">FORCEINLINE VOID InitializeListHead(_Out_ PLIST_ENTRY ListHead)</div><div class="ttdef"><b>Definition</b> Windows.h:41</div></div>
<div class="ttc" id="a_windows_8h_html_ad311db6648e5e4e2860aab6164cdb6c1"><div class="ttname"><a href="_windows_8h.html#ad311db6648e5e4e2860aab6164cdb6c1">InsertHeadList</a></div><div class="ttdeci">FORCEINLINE VOID InsertHeadList(_Inout_ PLIST_ENTRY ListHead, _Inout_ PLIST_ENTRY Entry)</div><div class="ttdef"><b>Definition</b> Windows.h:115</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r_html_ab819b34b5ec3d24e71ab3927e24b4aa4"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#ab819b34b5ec3d24e71ab3927e24b4aa4">_USERMODE_DEBUGGING_THREAD_HOLDER::ThreadHolderList</a></div><div class="ttdeci">LIST_ENTRY ThreadHolderList</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:47</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac752176641e6314d84738f2f323cec68" name="ac752176641e6314d84738f2f323cec68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac752176641e6314d84738f2f323cec68">&#9670;&#160;</a></span>ThreadHolderFindOrCreateThreadDebuggingDetail()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadHolderFindOrCreateThreadDebuggingDetail </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ThreadId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetail</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find or create user-mode debugging details for threads. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadId</td><td></td></tr>
    <tr><td class="paramname">ProcessDebuggingDetail</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PUSERMODE_DEBUGGING_THREAD_DETAILS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  258</span>{</div>
<div class="line"><span class="lineno">  259</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  264</span>    <span class="comment">// Let&#39;s see if we can find the thread</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  267</span>    {</div>
<div class="line"><span class="lineno">  268</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  269</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  270</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  273</span>        {</div>
<div class="line"><span class="lineno">  274</span>            <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> == ThreadId)</div>
<div class="line"><span class="lineno">  275</span>            {</div>
<div class="line"><span class="lineno">  276</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  277</span>                <span class="comment">// We find a thread, let&#39;s return it&#39;s structure</span></div>
<div class="line"><span class="lineno">  278</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  279</span>                <span class="keywordflow">return</span> &amp;ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i];</div>
<div class="line"><span class="lineno">  280</span>            }</div>
<div class="line"><span class="lineno">  281</span>        }</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="comment">// *** We&#39;re here, the thread is not found, let&#39;s create an entry for it ***</span></div>
<div class="line"><span class="lineno">  286</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">// Two threads should not simultaneously reach here</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_function" href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a>(&amp;<a class="code hl_variable" href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a>);</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="comment">// Let&#39;s see if we can find the thread</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  299</span>    {</div>
<div class="line"><span class="lineno">  300</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  301</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  302</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  305</span>        {</div>
<div class="line"><span class="lineno">  306</span>            <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> == <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>)</div>
<div class="line"><span class="lineno">  307</span>            {</div>
<div class="line"><span class="lineno">  308</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  309</span>                <span class="comment">// We find a null thread place, let&#39;s return it&#39;s structure</span></div>
<div class="line"><span class="lineno">  310</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  311</span>                ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> = ThreadId;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>                <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(&amp;<a class="code hl_variable" href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a>);</div>
<div class="line"><span class="lineno">  314</span>                <span class="keywordflow">return</span> &amp;ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i];</div>
<div class="line"><span class="lineno">  315</span>            }</div>
<div class="line"><span class="lineno">  316</span>        }</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="comment">// We didn&#39;t find an empty entry,</span></div>
<div class="line"><span class="lineno">  321</span>    <span class="comment">// let&#39;s use another structure and link it to the thread holder</span></div>
<div class="line"><span class="lineno">  322</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  323</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> NewThreadHolder = (<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a> *)</div>
<div class="line"><span class="lineno">  324</span>        <a class="code hl_function" href="_pool_manager_8c.html#a065841edb44331344b1a71a2ea397923">PoolManagerRequestPool</a>(<a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a>, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>));</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">if</span> (NewThreadHolder == NULL)</div>
<div class="line"><span class="lineno">  327</span>    {</div>
<div class="line"><span class="lineno">  328</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, enable to find a place to save the threads data, &quot;</span></div>
<div class="line"><span class="lineno">  329</span>                 <span class="stringliteral">&quot;please use &#39;prealloc&#39; command to allocate more pre-allocated &quot;</span></div>
<div class="line"><span class="lineno">  330</span>                 <span class="stringliteral">&quot;buffer for the thread holder&quot;</span>);</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>        <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(&amp;<a class="code hl_variable" href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a>);</div>
<div class="line"><span class="lineno">  333</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  334</span>    }</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  337</span>    <span class="comment">// Add the current thread as the first entry of the holder</span></div>
<div class="line"><span class="lineno">  338</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>    NewThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[0].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> = ThreadId;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">// Link to the thread holding structure</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>    <a class="code hl_function" href="_windows_8h.html#ad311db6648e5e4e2860aab6164cdb6c1">InsertHeadList</a>(&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>, &amp;(NewThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#ab819b34b5ec3d24e71ab3927e24b4aa4">ThreadHolderList</a>));</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  347</span>    <span class="comment">// Other threads are now allowed to use the thread listing mechanism</span></div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  349</span>    <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(&amp;<a class="code hl_variable" href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a>);</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>    <span class="keywordflow">return</span> &amp;NewThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[0];</div>
<div class="line"><span class="lineno">  352</span>}</div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="a_spinlock_8c_html_a08984f739349991eab67c45376a990bc"><div class="ttname"><a href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a></div><div class="ttdeci">void SpinlockLock(volatile LONG *Lock)</div><div class="ttdoc">Tries to get the lock and won't return until successfully get the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:52</div></div>
<div class="ttc" id="a_spinlock_8c_html_a529db917026601c47af458af0154bfa1"><div class="ttname"><a href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a></div><div class="ttdeci">void SpinlockUnlock(volatile LONG *Lock)</div><div class="ttdoc">Release the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:158</div></div>
<div class="ttc" id="a_thread_holder_8h_html_a5f373c61acb9fe386b8b8b975c5ca094"><div class="ttname"><a href="#a5f373c61acb9fe386b8b8b975c5ca094">VmxRootThreadHoldingLock</a></div><div class="ttdeci">volatile LONG VmxRootThreadHoldingLock</div><div class="ttdoc">Vmx-root lock for thread holding.</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:22</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b4a9b1b679bae96959ca1f7a8a8d2aa" name="a3b4a9b1b679bae96959ca1f7a8a8d2aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b4a9b1b679bae96959ca1f7a8a8d2aa">&#9670;&#160;</a></span>ThreadHolderFreeHoldingStructures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ThreadHolderFreeHoldingStructures </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetail</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free all of thread holder structures. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessDebuggingDetail</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  466</span>{</div>
<div class="line"><span class="lineno">  467</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  472</span>    {</div>
<div class="line"><span class="lineno">  473</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  474</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  475</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// The thread is allocated from the pool management, so we&#39;ll</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">// free it from there</span></div>
<div class="line"><span class="lineno">  480</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span>        <a class="code hl_function" href="_pool_manager_8c.html#aac1a781a8d6463b65848555355e687dd">PoolManagerFreePool</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)ThreadHolder);</div>
<div class="line"><span class="lineno">  482</span>    }</div>
<div class="line"><span class="lineno">  483</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_pool_manager_8c_html_aac1a781a8d6463b65848555355e687dd"><div class="ttname"><a href="_pool_manager_8c.html#aac1a781a8d6463b65848555355e687dd">PoolManagerFreePool</a></div><div class="ttdeci">BOOLEAN PoolManagerFreePool(UINT64 AddressToFree)</div><div class="ttdoc">This function set a pool flag to be freed, and it will be freed on the next IOCTL when it's safe to r...</div><div class="ttdef"><b>Definition</b> PoolManager.c:136</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acba2daedbfe8905ff43917a1ccf7c401" name="acba2daedbfe8905ff43917a1ccf7c401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acba2daedbfe8905ff43917a1ccf7c401">&#9670;&#160;</a></span>ThreadHolderGetProcessDebuggingDetailsByThreadId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ThreadHolderGetProcessDebuggingDetailsByThreadId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ThreadId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the active process debugging detail from the thread id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PUSERMODE_DEBUGGING_PROCESS_DETAILS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  206</span>{</div>
<div class="line"><span class="lineno">  207</span>    PLIST_ENTRY TempList  = 0;</div>
<div class="line"><span class="lineno">  208</span>    PLIST_ENTRY TempList2 = 0;</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    TempList = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a>;</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  213</span>    {</div>
<div class="line"><span class="lineno">  214</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  215</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails =</div>
<div class="line"><span class="lineno">  216</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">USERMODE_DEBUGGING_PROCESS_DETAILS</a>, AttachedProcessList);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  219</span>        <span class="comment">// Search through all the active threads of this process</span></div>
<div class="line"><span class="lineno">  220</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  221</span>        TempList2 = &amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList2-&gt;Flink)</div>
<div class="line"><span class="lineno">  224</span>        {</div>
<div class="line"><span class="lineno">  225</span>            TempList2 = TempList2-&gt;Flink;</div>
<div class="line"><span class="lineno">  226</span>            <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  227</span>                CONTAINING_RECORD(TempList2, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  230</span>            {</div>
<div class="line"><span class="lineno">  231</span>                <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> == ThreadId)</div>
<div class="line"><span class="lineno">  232</span>                {</div>
<div class="line"><span class="lineno">  233</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>                    <span class="comment">// The target thread is found, not let&#39;s return the process debugging</span></div>
<div class="line"><span class="lineno">  235</span>                    <span class="comment">// details of this process</span></div>
<div class="line"><span class="lineno">  236</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  237</span>                    <span class="keywordflow">return</span> ProcessDebuggingDetails;</div>
<div class="line"><span class="lineno">  238</span>                }</div>
<div class="line"><span class="lineno">  239</span>            }</div>
<div class="line"><span class="lineno">  240</span>        }</div>
<div class="line"><span class="lineno">  241</span>    }</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">// Active thread not found</span></div>
<div class="line"><span class="lineno">  245</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  247</span>}</div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a3a003d2c59562062fe921cd2754440f7"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a></div><div class="ttdeci">LIST_ENTRY g_ProcessDebuggingDetailsListHead</div><div class="ttdoc">List header of thread debugging details.</div><div class="ttdef"><b>Definition</b> Global.h:152</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_PROCESS_DETAILS</a></div><div class="ttdoc">Description of each active thread in user-mode attaching mechanism.</div><div class="ttdef"><b>Definition</b> Attaching.h:49</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab07678c8fe445f2a876f6bee3b42dcd8" name="ab07678c8fe445f2a876f6bee3b42dcd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab07678c8fe445f2a876f6bee3b42dcd8">&#9670;&#160;</a></span>ThreadHolderGetProcessFirstThreadDetailsByProcessId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadHolderGetProcessFirstThreadDetailsByProcessId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the first active threads of the process from process id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PUSERMODE_DEBUGGING_THREAD_DETAILS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>    PLIST_ENTRY                         TempList = 0;</div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// First, find the process details</span></div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>    ProcessDebuggingDetail = <a class="code hl_function" href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a>(ProcessId);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">if</span> (ProcessDebuggingDetail == NULL)</div>
<div class="line"><span class="lineno">  168</span>    {</div>
<div class="line"><span class="lineno">  169</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  170</span>    }</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  175</span>    {</div>
<div class="line"><span class="lineno">  176</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  177</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  178</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  181</span>        {</div>
<div class="line"><span class="lineno">  182</span>            <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> != <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>)</div>
<div class="line"><span class="lineno">  183</span>            {</div>
<div class="line"><span class="lineno">  184</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  185</span>                <span class="comment">// The active thread&#39;s structure is found</span></div>
<div class="line"><span class="lineno">  186</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  187</span>                <span class="keywordflow">return</span> &amp;ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i];</div>
<div class="line"><span class="lineno">  188</span>            }</div>
<div class="line"><span class="lineno">  189</span>        }</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  193</span>    <span class="comment">// Active thread not found</span></div>
<div class="line"><span class="lineno">  194</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  196</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a733d0f343ddcccaeec221bbbb20483c7"><div class="ttname"><a href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByProcessId(UINT32 ProcessId)</div><div class="ttdoc">Find user-mode debugging details for threads by process Id.</div><div class="ttdef"><b>Definition</b> Attaching.c:187</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae54fde00233fd8e30b197ab1a64a555" name="aae54fde00233fd8e30b197ab1a64a555"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae54fde00233fd8e30b197ab1a64a555">&#9670;&#160;</a></span>ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ThreadId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the active threads of the process from process id. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessId</td><td></td></tr>
    <tr><td class="paramname">ThreadId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PUSERMODE_DEBUGGING_THREAD_DETAILS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  110</span>{</div>
<div class="line"><span class="lineno">  111</span>    PLIST_ENTRY                         TempList = 0;</div>
<div class="line"><span class="lineno">  112</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetail;</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="comment">// First, find the process details</span></div>
<div class="line"><span class="lineno">  116</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  117</span>    ProcessDebuggingDetail = <a class="code hl_function" href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a>(ProcessId);</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> (ProcessDebuggingDetail == NULL)</div>
<div class="line"><span class="lineno">  120</span>    {</div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  122</span>    }</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  127</span>    {</div>
<div class="line"><span class="lineno">  128</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  129</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  130</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  133</span>        {</div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> == ThreadId)</div>
<div class="line"><span class="lineno">  135</span>            {</div>
<div class="line"><span class="lineno">  136</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  137</span>                <span class="comment">// The active thread&#39;s structure is found</span></div>
<div class="line"><span class="lineno">  138</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  139</span>                <span class="keywordflow">return</span> &amp;ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i];</div>
<div class="line"><span class="lineno">  140</span>            }</div>
<div class="line"><span class="lineno">  141</span>        }</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  145</span>    <span class="comment">// Active thread not found</span></div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  148</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afd1b9edf45c36db1744c2253b4e84a34" name="afd1b9edf45c36db1744c2253b4e84a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd1b9edf45c36db1744c2253b4e84a34">&#9670;&#160;</a></span>ThreadHolderIsAnyPausedThreadInProcess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ThreadHolderIsAnyPausedThreadInProcess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetail</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if there is any thread paused by checking process debugging details. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessDebuggingDetail</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>    PLIST_ENTRY TempList = 0;</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    TempList = &amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetail-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">   84</span>    {</div>
<div class="line"><span class="lineno">   85</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">   86</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">   87</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">   90</span>        {</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a> != <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a> &amp;&amp; ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">   92</span>            {</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   94</span>            }</div>
<div class="line"><span class="lineno">   95</span>        }</div>
<div class="line"><span class="lineno">   96</span>    }</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   99</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="affb7e7920935c0f6e29a3401242b155b" name="affb7e7920935c0f6e29a3401242b155b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affb7e7920935c0f6e29a3401242b155b">&#9670;&#160;</a></span>ThreadHolderQueryCountOfActiveDebuggingThreadsAndProcesses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ThreadHolderQueryCountOfActiveDebuggingThreadsAndProcesses </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query count of active debugging threads and processes. </p>
<dl class="section return"><dt>Returns</dt><dd>UINT32 </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  492</span>{</div>
<div class="line"><span class="lineno">  493</span>    PLIST_ENTRY TempList                   = 0;</div>
<div class="line"><span class="lineno">  494</span>    PLIST_ENTRY TempList2                  = 0;</div>
<div class="line"><span class="lineno">  495</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      CountOfThreadsAndProcesses = 0;</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    TempList = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a>;</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  500</span>    {</div>
<div class="line"><span class="lineno">  501</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  502</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails =</div>
<div class="line"><span class="lineno">  503</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">USERMODE_DEBUGGING_PROCESS_DETAILS</a>, AttachedProcessList);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  506</span>        <span class="comment">// Each process is also counted (no matter if it has active paused thread or not)</span></div>
<div class="line"><span class="lineno">  507</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  508</span>        CountOfThreadsAndProcesses++;</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  511</span>        <span class="comment">// Search through all the active threads of this process</span></div>
<div class="line"><span class="lineno">  512</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  513</span>        TempList2 = &amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList2-&gt;Flink)</div>
<div class="line"><span class="lineno">  516</span>        {</div>
<div class="line"><span class="lineno">  517</span>            TempList2 = TempList2-&gt;Flink;</div>
<div class="line"><span class="lineno">  518</span>            <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  519</span>                CONTAINING_RECORD(TempList2, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  522</span>            {</div>
<div class="line"><span class="lineno">  523</span>                <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">  524</span>                {</div>
<div class="line"><span class="lineno">  525</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  526</span>                    <span class="comment">// A paused thread should be counted</span></div>
<div class="line"><span class="lineno">  527</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  528</span>                    CountOfThreadsAndProcesses++;</div>
<div class="line"><span class="lineno">  529</span>                }</div>
<div class="line"><span class="lineno">  530</span>            }</div>
<div class="line"><span class="lineno">  531</span>        }</div>
<div class="line"><span class="lineno">  532</span>    }</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  535</span>    <span class="comment">// Return count of active threads and processes</span></div>
<div class="line"><span class="lineno">  536</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">return</span> CountOfThreadsAndProcesses;</div>
<div class="line"><span class="lineno">  538</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abefefca1094887640b64fb4405d1504e" name="abefefca1094887640b64fb4405d1504e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abefefca1094887640b64fb4405d1504e">&#9670;&#160;</a></span>ThreadHolderQueryDetailsOfActiveDebuggingThreadsAndProcesses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ThreadHolderQueryDetailsOfActiveDebuggingThreadsAndProcesses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#ac7aac921d83411cb9ae91f8fe3fba401">USERMODE_DEBUGGING_THREAD_OR_PROCESS_STATE_DETAILS</a> *</td>          <td class="paramname"><span class="paramname"><em>BufferToStoreDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>MaxCount</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query details of active debugging threads and processes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">BufferToStoreDetails</td><td></td></tr>
    <tr><td class="paramname">MaxCount</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  552</span>{</div>
<div class="line"><span class="lineno">  553</span>    PLIST_ENTRY TempList     = 0;</div>
<div class="line"><span class="lineno">  554</span>    PLIST_ENTRY TempList2    = 0;</div>
<div class="line"><span class="lineno">  555</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>      CurrentIndex = 0;</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordflow">if</span> (MaxCount == 0)</div>
<div class="line"><span class="lineno">  558</span>    {</div>
<div class="line"><span class="lineno">  559</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  560</span>        <span class="comment">// Invalid query, storage is empty</span></div>
<div class="line"><span class="lineno">  561</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  563</span>    }</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    TempList = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a>;</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  568</span>    {</div>
<div class="line"><span class="lineno">  569</span>        TempList = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  570</span>        <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails =</div>
<div class="line"><span class="lineno">  571</span>            CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">USERMODE_DEBUGGING_PROCESS_DETAILS</a>, AttachedProcessList);</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  574</span>        <span class="comment">// Each process is also save (no matter if it has active paused thread or not)</span></div>
<div class="line"><span class="lineno">  575</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  576</span>        BufferToStoreDetails[CurrentIndex].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a713808f072ea460e1774439e68cd84b9">IsProcess</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  577</span>        BufferToStoreDetails[CurrentIndex].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a72dbaec5dd832208d5b3b9853ec8f781">ProcessId</a> = ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ace267a6473505408e798a827e1b244f0">ProcessId</a>;</div>
<div class="line"><span class="lineno">  578</span>        CurrentIndex++;</div>
<div class="line"><span class="lineno">  579</span>        <span class="keywordflow">if</span> (MaxCount == CurrentIndex)</div>
<div class="line"><span class="lineno">  580</span>        {</div>
<div class="line"><span class="lineno">  581</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  582</span>            <span class="comment">// Storage is full</span></div>
<div class="line"><span class="lineno">  583</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  585</span>        }</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="comment">// Search through all the active threads of this process</span></div>
<div class="line"><span class="lineno">  589</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  590</span>        TempList2 = &amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a>;</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>        <span class="keywordflow">while</span> (&amp;ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aa599a0813df15b4250895e755bc484b9">ThreadsListHead</a> != TempList2-&gt;Flink)</div>
<div class="line"><span class="lineno">  593</span>        {</div>
<div class="line"><span class="lineno">  594</span>            TempList2 = TempList2-&gt;Flink;</div>
<div class="line"><span class="lineno">  595</span>            <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">PUSERMODE_DEBUGGING_THREAD_HOLDER</a> ThreadHolder =</div>
<div class="line"><span class="lineno">  596</span>                CONTAINING_RECORD(TempList2, <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>, ThreadHolderList);</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a0c6e13c5d1c8b877d7e31b6f5065b1e3">MAX_THREADS_IN_A_PROCESS_HOLDER</a>; i++)</div>
<div class="line"><span class="lineno">  599</span>            {</div>
<div class="line"><span class="lineno">  600</span>                <span class="keywordflow">if</span> (ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">  601</span>                {</div>
<div class="line"><span class="lineno">  602</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  603</span>                    <span class="comment">// A paused thread should be saved</span></div>
<div class="line"><span class="lineno">  604</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  605</span>                    BufferToStoreDetails[CurrentIndex].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a713808f072ea460e1774439e68cd84b9">IsProcess</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  606</span>                    BufferToStoreDetails[CurrentIndex].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a72dbaec5dd832208d5b3b9853ec8f781">ProcessId</a> = ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ace267a6473505408e798a827e1b244f0">ProcessId</a>;</div>
<div class="line"><span class="lineno">  607</span>                    BufferToStoreDetails[CurrentIndex].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a718829122dd1cf4a79212994c25519f6">ThreadId</a>  = ThreadHolder-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html#a60f23a7a2c69e25768792a6626fb73a6">Threads</a>[i].<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a>;</div>
<div class="line"><span class="lineno">  608</span>                    CurrentIndex++;</div>
<div class="line"><span class="lineno">  609</span>                    <span class="keywordflow">if</span> (MaxCount == CurrentIndex)</div>
<div class="line"><span class="lineno">  610</span>                    {</div>
<div class="line"><span class="lineno">  611</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  612</span>                        <span class="comment">// Storage is full</span></div>
<div class="line"><span class="lineno">  613</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  614</span>                        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  615</span>                    }</div>
<div class="line"><span class="lineno">  616</span>                }</div>
<div class="line"><span class="lineno">  617</span>            }</div>
<div class="line"><span class="lineno">  618</span>        }</div>
<div class="line"><span class="lineno">  619</span>    }</div>
<div class="line"><span class="lineno">  620</span>}</div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s_html_a713808f072ea460e1774439e68cd84b9"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a713808f072ea460e1774439e68cd84b9">_USERMODE_DEBUGGING_THREAD_OR_PROCESS_STATE_DETAILS::IsProcess</a></div><div class="ttdeci">BOOLEAN IsProcess</div><div class="ttdef"><b>Definition</b> RequestStructures.h:813</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s_html_a718829122dd1cf4a79212994c25519f6"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a718829122dd1cf4a79212994c25519f6">_USERMODE_DEBUGGING_THREAD_OR_PROCESS_STATE_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:812</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s_html_a72dbaec5dd832208d5b3b9853ec8f781"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___o_r___p_r_o_c_e_s_s___s_t_a_t_e___d_e_t_a_i_l_s.html#a72dbaec5dd832208d5b3b9853ec8f781">_USERMODE_DEBUGGING_THREAD_OR_PROCESS_STATE_DETAILS::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:811</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a5f373c61acb9fe386b8b8b975c5ca094" name="a5f373c61acb9fe386b8b8b975c5ca094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f373c61acb9fe386b8b8b975c5ca094">&#9670;&#160;</a></span>VmxRootThreadHoldingLock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile LONG VmxRootThreadHoldingLock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vmx-root lock for thread holding. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_fd401680aa8c7ceffc479e97f6bdc4df.html">hyperkd</a></li><li class="navelem"><a class="el" href="dir_b9a42e394d8efcca63fc5d2d60127445.html">header</a></li><li class="navelem"><a class="el" href="dir_b7f82d642e4d0c525e6cfe8908059b17.html">debugger</a></li><li class="navelem"><a class="el" href="dir_313e9e9e5342a34428cfe05999879d58.html">user-level</a></li><li class="navelem"><a class="el" href="_thread_holder_8h.html">ThreadHolder.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
