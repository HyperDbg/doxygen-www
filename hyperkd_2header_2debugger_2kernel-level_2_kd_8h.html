<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperkd/header/debugger/kernel-level/Kd.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('hyperkd_2header_2debugger_2kernel-level_2_kd_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Kd.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header for routines related to kernel mode debugging.  
<a href="#details">More...</a></p>

<p><a href="hyperkd_2header_2debugger_2kernel-level_2_kd_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html">_DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to change the process  <a href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html">_DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to change the thread  <a href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to pause and halt the system  <a href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">store the details of a hardware debug register to ignore any trigger for other threads  <a href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a1ad4ae8cc604353c84f45d060c15e641" id="r_a1ad4ae8cc604353c84f45d060c15e641"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html">_DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ad4ae8cc604353c84f45d060c15e641">DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a></td></tr>
<tr class="memdesc:a1ad4ae8cc604353c84f45d060c15e641"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to change the process  <br /></td></tr>
<tr class="separator:a1ad4ae8cc604353c84f45d060c15e641"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75462fddb22aeb284e09a0465e8e6929" id="r_a75462fddb22aeb284e09a0465e8e6929"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html">_DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75462fddb22aeb284e09a0465e8e6929">PDEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a></td></tr>
<tr class="separator:a75462fddb22aeb284e09a0465e8e6929"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd44542909b860301b2b95fbfbca8ea" id="r_a5fd44542909b860301b2b95fbfbca8ea"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html">_DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5fd44542909b860301b2b95fbfbca8ea">DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a></td></tr>
<tr class="memdesc:a5fd44542909b860301b2b95fbfbca8ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to change the thread  <br /></td></tr>
<tr class="separator:a5fd44542909b860301b2b95fbfbca8ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd076187998184fbf980d03949ad4eb9" id="r_acd076187998184fbf980d03949ad4eb9"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html">_DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd076187998184fbf980d03949ad4eb9">PDEBUGGEE_REQUEST_TO_CHANGE_THREAD</a></td></tr>
<tr class="separator:acd076187998184fbf980d03949ad4eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedf0b19343dd23c43662c511b9ef14f3" id="r_aedf0b19343dd23c43662c511b9ef14f3"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aedf0b19343dd23c43662c511b9ef14f3">DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></td></tr>
<tr class="memdesc:aedf0b19343dd23c43662c511b9ef14f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">request to pause and halt the system  <br /></td></tr>
<tr class="separator:aedf0b19343dd23c43662c511b9ef14f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf4b7231fd2b6d0250c9ffc8cacdc0c" id="r_a2cf4b7231fd2b6d0250c9ffc8cacdc0c"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cf4b7231fd2b6d0250c9ffc8cacdc0c">PDEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></td></tr>
<tr class="separator:a2cf4b7231fd2b6d0250c9ffc8cacdc0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2caac9dcb648b3b97f9b1bc150ffa078" id="r_a2caac9dcb648b3b97f9b1bc150ffa078"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2caac9dcb648b3b97f9b1bc150ffa078">HARDWARE_DEBUG_REGISTER_DETAILS</a></td></tr>
<tr class="memdesc:a2caac9dcb648b3b97f9b1bc150ffa078"><td class="mdescLeft">&#160;</td><td class="mdescRight">store the details of a hardware debug register to ignore any trigger for other threads  <br /></td></tr>
<tr class="separator:a2caac9dcb648b3b97f9b1bc150ffa078"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac138c71071baa0775fc179a9b25eb114" id="r_ac138c71071baa0775fc179a9b25eb114"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac138c71071baa0775fc179a9b25eb114">PHARDWARE_DEBUG_REGISTER_DETAILS</a></td></tr>
<tr class="separator:ac138c71071baa0775fc179a9b25eb114"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac7a7e5c80ccd8650a1b4e6c9e9193845" id="r_ac7a7e5c80ccd8650a1b4e6c9e9193845"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac7a7e5c80ccd8650a1b4e6c9e9193845">KdHaltSystem</a> (<a class="el" href="_data_types_8h.html#a76ef165d19b9e825f9bced11160f1049">PDEBUGGER_PAUSE_PACKET_RECEIVED</a> PausePacket)</td></tr>
<tr class="memdesc:ac7a7e5c80ccd8650a1b4e6c9e9193845"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halt the system.  <br /></td></tr>
<tr class="separator:ac7a7e5c80ccd8650a1b4e6c9e9193845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7edea2d3f08ab8587b3048031d3cddd" id="r_af7edea2d3f08ab8587b3048031d3cddd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7edea2d3f08ab8587b3048031d3cddd">KdHandleDebugEventsWhenKernelDebuggerIsAttached</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> TrapSetByDebugger)</td></tr>
<tr class="memdesc:af7edea2d3f08ab8587b3048031d3cddd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles debug events when kernel-debugger is attached.  <br /></td></tr>
<tr class="separator:af7edea2d3f08ab8587b3048031d3cddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ec660b5db2e1b3a1677661c23b51d0" id="r_a81ec660b5db2e1b3a1677661c23b51d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81ec660b5db2e1b3a1677661c23b51d0">KdManageSystemHaltOnVmxRoot</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:a81ec660b5db2e1b3a1677661c23b51d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">manage system halt on vmx-root mode  <br /></td></tr>
<tr class="separator:a81ec660b5db2e1b3a1677661c23b51d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a874c5a260b2ad0704e92c2b68b6a97af" id="r_a874c5a260b2ad0704e92c2b68b6a97af"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a874c5a260b2ad0704e92c2b68b6a97af">KdCheckAndHandleNmiCallback</a> (_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="separator:a874c5a260b2ad0704e92c2b68b6a97af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ea35c78a7ce042d1fa92e31cc86e3c3" id="r_a4ea35c78a7ce042d1fa92e31cc86e3c3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ea35c78a7ce042d1fa92e31cc86e3c3">KdHandleNmi</a> (_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState)</td></tr>
<tr class="separator:a4ea35c78a7ce042d1fa92e31cc86e3c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6327269502f58fa975905189894eb48" id="r_aa6327269502f58fa975905189894eb48"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa6327269502f58fa975905189894eb48">KdInitializeKernelDebugger</a> ()</td></tr>
<tr class="memdesc:aa6327269502f58fa975905189894eb48"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize kernel debugger  <br /></td></tr>
<tr class="separator:aa6327269502f58fa975905189894eb48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b5f11529ccadc52cc47bccb072ed27" id="r_a93b5f11529ccadc52cc47bccb072ed27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a93b5f11529ccadc52cc47bccb072ed27">KdUninitializeKernelDebugger</a> ()</td></tr>
<tr class="memdesc:a93b5f11529ccadc52cc47bccb072ed27"><td class="mdescLeft">&#160;</td><td class="mdescRight">uninitialize kernel debugger  <br /></td></tr>
<tr class="separator:a93b5f11529ccadc52cc47bccb072ed27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6587839febc38997d213ccc23f5a21" id="r_ada6587839febc38997d213ccc23f5a21"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada6587839febc38997d213ccc23f5a21">KdInitializeInstantEventPools</a> ()</td></tr>
<tr class="memdesc:ada6587839febc38997d213ccc23f5a21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the required pools for instant events.  <br /></td></tr>
<tr class="separator:ada6587839febc38997d213ccc23f5a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af968467072898abb6bbd25495a06eb" id="r_a0af968467072898abb6bbd25495a06eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0af968467072898abb6bbd25495a06eb">KdSendFormatsFunctionResult</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> <a class="el" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>)</td></tr>
<tr class="memdesc:a0af968467072898abb6bbd25495a06eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify user-mode to unload the debuggee and close the connections.  <br /></td></tr>
<tr class="separator:a0af968467072898abb6bbd25495a06eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ba4b9350674375c024a9f2b63c7907" id="r_a38ba4b9350674375c024a9f2b63c7907"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a38ba4b9350674375c024a9f2b63c7907">KdSendCommandFinishedSignal</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="memdesc:a38ba4b9350674375c024a9f2b63c7907"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify debugger that the execution of command finished.  <br /></td></tr>
<tr class="separator:a38ba4b9350674375c024a9f2b63c7907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ae5d7ad1daa1d2516238d1f6f8d96d" id="r_a66ae5d7ad1daa1d2516238d1f6f8d96d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66ae5d7ad1daa1d2516238d1f6f8d96d">KdHandleBreakpointAndDebugBreakpointsCallback</a> (_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, _In_ <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="separator:a66ae5d7ad1daa1d2516238d1f6f8d96d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed037f4430a6dec6d52f38a799394e7e" id="r_aed037f4430a6dec6d52f38a799394e7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aed037f4430a6dec6d52f38a799394e7e">KdHandleBreakpointAndDebugBreakpoints</a> (_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, _In_ <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="separator:aed037f4430a6dec6d52f38a799394e7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36cd156d7513f5bb5f119b5e05fb4206" id="r_a36cd156d7513f5bb5f119b5e05fb4206"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36cd156d7513f5bb5f119b5e05fb4206">KdHandleRegisteredMtfCallback</a> (_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId)</td></tr>
<tr class="separator:a36cd156d7513f5bb5f119b5e05fb4206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfff40dfc7fe7e837164f8eb7bc9c7f" id="r_a1dfff40dfc7fe7e837164f8eb7bc9c7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dfff40dfc7fe7e837164f8eb7bc9c7f">KdHandleHaltsWhenNmiReceivedFromVmxRoot</a> (_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState)</td></tr>
<tr class="separator:a1dfff40dfc7fe7e837164f8eb7bc9c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a054ac5a2eacb043709217c38c8a17b2e" id="r_a054ac5a2eacb043709217c38c8a17b2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a054ac5a2eacb043709217c38c8a17b2e">KdCheckImmediateMessagingMechanism</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OperationCode)</td></tr>
<tr class="memdesc:a054ac5a2eacb043709217c38c8a17b2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether the immediate messaging mechism is needed or not.  <br /></td></tr>
<tr class="separator:a054ac5a2eacb043709217c38c8a17b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67a719083cf8982cdf9c0283c8779bd" id="r_ae67a719083cf8982cdf9c0283c8779bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae67a719083cf8982cdf9c0283c8779bd">KdResponsePacketToDebugger</a> (_In_ _Strict_type_match_ <a class="el" href="_connection_8h.html#a4924566aaf12e93c1e2a037d12bc32fe">DEBUGGER_REMOTE_PACKET_TYPE</a> PacketType, _In_ _Strict_type_match_ <a class="el" href="_connection_8h.html#a4c14c05a1e67ce2b3fcf780d0e622424">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION</a> Response, _In_reads_bytes_opt_(OptionalBufferLength) <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *OptionalBuffer, _In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OptionalBufferLength)</td></tr>
<tr class="separator:ae67a719083cf8982cdf9c0283c8779bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea3d8b33fc912094006bdec836ca4e70" id="r_aea3d8b33fc912094006bdec836ca4e70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea3d8b33fc912094006bdec836ca4e70">KdLoggingResponsePacketToDebugger</a> (_In_reads_bytes_(OptionalBufferLength) <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *OptionalBuffer, _In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OptionalBufferLength, _In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> OperationCode)</td></tr>
<tr class="separator:aea3d8b33fc912094006bdec836ca4e70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741a955565e9e421cb67d11ccd51b0d4" id="r_a741a955565e9e421cb67d11ccd51b0d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a741a955565e9e421cb67d11ccd51b0d4">KdCheckGuestOperatingModeChanges</a> (<a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> PreviousCsSelector, <a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> CurrentCsSelector)</td></tr>
<tr class="memdesc:a741a955565e9e421cb67d11ccd51b0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the execution mode (kernel-mode to user-mode or user-mode to kernel-mode) changed.  <br /></td></tr>
<tr class="separator:a741a955565e9e421cb67d11ccd51b0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a814437795a9e923d352b848630625a56" id="r_a814437795a9e923d352b848630625a56"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a> ()</td></tr>
<tr class="memdesc:a814437795a9e923d352b848630625a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">determines if the guest was in 32-bit user-mode or 64-bit (long mode)  <br /></td></tr>
<tr class="separator:a814437795a9e923d352b848630625a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7d47bab2ada4c9c4f1f5cfbd2e0852f" id="r_ab7d47bab2ada4c9c4f1f5cfbd2e0852f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7d47bab2ada4c9c4f1f5cfbd2e0852f">KdHandleNmiBroadcastDebugBreaks</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsOnVmxNmiHandler)</td></tr>
<tr class="memdesc:ab7d47bab2ada4c9c4f1f5cfbd2e0852f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle broadcast NMIs for halting cores in vmx-root mode.  <br /></td></tr>
<tr class="separator:ab7d47bab2ada4c9c4f1f5cfbd2e0852f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad53861a47c60820feee3d0bc2351285a" id="r_ad53861a47c60820feee3d0bc2351285a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad53861a47c60820feee3d0bc2351285a">KdUnlockTheHaltedCore</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState)</td></tr>
<tr class="memdesc:ad53861a47c60820feee3d0bc2351285a"><td class="mdescLeft">&#160;</td><td class="mdescRight">unlock the target core  <br /></td></tr>
<tr class="separator:ad53861a47c60820feee3d0bc2351285a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac229aecc3edc3d24c062528ccfd7e431" id="r_ac229aecc3edc3d24c062528ccfd7e431"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac229aecc3edc3d24c062528ccfd7e431">KdCheckTheHaltedCore</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState)</td></tr>
<tr class="memdesc:ac229aecc3edc3d24c062528ccfd7e431"><td class="mdescLeft">&#160;</td><td class="mdescRight">check the lock state of the target core  <br /></td></tr>
<tr class="separator:ac229aecc3edc3d24c062528ccfd7e431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc12878954fd8a1118d83f2cfe08052f" id="r_acc12878954fd8a1118d83f2cfe08052f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc12878954fd8a1118d83f2cfe08052f">KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, <a class="el" href="_data_types_8h.html#ad6e74aca70f1102548c8fbe12b407384">DEBUGGER_THREAD_PROCESS_TRACING</a> TracingType)</td></tr>
<tr class="memdesc:acc12878954fd8a1118d83f2cfe08052f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query for process/thread interception status.  <br /></td></tr>
<tr class="separator:acc12878954fd8a1118d83f2cfe08052f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac9e9a8a58602b96c760514fbe7a268d4" id="r_ac9e9a8a58602b96c760514fbe7a268d4"><td class="memItemLeft" align="right" valign="top">volatile LONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9e9a8a58602b96c760514fbe7a268d4">DebuggerResponseLock</a></td></tr>
<tr class="memdesc:ac9e9a8a58602b96c760514fbe7a268d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vmx-root lock for sending response of debugger.  <br /></td></tr>
<tr class="separator:ac9e9a8a58602b96c760514fbe7a268d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8f0690057ff0d1c6f2f42dbbdb3ee96" id="r_aa8f0690057ff0d1c6f2f42dbbdb3ee96"><td class="memItemLeft" align="right" valign="top">volatile LONG&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa8f0690057ff0d1c6f2f42dbbdb3ee96">DebuggerHandleBreakpointLock</a></td></tr>
<tr class="memdesc:aa8f0690057ff0d1c6f2f42dbbdb3ee96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Vmx-root lock for handling breaks to debugger.  <br /></td></tr>
<tr class="separator:aa8f0690057ff0d1c6f2f42dbbdb3ee96"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header for routines related to kernel mode debugging. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-12-20</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="a1ad4ae8cc604353c84f45d060c15e641" name="a1ad4ae8cc604353c84f45d060c15e641"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ad4ae8cc604353c84f45d060c15e641">&#9670;&#160;</a></span>DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html">_DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a> <a class="el" href="#a1ad4ae8cc604353c84f45d060c15e641">DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>request to change the process </p>

</div>
</div>
<a id="a5fd44542909b860301b2b95fbfbca8ea" name="a5fd44542909b860301b2b95fbfbca8ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fd44542909b860301b2b95fbfbca8ea">&#9670;&#160;</a></span>DEBUGGEE_REQUEST_TO_CHANGE_THREAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html">_DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a> <a class="el" href="#a5fd44542909b860301b2b95fbfbca8ea">DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>request to change the thread </p>

</div>
</div>
<a id="aedf0b19343dd23c43662c511b9ef14f3" name="aedf0b19343dd23c43662c511b9ef14f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedf0b19343dd23c43662c511b9ef14f3">&#9670;&#160;</a></span>DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a> <a class="el" href="#aedf0b19343dd23c43662c511b9ef14f3">DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>request to pause and halt the system </p>

</div>
</div>
<a id="a2caac9dcb648b3b97f9b1bc150ffa078" name="a2caac9dcb648b3b97f9b1bc150ffa078"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2caac9dcb648b3b97f9b1bc150ffa078">&#9670;&#160;</a></span>HARDWARE_DEBUG_REGISTER_DETAILS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a> <a class="el" href="#a2caac9dcb648b3b97f9b1bc150ffa078">HARDWARE_DEBUG_REGISTER_DETAILS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>store the details of a hardware debug register to ignore any trigger for other threads </p>

</div>
</div>
<a id="a75462fddb22aeb284e09a0465e8e6929" name="a75462fddb22aeb284e09a0465e8e6929"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75462fddb22aeb284e09a0465e8e6929">&#9670;&#160;</a></span>PDEBUGGEE_REQUEST_TO_CHANGE_PROCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___p_r_o_c_e_s_s.html">_DEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a> * <a class="el" href="#a75462fddb22aeb284e09a0465e8e6929">PDEBUGGEE_REQUEST_TO_CHANGE_PROCESS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="acd076187998184fbf980d03949ad4eb9" name="acd076187998184fbf980d03949ad4eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd076187998184fbf980d03949ad4eb9">&#9670;&#160;</a></span>PDEBUGGEE_REQUEST_TO_CHANGE_THREAD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___c_h_a_n_g_e___t_h_r_e_a_d.html">_DEBUGGEE_REQUEST_TO_CHANGE_THREAD</a> * <a class="el" href="#acd076187998184fbf980d03949ad4eb9">PDEBUGGEE_REQUEST_TO_CHANGE_THREAD</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cf4b7231fd2b6d0250c9ffc8cacdc0c" name="a2cf4b7231fd2b6d0250c9ffc8cacdc0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf4b7231fd2b6d0250c9ffc8cacdc0c">&#9670;&#160;</a></span>PDEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a> * <a class="el" href="#a2cf4b7231fd2b6d0250c9ffc8cacdc0c">PDEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac138c71071baa0775fc179a9b25eb114" name="ac138c71071baa0775fc179a9b25eb114"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac138c71071baa0775fc179a9b25eb114">&#9670;&#160;</a></span>PHARDWARE_DEBUG_REGISTER_DETAILS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a> * <a class="el" href="#ac138c71071baa0775fc179a9b25eb114">PHARDWARE_DEBUG_REGISTER_DETAILS</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a874c5a260b2ad0704e92c2b68b6a97af" name="a874c5a260b2ad0704e92c2b68b6a97af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a874c5a260b2ad0704e92c2b68b6a97af">&#9670;&#160;</a></span>KdCheckAndHandleNmiCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdCheckAndHandleNmiCallback </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a741a955565e9e421cb67d11ccd51b0d4" name="a741a955565e9e421cb67d11ccd51b0d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741a955565e9e421cb67d11ccd51b0d4">&#9670;&#160;</a></span>KdCheckGuestOperatingModeChanges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdCheckGuestOperatingModeChanges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></td>          <td class="paramname"><span class="paramname"><em>PreviousCsSelector</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></td>          <td class="paramname"><span class="paramname"><em>CurrentCsSelector</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the execution mode (kernel-mode to user-mode or user-mode to kernel-mode) changed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PreviousCsSelector</td><td></td></tr>
    <tr><td class="paramname">CurrentCsSelector</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1454</span>{</div>
<div class="line"><span class="lineno"> 1455</span>    PreviousCsSelector = PreviousCsSelector &amp; ~3;</div>
<div class="line"><span class="lineno"> 1456</span>    CurrentCsSelector  = CurrentCsSelector &amp; ~3;</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1459</span>    <span class="comment">// Check if the execution modes are the same or not</span></div>
<div class="line"><span class="lineno"> 1460</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1461</span>    <span class="keywordflow">if</span> (PreviousCsSelector == CurrentCsSelector)</div>
<div class="line"><span class="lineno"> 1462</span>    {</div>
<div class="line"><span class="lineno"> 1463</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1464</span>        <span class="comment">// Execution modes are not changed</span></div>
<div class="line"><span class="lineno"> 1465</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1466</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1467</span>    }</div>
<div class="line"><span class="lineno"> 1468</span> </div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keywordflow">if</span> ((PreviousCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a> || PreviousCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a>) &amp;&amp; CurrentCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a5bc1b920e0b1b8a1b35327b5f89ab6ac">KGDT64_R0_CODE</a>)</div>
<div class="line"><span class="lineno"> 1470</span>    {</div>
<div class="line"><span class="lineno"> 1471</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1472</span>        <span class="comment">// User-mode -&gt; Kernel-mode</span></div>
<div class="line"><span class="lineno"> 1473</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1474</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;User-mode -&gt; Kernel-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1475</span>    }</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((CurrentCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a> || CurrentCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a>) &amp;&amp; PreviousCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a5bc1b920e0b1b8a1b35327b5f89ab6ac">KGDT64_R0_CODE</a>)</div>
<div class="line"><span class="lineno"> 1477</span>    {</div>
<div class="line"><span class="lineno"> 1478</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1479</span>        <span class="comment">// Kernel-mode to user-mode</span></div>
<div class="line"><span class="lineno"> 1480</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1481</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Kernel-mode -&gt; User-mode\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1482</span>    }</div>
<div class="line"><span class="lineno"> 1483</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CurrentCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a> &amp;&amp; PreviousCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a>)</div>
<div class="line"><span class="lineno"> 1484</span>    {</div>
<div class="line"><span class="lineno"> 1485</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1486</span>        <span class="comment">// A heaven&#39;s gate (User-mode 32-bit code -&gt; User-mode 64-bit code)</span></div>
<div class="line"><span class="lineno"> 1487</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1488</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;32-bit User-mode -&gt; 64-bit User-mode (Heaven&#39;s gate)\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1489</span>    }</div>
<div class="line"><span class="lineno"> 1490</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PreviousCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a> &amp;&amp; CurrentCsSelector == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a>)</div>
<div class="line"><span class="lineno"> 1491</span>    {</div>
<div class="line"><span class="lineno"> 1492</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1493</span>        <span class="comment">// A heaven&#39;s gate (User-mode 64-bit code -&gt; User-mode 32-bit code)</span></div>
<div class="line"><span class="lineno"> 1494</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1495</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;64-bit User-mode -&gt; 32-bit User-mode (Return from Heaven&#39;s gate)\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1496</span>    }</div>
<div class="line"><span class="lineno"> 1497</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1498</span>    {</div>
<div class="line"><span class="lineno"> 1499</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unknown changes in cs selector during the instrumentation step-in\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1500</span>    }</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1503</span>    <span class="comment">// Execution modes are changed</span></div>
<div class="line"><span class="lineno"> 1504</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1505</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1506</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a97b0adbd65790fb90734daa8e5245a04"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a></div><div class="ttdeci">#define LogInfo(format,...)</div><div class="ttdoc">Define log variables.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:71</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_common_8h_html_a3566c0de563735de786e1052440226a1"><div class="ttname"><a href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a></div><div class="ttdeci">#define KGDT64_R3_CODE</div><div class="ttdef"><b>Definition</b> Common.h:127</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_common_8h_html_a5bc1b920e0b1b8a1b35327b5f89ab6ac"><div class="ttname"><a href="hyperhv_2header_2common_2_common_8h.html#a5bc1b920e0b1b8a1b35327b5f89ab6ac">KGDT64_R0_CODE</a></div><div class="ttdeci">#define KGDT64_R0_CODE</div><div class="ttdef"><b>Definition</b> Common.h:123</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_common_8h_html_a8b6aab65ae2c0a4e02ac1069d4ac46ad"><div class="ttname"><a href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a></div><div class="ttdeci">#define KGDT64_R3_CMCODE</div><div class="ttdef"><b>Definition</b> Common.h:125</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a054ac5a2eacb043709217c38c8a17b2e" name="a054ac5a2eacb043709217c38c8a17b2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a054ac5a2eacb043709217c38c8a17b2e">&#9670;&#160;</a></span>KdCheckImmediateMessagingMechanism()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdCheckImmediateMessagingMechanism </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>OperationCode</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether the immediate messaging mechism is needed or not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">OperationCode</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  121</span>{</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> &amp;&amp; !(OperationCode &amp; <a class="code hl_define" href="_constants_8h.html#a7337b6a99c8d8f595d658a4c59cf3bb0">OPERATION_MANDATORY_DEBUGGEE_BIT</a>));</div>
<div class="line"><span class="lineno">  123</span>}</div>
<div class="ttc" id="a_constants_8h_html_a7337b6a99c8d8f595d658a4c59cf3bb0"><div class="ttname"><a href="_constants_8h.html#a7337b6a99c8d8f595d658a4c59cf3bb0">OPERATION_MANDATORY_DEBUGGEE_BIT</a></div><div class="ttdeci">#define OPERATION_MANDATORY_DEBUGGEE_BIT</div><div class="ttdoc">If a operation use this bit in its Operation code, then it means that the operation should be perform...</div><div class="ttdef"><b>Definition</b> Constants.h:359</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_ae4b5afa957e3e26377135b91b60eda4e"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a></div><div class="ttdeci">BOOLEAN g_KernelDebuggerState</div><div class="ttdoc">shows whether the kernel debugger is enabled or disabled</div><div class="ttdef"><b>Definition</b> Global.h:103</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac229aecc3edc3d24c062528ccfd7e431" name="ac229aecc3edc3d24c062528ccfd7e431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac229aecc3edc3d24c062528ccfd7e431">&#9670;&#160;</a></span>KdCheckTheHaltedCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdCheckTheHaltedCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>check the lock state of the target core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the target core</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1826</span>{</div>
<div class="line"><span class="lineno"> 1827</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_spinlock_8c.html#ac1a95c40a6bbcf4129b96feaee489b81">SpinlockCheckLock</a>(&amp;DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5cb1b3e0fee150e30f93529efdcb324b">Lock</a>);</div>
<div class="line"><span class="lineno"> 1828</span>}</div>
<div class="ttc" id="a_spinlock_8c_html_ac1a95c40a6bbcf4129b96feaee489b81"><div class="ttname"><a href="_spinlock_8c.html#ac1a95c40a6bbcf4129b96feaee489b81">SpinlockCheckLock</a></div><div class="ttdeci">BOOLEAN SpinlockCheckLock(volatile LONG *Lock)</div><div class="ttdoc">Check the lock without changing the state.</div><div class="ttdef"><b>Definition</b> Spinlock.c:169</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a5cb1b3e0fee150e30f93529efdcb324b"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5cb1b3e0fee150e30f93529efdcb324b">_PROCESSOR_DEBUGGING_STATE::Lock</a></div><div class="ttdeci">volatile LONG Lock</div><div class="ttdef"><b>Definition</b> State.h:166</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac7a7e5c80ccd8650a1b4e6c9e9193845" name="ac7a7e5c80ccd8650a1b4e6c9e9193845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7a7e5c80ccd8650a1b4e6c9e9193845">&#9670;&#160;</a></span>KdHaltSystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHaltSystem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#a76ef165d19b9e825f9bced11160f1049">PDEBUGGER_PAUSE_PACKET_RECEIVED</a></td>          <td class="paramname"><span class="paramname"><em>PausePacket</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Halt the system. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PausePacket</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 3377</span>{</div>
<div class="line"><span class="lineno"> 3378</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3379</span>    <span class="comment">// Broadcast to halt everything</span></div>
<div class="line"><span class="lineno"> 3380</span>    <span class="comment">// Instead of broadcasting we will just send one vmcall and</span></div>
<div class="line"><span class="lineno"> 3381</span>    <span class="comment">// from that point, we halt all the other cores by NMIs, this</span></div>
<div class="line"><span class="lineno"> 3382</span>    <span class="comment">// way we are sure that we get all the other cores at the middle</span></div>
<div class="line"><span class="lineno"> 3383</span>    <span class="comment">// of their execution codes and not on HyperDbg routines</span></div>
<div class="line"><span class="lineno"> 3384</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3385</span>    <span class="comment">// KdBroadcastHaltOnAllCores();</span></div>
<div class="line"><span class="lineno"> 3386</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3387</span> </div>
<div class="line"><span class="lineno"> 3388</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3389</span>    <span class="comment">// vm-exit and halt current core</span></div>
<div class="line"><span class="lineno"> 3390</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3391</span>    <a class="code hl_function" href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a995b2bb03835e5c569e4ea3fca385d9a">DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM</a>, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 3392</span> </div>
<div class="line"><span class="lineno"> 3393</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3394</span>    <span class="comment">// Set the status</span></div>
<div class="line"><span class="lineno"> 3395</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3396</span>    PausePacket-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_a_u_s_e___p_a_c_k_e_t___r_e_c_e_i_v_e_d.html#a2982924464dbc80791d36cd9b1097063">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 3397</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a995b2bb03835e5c569e4ea3fca385d9a"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a995b2bb03835e5c569e4ea3fca385d9a">DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_VM_EXIT_HALT_SYSTEM</div><div class="ttdoc">VMCALL to cause vm-exit and halt the system.</div><div class="ttdef"><b>Definition</b> DebuggerVmcalls.h:22</div></div>
<div class="ttc" id="a_error_codes_8h_html_aed656c58434eecb2d7e8c10e93aecff4"><div class="ttname"><a href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a></div><div class="ttdeci">#define DEBUGGER_OPERATION_WAS_SUCCESSFUL</div><div class="ttdoc">General value to indicate that the operation or request was successful.</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:23</div></div>
<div class="ttc" id="a_export_8c_html_a12ce0403e6a293853c4f103d73403b07"><div class="ttname"><a href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a></div><div class="ttdeci">NTSTATUS VmFuncVmxVmcall(unsigned long long VmcallNumber, unsigned long long OptionalParam1, unsigned long long OptionalParam2, unsigned long long OptionalParam3)</div><div class="ttdoc">Export for running VMX VMCALLs.</div><div class="ttdef"><b>Definition</b> Export.c:683</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_a_u_s_e___p_a_c_k_e_t___r_e_c_e_i_v_e_d_html_a2982924464dbc80791d36cd9b1097063"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_a_u_s_e___p_a_c_k_e_t___r_e_c_e_i_v_e_d.html#a2982924464dbc80791d36cd9b1097063">_DEBUGGER_PAUSE_PACKET_RECEIVED::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition</b> DataTypes.h:179</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aed037f4430a6dec6d52f38a799394e7e" name="aed037f4430a6dec6d52f38a799394e7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed037f4430a6dec6d52f38a799394e7e">&#9670;&#160;</a></span>KdHandleBreakpointAndDebugBreakpoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleBreakpointAndDebugBreakpoints </td>
          <td>(</td>
          <td class="paramtype">_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a></td>          <td class="paramname"><span class="paramname"><em>Reason</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>EventDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a66ae5d7ad1daa1d2516238d1f6f8d96d" name="a66ae5d7ad1daa1d2516238d1f6f8d96d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ae5d7ad1daa1d2516238d1f6f8d96d">&#9670;&#160;</a></span>KdHandleBreakpointAndDebugBreakpointsCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleBreakpointAndDebugBreakpointsCallback </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a></td>          <td class="paramname"><span class="paramname"><em>Reason</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>EventDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af7edea2d3f08ab8587b3048031d3cddd" name="af7edea2d3f08ab8587b3048031d3cddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7edea2d3f08ab8587b3048031d3cddd">&#9670;&#160;</a></span>KdHandleDebugEventsWhenKernelDebuggerIsAttached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleDebugEventsWhenKernelDebuggerIsAttached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>TrapSetByDebugger</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles debug events when kernel-debugger is attached. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">TrapSetByDebugger</td><td>Shows whether a trap set by debugger or not</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  427</span>{</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">DEBUGGER_TRIGGERED_EVENT_DETAILS</a> TargetContext    = {0};</div>
<div class="line"><span class="lineno">  429</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                          IgnoreDebugEvent = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                           LastVmexitRip    = <a class="code hl_function" href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">// It&#39;s a breakpoint and should be handled by the kernel debugger</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  435</span>    TargetContext.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">Context</a> = (PVOID)LastVmexitRip;</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">if</span> (TrapSetByDebugger)</div>
<div class="line"><span class="lineno">  438</span>    {</div>
<div class="line"><span class="lineno">  439</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  440</span>        <span class="comment">// *** Handle a regular trap flag (most of the times as a result of stepping) set by the debugger ***</span></div>
<div class="line"><span class="lineno">  441</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  444</span>        <span class="comment">// Check and handle if there is a software defined breakpoint</span></div>
<div class="line"><span class="lineno">  445</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  447</span>                                                                LastVmexitRip,</div>
<div class="line"><span class="lineno">  448</span>                                                                <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba2e4a9051f91b8dd308c56566d57bbd19">DEBUGGEE_PAUSING_REASON_DEBUGGEE_STEPPED</a>,</div>
<div class="line"><span class="lineno">  449</span>                                                                <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</div>
<div class="line"><span class="lineno">  450</span>        {</div>
<div class="line"><span class="lineno">  451</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>.<a class="code hl_variable" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#ad6283c78aa0a3e8a33a7629bf71accb9">Address</a> != (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>)</div>
<div class="line"><span class="lineno">  452</span>            {</div>
<div class="line"><span class="lineno">  453</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  454</span>                <span class="comment">// Check if it&#39;s caused by a step-over hardware debug breakpoint or not</span></div>
<div class="line"><span class="lineno">  455</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  456</span>                <span class="keywordflow">if</span> (LastVmexitRip == <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>.<a class="code hl_variable" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#ad6283c78aa0a3e8a33a7629bf71accb9">Address</a>)</div>
<div class="line"><span class="lineno">  457</span>                {</div>
<div class="line"><span class="lineno">  458</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>.<a class="code hl_variable" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#afc21368e7a0be9dc359747ca96b7c17f">ProcessId</a> == <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()) &amp;&amp;</div>
<div class="line"><span class="lineno">  459</span>                        <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>.<a class="code hl_variable" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#a2ff9ff153a2d64da6969c24d58949eb3">ThreadId</a> == <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentThreadId()))</div>
<div class="line"><span class="lineno">  460</span>                    {</div>
<div class="line"><span class="lineno">  461</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  462</span>                        <span class="comment">// It&#39;s a step caused by a debug register breakpoint step-over</span></div>
<div class="line"><span class="lineno">  463</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  464</span>                        RtlZeroMemory(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">HARDWARE_DEBUG_REGISTER_DETAILS</a>));</div>
<div class="line"><span class="lineno">  465</span>                    }</div>
<div class="line"><span class="lineno">  466</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  467</span>                    {</div>
<div class="line"><span class="lineno">  468</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span>                        <span class="comment">// Should be ignored because it&#39;s a hardware debug register that is</span></div>
<div class="line"><span class="lineno">  470</span>                        <span class="comment">// likely triggered by other thread</span></div>
<div class="line"><span class="lineno">  471</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  472</span>                        IgnoreDebugEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  475</span>                        <span class="comment">// Also, we should re-apply the hardware debug breakpoint on this thread</span></div>
<div class="line"><span class="lineno">  476</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  477</span>                        <a class="code hl_function" href="_debug_registers_8c.html#aaaab32c0c14718eb2283f9b3069043a8">SetDebugRegisters</a>(<a class="code hl_define" href="hyperkd_2header_2debugger_2core_2_debugger_8h.html#a658b2dec7e55b47e8b8b1f2b57747953">DEBUGGER_DEBUG_REGISTER_FOR_STEP_OVER</a>,</div>
<div class="line"><span class="lineno">  478</span>                                          <a class="code hl_enumvalue" href="_data_types_8h.html#acbbc04b3f929bcff66333b5968b3a796af2a12e7545d187d63fe4e165e852b15b">BREAK_ON_INSTRUCTION_FETCH</a>,</div>
<div class="line"><span class="lineno">  479</span>                                          <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>,</div>
<div class="line"><span class="lineno">  480</span>                                          <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a>.<a class="code hl_variable" href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#ad6283c78aa0a3e8a33a7629bf71accb9">Address</a>);</div>
<div class="line"><span class="lineno">  481</span>                    }</div>
<div class="line"><span class="lineno">  482</span>                }</div>
<div class="line"><span class="lineno">  483</span>            }</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>            <span class="keywordflow">if</span> (!IgnoreDebugEvent)</div>
<div class="line"><span class="lineno">  486</span>            {</div>
<div class="line"><span class="lineno">  487</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  488</span>                <span class="comment">// Handle a regular step</span></div>
<div class="line"><span class="lineno">  489</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  490</span>                <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  491</span>                                                      <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba2e4a9051f91b8dd308c56566d57bbd19">DEBUGGEE_PAUSING_REASON_DEBUGGEE_STEPPED</a>,</div>
<div class="line"><span class="lineno">  492</span>                                                      &amp;TargetContext);</div>
<div class="line"><span class="lineno">  493</span>            }</div>
<div class="line"><span class="lineno">  494</span>        }</div>
<div class="line"><span class="lineno">  495</span>    }</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  497</span>    {</div>
<div class="line"><span class="lineno">  498</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  499</span>        <span class="comment">// It&#39;s a regular debug break event</span></div>
<div class="line"><span class="lineno">  500</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  501</span>        <a class="code hl_function" href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a>(DbgState,</div>
<div class="line"><span class="lineno">  502</span>                                              <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21badffddec7e865c30fb1c520d1a469ca82">DEBUGGEE_PAUSING_REASON_DEBUGGEE_HARDWARE_DEBUG_REGISTER_HIT</a>,</div>
<div class="line"><span class="lineno">  503</span>                                              &amp;TargetContext);</div>
<div class="line"><span class="lineno">  504</span>    }</div>
<div class="line"><span class="lineno">  505</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af249a8d277f3fe6fdeeb1796e537572b"><div class="ttname"><a href="_breakpoint_commands_8c.html#af249a8d277f3fe6fdeeb1796e537572b">BreakpointCheckAndHandleDebuggerDefinedBreakpoints</a></div><div class="ttdeci">BOOLEAN BreakpointCheckAndHandleDebuggerDefinedBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, UINT64 GuestRip, DEBUGGEE_PAUSING_REASON Reason, BOOLEAN ChangeMtfState)</div><div class="ttdoc">Check if the breakpoint vm-exit relates to 'bp' command or not.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:497</div></div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba2e4a9051f91b8dd308c56566d57bbd19"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba2e4a9051f91b8dd308c56566d57bbd19">DEBUGGEE_PAUSING_REASON_DEBUGGEE_STEPPED</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_STEPPED</div><div class="ttdef"><b>Definition</b> Connection.h:27</div></div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21badffddec7e865c30fb1c520d1a469ca82"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21badffddec7e865c30fb1c520d1a469ca82">DEBUGGEE_PAUSING_REASON_DEBUGGEE_HARDWARE_DEBUG_REGISTER_HIT</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_HARDWARE_DEBUG_REGISTER_HIT</div><div class="ttdef"><b>Definition</b> Connection.h:30</div></div>
<div class="ttc" id="a_data_types_8h_html_acbbc04b3f929bcff66333b5968b3a796af2a12e7545d187d63fe4e165e852b15b"><div class="ttname"><a href="_data_types_8h.html#acbbc04b3f929bcff66333b5968b3a796af2a12e7545d187d63fe4e165e852b15b">BREAK_ON_INSTRUCTION_FETCH</a></div><div class="ttdeci">@ BREAK_ON_INSTRUCTION_FETCH</div><div class="ttdef"><b>Definition</b> DataTypes.h:70</div></div>
<div class="ttc" id="a_debug_registers_8c_html_aaaab32c0c14718eb2283f9b3069043a8"><div class="ttname"><a href="_debug_registers_8c.html#aaaab32c0c14718eb2283f9b3069043a8">SetDebugRegisters</a></div><div class="ttdeci">BOOLEAN SetDebugRegisters(UINT32 DebugRegNum, DEBUG_REGISTER_TYPE ActionType, BOOLEAN ApplyToVmcs, UINT64 TargetAddress)</div><div class="ttdoc">Configure hardware debug register for access, write and fetch breakpoints.</div><div class="ttdef"><b>Definition</b> DebugRegisters.c:37</div></div>
<div class="ttc" id="a_export_8c_html_ab49740d6ce5d1c5f90828b66496dcb4c"><div class="ttname"><a href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a></div><div class="ttdeci">UINT64 VmFuncGetLastVmexitRip(UINT32 CoreId)</div><div class="ttdoc">get the last vm-exit RIP</div><div class="ttdef"><b>Definition</b> Export.c:318</div></div>
<div class="ttc" id="a_kd_8c_html_a732bca2051e444c16d2d9a5080978981"><div class="ttname"><a href="_kd_8c.html#a732bca2051e444c16d2d9a5080978981">KdHandleBreakpointAndDebugBreakpoints</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleBreakpointAndDebugBreakpoints(PROCESSOR_DEBUGGING_STATE *DbgState, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition</b> Kd.c:1214</div></div>
<div class="ttc" id="a_meta_macros_8h_html_ad790279846c85a5a453f2e7a4e02abad"><div class="ttname"><a href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a></div><div class="ttdeci">#define HANDLE_TO_UINT32(_var)</div><div class="ttdef"><b>Definition</b> MetaMacros.h:39</div></div>
<div class="ttc" id="ahyperkd_2header_2debugger_2core_2_debugger_8h_html_a658b2dec7e55b47e8b8b1f2b57747953"><div class="ttname"><a href="hyperkd_2header_2debugger_2core_2_debugger_8h.html#a658b2dec7e55b47e8b8b1f2b57747953">DEBUGGER_DEBUG_REGISTER_FOR_STEP_OVER</a></div><div class="ttdeci">#define DEBUGGER_DEBUG_REGISTER_FOR_STEP_OVER</div><div class="ttdoc">debug register for step-over</div><div class="ttdef"><b>Definition</b> Debugger.h:21</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_aa18646fd48487bbd6d28a61f575afe4e"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#aa18646fd48487bbd6d28a61f575afe4e">g_HardwareDebugRegisterDetailsForStepOver</a></div><div class="ttdeci">HARDWARE_DEBUG_REGISTER_DETAILS g_HardwareDebugRegisterDetailsForStepOver</div><div class="ttdoc">Holds the state of hardware debug register for step-over.</div><div class="ttdef"><b>Definition</b> Global.h:61</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html">_DEBUGGER_TRIGGERED_EVENT_DETAILS</a></div><div class="ttdoc">The structure of detail of a triggered event in HyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:192</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_aed232a35a0d0d95aa4ca77dc50fc6fae"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#aed232a35a0d0d95aa4ca77dc50fc6fae">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition</b> DataTypes.h:194</div></div>
<div class="ttc" id="astruct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html">_HARDWARE_DEBUG_REGISTER_DETAILS</a></div><div class="ttdoc">store the details of a hardware debug register to ignore any trigger for other threads</div><div class="ttdef"><b>Definition</b> Kd.h:73</div></div>
<div class="ttc" id="astruct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s_html_a2ff9ff153a2d64da6969c24d58949eb3"><div class="ttname"><a href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#a2ff9ff153a2d64da6969c24d58949eb3">_HARDWARE_DEBUG_REGISTER_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition</b> Kd.h:76</div></div>
<div class="ttc" id="astruct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s_html_ad6283c78aa0a3e8a33a7629bf71accb9"><div class="ttname"><a href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#ad6283c78aa0a3e8a33a7629bf71accb9">_HARDWARE_DEBUG_REGISTER_DETAILS::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> Kd.h:74</div></div>
<div class="ttc" id="astruct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s_html_afc21368e7a0be9dc359747ca96b7c17f"><div class="ttname"><a href="struct___h_a_r_d_w_a_r_e___d_e_b_u_g___r_e_g_i_s_t_e_r___d_e_t_a_i_l_s.html#afc21368e7a0be9dc359747ca96b7c17f">_HARDWARE_DEBUG_REGISTER_DETAILS::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> Kd.h:75</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:169</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dfff40dfc7fe7e837164f8eb7bc9c7f" name="a1dfff40dfc7fe7e837164f8eb7bc9c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfff40dfc7fe7e837164f8eb7bc9c7f">&#9670;&#160;</a></span>KdHandleHaltsWhenNmiReceivedFromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleHaltsWhenNmiReceivedFromVmxRoot </td>
          <td>(</td>
          <td class="paramtype">_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4ea35c78a7ce042d1fa92e31cc86e3c3" name="a4ea35c78a7ce042d1fa92e31cc86e3c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ea35c78a7ce042d1fa92e31cc86e3c3">&#9670;&#160;</a></span>KdHandleNmi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleNmi </td>
          <td>(</td>
          <td class="paramtype">_Inout_ <a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab7d47bab2ada4c9c4f1f5cfbd2e0852f" name="ab7d47bab2ada4c9c4f1f5cfbd2e0852f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7d47bab2ada4c9c4f1f5cfbd2e0852f">&#9670;&#160;</a></span>KdHandleNmiBroadcastDebugBreaks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleNmiBroadcastDebugBreaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsOnVmxNmiHandler</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle broadcast NMIs for halting cores in vmx-root mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
    <tr><td class="paramname">IsOnVmxNmiHandler</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1063</span>{</div>
<div class="line"><span class="lineno"> 1064</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1065</span>    <span class="comment">// Get the current debugging state</span></div>
<div class="line"><span class="lineno"> 1066</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1067</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1070</span>    <span class="comment">// We use it as a global flag (for both vmx-root and vmx non-root), because</span></div>
<div class="line"><span class="lineno"> 1071</span>    <span class="comment">// generally it doesn&#39;t have any use case in vmx-root (IsOnVmxNmiHandler == FALSE)</span></div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">// but in some cases, we might set the MTF but another vm-exit receives before</span></div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">// MTF and in that place if it tries to trigger and event, then the MTF is not</span></div>
<div class="line"><span class="lineno"> 1074</span>    <span class="comment">// handled and the core is not locked properly, just waits to get the handle</span></div>
<div class="line"><span class="lineno"> 1075</span>    <span class="comment">// of the &quot;DebuggerHandleBreakpointLock&quot;, so we check this flag there</span></div>
<div class="line"><span class="lineno"> 1076</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1077</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a0d22e0340ffa5de9190c09683fdfccf2">NmiState</a>.<a class="code hl_variable" href="struct___k_d___n_m_i___s_t_a_t_e.html#a6359e6a5d2e428c7dfc299e69592b9ef">WaitingToBeLocked</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">if</span> (IsOnVmxNmiHandler)</div>
<div class="line"><span class="lineno"> 1080</span>    {</div>
<div class="line"><span class="lineno"> 1081</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1082</span>        <span class="comment">// Indicate that it&#39;s called from NMI handle, and it relates to</span></div>
<div class="line"><span class="lineno"> 1083</span>        <span class="comment">// halting the debuggee</span></div>
<div class="line"><span class="lineno"> 1084</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1085</span>        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a0d22e0340ffa5de9190c09683fdfccf2">NmiState</a>.<a class="code hl_variable" href="struct___k_d___n_m_i___s_t_a_t_e.html#aee467e0975f8b0c6d71a727e3790e27e">NmiCalledInVmxRootRelatedToHaltDebuggee</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1088</span>        <span class="comment">// If the core was in the middle of spinning on the spinlock</span></div>
<div class="line"><span class="lineno"> 1089</span>        <span class="comment">// of getting the debug lock, this mechanism is not needed,</span></div>
<div class="line"><span class="lineno"> 1090</span>        <span class="comment">// but if the core is not spinning there or the core is processing</span></div>
<div class="line"><span class="lineno"> 1091</span>        <span class="comment">// a random vm-exit, then we inject an immediate vm-exit after vm-entry</span></div>
<div class="line"><span class="lineno"> 1092</span>        <span class="comment">// or inject a DPC</span></div>
<div class="line"><span class="lineno"> 1093</span>        <span class="comment">// this is used for two reasons.</span></div>
<div class="line"><span class="lineno"> 1094</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1095</span>        <span class="comment">//      1. first, we will get the registers (context) to halt the core</span></div>
<div class="line"><span class="lineno"> 1096</span>        <span class="comment">//      2. second, it guarantees that if the NMI arrives within any</span></div>
<div class="line"><span class="lineno"> 1097</span>        <span class="comment">//         instruction in vmx-root mode, then we injected an immediate</span></div>
<div class="line"><span class="lineno"> 1098</span>        <span class="comment">//         vm-exit and we won&#39;t miss any cpu cycle in the guest</span></div>
<div class="line"><span class="lineno"> 1099</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1100</span>        <span class="comment">// KdFireDpc(KdHaltCoreInTheCaseOfHaltedFromNmiInVmxRoot, NULL);</span></div>
<div class="line"><span class="lineno"> 1101</span>        <a class="code hl_function" href="_export_8c.html#a85480760316ec7682996e98898d3a611">VmFuncSetMonitorTrapFlag</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno"> 1102</span>    }</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1104</span>    {</div>
<div class="line"><span class="lineno"> 1105</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1106</span>        <span class="comment">// Handle core break</span></div>
<div class="line"><span class="lineno"> 1107</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1108</span>        <a class="code hl_function" href="_kd_8c.html#ab1cdd12912e4384ef4d5659c76a6da35">KdHandleNmi</a>(DbgState);</div>
<div class="line"><span class="lineno"> 1109</span>    }</div>
<div class="line"><span class="lineno"> 1110</span>}</div>
<div class="ttc" id="a_export_8c_html_a85480760316ec7682996e98898d3a611"><div class="ttname"><a href="_export_8c.html#a85480760316ec7682996e98898d3a611">VmFuncSetMonitorTrapFlag</a></div><div class="ttdeci">VOID VmFuncSetMonitorTrapFlag(BOOLEAN Set)</div><div class="ttdoc">Set the monitor trap flag.</div><div class="ttdef"><b>Definition</b> Export.c:98</div></div>
<div class="ttc" id="a_kd_8c_html_ab1cdd12912e4384ef4d5659c76a6da35"><div class="ttname"><a href="_kd_8c.html#ab1cdd12912e4384ef4d5659c76a6da35">KdHandleNmi</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleNmi(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">Handle NMI Vm-exits.</div><div class="ttdef"><b>Definition</b> Kd.c:1365</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition</b> Global.h:17</div></div>
<div class="ttc" id="astruct___k_d___n_m_i___s_t_a_t_e_html_a6359e6a5d2e428c7dfc299e69592b9ef"><div class="ttname"><a href="struct___k_d___n_m_i___s_t_a_t_e.html#a6359e6a5d2e428c7dfc299e69592b9ef">_KD_NMI_STATE::WaitingToBeLocked</a></div><div class="ttdeci">volatile BOOLEAN WaitingToBeLocked</div><div class="ttdef"><b>Definition</b> State.h:97</div></div>
<div class="ttc" id="astruct___k_d___n_m_i___s_t_a_t_e_html_aee467e0975f8b0c6d71a727e3790e27e"><div class="ttname"><a href="struct___k_d___n_m_i___s_t_a_t_e.html#aee467e0975f8b0c6d71a727e3790e27e">_KD_NMI_STATE::NmiCalledInVmxRootRelatedToHaltDebuggee</a></div><div class="ttdeci">volatile BOOLEAN NmiCalledInVmxRootRelatedToHaltDebuggee</div><div class="ttdef"><b>Definition</b> State.h:96</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">_PROCESSOR_DEBUGGING_STATE</a></div><div class="ttdoc">Saves the debugger state.</div><div class="ttdef"><b>Definition</b> State.h:165</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a0d22e0340ffa5de9190c09683fdfccf2"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a0d22e0340ffa5de9190c09683fdfccf2">_PROCESSOR_DEBUGGING_STATE::NmiState</a></div><div class="ttdeci">KD_NMI_STATE NmiState</div><div class="ttdef"><b>Definition</b> State.h:179</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a36cd156d7513f5bb5f119b5e05fb4206" name="a36cd156d7513f5bb5f119b5e05fb4206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36cd156d7513f5bb5f119b5e05fb4206">&#9670;&#160;</a></span>KdHandleRegisteredMtfCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdHandleRegisteredMtfCallback </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ada6587839febc38997d213ccc23f5a21" name="ada6587839febc38997d213ccc23f5a21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada6587839febc38997d213ccc23f5a21">&#9670;&#160;</a></span>KdInitializeInstantEventPools()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdInitializeInstantEventPools </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the required pools for instant events. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  132</span>{</div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// Request pages to be allocated for regular instant events</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a9a43e7c3f88b34c27ef48ffee07707e0">REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</a>, <a class="code hl_define" href="_constants_8h.html#a898a403eba5557b0e2ed10bfa4e4338b">MAXIMUM_REGULAR_INSTANT_EVENTS</a>, <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c">INSTANT_REGULAR_EVENT_BUFFER</a>);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="comment">// Request pages to be allocated for regular instant events&#39;s actions</span></div>
<div class="line"><span class="lineno">  140</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a88064ae4d52a6ef17dfc68bc2366a625">REGULAR_INSTANT_EVENT_ACTION_BUFFER</a>, <a class="code hl_define" href="_constants_8h.html#a898a403eba5557b0e2ed10bfa4e4338b">MAXIMUM_REGULAR_INSTANT_EVENTS</a>, <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529">INSTANT_REGULAR_EVENT_ACTION_BUFFER</a>);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span><span class="preprocessor">#if MAXIMUM_BIG_INSTANT_EVENTS &gt;= 1</span></div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// Request pages to be allocated for big instant events</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a9c2b21c71746a30f993c09fa8ae8c8f3">BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</a>, <a class="code hl_define" href="_constants_8h.html#a89326ca89ebdc7653dc8d7b70d7a098f">MAXIMUM_BIG_INSTANT_EVENTS</a>, <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047">INSTANT_BIG_EVENT_BUFFER</a>);</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  151</span>    <span class="comment">// Request pages to be allocated for big instant events&#39;s actions</span></div>
<div class="line"><span class="lineno">  152</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  153</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a1e4cfd3362664680ff4230700c100c6d">BIG_INSTANT_EVENT_ACTION_BUFFER</a>, <a class="code hl_define" href="_constants_8h.html#a89326ca89ebdc7653dc8d7b70d7a098f">MAXIMUM_BIG_INSTANT_EVENTS</a>, <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112">INSTANT_BIG_EVENT_ACTION_BUFFER</a>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">#endif </span><span class="comment">// MAXIMUM_BIG_INSTANT_EVENTS</span></div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">// Pre-allocate pools for possible EPT hooks</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="comment">// Because there are possible init EPT hook structures, we only allocate the</span></div>
<div class="line"><span class="lineno">  160</span>    <span class="comment">//  maximum number of regular instant event subtracted from the initial pages</span></div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  162</span>    <a class="code hl_function" href="_configuration_8c.html#af51d98af8c16c62303308f6f3ba91d1f">ConfigureEptHookReservePreallocatedPoolsForEptHooks</a>(<a class="code hl_define" href="_constants_8h.html#a898a403eba5557b0e2ed10bfa4e4338b">MAXIMUM_REGULAR_INSTANT_EVENTS</a> - <a class="code hl_define" href="_constants_8h.html#a0fdd1b09ceafbfd45fdf080cbf912574">MAXIMUM_NUMBER_OF_INITIAL_PREALLOCATED_EPT_HOOKS</a>);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a>())</div>
<div class="line"><span class="lineno">  165</span>    {</div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a>(<span class="stringliteral">&quot;Warning, cannot allocate the pre-allocated pools for EPT hooks&quot;</span>);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  169</span>        <span class="comment">// BTW, won&#39;t fail the starting phase because of this</span></div>
<div class="line"><span class="lineno">  170</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span>}</div>
<div class="ttc" id="a_configuration_8c_html_af51d98af8c16c62303308f6f3ba91d1f"><div class="ttname"><a href="_configuration_8c.html#af51d98af8c16c62303308f6f3ba91d1f">ConfigureEptHookReservePreallocatedPoolsForEptHooks</a></div><div class="ttdeci">VOID ConfigureEptHookReservePreallocatedPoolsForEptHooks(UINT32 Count)</div><div class="ttdoc">Allocate (reserve) pages for storing EPT hooks page hooks.</div><div class="ttdef"><b>Definition</b> Configuration.c:239</div></div>
<div class="ttc" id="a_constants_8h_html_a0fdd1b09ceafbfd45fdf080cbf912574"><div class="ttname"><a href="_constants_8h.html#a0fdd1b09ceafbfd45fdf080cbf912574">MAXIMUM_NUMBER_OF_INITIAL_PREALLOCATED_EPT_HOOKS</a></div><div class="ttdeci">#define MAXIMUM_NUMBER_OF_INITIAL_PREALLOCATED_EPT_HOOKS</div><div class="ttdoc">Maximum number of initial pre-allocated EPT hooks.</div><div class="ttdef"><b>Definition</b> Constants.h:260</div></div>
<div class="ttc" id="a_constants_8h_html_a1e4cfd3362664680ff4230700c100c6d"><div class="ttname"><a href="_constants_8h.html#a1e4cfd3362664680ff4230700c100c6d">BIG_INSTANT_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">#define BIG_INSTANT_EVENT_ACTION_BUFFER</div><div class="ttdoc">Pre-allocated size for a big action + custom code or script buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:300</div></div>
<div class="ttc" id="a_constants_8h_html_a88064ae4d52a6ef17dfc68bc2366a625"><div class="ttname"><a href="_constants_8h.html#a88064ae4d52a6ef17dfc68bc2366a625">REGULAR_INSTANT_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">#define REGULAR_INSTANT_EVENT_ACTION_BUFFER</div><div class="ttdoc">Pre-allocated size for a regular action + custom code or script buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:294</div></div>
<div class="ttc" id="a_constants_8h_html_a89326ca89ebdc7653dc8d7b70d7a098f"><div class="ttname"><a href="_constants_8h.html#a89326ca89ebdc7653dc8d7b70d7a098f">MAXIMUM_BIG_INSTANT_EVENTS</a></div><div class="ttdeci">#define MAXIMUM_BIG_INSTANT_EVENTS</div><div class="ttdoc">Maximum number of (big) instant events that are pre-allocated.</div><div class="ttdef"><b>Definition</b> Constants.h:276</div></div>
<div class="ttc" id="a_constants_8h_html_a898a403eba5557b0e2ed10bfa4e4338b"><div class="ttname"><a href="_constants_8h.html#a898a403eba5557b0e2ed10bfa4e4338b">MAXIMUM_REGULAR_INSTANT_EVENTS</a></div><div class="ttdeci">#define MAXIMUM_REGULAR_INSTANT_EVENTS</div><div class="ttdoc">Maximum number of (regular) instant events that are pre-allocated.</div><div class="ttdef"><b>Definition</b> Constants.h:270</div></div>
<div class="ttc" id="a_constants_8h_html_a9a43e7c3f88b34c27ef48ffee07707e0"><div class="ttname"><a href="_constants_8h.html#a9a43e7c3f88b34c27ef48ffee07707e0">REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</a></div><div class="ttdeci">#define REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</div><div class="ttdoc">Pre-allocated size for a regular event + conditions buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:282</div></div>
<div class="ttc" id="a_constants_8h_html_a9c2b21c71746a30f993c09fa8ae8c8f3"><div class="ttname"><a href="_constants_8h.html#a9c2b21c71746a30f993c09fa8ae8c8f3">BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</a></div><div class="ttdeci">#define BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</div><div class="ttdoc">Pre-allocated size for a big event + conditions buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:288</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047">INSTANT_BIG_EVENT_BUFFER</a></div><div class="ttdeci">@ INSTANT_BIG_EVENT_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:52</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112">INSTANT_BIG_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">@ INSTANT_BIG_EVENT_ACTION_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:54</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529">INSTANT_REGULAR_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">@ INSTANT_REGULAR_EVENT_ACTION_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:53</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c">INSTANT_REGULAR_EVENT_BUFFER</a></div><div class="ttdeci">@ INSTANT_REGULAR_EVENT_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:51</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_abf506c814a6f717a87b5d808b828ef56"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a></div><div class="ttdeci">#define LogWarning(format,...)</div><div class="ttdoc">Log in the case of warning.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:99</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a03e9f251a31e86dcac849bd9d681aa6d"><div class="ttname"><a href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a></div><div class="ttdeci">BOOLEAN PoolManagerCheckAndPerformAllocationAndDeallocation()</div><div class="ttdoc">This function performs allocations from VMX non-root based on g_RequestNewAllocation.</div><div class="ttdef"><b>Definition</b> PoolManager.c:302</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a3660fd340db1240d410e847fb1ffe3d8"><div class="ttname"><a href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a></div><div class="ttdeci">BOOLEAN PoolManagerRequestAllocation(SIZE_T Size, UINT32 Count, POOL_ALLOCATION_INTENTION Intention)</div><div class="ttdoc">Request to allocate new buffers.</div><div class="ttdef"><b>Definition</b> PoolManager.c:415</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6327269502f58fa975905189894eb48" name="aa6327269502f58fa975905189894eb48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6327269502f58fa975905189894eb48">&#9670;&#160;</a></span>KdInitializeKernelDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdInitializeKernelDebugger </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize kernel debugger </p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   23</span>{</div>
<div class="line"><span class="lineno">   24</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">// Allocate DPC routine</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   27</span>    <span class="comment">// for (size_t i = 0; i &lt; CoreCount; i++)</span></div>
<div class="line"><span class="lineno">   28</span>    <span class="comment">// {</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">//     g_DbgState[i].KdDpcObject = PlatformMemAllocateNonPagedPool(sizeof(KDPC));</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">//     if (g_DbgState[i].KdDpcObject == NULL)</span></div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">//     {</span></div>
<div class="line"><span class="lineno">   33</span>    <span class="comment">//         LogError(&quot;Err, allocating dpc holder for debuggee&quot;);</span></div>
<div class="line"><span class="lineno">   34</span>    <span class="comment">//         return;</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   36</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">// Request pages for breakpoint detail</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   41</span>    <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>),</div>
<div class="line"><span class="lineno">   42</span>                                 <a class="code hl_define" href="_constants_8h.html#a2b58d9ed6c9313bad1ec12d9b8506453">MAXIMUM_BREAKPOINTS_WITHOUT_CONTINUE</a>,</div>
<div class="line"><span class="lineno">   43</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a>);</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   46</span>    <span class="comment">// Enable vm-exit on Hardware debug exceptions and breakpoints</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// so, intercept #DBs and #BP by changing exception bitmap (one core)</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_function" href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a>();</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="comment">// Reset pause break requests</span></div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   54</span>    RtlZeroMemory(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a0c50a3971433f95430249d30dfc9856b">g_IgnoreBreaksToDebugger</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a>));</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   57</span>    <span class="comment">// Initialize list of breakpoints and breakpoint id</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a> = 0;</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_function" href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// Initial the needed pools for instant events</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_function" href="_kd_8c.html#ada6587839febc38997d213ccc23f5a21">KdInitializeInstantEventPools</a>();</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">// Indicate that the kernel debugger is active</span></div>
<div class="line"><span class="lineno">   69</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   71</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_a74d9c313b40b008235ca3ca0e40628d3"><div class="ttname"><a href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a></div><div class="ttdeci">VOID BroadcastEnableDbAndBpExitingAllCores()</div><div class="ttdoc">routines to set vm-exit on all #DBs and #BP on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:35</div></div>
<div class="ttc" id="a_constants_8h_html_a2b58d9ed6c9313bad1ec12d9b8506453"><div class="ttname"><a href="_constants_8h.html#a2b58d9ed6c9313bad1ec12d9b8506453">MAXIMUM_BREAKPOINTS_WITHOUT_CONTINUE</a></div><div class="ttdeci">#define MAXIMUM_BREAKPOINTS_WITHOUT_CONTINUE</div><div class="ttdoc">maximum number of buffers to be allocated for a single breakpoint</div><div class="ttdef"><b>Definition</b> Constants.h:398</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63ab8948b7a3ee40226d0f76b7fccf90b9a">BREAKPOINT_DEFINITION_STRUCTURE</a></div><div class="ttdeci">@ BREAKPOINT_DEFINITION_STRUCTURE</div><div class="ttdef"><b>Definition</b> DataTypes.h:45</div></div>
<div class="ttc" id="a_kd_8c_html_ada6587839febc38997d213ccc23f5a21"><div class="ttname"><a href="_kd_8c.html#ada6587839febc38997d213ccc23f5a21">KdInitializeInstantEventPools</a></div><div class="ttdeci">VOID KdInitializeInstantEventPools()</div><div class="ttdoc">Initialize the required pools for instant events.</div><div class="ttdef"><b>Definition</b> Kd.c:131</div></div>
<div class="ttc" id="a_windows_8h_html_ad211c1678754ed394322f51a9e909c4a"><div class="ttname"><a href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a></div><div class="ttdeci">FORCEINLINE VOID InitializeListHead(_Out_ PLIST_ENTRY ListHead)</div><div class="ttdef"><b>Definition</b> Windows.h:41</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a0c50a3971433f95430249d30dfc9856b"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a0c50a3971433f95430249d30dfc9856b">g_IgnoreBreaksToDebugger</a></div><div class="ttdeci">DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT g_IgnoreBreaksToDebugger</div><div class="ttdoc">Holds the requests to pause the break of debuggee until a special event happens.</div><div class="ttdef"><b>Definition</b> Global.h:55</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_abca944290c6a683f0821a9096472f7d4"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a></div><div class="ttdeci">LIST_ENTRY g_BreakpointsListHead</div><div class="ttdoc">List header of breakpoints for debugger-mode.</div><div class="ttdef"><b>Definition</b> Global.h:91</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_ad09616266c993d19a27d9f414073c0a7"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#ad09616266c993d19a27d9f414073c0a7">g_MaximumBreakpointId</a></div><div class="ttdeci">UINT64 g_MaximumBreakpointId</div><div class="ttdoc">Seed for setting id of breakpoints.</div><div class="ttdef"><b>Definition</b> Global.h:97</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">_DEBUGGEE_BP_DESCRIPTOR</a></div><div class="ttdoc">The structure of storing breakpoints.</div><div class="ttdef"><b>Definition</b> State.h:72</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">_DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a></div><div class="ttdoc">request to pause and halt the system</div><div class="ttdef"><b>Definition</b> Kd.h:61</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a814437795a9e923d352b848630625a56" name="a814437795a9e923d352b848630625a56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a814437795a9e923d352b848630625a56">&#9670;&#160;</a></span>KdIsGuestOnUsermode32Bit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdIsGuestOnUsermode32Bit </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determines if the guest was in 32-bit user-mode or 64-bit (long mode) </p>
<p>this function should be called from vmx-root</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 3108</span>{</div>
<div class="line"><span class="lineno"> 3109</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3110</span>    <span class="comment">// Only 16 bit is needed however, vmwrite might write on other bits</span></div>
<div class="line"><span class="lineno"> 3111</span>    <span class="comment">// and corrupt other variables, that&#39;s why we get 64bit</span></div>
<div class="line"><span class="lineno"> 3112</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3113</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> CsSel = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno"> 3114</span> </div>
<div class="line"><span class="lineno"> 3115</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3116</span>    <span class="comment">// Read guest&#39;s cs selector</span></div>
<div class="line"><span class="lineno"> 3117</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3118</span>    CsSel = <a class="code hl_function" href="_export_8c.html#a08e9402c406068d70419121099c455cf">VmFuncGetCsSelector</a>();</div>
<div class="line"><span class="lineno"> 3119</span> </div>
<div class="line"><span class="lineno"> 3120</span>    <span class="keywordflow">if</span> (CsSel == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a5bc1b920e0b1b8a1b35327b5f89ab6ac">KGDT64_R0_CODE</a>)</div>
<div class="line"><span class="lineno"> 3121</span>    {</div>
<div class="line"><span class="lineno"> 3122</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3123</span>        <span class="comment">// 64-bit kernel-mode</span></div>
<div class="line"><span class="lineno"> 3124</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3125</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3126</span>    }</div>
<div class="line"><span class="lineno"> 3127</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((CsSel &amp; ~3) == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a3566c0de563735de786e1052440226a1">KGDT64_R3_CODE</a>)</div>
<div class="line"><span class="lineno"> 3128</span>    {</div>
<div class="line"><span class="lineno"> 3129</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3130</span>        <span class="comment">// 64-bit user-mode</span></div>
<div class="line"><span class="lineno"> 3131</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3132</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3133</span>    }</div>
<div class="line"><span class="lineno"> 3134</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((CsSel &amp; ~3) == <a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8b6aab65ae2c0a4e02ac1069d4ac46ad">KGDT64_R3_CMCODE</a>)</div>
<div class="line"><span class="lineno"> 3135</span>    {</div>
<div class="line"><span class="lineno"> 3136</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3137</span>        <span class="comment">// 32-bit user-mode</span></div>
<div class="line"><span class="lineno"> 3138</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 3140</span>    }</div>
<div class="line"><span class="lineno"> 3141</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3142</span>    {</div>
<div class="line"><span class="lineno"> 3143</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unknown value for cs, cannot determine wow64 mode&quot;</span>);</div>
<div class="line"><span class="lineno"> 3144</span>    }</div>
<div class="line"><span class="lineno"> 3145</span> </div>
<div class="line"><span class="lineno"> 3146</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3147</span>    <span class="comment">// By default, 64-bit</span></div>
<div class="line"><span class="lineno"> 3148</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3149</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3150</span>}</div>
<div class="ttc" id="a_export_8c_html_a08e9402c406068d70419121099c455cf"><div class="ttname"><a href="_export_8c.html#a08e9402c406068d70419121099c455cf">VmFuncGetCsSelector</a></div><div class="ttdeci">UINT16 VmFuncGetCsSelector()</div><div class="ttdoc">Read CS selector.</div><div class="ttdef"><b>Definition</b> Export.c:341</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea3d8b33fc912094006bdec836ca4e70" name="aea3d8b33fc912094006bdec836ca4e70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3d8b33fc912094006bdec836ca4e70">&#9670;&#160;</a></span>KdLoggingResponsePacketToDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdLoggingResponsePacketToDebugger </td>
          <td>(</td>
          <td class="paramtype">_In_reads_bytes_(OptionalBufferLength) <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>OptionalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>OptionalBufferLength</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>OperationCode</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a81ec660b5db2e1b3a1677661c23b51d0" name="a81ec660b5db2e1b3a1677661c23b51d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81ec660b5db2e1b3a1677661c23b51d0">&#9670;&#160;</a></span>KdManageSystemHaltOnVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdManageSystemHaltOnVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>EventDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>manage system halt on vmx-root mode </p>
<p>This function should only be called from KdHandleBreakpointAndDebugBreakpoints </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
    <tr><td class="paramname">MainCore</td><td>the core that triggered the event</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 3164</span>{</div>
<div class="line"><span class="lineno"> 3165</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_KD_PAUSED_PACKET</a> PausePacket;</div>
<div class="line"><span class="lineno"> 3166</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                     ExitInstructionLength = 0;</div>
<div class="line"><span class="lineno"> 3167</span>    RFLAGS                    Rflags                = {0};</div>
<div class="line"><span class="lineno"> 3168</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    LastVmexitRip         = 0;</div>
<div class="line"><span class="lineno"> 3169</span> </div>
<div class="line"><span class="lineno"> 3170</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3171</span>    <span class="comment">// Perform Pre-halt tasks</span></div>
<div class="line"><span class="lineno"> 3172</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3173</span>    <a class="code hl_function" href="_kd_8c.html#a26ca81a35a0a6e96b7067f59e97d657f">KdApplyTasksPreHaltCore</a>(DbgState);</div>
<div class="line"><span class="lineno"> 3174</span> </div>
<div class="line"><span class="lineno"> 3175</span>StartAgain:</div>
<div class="line"><span class="lineno"> 3176</span> </div>
<div class="line"><span class="lineno"> 3177</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3178</span>    <span class="comment">// We check for receiving buffer (unhalting) only on the</span></div>
<div class="line"><span class="lineno"> 3179</span>    <span class="comment">// first core and not on every cores</span></div>
<div class="line"><span class="lineno"> 3180</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3181</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a4c041c2d74937318d15c2736dc95f661">MainDebuggingCore</a>)</div>
<div class="line"><span class="lineno"> 3182</span>    {</div>
<div class="line"><span class="lineno"> 3183</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3184</span>        <span class="comment">// *** Current Operating Core  ***</span></div>
<div class="line"><span class="lineno"> 3185</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3186</span>        RtlZeroMemory(&amp;PausePacket, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_KD_PAUSED_PACKET</a>));</div>
<div class="line"><span class="lineno"> 3187</span> </div>
<div class="line"><span class="lineno"> 3188</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3189</span>        <span class="comment">// Get the last RIP for vm-exit handler</span></div>
<div class="line"><span class="lineno"> 3190</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3191</span>        LastVmexitRip = <a class="code hl_function" href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a>();</div>
<div class="line"><span class="lineno"> 3192</span> </div>
<div class="line"><span class="lineno"> 3193</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3194</span>        <span class="comment">// Set the halt reason</span></div>
<div class="line"><span class="lineno"> 3195</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3196</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a44c1a04de19a49588f1dbaa6d2302294">PausingReason</a> = <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#acf21790b2fc221ed28789a132d509cb7">g_DebuggeeHaltReason</a>;</div>
<div class="line"><span class="lineno"> 3197</span> </div>
<div class="line"><span class="lineno"> 3198</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3199</span>        <span class="comment">// Set the current core</span></div>
<div class="line"><span class="lineno"> 3200</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3201</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a908147ed36f20636e8dfc9238c2dd451">CurrentCore</a> = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>;</div>
<div class="line"><span class="lineno"> 3202</span> </div>
<div class="line"><span class="lineno"> 3203</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3204</span>        <span class="comment">// Set the RIP and mode of execution</span></div>
<div class="line"><span class="lineno"> 3205</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3206</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a24ab04316c8cbfa77a9eb389181de510">Rip</a>                    = LastVmexitRip;</div>
<div class="line"><span class="lineno"> 3207</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3dd56af14cc103ca9c1d52d1d28708f4">IsProcessorOn32BitMode</a> = <a class="code hl_function" href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a>();</div>
<div class="line"><span class="lineno"> 3208</span> </div>
<div class="line"><span class="lineno"> 3209</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3210</span>        <span class="comment">// Set disassembly state</span></div>
<div class="line"><span class="lineno"> 3211</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3212</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aded4b1fae8826baefdfb11ebabc76c24">IgnoreDisassembling</a>    = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a2cde0a767eadada91cab15f3a0db5dbb">IgnoreDisasmInNextPacket</a>;</div>
<div class="line"><span class="lineno"> 3213</span>        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a2cde0a767eadada91cab15f3a0db5dbb">IgnoreDisasmInNextPacket</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3214</span> </div>
<div class="line"><span class="lineno"> 3215</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3216</span>        <span class="comment">// Set rflags for finding the results of conditional jumps</span></div>
<div class="line"><span class="lineno"> 3217</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3218</span>        Rflags.AsUInt      = <a class="code hl_function" href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno"> 3219</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a29e674840f7cab9cbe3267bf8bef572e">Rflags</a> = Rflags.AsUInt;</div>
<div class="line"><span class="lineno"> 3220</span> </div>
<div class="line"><span class="lineno"> 3221</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3222</span>        <span class="comment">// Set the event tag (if it&#39;s an event)</span></div>
<div class="line"><span class="lineno"> 3223</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3224</span>        <span class="keywordflow">if</span> (EventDetails != NULL)</div>
<div class="line"><span class="lineno"> 3225</span>        {</div>
<div class="line"><span class="lineno"> 3226</span>            PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a6bc867f46b9b8a81950d10a0307734fe">EventTag</a>          = EventDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a>;</div>
<div class="line"><span class="lineno"> 3227</span>            PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aed7d2ad1f84892012a795ec0f1fb77f6">EventCallingStage</a> = EventDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a6101dc9a0fb47c16e38046ca1eecaa31">Stage</a>;</div>
<div class="line"><span class="lineno"> 3228</span>        }</div>
<div class="line"><span class="lineno"> 3229</span> </div>
<div class="line"><span class="lineno"> 3230</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3231</span>        <span class="comment">// Read the instruction len hint</span></div>
<div class="line"><span class="lineno"> 3232</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3233</span>        <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> != 0)</div>
<div class="line"><span class="lineno"> 3234</span>        {</div>
<div class="line"><span class="lineno"> 3235</span>            ExitInstructionLength = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a>;</div>
<div class="line"><span class="lineno"> 3236</span>        }</div>
<div class="line"><span class="lineno"> 3237</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3238</span>        {</div>
<div class="line"><span class="lineno"> 3239</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3240</span>            <span class="comment">// Reading instruction length (VMCS_VMEXIT_INSTRUCTION_LENGTH) won&#39;t work for anything that is not instruction exiting,</span></div>
<div class="line"><span class="lineno"> 3241</span>            <span class="comment">// so we won&#39;t use it anymore</span></div>
<div class="line"><span class="lineno"> 3242</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3243</span> </div>
<div class="line"><span class="lineno"> 3244</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3245</span>            <span class="comment">// Set the length to notify debuggee</span></div>
<div class="line"><span class="lineno"> 3246</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3247</span>            ExitInstructionLength = <a class="code hl_function" href="_address_check_8c.html#ad7237183f690522bfbc5caee88370eae">CheckAddressMaximumInstructionLength</a>((PVOID)LastVmexitRip);</div>
<div class="line"><span class="lineno"> 3248</span>        }</div>
<div class="line"><span class="lineno"> 3249</span> </div>
<div class="line"><span class="lineno"> 3250</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3251</span>        <span class="comment">// Set the reading length of bytes (for instruction disassembling)</span></div>
<div class="line"><span class="lineno"> 3252</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3253</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0f796658e06e2e73b3fea4390192b79d">ReadInstructionLen</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)ExitInstructionLength;</div>
<div class="line"><span class="lineno"> 3254</span> </div>
<div class="line"><span class="lineno"> 3255</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3256</span>        <span class="comment">// Find the current instruction</span></div>
<div class="line"><span class="lineno"> 3257</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3258</span>        <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(LastVmexitRip,</div>
<div class="line"><span class="lineno"> 3259</span>                                                  &amp;PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2e7f707431030c6f8f509b68015efb1b">InstructionBytesOnRip</a>,</div>
<div class="line"><span class="lineno"> 3260</span>                                                  ExitInstructionLength);</div>
<div class="line"><span class="lineno"> 3261</span> </div>
<div class="line"><span class="lineno"> 3262</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3263</span>        <span class="comment">// Send the pause packet, along with RIP and an indication</span></div>
<div class="line"><span class="lineno"> 3264</span>        <span class="comment">// to pause to the debugger</span></div>
<div class="line"><span class="lineno"> 3265</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3266</span>        <a class="code hl_function" href="_kd_8c.html#af5ce9948d5b3e6e5bb0246a42fb9e33f">KdResponsePacketToDebugger</a>(<a class="code hl_enumvalue" href="_connection_8h.html#a3b63482b33f70cef2d569a3628e842d8a2745713725bcc259626fc019fca4c1d8">DEBUGGER_REMOTE_PACKET_TYPE_DEBUGGEE_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno"> 3267</span>                                   <a class="code hl_enumvalue" href="_connection_8h.html#ac0e6db4051893271cfa53c365980c7c7a964486510276b655bcf43e66f28e3f7f">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_PAUSED_AND_CURRENT_INSTRUCTION</a>,</div>
<div class="line"><span class="lineno"> 3268</span>                                   (<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *)&amp;PausePacket,</div>
<div class="line"><span class="lineno"> 3269</span>                                   <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_KD_PAUSED_PACKET</a>));</div>
<div class="line"><span class="lineno"> 3270</span> </div>
<div class="line"><span class="lineno"> 3271</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3272</span>        <span class="comment">// Perform Commands from the debugger</span></div>
<div class="line"><span class="lineno"> 3273</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3274</span>        <a class="code hl_function" href="_kd_8c.html#a8a8ff209696d894e938f4ad71dbef9d3">KdDispatchAndPerformCommandsFromDebugger</a>(DbgState);</div>
<div class="line"><span class="lineno"> 3275</span> </div>
<div class="line"><span class="lineno"> 3276</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3277</span>        <span class="comment">// Check if it&#39;s a change core event or not, otherwise finish the execution</span></div>
<div class="line"><span class="lineno"> 3278</span>        <span class="comment">// and continue debuggee</span></div>
<div class="line"><span class="lineno"> 3279</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3280</span>        <span class="keywordflow">if</span> (!DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a4c041c2d74937318d15c2736dc95f661">MainDebuggingCore</a>)</div>
<div class="line"><span class="lineno"> 3281</span>        {</div>
<div class="line"><span class="lineno"> 3282</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3283</span>            <span class="comment">// It&#39;s a core switch, start again</span></div>
<div class="line"><span class="lineno"> 3284</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3285</span>            <span class="keywordflow">goto</span> StartAgain;</div>
<div class="line"><span class="lineno"> 3286</span>        }</div>
<div class="line"><span class="lineno"> 3287</span>    }</div>
<div class="line"><span class="lineno"> 3288</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3289</span>    {</div>
<div class="line"><span class="lineno"> 3290</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3291</span>        <span class="comment">// All cores except operating core</span></div>
<div class="line"><span class="lineno"> 3292</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3293</span> </div>
<div class="line"><span class="lineno"> 3294</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3295</span>        <span class="comment">// Lock and unlock the lock so all core can get the lock</span></div>
<div class="line"><span class="lineno"> 3296</span>        <span class="comment">// and continue their normal execution</span></div>
<div class="line"><span class="lineno"> 3297</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3298</span>        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a0d22e0340ffa5de9190c09683fdfccf2">NmiState</a>.<a class="code hl_variable" href="struct___k_d___n_m_i___s_t_a_t_e.html#a6359e6a5d2e428c7dfc299e69592b9ef">WaitingToBeLocked</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3299</span> </div>
<div class="line"><span class="lineno"> 3300</span>        <a class="code hl_define" href="_spinlock_8h.html#ab7d1adaa816383a963ebae38e41f2f63">ScopedSpinlock</a>(</div>
<div class="line"><span class="lineno"> 3301</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5cb1b3e0fee150e30f93529efdcb324b">Lock</a>,</div>
<div class="line"><span class="lineno"> 3302</span> </div>
<div class="line"><span class="lineno"> 3303</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3304</span>            <span class="comment">// Check if it&#39;s a change core event or not</span></div>
<div class="line"><span class="lineno"> 3305</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3306</span>            <a class="code hl_function" href="script__conditional__statement__global__var_8txt.html#afe23eb67d2103a166a3d92da5f9fc787">if</a> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a4c041c2d74937318d15c2736dc95f661">MainDebuggingCore</a>) {</div>
<div class="line"><span class="lineno"> 3307</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3308</span>                <span class="comment">// It&#39;s a core change event</span></div>
<div class="line"><span class="lineno"> 3309</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3310</span>                g_DebuggeeHaltReason = DEBUGGEE_PAUSING_REASON_DEBUGGEE_CORE_SWITCHED;</div>
<div class="line"><span class="lineno"> 3311</span> </div>
<div class="line"><span class="lineno"> 3312</span>                goto StartAgain;</div>
<div class="line"><span class="lineno"> 3313</span>            }</div>
<div class="line"><span class="lineno"> 3314</span> </div>
<div class="line"><span class="lineno"> 3315</span>        );</div>
<div class="line"><span class="lineno"> 3316</span> </div>
<div class="line"><span class="lineno"> 3317</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3318</span>        <span class="comment">// Check if any task needs to be executed on this core or not</span></div>
<div class="line"><span class="lineno"> 3319</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3320</span>        <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8a198fb109fc974a7a8bbab43b6be438">PerformHaltedTask</a>)</div>
<div class="line"><span class="lineno"> 3321</span>        {</div>
<div class="line"><span class="lineno"> 3322</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3323</span>            <span class="comment">// Indicate that the halted core is no longer needed to execute a task</span></div>
<div class="line"><span class="lineno"> 3324</span>            <span class="comment">// as the current task is executed once</span></div>
<div class="line"><span class="lineno"> 3325</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3326</span>            DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8a198fb109fc974a7a8bbab43b6be438">PerformHaltedTask</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 3327</span> </div>
<div class="line"><span class="lineno"> 3328</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3329</span>            <span class="comment">// Perform the target task</span></div>
<div class="line"><span class="lineno"> 3330</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3331</span>            <a class="code hl_function" href="_halted_core_8c.html#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a>(DbgState,</div>
<div class="line"><span class="lineno"> 3332</span>                                        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8e9ff1678a75061627e6f562a3442497">TargetTask</a>,</div>
<div class="line"><span class="lineno"> 3333</span>                                        DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a6cdb6316111383cf8f9f6087398fe470">Context</a>);</div>
<div class="line"><span class="lineno"> 3334</span> </div>
<div class="line"><span class="lineno"> 3335</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3336</span>            <span class="comment">// Check if the core needs to be locked again</span></div>
<div class="line"><span class="lineno"> 3337</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3338</span>            <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a0e4361d30047e9ec9443c4b490602f6d">LockAgainAfterTask</a>)</div>
<div class="line"><span class="lineno"> 3339</span>            {</div>
<div class="line"><span class="lineno"> 3340</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3341</span>                <span class="comment">// Lock again</span></div>
<div class="line"><span class="lineno"> 3342</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3343</span>                <a class="code hl_function" href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a>(&amp;DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5cb1b3e0fee150e30f93529efdcb324b">Lock</a>);</div>
<div class="line"><span class="lineno"> 3344</span> </div>
<div class="line"><span class="lineno"> 3345</span>                <span class="keywordflow">goto</span> StartAgain;</div>
<div class="line"><span class="lineno"> 3346</span>            }</div>
<div class="line"><span class="lineno"> 3347</span>        }</div>
<div class="line"><span class="lineno"> 3348</span>    }</div>
<div class="line"><span class="lineno"> 3349</span> </div>
<div class="line"><span class="lineno"> 3350</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3351</span>    <span class="comment">// Apply the basic task for the core before continue</span></div>
<div class="line"><span class="lineno"> 3352</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3353</span>    <a class="code hl_function" href="_kd_8c.html#aefe9d84bf256f6624b2c9c2376479514">KdApplyTasksPostContinueCore</a>(DbgState);</div>
<div class="line"><span class="lineno"> 3354</span>}</div>
<div class="ttc" id="a_address_check_8c_html_ad7237183f690522bfbc5caee88370eae"><div class="ttname"><a href="_address_check_8c.html#ad7237183f690522bfbc5caee88370eae">CheckAddressMaximumInstructionLength</a></div><div class="ttdeci">UINT32 CheckAddressMaximumInstructionLength(PVOID Address)</div><div class="ttdoc">This function returns the maximum instruction length that can be read from this address.</div><div class="ttdef"><b>Definition</b> AddressCheck.c:306</div></div>
<div class="ttc" id="a_basic_types_8h_html_a09f1a1fb2293e33483cc8d44aefb1eb1"><div class="ttname"><a href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></div><div class="ttdeci">unsigned short UINT16</div><div class="ttdef"><b>Definition</b> BasicTypes.h:47</div></div>
<div class="ttc" id="a_basic_types_8h_html_aebb9e13210d88d43e32e735ada43a425"><div class="ttname"><a href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a></div><div class="ttdeci">char CHAR</div><div class="ttdef"><b>Definition</b> BasicTypes.h:31</div></div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_connection_8h_html_a3b63482b33f70cef2d569a3628e842d8a2745713725bcc259626fc019fca4c1d8"><div class="ttname"><a href="_connection_8h.html#a3b63482b33f70cef2d569a3628e842d8a2745713725bcc259626fc019fca4c1d8">DEBUGGER_REMOTE_PACKET_TYPE_DEBUGGEE_TO_DEBUGGER</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_PACKET_TYPE_DEBUGGEE_TO_DEBUGGER</div><div class="ttdef"><b>Definition</b> Connection.h:164</div></div>
<div class="ttc" id="a_connection_8h_html_ac0e6db4051893271cfa53c365980c7c7a964486510276b655bcf43e66f28e3f7f"><div class="ttname"><a href="_connection_8h.html#ac0e6db4051893271cfa53c365980c7c7a964486510276b655bcf43e66f28e3f7f">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_PAUSED_AND_CURRENT_INSTRUCTION</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_PAUSED_AND_CURRENT_INSTRUCTION</div><div class="ttdef"><b>Definition</b> Connection.h:106</div></div>
<div class="ttc" id="a_export_8c_html_a65a0cf94fa34ebb1f4150ed97fa7abc0"><div class="ttname"><a href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a></div><div class="ttdeci">UINT64 VmFuncGetRflags()</div><div class="ttdoc">Read guest's RFLAGS.</div><div class="ttdef"><b>Definition</b> Export.c:352</div></div>
<div class="ttc" id="a_export_8c_html_adcc46211db99d7ad7e48e04fda4cf416"><div class="ttname"><a href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a></div><div class="ttdeci">UINT64 VmFuncGetRip()</div><div class="ttdoc">Read guest's RIP.</div><div class="ttdef"><b>Definition</b> Export.c:375</div></div>
<div class="ttc" id="a_halted_core_8c_html_aea1b886f9a8ea60c897b656b66e22b5e"><div class="ttname"><a href="_halted_core_8c.html#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a></div><div class="ttdeci">VOID HaltedCorePerformTargetTask(PROCESSOR_DEBUGGING_STATE *DbgState, UINT64 TargetTask, PVOID Context)</div><div class="ttdoc">Perform the task on halted core.</div><div class="ttdef"><b>Definition</b> HaltedCore.c:45</div></div>
<div class="ttc" id="a_kd_8c_html_a26ca81a35a0a6e96b7067f59e97d657f"><div class="ttname"><a href="_kd_8c.html#a26ca81a35a0a6e96b7067f59e97d657f">KdApplyTasksPreHaltCore</a></div><div class="ttdeci">VOID KdApplyTasksPreHaltCore(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">before halting any core, all the tasks will be applied to all cores including the main core</div><div class="ttdef"><b>Definition</b> Kd.c:517</div></div>
<div class="ttc" id="a_kd_8c_html_a814437795a9e923d352b848630625a56"><div class="ttname"><a href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a></div><div class="ttdeci">BOOLEAN KdIsGuestOnUsermode32Bit()</div><div class="ttdoc">determines if the guest was in 32-bit user-mode or 64-bit (long mode)</div><div class="ttdef"><b>Definition</b> Kd.c:3107</div></div>
<div class="ttc" id="a_kd_8c_html_a8a8ff209696d894e938f4ad71dbef9d3"><div class="ttname"><a href="_kd_8c.html#a8a8ff209696d894e938f4ad71dbef9d3">KdDispatchAndPerformCommandsFromDebugger</a></div><div class="ttdeci">VOID KdDispatchAndPerformCommandsFromDebugger(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">This function applies commands from the debugger to the debuggee.</div><div class="ttdef"><b>Definition</b> Kd.c:2292</div></div>
<div class="ttc" id="a_kd_8c_html_aefe9d84bf256f6624b2c9c2376479514"><div class="ttname"><a href="_kd_8c.html#aefe9d84bf256f6624b2c9c2376479514">KdApplyTasksPostContinueCore</a></div><div class="ttdeci">VOID KdApplyTasksPostContinueCore(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">before continue any core, all the tasks will be applied to all cores including the main core</div><div class="ttdef"><b>Definition</b> Kd.c:556</div></div>
<div class="ttc" id="a_kd_8c_html_af5ce9948d5b3e6e5bb0246a42fb9e33f"><div class="ttname"><a href="_kd_8c.html#af5ce9948d5b3e6e5bb0246a42fb9e33f">KdResponsePacketToDebugger</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN KdResponsePacketToDebugger(DEBUGGER_REMOTE_PACKET_TYPE PacketType, DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION Response, CHAR *OptionalBuffer, UINT32 OptionalBufferLength)</div><div class="ttdoc">Sends a HyperDbg response packet to the debugger.</div><div class="ttdef"><b>Definition</b> Kd.c:294</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4b9c8387e09821a8668975ec6119782e"><div class="ttname"><a href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1120</div></div>
<div class="ttc" id="a_spinlock_8c_html_a08984f739349991eab67c45376a990bc"><div class="ttname"><a href="_spinlock_8c.html#a08984f739349991eab67c45376a990bc">SpinlockLock</a></div><div class="ttdeci">void SpinlockLock(volatile LONG *Lock)</div><div class="ttdoc">Tries to get the lock and won't return until successfully get the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:52</div></div>
<div class="ttc" id="a_spinlock_8h_html_ab7d1adaa816383a963ebae38e41f2f63"><div class="ttname"><a href="_spinlock_8h.html#ab7d1adaa816383a963ebae38e41f2f63">ScopedSpinlock</a></div><div class="ttdeci">#define ScopedSpinlock(LockObject, CodeToRun)</div><div class="ttdef"><b>Definition</b> Spinlock.h:39</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_acf21790b2fc221ed28789a132d509cb7"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#acf21790b2fc221ed28789a132d509cb7">g_DebuggeeHaltReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON g_DebuggeeHaltReason</div><div class="ttdoc">Reason that the debuggee is halted.</div><div class="ttdef"><b>Definition</b> Global.h:127</div></div>
<div class="ttc" id="ascript__conditional__statement__global__var_8txt_html_afe23eb67d2103a166a3d92da5f9fc787"><div class="ttname"><a href="script__conditional__statement__global__var_8txt.html#afe23eb67d2103a166a3d92da5f9fc787">if</a></div><div class="ttdeci">if(.test_var==4)</div><div class="ttdef"><b>Definition</b> script_conditional_statement_global_var.txt:5</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a0e4361d30047e9ec9443c4b490602f6d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a0e4361d30047e9ec9443c4b490602f6d">_DEBUGGEE_HALTED_CORE_TASK::LockAgainAfterTask</a></div><div class="ttdeci">BOOLEAN LockAgainAfterTask</div><div class="ttdef"><b>Definition</b> State.h:139</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a6cdb6316111383cf8f9f6087398fe470"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a6cdb6316111383cf8f9f6087398fe470">_DEBUGGEE_HALTED_CORE_TASK::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition</b> State.h:141</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a8a198fb109fc974a7a8bbab43b6be438"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8a198fb109fc974a7a8bbab43b6be438">_DEBUGGEE_HALTED_CORE_TASK::PerformHaltedTask</a></div><div class="ttdeci">BOOLEAN PerformHaltedTask</div><div class="ttdef"><b>Definition</b> State.h:138</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a8e9ff1678a75061627e6f562a3442497"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8e9ff1678a75061627e6f562a3442497">_DEBUGGEE_HALTED_CORE_TASK::TargetTask</a></div><div class="ttdeci">UINT64 TargetTask</div><div class="ttdef"><b>Definition</b> State.h:140</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html">_DEBUGGEE_KD_PAUSED_PACKET</a></div><div class="ttdoc">The structure of pausing packet in kHyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:207</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a0f796658e06e2e73b3fea4390192b79d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0f796658e06e2e73b3fea4390192b79d">_DEBUGGEE_KD_PAUSED_PACKET::ReadInstructionLen</a></div><div class="ttdeci">UINT16 ReadInstructionLen</div><div class="ttdef"><b>Definition</b> DataTypes.h:217</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a24ab04316c8cbfa77a9eb389181de510"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a24ab04316c8cbfa77a9eb389181de510">_DEBUGGEE_KD_PAUSED_PACKET::Rip</a></div><div class="ttdeci">UINT64 Rip</div><div class="ttdef"><b>Definition</b> DataTypes.h:208</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a29e674840f7cab9cbe3267bf8bef572e"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a29e674840f7cab9cbe3267bf8bef572e">_DEBUGGEE_KD_PAUSED_PACKET::Rflags</a></div><div class="ttdeci">UINT64 Rflags</div><div class="ttdef"><b>Definition</b> DataTypes.h:215</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a2e7f707431030c6f8f509b68015efb1b"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2e7f707431030c6f8f509b68015efb1b">_DEBUGGEE_KD_PAUSED_PACKET::InstructionBytesOnRip</a></div><div class="ttdeci">BYTE InstructionBytesOnRip[MAXIMUM_INSTR_SIZE]</div><div class="ttdef"><b>Definition</b> DataTypes.h:216</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a3dd56af14cc103ca9c1d52d1d28708f4"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3dd56af14cc103ca9c1d52d1d28708f4">_DEBUGGEE_KD_PAUSED_PACKET::IsProcessorOn32BitMode</a></div><div class="ttdeci">BOOLEAN IsProcessorOn32BitMode</div><div class="ttdef"><b>Definition</b> DataTypes.h:209</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a44c1a04de19a49588f1dbaa6d2302294"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a44c1a04de19a49588f1dbaa6d2302294">_DEBUGGEE_KD_PAUSED_PACKET::PausingReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON PausingReason</div><div class="ttdef"><b>Definition</b> DataTypes.h:211</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a6bc867f46b9b8a81950d10a0307734fe"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a6bc867f46b9b8a81950d10a0307734fe">_DEBUGGEE_KD_PAUSED_PACKET::EventTag</a></div><div class="ttdeci">UINT64 EventTag</div><div class="ttdef"><b>Definition</b> DataTypes.h:213</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a908147ed36f20636e8dfc9238c2dd451"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a908147ed36f20636e8dfc9238c2dd451">_DEBUGGEE_KD_PAUSED_PACKET::CurrentCore</a></div><div class="ttdeci">ULONG CurrentCore</div><div class="ttdef"><b>Definition</b> DataTypes.h:212</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aded4b1fae8826baefdfb11ebabc76c24"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aded4b1fae8826baefdfb11ebabc76c24">_DEBUGGEE_KD_PAUSED_PACKET::IgnoreDisassembling</a></div><div class="ttdeci">BOOLEAN IgnoreDisassembling</div><div class="ttdef"><b>Definition</b> DataTypes.h:210</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aed7d2ad1f84892012a795ec0f1fb77f6"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___k_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aed7d2ad1f84892012a795ec0f1fb77f6">_DEBUGGEE_KD_PAUSED_PACKET::EventCallingStage</a></div><div class="ttdeci">VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE EventCallingStage</div><div class="ttdef"><b>Definition</b> DataTypes.h:214</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition</b> DataTypes.h:193</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a6101dc9a0fb47c16e38046ca1eecaa31"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a6101dc9a0fb47c16e38046ca1eecaa31">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Stage</a></div><div class="ttdeci">VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE Stage</div><div class="ttdef"><b>Definition</b> DataTypes.h:195</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a2cde0a767eadada91cab15f3a0db5dbb"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a2cde0a767eadada91cab15f3a0db5dbb">_PROCESSOR_DEBUGGING_STATE::IgnoreDisasmInNextPacket</a></div><div class="ttdeci">BOOLEAN IgnoreDisasmInNextPacket</div><div class="ttdef"><b>Definition</b> State.h:171</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a4c041c2d74937318d15c2736dc95f661"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a4c041c2d74937318d15c2736dc95f661">_PROCESSOR_DEBUGGING_STATE::MainDebuggingCore</a></div><div class="ttdeci">volatile BOOLEAN MainDebuggingCore</div><div class="ttdef"><b>Definition</b> State.h:167</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition</b> State.h:182</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_adcf7b3f5a76564010eace3a94979c699"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">_PROCESSOR_DEBUGGING_STATE::HaltedCoreTask</a></div><div class="ttdeci">DEBUGGEE_HALTED_CORE_TASK HaltedCoreTask</div><div class="ttdef"><b>Definition</b> State.h:180</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acc12878954fd8a1118d83f2cfe08052f" name="acc12878954fd8a1118d83f2cfe08052f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc12878954fd8a1118d83f2cfe08052f">&#9670;&#160;</a></span>KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad6e74aca70f1102548c8fbe12b407384">DEBUGGER_THREAD_PROCESS_TRACING</a></td>          <td class="paramname"><span class="paramname"><em>TracingType</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Query for process/thread interception status. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
    <tr><td class="paramname">TracingType</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN whether it's activated or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  221</span>{</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                     Result   = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[CoreId];</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">switch</span> (TracingType)</div>
<div class="line"><span class="lineno">  226</span>    {</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba6fcabe7730de54788ae979fd117e10da">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_THREAD_CHANGE</a>:</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>        Result = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#abed37561390beafa280eb6b67b357c41">InterceptClockInterruptsForThreadChange</a>;</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba86c07de6df8f91fb9bdcacafef9cf97e">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_PROCESS_CHANGE</a>:</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>        Result = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a20a517035c8a845e5d3fd60012b1acf5">InterceptClockInterruptsForProcessChange</a>;</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a>:</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>        Result = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">DebugRegisterInterceptionState</a>;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bbaa42dc9a9650eab4092275352044c1091">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_WAITING_FOR_MOV_CR3_VM_EXITS</a>:</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>        Result = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">ThreadOrProcessTracingDetails</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a8d5059c7d9400a075fa5dcb1499ea40f">IsWatingForMovCr3VmExits</a>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, debugger encountered an unknown query type for querying process or thread interception details&quot;</span>);</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  256</span>    }</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno">  259</span>}</div>
<div class="ttc" id="a_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bba6fcabe7730de54788ae979fd117e10da"><div class="ttname"><a href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba6fcabe7730de54788ae979fd117e10da">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_THREAD_CHANGE</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_THREAD_CHANGE</div><div class="ttdef"><b>Definition</b> DataTypes.h:106</div></div>
<div class="ttc" id="a_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bba86c07de6df8f91fb9bdcacafef9cf97e"><div class="ttname"><a href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba86c07de6df8f91fb9bdcacafef9cf97e">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_PROCESS_CHANGE</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_INTERRUPTS_FOR_PROCESS_CHANGE</div><div class="ttdef"><b>Definition</b> DataTypes.h:107</div></div>
<div class="ttc" id="a_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd"><div class="ttname"><a href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</div><div class="ttdef"><b>Definition</b> DataTypes.h:108</div></div>
<div class="ttc" id="a_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bbaa42dc9a9650eab4092275352044c1091"><div class="ttname"><a href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bbaa42dc9a9650eab4092275352044c1091">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_WAITING_FOR_MOV_CR3_VM_EXITS</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_WAITING_FOR_MOV_CR3_VM_EXITS</div><div class="ttdef"><b>Definition</b> DataTypes.h:109</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_a20a517035c8a845e5d3fd60012b1acf5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a20a517035c8a845e5d3fd60012b1acf5">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::InterceptClockInterruptsForProcessChange</a></div><div class="ttdeci">BOOLEAN InterceptClockInterruptsForProcessChange</div><div class="ttdef"><b>Definition</b> State.h:63</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_a828cb9812e870d901c9397930c02a451"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a828cb9812e870d901c9397930c02a451">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::DebugRegisterInterceptionState</a></div><div class="ttdeci">BOOLEAN DebugRegisterInterceptionState</div><div class="ttdef"><b>Definition</b> State.h:56</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_a8d5059c7d9400a075fa5dcb1499ea40f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#a8d5059c7d9400a075fa5dcb1499ea40f">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::IsWatingForMovCr3VmExits</a></div><div class="ttdeci">BOOLEAN IsWatingForMovCr3VmExits</div><div class="ttdef"><b>Definition</b> State.h:62</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s_html_abed37561390beafa280eb6b67b357c41"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___p_r_o_c_e_s_s___o_r___t_h_r_e_a_d___t_r_a_c_i_n_g___d_e_t_a_i_l_s.html#abed37561390beafa280eb6b67b357c41">_DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS::InterceptClockInterruptsForThreadChange</a></div><div class="ttdeci">BOOLEAN InterceptClockInterruptsForThreadChange</div><div class="ttdef"><b>Definition</b> State.h:57</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a8f17ce3238c1b7fcd0e8a53040cba548"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a8f17ce3238c1b7fcd0e8a53040cba548">_PROCESSOR_DEBUGGING_STATE::ThreadOrProcessTracingDetails</a></div><div class="ttdeci">DEBUGGEE_PROCESS_OR_THREAD_TRACING_DETAILS ThreadOrProcessTracingDetails</div><div class="ttdef"><b>Definition</b> State.h:178</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae67a719083cf8982cdf9c0283c8779bd" name="ae67a719083cf8982cdf9c0283c8779bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae67a719083cf8982cdf9c0283c8779bd">&#9670;&#160;</a></span>KdResponsePacketToDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KdResponsePacketToDebugger </td>
          <td>(</td>
          <td class="paramtype">_In_ _Strict_type_match_ <a class="el" href="_connection_8h.html#a4924566aaf12e93c1e2a037d12bc32fe">DEBUGGER_REMOTE_PACKET_TYPE</a></td>          <td class="paramname"><span class="paramname"><em>PacketType</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ _Strict_type_match_ <a class="el" href="_connection_8h.html#a4c14c05a1e67ce2b3fcf780d0e622424">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION</a></td>          <td class="paramname"><span class="paramname"><em>Response</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_reads_bytes_opt_(OptionalBufferLength) <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>OptionalBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>OptionalBufferLength</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a38ba4b9350674375c024a9f2b63c7907" name="a38ba4b9350674375c024a9f2b63c7907"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38ba4b9350674375c024a9f2b63c7907">&#9670;&#160;</a></span>KdSendCommandFinishedSignal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdSendCommandFinishedSignal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notify debugger that the execution of command finished. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  925</span>{</div>
<div class="line"><span class="lineno">  926</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  927</span>    <span class="comment">// Halt other cores again</span></div>
<div class="line"><span class="lineno">  928</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  929</span>    <a class="code hl_function" href="_kd_8c.html#a3dd81f890bc081d3920c2f8ed8dcaf58">KdHandleBreakpointAndDebugBreakpointsCallback</a>(CoreId,</div>
<div class="line"><span class="lineno">  930</span>                                                  <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21bad6ffb5d5b6e53c2a257cb389e131ff4b">DEBUGGEE_PAUSING_REASON_DEBUGGEE_COMMAND_EXECUTION_FINISHED</a>,</div>
<div class="line"><span class="lineno">  931</span>                                                  NULL);</div>
<div class="line"><span class="lineno">  932</span>}</div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21bad6ffb5d5b6e53c2a257cb389e131ff4b"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21bad6ffb5d5b6e53c2a257cb389e131ff4b">DEBUGGEE_PAUSING_REASON_DEBUGGEE_COMMAND_EXECUTION_FINISHED</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_COMMAND_EXECUTION_FINISHED</div><div class="ttdef"><b>Definition</b> Connection.h:34</div></div>
<div class="ttc" id="a_kd_8c_html_a3dd81f890bc081d3920c2f8ed8dcaf58"><div class="ttname"><a href="_kd_8c.html#a3dd81f890bc081d3920c2f8ed8dcaf58">KdHandleBreakpointAndDebugBreakpointsCallback</a></div><div class="ttdeci">_Use_decl_annotations_ VOID KdHandleBreakpointAndDebugBreakpointsCallback(UINT32 CoreId, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle #DBs and #BPs for kernel debugger.</div><div class="ttdef"><b>Definition</b> Kd.c:1124</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0af968467072898abb6bbd25495a06eb" name="a0af968467072898abb6bbd25495a06eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af968467072898abb6bbd25495a06eb">&#9670;&#160;</a></span>KdSendFormatsFunctionResult()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdSendFormatsFunctionResult </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Value</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notify user-mode to unload the debuggee and close the connections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Value</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  901</span>{</div>
<div class="line"><span class="lineno">  902</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html">DEBUGGEE_FORMATS_PACKET</a> FormatsPacket = {0};</div>
<div class="line"><span class="lineno">  903</span> </div>
<div class="line"><span class="lineno">  904</span>    FormatsPacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html#aa78cacc685a1832051a48d2591ff4d32">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  905</span>    FormatsPacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html#ab2aca2b76d083f1882f41597bd8dae87">Value</a>  = <a class="code hl_function" href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a>;</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  908</span>    <span class="comment">// Kernel debugger is active, we should send the bytes over serial</span></div>
<div class="line"><span class="lineno">  909</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  910</span>    <a class="code hl_function" href="_kd_8c.html#af5ce9948d5b3e6e5bb0246a42fb9e33f">KdResponsePacketToDebugger</a>(</div>
<div class="line"><span class="lineno">  911</span>        <a class="code hl_enumvalue" href="_connection_8h.html#a3b63482b33f70cef2d569a3628e842d8a2745713725bcc259626fc019fca4c1d8">DEBUGGER_REMOTE_PACKET_TYPE_DEBUGGEE_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno">  912</span>        <a class="code hl_enumvalue" href="_connection_8h.html#ac0e6db4051893271cfa53c365980c7c7afe4d1a15fd8ee7a9679e08c80c4eecfb">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_RESULT_OF_FORMATS</a>,</div>
<div class="line"><span class="lineno">  913</span>        (<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *)&amp;FormatsPacket,</div>
<div class="line"><span class="lineno">  914</span>        <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html">DEBUGGEE_FORMATS_PACKET</a>));</div>
<div class="line"><span class="lineno">  915</span>}</div>
<div class="ttc" id="a_connection_8h_html_ac0e6db4051893271cfa53c365980c7c7afe4d1a15fd8ee7a9679e08c80c4eecfb"><div class="ttname"><a href="_connection_8h.html#ac0e6db4051893271cfa53c365980c7c7afe4d1a15fd8ee7a9679e08c80c4eecfb">DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_RESULT_OF_FORMATS</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_PACKET_REQUESTED_ACTION_DEBUGGEE_RESULT_OF_FORMATS</div><div class="ttdef"><b>Definition</b> Connection.h:111</div></div>
<div class="ttc" id="ainstance__info_8hex_8txt_html_a1068e3543230ebb8ef661f6f6cce7f8f"><div class="ttname"><a href="instance__info_8hex_8txt.html#a1068e3543230ebb8ef661f6f6cce7f8f">Value</a></div><div class="ttdeci">RequestedActionOfThePacket Value(0x1) 00000000</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html">_DEBUGGEE_FORMATS_PACKET</a></div><div class="ttdoc">The structure of .formats result packet in HyperDbg.</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1033</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t_html_aa78cacc685a1832051a48d2591ff4d32"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html#aa78cacc685a1832051a48d2591ff4d32">_DEBUGGEE_FORMATS_PACKET::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1035</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t_html_ab2aca2b76d083f1882f41597bd8dae87"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___f_o_r_m_a_t_s___p_a_c_k_e_t.html#ab2aca2b76d083f1882f41597bd8dae87">_DEBUGGEE_FORMATS_PACKET::Value</a></div><div class="ttdeci">UINT64 Value</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1034</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a93b5f11529ccadc52cc47bccb072ed27" name="a93b5f11529ccadc52cc47bccb072ed27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93b5f11529ccadc52cc47bccb072ed27">&#9670;&#160;</a></span>KdUninitializeKernelDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdUninitializeKernelDebugger </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>uninitialize kernel debugger </p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   82</span>{</div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> ProcessorsCount;</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a>)</div>
<div class="line"><span class="lineno">   86</span>    {</div>
<div class="line"><span class="lineno">   87</span>        ProcessorsCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   90</span>        <span class="comment">// Indicate that the kernel debugger is not active</span></div>
<div class="line"><span class="lineno">   91</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae4b5afa957e3e26377135b91b60eda4e">g_KernelDebuggerState</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   95</span>        <span class="comment">// Reset pause break requests</span></div>
<div class="line"><span class="lineno">   96</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   97</span>        RtlZeroMemory(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a0c50a3971433f95430249d30dfc9856b">g_IgnoreBreaksToDebugger</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___r_e_q_u_e_s_t___t_o___i_g_n_o_r_e___b_r_e_a_k_s___u_n_t_i_l___a_n___e_v_e_n_t.html">DEBUGGEE_REQUEST_TO_IGNORE_BREAKS_UNTIL_AN_EVENT</a>));</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">// Remove all active breakpoints</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  102</span>        <a class="code hl_function" href="_breakpoint_commands_8c.html#af5a28890d7cdeb6e697ba8c41d2bbbe7">BreakpointRemoveAllBreakpoints</a>();</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  105</span>        <span class="comment">// Disable vm-exit on Hardware debug exceptions and breakpoints</span></div>
<div class="line"><span class="lineno">  106</span>        <span class="comment">// so, not intercept #DBs and #BP by changing exception bitmap (one core)</span></div>
<div class="line"><span class="lineno">  107</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  108</span>        <a class="code hl_function" href="_broadcast_8c.html#ab1152780541f8b9d3685259e3c294b01">BroadcastDisableDbAndBpExitingAllCores</a>();</div>
<div class="line"><span class="lineno">  109</span>    }</div>
<div class="line"><span class="lineno">  110</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_af5a28890d7cdeb6e697ba8c41d2bbbe7"><div class="ttname"><a href="_breakpoint_commands_8c.html#af5a28890d7cdeb6e697ba8c41d2bbbe7">BreakpointRemoveAllBreakpoints</a></div><div class="ttdeci">VOID BreakpointRemoveAllBreakpoints()</div><div class="ttdoc">Remove all the breakpoints if possible.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:803</div></div>
<div class="ttc" id="a_broadcast_8c_html_ab1152780541f8b9d3685259e3c294b01"><div class="ttname"><a href="_broadcast_8c.html#ab1152780541f8b9d3685259e3c294b01">BroadcastDisableDbAndBpExitingAllCores</a></div><div class="ttdeci">VOID BroadcastDisableDbAndBpExitingAllCores()</div><div class="ttdoc">routines to unset vm-exit on all #DBs and #BP on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:49</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad53861a47c60820feee3d0bc2351285a" name="ad53861a47c60820feee3d0bc2351285a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad53861a47c60820feee3d0bc2351285a">&#9670;&#160;</a></span>KdUnlockTheHaltedCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> KdUnlockTheHaltedCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>unlock the target core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the target core</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1813</span>{</div>
<div class="line"><span class="lineno"> 1814</span>    <a class="code hl_function" href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a>(&amp;DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5cb1b3e0fee150e30f93529efdcb324b">Lock</a>);</div>
<div class="line"><span class="lineno"> 1815</span>}</div>
<div class="ttc" id="a_spinlock_8c_html_a529db917026601c47af458af0154bfa1"><div class="ttname"><a href="_spinlock_8c.html#a529db917026601c47af458af0154bfa1">SpinlockUnlock</a></div><div class="ttdeci">void SpinlockUnlock(volatile LONG *Lock)</div><div class="ttdoc">Release the lock.</div><div class="ttdef"><b>Definition</b> Spinlock.c:158</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa8f0690057ff0d1c6f2f42dbbdb3ee96" name="aa8f0690057ff0d1c6f2f42dbbdb3ee96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8f0690057ff0d1c6f2f42dbbdb3ee96">&#9670;&#160;</a></span>DebuggerHandleBreakpointLock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile LONG DebuggerHandleBreakpointLock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vmx-root lock for handling breaks to debugger. </p>

</div>
</div>
<a id="ac9e9a8a58602b96c760514fbe7a268d4" name="ac9e9a8a58602b96c760514fbe7a268d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e9a8a58602b96c760514fbe7a268d4">&#9670;&#160;</a></span>DebuggerResponseLock</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile LONG DebuggerResponseLock</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Vmx-root lock for sending response of debugger. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_fd401680aa8c7ceffc479e97f6bdc4df.html">hyperkd</a></li><li class="navelem"><a class="el" href="dir_b9a42e394d8efcca63fc5d2d60127445.html">header</a></li><li class="navelem"><a class="el" href="dir_b7f82d642e4d0c525e6cfe8908059b17.html">debugger</a></li><li class="navelem"><a class="el" href="dir_7b2a6d589e5dc54e60f4009daf337889.html">kernel-level</a></li><li class="navelem"><a class="el" href="hyperkd_2header_2debugger_2kernel-level_2_kd_8h.html">Kd.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
