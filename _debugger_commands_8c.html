<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperkd/code/debugger/commands/DebuggerCommands.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_debugger_commands_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">DebuggerCommands.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of Debugger Commands.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8bb200983c48761d01ca416f16ef580" id="r_ab8bb200983c48761d01ca416f16ef580"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab8bb200983c48761d01ca416f16ef580">DebuggerCommandReadMemory</a> (<a class="el" href="_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a> ReadMemRequest, PVOID UserBuffer, PSIZE_T ReturnSize)</td></tr>
<tr class="memdesc:ab8bb200983c48761d01ca416f16ef580"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read memory for different commands.  <br /></td></tr>
<tr class="separator:ab8bb200983c48761d01ca416f16ef580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8868ea6e7d1a50960d949cce8d54778e" id="r_a8868ea6e7d1a50960d949cce8d54778e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8868ea6e7d1a50960d949cce8d54778e">DebuggerCommandReadMemoryVmxRoot</a> (<a class="el" href="_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a> ReadMemRequest, <a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *UserBuffer, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *ReturnSize)</td></tr>
<tr class="memdesc:a8868ea6e7d1a50960d949cce8d54778e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read memory for different commands from vmxroot mode.  <br /></td></tr>
<tr class="separator:a8868ea6e7d1a50960d949cce8d54778e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cacf53abe149ebe3e2c43ad68d43e22" id="r_a6cacf53abe149ebe3e2c43ad68d43e22"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cacf53abe149ebe3e2c43ad68d43e22">DebuggerReadOrWriteMsr</a> (<a class="el" href="_request_structures_8h.html#a4d767d7cb2f35f41f4644da283ed779b">PDEBUGGER_READ_AND_WRITE_ON_MSR</a> ReadOrWriteMsrRequest, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *UserBuffer, PSIZE_T ReturnSize)</td></tr>
<tr class="memdesc:a6cacf53abe149ebe3e2c43ad68d43e22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform rdmsr, wrmsr commands.  <br /></td></tr>
<tr class="separator:a6cacf53abe149ebe3e2c43ad68d43e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af777c50999a33ad8c4555984d41c5ae5" id="r_af777c50999a33ad8c4555984d41c5ae5"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af777c50999a33ad8c4555984d41c5ae5">DebuggerCommandEditMemory</a> (<a class="el" href="_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a> EditMemRequest)</td></tr>
<tr class="memdesc:af777c50999a33ad8c4555984d41c5ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Edit physical and virtual memory.  <br /></td></tr>
<tr class="separator:af777c50999a33ad8c4555984d41c5ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0af7ab7231ae69429262b4061e93ccfe" id="r_a0af7ab7231ae69429262b4061e93ccfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0af7ab7231ae69429262b4061e93ccfe">DebuggerCommandEditMemoryVmxRoot</a> (<a class="el" href="_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a> EditMemRequest)</td></tr>
<tr class="memdesc:a0af7ab7231ae69429262b4061e93ccfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Edit physical and virtual memory on vmxroot mode.  <br /></td></tr>
<tr class="separator:a0af7ab7231ae69429262b4061e93ccfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552399e58dff411c2c11f789f687f6d1" id="r_a552399e58dff411c2c11f789f687f6d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *AddressToSaveResults, <a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a> SearchMemRequest, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> StartAddress, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EndAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDebuggeePaused, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CountOfMatchedCases)</td></tr>
<tr class="memdesc:a552399e58dff411c2c11f789f687f6d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Search on virtual memory (not work on physical memory)  <br /></td></tr>
<tr class="separator:a552399e58dff411c2c11f789f687f6d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2b3b7d14e79251d6e4b20dff257500a" id="r_aa2b3b7d14e79251d6e4b20dff257500a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a> (<a class="el" href="_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> AddressToSaveResults, <a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a> SearchMemRequest, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> StartAddress, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> EndAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDebuggeePaused, <a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a> CountOfMatchedCases)</td></tr>
<tr class="memdesc:aa2b3b7d14e79251d6e4b20dff257500a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The wrapper to check for validity of addresses and call the search routines for both physical and virtual memory.  <br /></td></tr>
<tr class="separator:aa2b3b7d14e79251d6e4b20dff257500a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90d49ed0d4f0c40139d885b24e4c5b81" id="r_a90d49ed0d4f0c40139d885b24e4c5b81"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90d49ed0d4f0c40139d885b24e4c5b81">DebuggerCommandSearchMemory</a> (<a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a> SearchMemRequest)</td></tr>
<tr class="memdesc:a90d49ed0d4f0c40139d885b24e4c5b81"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start searching memory.  <br /></td></tr>
<tr class="separator:a90d49ed0d4f0c40139d885b24e4c5b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaad6ca3d40207e5acacf96ae173aefe" id="r_aeaad6ca3d40207e5acacf96ae173aefe"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaad6ca3d40207e5acacf96ae173aefe">DebuggerCommandFlush</a> (<a class="el" href="_request_structures_8h.html#ae01f58601a1fe6b667786f7323256da7">PDEBUGGER_FLUSH_LOGGING_BUFFERS</a> DebuggerFlushBuffersRequest)</td></tr>
<tr class="memdesc:aeaad6ca3d40207e5acacf96ae173aefe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the flush requests to vmx-root and vmx non-root buffers.  <br /></td></tr>
<tr class="separator:aeaad6ca3d40207e5acacf96ae173aefe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa8aa71f33a1a7c56f77864afb4641e" id="r_a7aa8aa71f33a1a7c56f77864afb4641e"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7aa8aa71f33a1a7c56f77864afb4641e">DebuggerCommandSignalExecutionState</a> (<a class="el" href="_request_structures_8h.html#a79b3c4ae30c99d53a4287aec1398db44">PDEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL</a> DebuggerFinishedExecutionRequest)</td></tr>
<tr class="memdesc:a7aa8aa71f33a1a7c56f77864afb4641e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the command finished signal.  <br /></td></tr>
<tr class="separator:a7aa8aa71f33a1a7c56f77864afb4641e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea94a64fc961c2aa25be87907844586" id="r_adea94a64fc961c2aa25be87907844586"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adea94a64fc961c2aa25be87907844586">DebuggerCommandSendMessage</a> (<a class="el" href="_request_structures_8h.html#a220681277ea06cfae1cec6d8cd06d3f9">PDEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a> DebuggerSendUsermodeMessageRequest)</td></tr>
<tr class="memdesc:adea94a64fc961c2aa25be87907844586"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the user-mode buffer to debugger.  <br /></td></tr>
<tr class="separator:adea94a64fc961c2aa25be87907844586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae149f6dd099f7dc3f64584a3b27f7d56" id="r_ae149f6dd099f7dc3f64584a3b27f7d56"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae149f6dd099f7dc3f64584a3b27f7d56">DebuggerCommandSendGeneralBufferToDebugger</a> (<a class="el" href="_request_structures_8h.html#ad97915c6241a0c1642aa62839e661aa1">PDEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER</a> DebuggeeBufferRequest)</td></tr>
<tr class="memdesc:ae149f6dd099f7dc3f64584a3b27f7d56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send general buffers from the debuggee to the debugger.  <br /></td></tr>
<tr class="separator:ae149f6dd099f7dc3f64584a3b27f7d56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62dfa3017c983808ae647ec03252a0fe" id="r_a62dfa3017c983808ae647ec03252a0fe"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62dfa3017c983808ae647ec03252a0fe">DebuggerCommandReservePreallocatedPools</a> (<a class="el" href="_request_structures_8h.html#a5dcf26594841b272af7f485934e92d24">PDEBUGGER_PREALLOC_COMMAND</a> PreallocRequest)</td></tr>
<tr class="memdesc:a62dfa3017c983808ae647ec03252a0fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve and allocate pre-allocated buffers.  <br /></td></tr>
<tr class="separator:a62dfa3017c983808ae647ec03252a0fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9d82c0c8c8cd250ca75483234db42a" id="r_a5c9d82c0c8c8cd250ca75483234db42a"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c9d82c0c8c8cd250ca75483234db42a">DebuggerCommandPreactivateFunctionality</a> (<a class="el" href="_request_structures_8h.html#a455865c115fa9c6344f2411fab30af64">PDEBUGGER_PREACTIVATE_COMMAND</a> PreactivateRequest)</td></tr>
<tr class="memdesc:a5c9d82c0c8c8cd250ca75483234db42a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Preactivate a special functionality.  <br /></td></tr>
<tr class="separator:a5c9d82c0c8c8cd250ca75483234db42a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f45afd6fe059d8dfdb0d7cc7ea130a6" id="r_a3f45afd6fe059d8dfdb0d7cc7ea130a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f45afd6fe059d8dfdb0d7cc7ea130a6">DebuggerCommandBringPagein</a> (<a class="el" href="_request_structures_8h.html#a707aafa57bc966e81bb134a1b6e64dc9">PDEBUGGER_PAGE_IN_REQUEST</a> PageinRequest)</td></tr>
<tr class="memdesc:a3f45afd6fe059d8dfdb0d7cc7ea130a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for the .pagein command  <br /></td></tr>
<tr class="separator:a3f45afd6fe059d8dfdb0d7cc7ea130a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of Debugger Commands. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>) </dd>
<dd>
Alee Amini (<a href="#" onclick="location.href='mai'+'lto:'+'ale'+'e@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">alee@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-04-23</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3f45afd6fe059d8dfdb0d7cc7ea130a6" name="a3f45afd6fe059d8dfdb0d7cc7ea130a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f45afd6fe059d8dfdb0d7cc7ea130a6">&#9670;&#160;</a></span>DebuggerCommandBringPagein()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandBringPagein </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a707aafa57bc966e81bb134a1b6e64dc9">PDEBUGGER_PAGE_IN_REQUEST</a></td>          <td class="paramname"><span class="paramname"><em>PageinRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for the .pagein command </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PageinRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1476</span>{</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1478</span>    <span class="comment">// *** Perform the injection here ***</span></div>
<div class="line"><span class="lineno"> 1479</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1480</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Page-request is received!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1483</span>    <span class="comment">// Adjust the flags for showing the successful #PF injection</span></div>
<div class="line"><span class="lineno"> 1484</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1485</span>    PageinRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_a_g_e___i_n___r_e_q_u_e_s_t.html#a465225e7bb24258556a90e47eb829b2f">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1488</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_error_codes_8h_html_aed656c58434eecb2d7e8c10e93aecff4"><div class="ttname"><a href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a></div><div class="ttdeci">#define DEBUGGER_OPERATION_WAS_SUCCESSFUL</div><div class="ttdoc">General value to indicate that the operation or request was successful.</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:23</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a97b0adbd65790fb90734daa8e5245a04"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a></div><div class="ttdeci">#define LogInfo(format,...)</div><div class="ttdoc">Define log variables.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:71</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_a_g_e___i_n___r_e_q_u_e_s_t_html_a465225e7bb24258556a90e47eb829b2f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_a_g_e___i_n___r_e_q_u_e_s_t.html#a465225e7bb24258556a90e47eb829b2f">_DEBUGGER_PAGE_IN_REQUEST::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:78</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af777c50999a33ad8c4555984d41c5ae5" name="af777c50999a33ad8c4555984d41c5ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af777c50999a33ad8c4555984d41c5ae5">&#9670;&#160;</a></span>DebuggerCommandEditMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandEditMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>EditMemRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Edit physical and virtual memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EditMemRequest</td><td>edit memory request </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  442</span>{</div>
<div class="line"><span class="lineno">  443</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> LengthOfEachChunk  = 0;</div>
<div class="line"><span class="lineno">  444</span>    PVOID  DestinationAddress = 0;</div>
<div class="line"><span class="lineno">  445</span>    PVOID  SourceAddress      = 0;</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  448</span>    <span class="comment">// set chunk size in each modification</span></div>
<div class="line"><span class="lineno">  449</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a>)</div>
<div class="line"><span class="lineno">  451</span>    {</div>
<div class="line"><span class="lineno">  452</span>        LengthOfEachChunk = 1;</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a>)</div>
<div class="line"><span class="lineno">  455</span>    {</div>
<div class="line"><span class="lineno">  456</span>        LengthOfEachChunk = 4;</div>
<div class="line"><span class="lineno">  457</span>    }</div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a>)</div>
<div class="line"><span class="lineno">  459</span>    {</div>
<div class="line"><span class="lineno">  460</span>        LengthOfEachChunk = 8;</div>
<div class="line"><span class="lineno">  461</span>    }</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  463</span>    {</div>
<div class="line"><span class="lineno">  464</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  465</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  466</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  467</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  469</span>    }</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">// Check if address is valid or not valid (virtual address)</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  475</span>    {</div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a> == <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()) &amp;&amp; <a class="code hl_function" href="_conversion_8c.html#ab7aedff95075e77cd8fbe128f01d2853">VirtualAddressToPhysicalAddress</a>((PVOID)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>) == 0)</div>
<div class="line"><span class="lineno">  477</span>        {</div>
<div class="line"><span class="lineno">  478</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  479</span>            <span class="comment">// It&#39;s an invalid address in current process</span></div>
<div class="line"><span class="lineno">  480</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a>;</div>
<div class="line"><span class="lineno">  482</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  483</span>        }</div>
<div class="line"><span class="lineno">  484</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="_conversion_8c.html#a507e3ba3c1076ac38e61c34f53ef5c38">VirtualAddressToPhysicalAddressByProcessId</a>((PVOID)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>, EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a>) == 0)</div>
<div class="line"><span class="lineno">  485</span>        {</div>
<div class="line"><span class="lineno">  486</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  487</span>            <span class="comment">// It&#39;s an invalid address in another process</span></div>
<div class="line"><span class="lineno">  488</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  489</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#a3dfaaa0714009886429c605e3cc82e9d">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</a>;</div>
<div class="line"><span class="lineno">  490</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  491</span>        }</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  494</span>        <span class="comment">// Edit the memory</span></div>
<div class="line"><span class="lineno">  495</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  497</span>        {</div>
<div class="line"><span class="lineno">  498</span>            DestinationAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk));</div>
<div class="line"><span class="lineno">  499</span>            SourceAddress      = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)));</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  502</span>            <span class="comment">// Instead of directly accessing the memory we use the MemoryMapperWriteMemorySafe</span></div>
<div class="line"><span class="lineno">  503</span>            <span class="comment">// It is because the target page might be read-only so we can make it writable</span></div>
<div class="line"><span class="lineno">  504</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  505</span>            <span class="comment">// RtlCopyBytes(DestinationAddress, SourceAddress, LengthOfEachChunk);</span></div>
<div class="line"><span class="lineno">  506</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a0bec3757baf1681542143a033cbea694">MemoryMapperWriteMemoryUnsafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DestinationAddress, SourceAddress, LengthOfEachChunk, EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">ProcessId</a>);</div>
<div class="line"><span class="lineno">  507</span>        }</div>
<div class="line"><span class="lineno">  508</span>    }</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  510</span>    {</div>
<div class="line"><span class="lineno">  511</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  512</span>        <span class="comment">// Check whether the physical addres</span></div>
<div class="line"><span class="lineno">  513</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#a66f7b8caa0489328006cca9cbcd6aa3d">CheckAddressPhysical</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>))</div>
<div class="line"><span class="lineno">  515</span>        {</div>
<div class="line"><span class="lineno">  516</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  517</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  518</span>        }</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  521</span>        <span class="comment">// Edit the physical memory</span></div>
<div class="line"><span class="lineno">  522</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  524</span>        {</div>
<div class="line"><span class="lineno">  525</span>            DestinationAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk));</div>
<div class="line"><span class="lineno">  526</span>            SourceAddress      = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)));</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DestinationAddress, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  529</span>        }</div>
<div class="line"><span class="lineno">  530</span>    }</div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  532</span>    {</div>
<div class="line"><span class="lineno">  533</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  534</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  535</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  536</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  537</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  538</span>    }</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">// Set the resutls</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  543</span>    EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  546</span>}</div>
<div class="ttc" id="a_address_check_8c_html_a66f7b8caa0489328006cca9cbcd6aa3d"><div class="ttname"><a href="_address_check_8c.html#a66f7b8caa0489328006cca9cbcd6aa3d">CheckAddressPhysical</a></div><div class="ttdeci">BOOLEAN CheckAddressPhysical(UINT64 PAddr)</div><div class="ttdoc">Checks if the physical address is correct or not based on physical address width.</div><div class="ttdef"><b>Definition</b> AddressCheck.c:120</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_conversion_8c_html_a507e3ba3c1076ac38e61c34f53ef5c38"><div class="ttname"><a href="_conversion_8c.html#a507e3ba3c1076ac38e61c34f53ef5c38">VirtualAddressToPhysicalAddressByProcessId</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 VirtualAddressToPhysicalAddressByProcessId(PVOID VirtualAddress, UINT32 ProcessId)</div><div class="ttdoc">Converts Virtual Address to Physical Address based on a specific process id's kernel cr3.</div><div class="ttdef"><b>Definition</b> Conversion.c:171</div></div>
<div class="ttc" id="a_conversion_8c_html_ab7aedff95075e77cd8fbe128f01d2853"><div class="ttname"><a href="_conversion_8c.html#ab7aedff95075e77cd8fbe128f01d2853">VirtualAddressToPhysicalAddress</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 VirtualAddressToPhysicalAddress(_In_ PVOID VirtualAddress)</div><div class="ttdoc">Converts Virtual Address to Physical Address.</div><div class="ttdef"><b>Definition</b> Conversion.c:154</div></div>
<div class="ttc" id="a_error_codes_8h_html_a3dfaaa0714009886429c605e3cc82e9d"><div class="ttname"><a href="_error_codes_8h.html#a3dfaaa0714009886429c605e3cc82e9d">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_OTHER_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on anotehr process's cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:114</div></div>
<div class="ttc" id="a_error_codes_8h_html_a68e4d375f85d62fc6169b228d0cb346a"><div class="ttname"><a href="_error_codes_8h.html#a68e4d375f85d62fc6169b228d0cb346a">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_ADDRESS_BASED_ON_CURRENT_PROCESS</div><div class="ttdoc">error, an invalid address is specified based on current cr3 in !e* or e* commands</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:106</div></div>
<div class="ttc" id="a_error_codes_8h_html_ac1b8dbae6748b88abe05844e42c29952"><div class="ttname"><a href="_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_INVALID_ADDRESS</div><div class="ttdoc">error, invalid address specified for debugger</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:63</div></div>
<div class="ttc" id="a_error_codes_8h_html_aeb2f51deac220ae86f8129a9abe6705f"><div class="ttname"><a href="_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a></div><div class="ttdeci">#define DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</div><div class="ttdoc">error, invalid parameters in !e* e* commands</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:99</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a0bec3757baf1681542143a033cbea694"><div class="ttname"><a href="_memory_mapper_8c.html#a0bec3757baf1681542143a033cbea694">MemoryMapperWriteMemoryUnsafe</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperWriteMemoryUnsafe(UINT64 Destination, PVOID Source, SIZE_T SizeToWrite, UINT32 TargetProcessId)</div><div class="ttdoc">Write memory safely by mapping the buffer (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1411</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a1ddcc27debd88fc732fe9b046a6b0038"><div class="ttname"><a href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperWriteMemorySafeByPhysicalAddress(UINT64 DestinationPa, UINT64 Source, SIZE_T SizeToWrite)</div><div class="ttdoc">Write memory safely by mapping the buffer.</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1432</div></div>
<div class="ttc" id="a_meta_macros_8h_html_ad790279846c85a5a453f2e7a4e02abad"><div class="ttname"><a href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a></div><div class="ttdeci">#define HANDLE_TO_UINT32(_var)</div><div class="ttdef"><b>Definition</b> MetaMacros.h:39</div></div>
<div class="ttc" id="a_request_structures_8h_html_a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de"><div class="ttname"><a href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a></div><div class="ttdeci">@ EDIT_PHYSICAL_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:463</div></div>
<div class="ttc" id="a_request_structures_8h_html_a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9"><div class="ttname"><a href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ EDIT_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:462</div></div>
<div class="ttc" id="a_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae"><div class="ttname"><a href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a></div><div class="ttdeci">@ EDIT_QWORD</div><div class="ttdef"><b>Definition</b> RequestStructures.h:474</div></div>
<div class="ttc" id="a_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139"><div class="ttname"><a href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a></div><div class="ttdeci">@ EDIT_DWORD</div><div class="ttdef"><b>Definition</b> RequestStructures.h:473</div></div>
<div class="ttc" id="a_request_structures_8h_html_a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e"><div class="ttname"><a href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a></div><div class="ttdeci">@ EDIT_BYTE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:472</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b40425317ba4b65485b3092c972187d"><div class="ttname"><a href="_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a></div><div class="ttdeci">#define SIZEOF_DEBUGGER_EDIT_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:454</div></div>
<div class="ttc" id="a_windows_8h_html_a9102789550b4971083e4fb315b30a984"><div class="ttname"><a href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a></div><div class="ttdeci">#define STATUS_UNSUCCESSFUL</div><div class="ttdef"><b>Definition</b> Windows.h:172</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a2781f698e302a08136de0e19fb6766af"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">_DEBUGGER_EDIT_MEMORY::Result</a></div><div class="ttdeci">UINT32 Result</div><div class="ttdef"><b>Definition</b> RequestStructures.h:483</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a474f6f7143bd243ef8b0d1d9fd55932e"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">_DEBUGGER_EDIT_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> RequestStructures.h:484</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a60cc85e8d33b351947da0ad1273abcb9"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">_DEBUGGER_EDIT_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_EDIT_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:486</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a7b8bede895701ebb3be2a5bb150c0a8f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">_DEBUGGER_EDIT_MEMORY::CountOf64Chunks</a></div><div class="ttdeci">UINT32 CountOf64Chunks</div><div class="ttdef"><b>Definition</b> RequestStructures.h:488</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_a91db707d5f4b15fa4de9006982cdbf50"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a91db707d5f4b15fa4de9006982cdbf50">_DEBUGGER_EDIT_MEMORY::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:485</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y_html_adc961c153906e8babc1e6460f9f733ef"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">_DEBUGGER_EDIT_MEMORY::ByteSize</a></div><div class="ttdeci">DEBUGGER_EDIT_MEMORY_BYTE_SIZE ByteSize</div><div class="ttdef"><b>Definition</b> RequestStructures.h:487</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0af7ab7231ae69429262b4061e93ccfe" name="a0af7ab7231ae69429262b4061e93ccfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0af7ab7231ae69429262b4061e93ccfe">&#9670;&#160;</a></span>DebuggerCommandEditMemoryVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandEditMemoryVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#aa1c158df9e1481468f1dfe46ba0bac86">PDEBUGGER_EDIT_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>EditMemRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Edit physical and virtual memory on vmxroot mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EditMemRequest</td><td>edit memory request </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  556</span>{</div>
<div class="line"><span class="lineno">  557</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> LengthOfEachChunk  = 0;</div>
<div class="line"><span class="lineno">  558</span>    PVOID  DestinationAddress = 0;</div>
<div class="line"><span class="lineno">  559</span>    PVOID  SourceAddress      = 0;</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  562</span>    <span class="comment">// THIS FUNCTION IS SAFE TO BE CALLED FROM VMX-ROOT</span></div>
<div class="line"><span class="lineno">  563</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  566</span>    <span class="comment">// set chunk size in each modification</span></div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0ab4407406c5406a1b8314ceb0dd88c32e">EDIT_BYTE</a>)</div>
<div class="line"><span class="lineno">  569</span>    {</div>
<div class="line"><span class="lineno">  570</span>        LengthOfEachChunk = 1;</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a9093b36693bfb1534f1baf9cfcbe5139">EDIT_DWORD</a>)</div>
<div class="line"><span class="lineno">  573</span>    {</div>
<div class="line"><span class="lineno">  574</span>        LengthOfEachChunk = 4;</div>
<div class="line"><span class="lineno">  575</span>    }</div>
<div class="line"><span class="lineno">  576</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a7b0872a1b7b5ad3d7dc89daa430f4cd0a155392ba36a9e4b809d61a58ff0664ae">EDIT_QWORD</a>)</div>
<div class="line"><span class="lineno">  577</span>    {</div>
<div class="line"><span class="lineno">  578</span>        LengthOfEachChunk = 8;</div>
<div class="line"><span class="lineno">  579</span>    }</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  581</span>    {</div>
<div class="line"><span class="lineno">  582</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  583</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  584</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  585</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  586</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  587</span>    }</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5af40a8625548287bf1f0c9a6c72c8a0b9">EDIT_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  590</span>    {</div>
<div class="line"><span class="lineno">  591</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  592</span>        <span class="comment">// Check whether the virtual memory is available in the current</span></div>
<div class="line"><span class="lineno">  593</span>        <span class="comment">// memory layout and also is present in the RAM</span></div>
<div class="line"><span class="lineno">  594</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>,</div>
<div class="line"><span class="lineno">  596</span>                                          EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#adc961c153906e8babc1e6460f9f733ef">ByteSize</a> * EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>))</div>
<div class="line"><span class="lineno">  597</span>        {</div>
<div class="line"><span class="lineno">  598</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  599</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  600</span>        }</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="comment">// Edit the memory</span></div>
<div class="line"><span class="lineno">  604</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  605</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  606</span>        {</div>
<div class="line"><span class="lineno">  607</span>            DestinationAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk));</div>
<div class="line"><span class="lineno">  608</span>            SourceAddress      = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)));</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  611</span>            <span class="comment">// Instead of directly accessing the memory we use the MemoryMapperWriteMemorySafeOnTargetProcess</span></div>
<div class="line"><span class="lineno">  612</span>            <span class="comment">// It is because the target page might be read-only so we can make it writable</span></div>
<div class="line"><span class="lineno">  613</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>            <span class="comment">// RtlCopyBytes(DestinationAddress, SourceAddress, LengthOfEachChunk);</span></div>
<div class="line"><span class="lineno">  616</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DestinationAddress, SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  617</span>        }</div>
<div class="line"><span class="lineno">  618</span>    }</div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a60cc85e8d33b351947da0ad1273abcb9">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a15d4e6c3df2a35e0e0a6ee9b461b5dc5a37551226140bb71a3c3767d0f333a4de">EDIT_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  620</span>    {</div>
<div class="line"><span class="lineno">  621</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  622</span>        <span class="comment">// Check whether the physical addres</span></div>
<div class="line"><span class="lineno">  623</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  624</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#a66f7b8caa0489328006cca9cbcd6aa3d">CheckAddressPhysical</a>(EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a>))</div>
<div class="line"><span class="lineno">  625</span>        {</div>
<div class="line"><span class="lineno">  626</span>            EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  627</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  628</span>        }</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  631</span>        <span class="comment">// Edit the physical memory</span></div>
<div class="line"><span class="lineno">  632</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  633</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a7b8bede895701ebb3be2a5bb150c0a8f">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  634</span>        {</div>
<div class="line"><span class="lineno">  635</span>            DestinationAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a474f6f7143bd243ef8b0d1d9fd55932e">Address</a> + (i * LengthOfEachChunk));</div>
<div class="line"><span class="lineno">  636</span>            SourceAddress      = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EditMemRequest + <a class="code hl_define" href="_request_structures_8h.html#a8b40425317ba4b65485b3092c972187d">SIZEOF_DEBUGGER_EDIT_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)));</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>            <a class="code hl_function" href="_memory_mapper_8c.html#a1ddcc27debd88fc732fe9b046a6b0038">MemoryMapperWriteMemorySafeByPhysicalAddress</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DestinationAddress, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)SourceAddress, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  639</span>        }</div>
<div class="line"><span class="lineno">  640</span>    }</div>
<div class="line"><span class="lineno">  641</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  642</span>    {</div>
<div class="line"><span class="lineno">  643</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  644</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  645</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  646</span>        EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aeb2f51deac220ae86f8129a9abe6705f">DEBUGGER_ERROR_EDIT_MEMORY_STATUS_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">// Set the resutls</span></div>
<div class="line"><span class="lineno">  652</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  653</span>    EditMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___e_d_i_t___m_e_m_o_r_y.html#a2781f698e302a08136de0e19fb6766af">Result</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  655</span>}</div>
<div class="ttc" id="a_address_check_8c_html_aec71cec56c29db61a23b2997ee8e2059"><div class="ttname"><a href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a></div><div class="ttdeci">BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition</b> AddressCheck.c:156</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a7c9eb4ee4fb121c661b36f36908f3a50"><div class="ttname"><a href="_memory_mapper_8c.html#a7c9eb4ee4fb121c661b36f36908f3a50">MemoryMapperWriteMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperWriteMemorySafeOnTargetProcess(UINT64 Destination, PVOID Source, SIZE_T Size)</div><div class="ttdoc">Write memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1165</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aeaad6ca3d40207e5acacf96ae173aefe" name="aeaad6ca3d40207e5acacf96ae173aefe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaad6ca3d40207e5acacf96ae173aefe">&#9670;&#160;</a></span>DebuggerCommandFlush()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandFlush </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#ae01f58601a1fe6b667786f7323256da7">PDEBUGGER_FLUSH_LOGGING_BUFFERS</a></td>          <td class="paramname"><span class="paramname"><em>DebuggerFlushBuffersRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the flush requests to vmx-root and vmx non-root buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerFlushBuffersRequest</td><td>Request to flush the buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1236</span>{</div>
<div class="line"><span class="lineno"> 1237</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1238</span>    <span class="comment">// We try to flush buffers for both vmx-root and regular kernel buffer</span></div>
<div class="line"><span class="lineno"> 1239</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1240</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a09e09b7c4094d0118e60286632bd832b">CountOfMessagesThatSetAsReadFromVmxRoot</a>    = <a class="code hl_function" href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno"> 1241</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a4bbc1ed12ba1d1c451f6fda086ea4af2">CountOfMessagesThatSetAsReadFromVmxNonRoot</a> = <a class="code hl_function" href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno"> 1242</span>    DebuggerFlushBuffersRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a58d48d4a871935399b264dfd8c70331c">KernelStatus</a>                               = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1245</span>}</div>
<div class="ttc" id="a_logging_8c_html_a480d59927ef95ff8c6aa39a77e88ccc2"><div class="ttname"><a href="_logging_8c.html#a480d59927ef95ff8c6aa39a77e88ccc2">LogMarkAllAsRead</a></div><div class="ttdeci">UINT32 LogMarkAllAsRead(BOOLEAN IsVmxRoot)</div><div class="ttdoc">Mark all buffers as read.</div><div class="ttdef"><b>Definition</b> Logging.c:558</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a09e09b7c4094d0118e60286632bd832b"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a09e09b7c4094d0118e60286632bd832b">_DEBUGGER_FLUSH_LOGGING_BUFFERS::CountOfMessagesThatSetAsReadFromVmxRoot</a></div><div class="ttdeci">UINT32 CountOfMessagesThatSetAsReadFromVmxRoot</div><div class="ttdef"><b>Definition</b> RequestStructures.h:296</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a4bbc1ed12ba1d1c451f6fda086ea4af2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a4bbc1ed12ba1d1c451f6fda086ea4af2">_DEBUGGER_FLUSH_LOGGING_BUFFERS::CountOfMessagesThatSetAsReadFromVmxNonRoot</a></div><div class="ttdeci">UINT32 CountOfMessagesThatSetAsReadFromVmxNonRoot</div><div class="ttdef"><b>Definition</b> RequestStructures.h:297</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s_html_a58d48d4a871935399b264dfd8c70331c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___f_l_u_s_h___l_o_g_g_i_n_g___b_u_f_f_e_r_s.html#a58d48d4a871935399b264dfd8c70331c">_DEBUGGER_FLUSH_LOGGING_BUFFERS::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:295</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c9d82c0c8c8cd250ca75483234db42a" name="a5c9d82c0c8c8cd250ca75483234db42a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9d82c0c8c8cd250ca75483234db42a">&#9670;&#160;</a></span>DebuggerCommandPreactivateFunctionality()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandPreactivateFunctionality </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a455865c115fa9c6344f2411fab30af64">PDEBUGGER_PREACTIVATE_COMMAND</a></td>          <td class="paramname"><span class="paramname"><em>PreactivateRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Preactivate a special functionality. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PreactivateRequest</td><td>Request details of preactivation</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1444</span>{</div>
<div class="line"><span class="lineno"> 1445</span>    <span class="keywordflow">switch</span> (PreactivateRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d.html#ac72e5e88a60b7bb9ac5b054888262e25">Type</a>)</div>
<div class="line"><span class="lineno"> 1446</span>    {</div>
<div class="line"><span class="lineno"> 1447</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a46dde9f707ffedbdbe715fbc730c3c81a313040af3341039d83e191a1becf0172">DEBUGGER_PREACTIVATE_COMMAND_TYPE_MODE</a>:</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1450</span>        <span class="comment">// Request for allocating the mode mechanism</span></div>
<div class="line"><span class="lineno"> 1451</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1452</span>        <a class="code hl_function" href="_configuration_8c.html#a1b26f0e861226a28347668799ce3f45e">ConfigureInitializeExecTrapOnAllProcessors</a>();</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1457</span> </div>
<div class="line"><span class="lineno"> 1458</span>        PreactivateRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d.html#a603518c212cd3b06489bd8067c0068a0">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#ab2f5bd9a722bff09f145b8c5b69f68b6">DEBUGGER_ERROR_COULD_NOT_FIND_PREACTIVATION_TYPE</a>;</div>
<div class="line"><span class="lineno"> 1459</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1460</span>    }</div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span>    PreactivateRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d.html#a603518c212cd3b06489bd8067c0068a0">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1463</span> </div>
<div class="line"><span class="lineno"> 1464</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1465</span>}</div>
<div class="ttc" id="a_configuration_8c_html_a1b26f0e861226a28347668799ce3f45e"><div class="ttname"><a href="_configuration_8c.html#a1b26f0e861226a28347668799ce3f45e">ConfigureInitializeExecTrapOnAllProcessors</a></div><div class="ttdeci">BOOLEAN ConfigureInitializeExecTrapOnAllProcessors()</div><div class="ttdoc">routines for initializing user-mode, kernel-mode exec trap</div><div class="ttdef"><b>Definition</b> Configuration.c:37</div></div>
<div class="ttc" id="a_error_codes_8h_html_ab2f5bd9a722bff09f145b8c5b69f68b6"><div class="ttname"><a href="_error_codes_8h.html#ab2f5bd9a722bff09f145b8c5b69f68b6">DEBUGGER_ERROR_COULD_NOT_FIND_PREACTIVATION_TYPE</a></div><div class="ttdeci">#define DEBUGGER_ERROR_COULD_NOT_FIND_PREACTIVATION_TYPE</div><div class="ttdoc">error, could not find the type of preactivation</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:507</div></div>
<div class="ttc" id="a_request_structures_8h_html_a46dde9f707ffedbdbe715fbc730c3c81a313040af3341039d83e191a1becf0172"><div class="ttname"><a href="_request_structures_8h.html#a46dde9f707ffedbdbe715fbc730c3c81a313040af3341039d83e191a1becf0172">DEBUGGER_PREACTIVATE_COMMAND_TYPE_MODE</a></div><div class="ttdeci">@ DEBUGGER_PREACTIVATE_COMMAND_TYPE_MODE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:190</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d_html_a603518c212cd3b06489bd8067c0068a0"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d.html#a603518c212cd3b06489bd8067c0068a0">_DEBUGGER_PREACTIVATE_COMMAND::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:204</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d_html_ac72e5e88a60b7bb9ac5b054888262e25"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_c_t_i_v_a_t_e___c_o_m_m_a_n_d.html#ac72e5e88a60b7bb9ac5b054888262e25">_DEBUGGER_PREACTIVATE_COMMAND::Type</a></div><div class="ttdeci">DEBUGGER_PREACTIVATE_COMMAND_TYPE Type</div><div class="ttdef"><b>Definition</b> RequestStructures.h:203</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8bb200983c48761d01ca416f16ef580" name="ab8bb200983c48761d01ca416f16ef580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8bb200983c48761d01ca416f16ef580">&#9670;&#160;</a></span>DebuggerCommandReadMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandReadMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>ReadMemRequest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>UserBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSIZE_T</td>          <td class="paramname"><span class="paramname"><em>ReturnSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read memory for different commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadMemRequest</td><td>request structure for reading memory </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to copy the memory </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>size that should be returned to user mode buffers</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Pid;</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Size;</div>
<div class="line"><span class="lineno">   29</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_typedef" href="_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a> MemType;</div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                   Is32BitProcess = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   34</span>    <span class="comment">// Adjust the parameters</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   36</span>    Pid     = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">Pid</a>;</div>
<div class="line"><span class="lineno">   37</span>    Size    = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">Size</a>;</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a>;</div>
<div class="line"><span class="lineno">   39</span>    MemType = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a>;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">if</span> (Size &amp;&amp; <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> != (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL)</div>
<div class="line"><span class="lineno">   42</span>    {</div>
<div class="line"><span class="lineno">   43</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="_memory_manager_8c.html#abc558733c695d4ebc61e2f45eec924ff">MemoryManagerReadProcessMemoryNormal</a>((HANDLE)Pid,</div>
<div class="line"><span class="lineno">   44</span>                                                 (PVOID)<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>,</div>
<div class="line"><span class="lineno">   45</span>                                                 MemType,</div>
<div class="line"><span class="lineno">   46</span>                                                 (PVOID)UserBuffer,</div>
<div class="line"><span class="lineno">   47</span>                                                 Size,</div>
<div class="line"><span class="lineno">   48</span>                                                 ReturnSize))</div>
<div class="line"><span class="lineno">   49</span>        {</div>
<div class="line"><span class="lineno">   50</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   51</span>            <span class="comment">// Reading memory was successful</span></div>
<div class="line"><span class="lineno">   52</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   55</span>            <span class="comment">// *** Now, we check whether this a disassembly request for a virtual address</span></div>
<div class="line"><span class="lineno">   56</span>            <span class="comment">// or not, if so, we&#39;ll detect whether the target process is 32-bit or 64-bit ***</span></div>
<div class="line"><span class="lineno">   57</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   60</span>            <span class="comment">// Check if the address is on a 32-bit mode process or not (just in case of disassembling)</span></div>
<div class="line"><span class="lineno">   61</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">   62</span>            <span class="keywordflow">if</span> (ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a> &amp;&amp; ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a8a9afa1a06769b9557ebc0e6c2b588d1">GetAddressMode</a>)</div>
<div class="line"><span class="lineno">   63</span>            {</div>
<div class="line"><span class="lineno">   64</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>                <span class="comment">// Check if the address is in the canonical range for kernel space</span></div>
<div class="line"><span class="lineno">   66</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">   67</span>                <span class="keywordflow">if</span> (ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a> &gt;= 0xFFFF800000000000 &amp;&amp; ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a> &lt;= 0xFFFFFFFFFFFFFFFF)</div>
<div class="line"><span class="lineno">   68</span>                {</div>
<div class="line"><span class="lineno">   69</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   70</span>                    <span class="comment">// The address is in the range of canonical kernel space, so it&#39;s 64-bit process</span></div>
<div class="line"><span class="lineno">   71</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   72</span>                    ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">   73</span>                }</div>
<div class="line"><span class="lineno">   74</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   75</span>                {</div>
<div class="line"><span class="lineno">   76</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   77</span>                    <span class="comment">// The address is in the user-mode and the memory type is a virtual address</span></div>
<div class="line"><span class="lineno">   78</span>                    <span class="comment">// for disassembly, so we have to query whether the target process is a</span></div>
<div class="line"><span class="lineno">   79</span>                    <span class="comment">// 32-bit process or a 64-bit process</span></div>
<div class="line"><span class="lineno">   80</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   81</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="_user_access_8c.html#afea1379e1a9acca82a320d700b63a7b8">UserAccessIsWow64Process</a>((HANDLE)ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">Pid</a>, &amp;Is32BitProcess))</div>
<div class="line"><span class="lineno">   82</span>                    {</div>
<div class="line"><span class="lineno">   83</span>                        <span class="keywordflow">if</span> (Is32BitProcess)</div>
<div class="line"><span class="lineno">   84</span>                        {</div>
<div class="line"><span class="lineno">   85</span>                            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22a9c98c1511465836be0346f50efcad823">DEBUGGER_READ_ADDRESS_MODE_32_BIT</a>;</div>
<div class="line"><span class="lineno">   86</span>                        }</div>
<div class="line"><span class="lineno">   87</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   88</span>                        {</div>
<div class="line"><span class="lineno">   89</span>                            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">   90</span>                        }</div>
<div class="line"><span class="lineno">   91</span>                    }</div>
<div class="line"><span class="lineno">   92</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   93</span>                    {</div>
<div class="line"><span class="lineno">   94</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   95</span>                        <span class="comment">// We couldn&#39;t determine the type of process, let&#39;s assume that it&#39;s a</span></div>
<div class="line"><span class="lineno">   96</span>                        <span class="comment">// 64-bit process by default</span></div>
<div class="line"><span class="lineno">   97</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   98</span>                        ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">   99</span>                    }</div>
<div class="line"><span class="lineno">  100</span>                }</div>
<div class="line"><span class="lineno">  101</span>            }</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  104</span>            <span class="comment">// Anyway, the read was successful</span></div>
<div class="line"><span class="lineno">  105</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  106</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  107</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  108</span>        }</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  110</span>        {</div>
<div class="line"><span class="lineno">  111</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  112</span>            <span class="comment">// Reading memory was not successful</span></div>
<div class="line"><span class="lineno">  113</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  114</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#a32f25124d52e2a76a6d9dba88f1ea3f4">DEBUGGER_ERROR_READING_MEMORY_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  115</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  116</span>        }</div>
<div class="line"><span class="lineno">  117</span>    }</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  119</span>    {</div>
<div class="line"><span class="lineno">  120</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  121</span>        <span class="comment">// Parameters are invalid</span></div>
<div class="line"><span class="lineno">  122</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  123</span>        ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#a32f25124d52e2a76a6d9dba88f1ea3f4">DEBUGGER_ERROR_READING_MEMORY_INVALID_PARAMETER</a>;</div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  125</span>    }</div>
<div class="line"><span class="lineno">  126</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_error_codes_8h_html_a32f25124d52e2a76a6d9dba88f1ea3f4"><div class="ttname"><a href="_error_codes_8h.html#a32f25124d52e2a76a6d9dba88f1ea3f4">DEBUGGER_ERROR_READING_MEMORY_INVALID_PARAMETER</a></div><div class="ttdeci">#define DEBUGGER_ERROR_READING_MEMORY_INVALID_PARAMETER</div><div class="ttdoc">error, for reading from memory in case of invalid parameters</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:405</div></div>
<div class="ttc" id="a_hyper_dbg_script_imports_8h_html_a3f7c5b71d899e923be0a80d4ac7902fe"><div class="ttname"><a href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> HyperDbgScriptImports.h:67</div></div>
<div class="ttc" id="a_memory_manager_8c_html_abc558733c695d4ebc61e2f45eec924ff"><div class="ttname"><a href="_memory_manager_8c.html#abc558733c695d4ebc61e2f45eec924ff">MemoryManagerReadProcessMemoryNormal</a></div><div class="ttdeci">BOOLEAN MemoryManagerReadProcessMemoryNormal(HANDLE PID, PVOID Address, DEBUGGER_READ_MEMORY_TYPE MemType, PVOID UserBuffer, SIZE_T Size, PSIZE_T ReturnSize)</div><div class="ttdoc">Read process memory.</div><div class="ttdef"><b>Definition</b> MemoryManager.c:29</div></div>
<div class="ttc" id="a_request_structures_8h_html_a6f202a103e130d55c5ed5b55d5511cab"><div class="ttname"><a href="_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a></div><div class="ttdeci">enum _DEBUGGER_READ_MEMORY_TYPE DEBUGGER_READ_MEMORY_TYPE</div><div class="ttdoc">different type of addresses</div></div>
<div class="ttc" id="a_request_structures_8h_html_a98bdf64c2e1daa0a4c87bdc446feef22a9c98c1511465836be0346f50efcad823"><div class="ttname"><a href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22a9c98c1511465836be0346f50efcad823">DEBUGGER_READ_ADDRESS_MODE_32_BIT</a></div><div class="ttdeci">@ DEBUGGER_READ_ADDRESS_MODE_32_BIT</div><div class="ttdef"><b>Definition</b> RequestStructures.h:239</div></div>
<div class="ttc" id="a_request_structures_8h_html_a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd"><div class="ttname"><a href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a></div><div class="ttdeci">@ DEBUGGER_READ_ADDRESS_MODE_64_BIT</div><div class="ttdef"><b>Definition</b> RequestStructures.h:240</div></div>
<div class="ttc" id="a_request_structures_8h_html_afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97"><div class="ttname"><a href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a></div><div class="ttdeci">@ DEBUGGER_READ_VIRTUAL_ADDRESS</div><div class="ttdef"><b>Definition</b> RequestStructures.h:230</div></div>
<div class="ttc" id="a_user_access_8c_html_afea1379e1a9acca82a320d700b63a7b8"><div class="ttname"><a href="_user_access_8c.html#afea1379e1a9acca82a320d700b63a7b8">UserAccessIsWow64Process</a></div><div class="ttdeci">BOOLEAN UserAccessIsWow64Process(HANDLE ProcessId, PBOOLEAN Is32Bit)</div><div class="ttdoc">Detects whether process is 32-bit or 64-bit.</div><div class="ttdef"><b>Definition</b> UserAccess.c:753</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a0eb19dcba59d45b95f2157eb674476d8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">_DEBUGGER_READ_MEMORY::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:275</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a215597b2a3418b4413fe5286b1d1c685"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">_DEBUGGER_READ_MEMORY::Size</a></div><div class="ttdeci">UINT32 Size</div><div class="ttdef"><b>Definition</b> RequestStructures.h:269</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a685a67cc05100b749ea071e9d9f7ff87"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">_DEBUGGER_READ_MEMORY::Pid</a></div><div class="ttdeci">UINT32 Pid</div><div class="ttdef"><b>Definition</b> RequestStructures.h:267</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a68a7a7213b052ece49ce39d0a4b62c86"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">_DEBUGGER_READ_MEMORY::AddressMode</a></div><div class="ttdeci">DEBUGGER_READ_MEMORY_ADDRESS_MODE AddressMode</div><div class="ttdef"><b>Definition</b> RequestStructures.h:271</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_a8a9afa1a06769b9557ebc0e6c2b588d1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a8a9afa1a06769b9557ebc0e6c2b588d1">_DEBUGGER_READ_MEMORY::GetAddressMode</a></div><div class="ttdeci">BOOLEAN GetAddressMode</div><div class="ttdef"><b>Definition</b> RequestStructures.h:270</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_ae6709d92b51f2c0ec9417a778b2cfa9f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">_DEBUGGER_READ_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_READ_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:272</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y_html_ae8a91a39973addb850d6fce45eba6b15"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">_DEBUGGER_READ_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> RequestStructures.h:268</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8868ea6e7d1a50960d949cce8d54778e" name="a8868ea6e7d1a50960d949cce8d54778e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8868ea6e7d1a50960d949cce8d54778e">&#9670;&#160;</a></span>DebuggerCommandReadMemoryVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DebuggerCommandReadMemoryVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#aa20edf6a6ccb273f5b16819964b171ac">PDEBUGGER_READ_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>ReadMemRequest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>UserBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *</td>          <td class="paramname"><span class="paramname"><em>ReturnSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read memory for different commands from vmxroot mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadMemRequest</td><td>request structure for reading memory </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to copy the memory </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>size that should be returned to user mode buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  138</span>{</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Pid;</div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                    Size;</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                    OffsetInUserBuffer;</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_typedef" href="_request_structures_8h.html#a6f202a103e130d55c5ed5b55d5511cab">DEBUGGER_READ_MEMORY_TYPE</a> MemType;</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                   Is32BitProcess = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  145</span>    PLIST_ENTRY               TempList       = 0;</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    Pid     = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a685a67cc05100b749ea071e9d9f7ff87">Pid</a>;</div>
<div class="line"><span class="lineno">  148</span>    Size    = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a215597b2a3418b4413fe5286b1d1c685">Size</a>;</div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a>;</div>
<div class="line"><span class="lineno">  150</span>    MemType = ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a>;</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  153</span>    <span class="comment">// read memory safe</span></div>
<div class="line"><span class="lineno">  154</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span> (MemType == <a class="code hl_enumvalue" href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888">DEBUGGER_READ_PHYSICAL_ADDRESS</a>)</div>
<div class="line"><span class="lineno">  156</span>    {</div>
<div class="line"><span class="lineno">  157</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  158</span>        <span class="comment">// Check whether the physical memory is valid or not</span></div>
<div class="line"><span class="lineno">  159</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#a66f7b8caa0489328006cca9cbcd6aa3d">CheckAddressPhysical</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>))</div>
<div class="line"><span class="lineno">  161</span>        {</div>
<div class="line"><span class="lineno">  162</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#ab7f71ae4d51b8f78bab349701bde3b05">DEBUGGER_ERROR_INVALID_PHYSICAL_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  163</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  164</span>        }</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        <a class="code hl_function" href="_memory_mapper_8c.html#acedcef82b2780b0252be0612881edf73">MemoryMapperReadMemorySafeByPhysicalAddress</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)UserBuffer, Size);</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MemType == <a class="code hl_enumvalue" href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a>)</div>
<div class="line"><span class="lineno">  169</span>    {</div>
<div class="line"><span class="lineno">  170</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  171</span>        <span class="comment">// Check whether the virtual memory is available in the current</span></div>
<div class="line"><span class="lineno">  172</span>        <span class="comment">// memory layout and also is present in the RAM</span></div>
<div class="line"><span class="lineno">  173</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, Size))</div>
<div class="line"><span class="lineno">  175</span>        {</div>
<div class="line"><span class="lineno">  176</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#ac1b8dbae6748b88abe05844e42c29952">DEBUGGER_ERROR_INVALID_ADDRESS</a>;</div>
<div class="line"><span class="lineno">  177</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  178</span>        }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  181</span>        <span class="comment">// Read memory safely</span></div>
<div class="line"><span class="lineno">  182</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  183</span>        <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(<a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>, UserBuffer, Size);</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  186</span>        <span class="comment">// Check if the target memory is filled with breakpoint of the &#39;bp&#39; commands</span></div>
<div class="line"><span class="lineno">  187</span>        <span class="comment">// if the memory is changed due to this command, then we&#39;ll changes it to</span></div>
<div class="line"><span class="lineno">  188</span>        <span class="comment">// the previous byte</span></div>
<div class="line"><span class="lineno">  189</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  192</span>        <span class="comment">// Iterate through the breakpoint list</span></div>
<div class="line"><span class="lineno">  193</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  194</span>        TempList = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a>;</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">while</span> (&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a> != TempList-&gt;Flink)</div>
<div class="line"><span class="lineno">  197</span>        {</div>
<div class="line"><span class="lineno">  198</span>            TempList                                      = TempList-&gt;Flink;</div>
<div class="line"><span class="lineno">  199</span>            <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">PDEBUGGEE_BP_DESCRIPTOR</a> CurrentBreakpointDesc = CONTAINING_RECORD(TempList, <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">DEBUGGEE_BP_DESCRIPTOR</a>, BreakpointsList);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>            <span class="keywordflow">if</span> (CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> &gt;= <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> &amp;&amp; CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> &lt;= <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a> + Size)</div>
<div class="line"><span class="lineno">  202</span>            {</div>
<div class="line"><span class="lineno">  203</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  204</span>                <span class="comment">// The address is found, we have to swap the byte if the target</span></div>
<div class="line"><span class="lineno">  205</span>                <span class="comment">// byte is 0xcc</span></div>
<div class="line"><span class="lineno">  206</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span>                <span class="comment">// Find the address location at user buffer</span></div>
<div class="line"><span class="lineno">  210</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  211</span>                OffsetInUserBuffer = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">Address</a> - <a class="code hl_variable" href="_hyper_dbg_script_imports_8h.html#a3f7c5b71d899e923be0a80d4ac7902fe">Address</a>;</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>                <span class="keywordflow">if</span> (UserBuffer[OffsetInUserBuffer] == 0xcc)</div>
<div class="line"><span class="lineno">  214</span>                {</div>
<div class="line"><span class="lineno">  215</span>                    UserBuffer[OffsetInUserBuffer] = CurrentBreakpointDesc-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">PreviousByte</a>;</div>
<div class="line"><span class="lineno">  216</span>                }</div>
<div class="line"><span class="lineno">  217</span>            }</div>
<div class="line"><span class="lineno">  218</span>        }</div>
<div class="line"><span class="lineno">  219</span>    }</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  221</span>    {</div>
<div class="line"><span class="lineno">  222</span>        ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aac9cc9511b87f4fb8676e7f60fb5a320">DEBUGGER_ERROR_MEMORY_TYPE_INVALID</a>;</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="comment">// Check if the address is on a 32-bit mode process or not (just in case of disassembling)</span></div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">if</span> (ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae6709d92b51f2c0ec9417a778b2cfa9f">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432ad7f19a8eee9857bada355d107f2ffc97">DEBUGGER_READ_VIRTUAL_ADDRESS</a> &amp;&amp; ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a8a9afa1a06769b9557ebc0e6c2b588d1">GetAddressMode</a>)</div>
<div class="line"><span class="lineno">  230</span>    {</div>
<div class="line"><span class="lineno">  231</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  232</span>        <span class="comment">// Check if the address is in the canonical range for kernel space</span></div>
<div class="line"><span class="lineno">  233</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordflow">if</span> (ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a> &gt;= 0xFFFF800000000000 &amp;&amp; ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#ae8a91a39973addb850d6fce45eba6b15">Address</a> &lt;= 0xFFFFFFFFFFFFFFFF)</div>
<div class="line"><span class="lineno">  235</span>        {</div>
<div class="line"><span class="lineno">  236</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  237</span>            <span class="comment">// The address is in the range of canonical kernel space, so it&#39;s 64-bit process</span></div>
<div class="line"><span class="lineno">  238</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  239</span>            ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">  240</span>        }</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  242</span>        {</div>
<div class="line"><span class="lineno">  243</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  244</span>            <span class="comment">// The address is in the user-mode and the memory type is a virtual address</span></div>
<div class="line"><span class="lineno">  245</span>            <span class="comment">// for disassembly, so we have to query whether the target process is a</span></div>
<div class="line"><span class="lineno">  246</span>            <span class="comment">// 32-bit process or a 64-bit process</span></div>
<div class="line"><span class="lineno">  247</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  248</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="_user_access_8c.html#af031f245bb3a7257c5c1f2155ddd54a9">UserAccessIsWow64ProcessByEprocess</a>(PsGetCurrentProcess(), &amp;Is32BitProcess))</div>
<div class="line"><span class="lineno">  249</span>            {</div>
<div class="line"><span class="lineno">  250</span>                <span class="keywordflow">if</span> (Is32BitProcess)</div>
<div class="line"><span class="lineno">  251</span>                {</div>
<div class="line"><span class="lineno">  252</span>                    ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22a9c98c1511465836be0346f50efcad823">DEBUGGER_READ_ADDRESS_MODE_32_BIT</a>;</div>
<div class="line"><span class="lineno">  253</span>                }</div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  255</span>                {</div>
<div class="line"><span class="lineno">  256</span>                    ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">  257</span>                }</div>
<div class="line"><span class="lineno">  258</span>            }</div>
<div class="line"><span class="lineno">  259</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  260</span>            {</div>
<div class="line"><span class="lineno">  261</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  262</span>                <span class="comment">// We couldn&#39;t determine the type of process, let&#39;s assume that it&#39;s a</span></div>
<div class="line"><span class="lineno">  263</span>                <span class="comment">// 64-bit process by default</span></div>
<div class="line"><span class="lineno">  264</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  265</span>                ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a68a7a7213b052ece49ce39d0a4b62c86">AddressMode</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a98bdf64c2e1daa0a4c87bdc446feef22aaf9c63e6e6c48cc1b05fc076c91fa2fd">DEBUGGER_READ_ADDRESS_MODE_64_BIT</a>;</div>
<div class="line"><span class="lineno">  266</span>            }</div>
<div class="line"><span class="lineno">  267</span>        }</div>
<div class="line"><span class="lineno">  268</span>    }</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>    <span class="comment">// Set the final status of memory read as it was successful</span></div>
<div class="line"><span class="lineno">  272</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  273</span>    ReadMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___m_e_m_o_r_y.html#a0eb19dcba59d45b95f2157eb674476d8">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  274</span>    *ReturnSize                  = Size;</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  277</span>}</div>
<div class="ttc" id="a_error_codes_8h_html_aac9cc9511b87f4fb8676e7f60fb5a320"><div class="ttname"><a href="_error_codes_8h.html#aac9cc9511b87f4fb8676e7f60fb5a320">DEBUGGER_ERROR_MEMORY_TYPE_INVALID</a></div><div class="ttdeci">#define DEBUGGER_ERROR_MEMORY_TYPE_INVALID</div><div class="ttdoc">error, memory type is invalid</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:214</div></div>
<div class="ttc" id="a_error_codes_8h_html_ab7f71ae4d51b8f78bab349701bde3b05"><div class="ttname"><a href="_error_codes_8h.html#ab7f71ae4d51b8f78bab349701bde3b05">DEBUGGER_ERROR_INVALID_PHYSICAL_ADDRESS</a></div><div class="ttdeci">#define DEBUGGER_ERROR_INVALID_PHYSICAL_ADDRESS</div><div class="ttdoc">error, invalid physical address</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:540</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4b9c8387e09821a8668975ec6119782e"><div class="ttname"><a href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1120</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_acedcef82b2780b0252be0612881edf73"><div class="ttname"><a href="_memory_mapper_8c.html#acedcef82b2780b0252be0612881edf73">MemoryMapperReadMemorySafeByPhysicalAddress</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeByPhysicalAddress(UINT64 PaAddressToRead, UINT64 BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer by physical address (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1077</div></div>
<div class="ttc" id="a_request_structures_8h_html_afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888"><div class="ttname"><a href="_request_structures_8h.html#afcd781e8aa8c0d7e70540647a24a8432a447255089e36bc1778a161e2713f8888">DEBUGGER_READ_PHYSICAL_ADDRESS</a></div><div class="ttdeci">@ DEBUGGER_READ_PHYSICAL_ADDRESS</div><div class="ttdef"><b>Definition</b> RequestStructures.h:229</div></div>
<div class="ttc" id="a_user_access_8c_html_af031f245bb3a7257c5c1f2155ddd54a9"><div class="ttname"><a href="_user_access_8c.html#af031f245bb3a7257c5c1f2155ddd54a9">UserAccessIsWow64ProcessByEprocess</a></div><div class="ttdeci">BOOLEAN UserAccessIsWow64ProcessByEprocess(PEPROCESS SourceProcess, PBOOLEAN Is32Bit)</div><div class="ttdoc">Detects whether process is 32-bit or 64-bit by using EPROCESS pointer.</div><div class="ttdef"><b>Definition</b> UserAccess.c:711</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_abca944290c6a683f0821a9096472f7d4"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#abca944290c6a683f0821a9096472f7d4">g_BreakpointsListHead</a></div><div class="ttdeci">LIST_ENTRY g_BreakpointsListHead</div><div class="ttdoc">List header of breakpoints for debugger-mode.</div><div class="ttdef"><b>Definition</b> Global.h:91</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html">_DEBUGGEE_BP_DESCRIPTOR</a></div><div class="ttdoc">The structure of storing breakpoints.</div><div class="ttdef"><b>Definition</b> State.h:72</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a5a31f78cc97ef4c9fdb0ab7a9a3d9bad"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a5a31f78cc97ef4c9fdb0ab7a9a3d9bad">_DEBUGGEE_BP_DESCRIPTOR::PreviousByte</a></div><div class="ttdeci">BYTE PreviousByte</div><div class="ttdef"><b>Definition</b> State.h:82</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r_html_a6ee164edb59fd20f9e69048564dd435a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___b_p___d_e_s_c_r_i_p_t_o_r.html#a6ee164edb59fd20f9e69048564dd435a">_DEBUGGEE_BP_DESCRIPTOR::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> State.h:76</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62dfa3017c983808ae647ec03252a0fe" name="a62dfa3017c983808ae647ec03252a0fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62dfa3017c983808ae647ec03252a0fe">&#9670;&#160;</a></span>DebuggerCommandReservePreallocatedPools()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandReservePreallocatedPools </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a5dcf26594841b272af7f485934e92d24">PDEBUGGER_PREALLOC_COMMAND</a></td>          <td class="paramname"><span class="paramname"><em>PreallocRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reserve and allocate pre-allocated buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">PreallocRequest</td><td>Request details of needed buffers to be reserved</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1320</span>{</div>
<div class="line"><span class="lineno"> 1321</span>    <span class="keywordflow">switch</span> (PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a6adbe0996a6cbf21690afd90352a1498">Type</a>)</div>
<div class="line"><span class="lineno"> 1322</span>    {</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0">DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</a>:</div>
<div class="line"><span class="lineno"> 1324</span> </div>
<div class="line"><span class="lineno"> 1325</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1326</span>        <span class="comment">// Request pages to be allocated for thread interception mechanism</span></div>
<div class="line"><span class="lineno"> 1327</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1328</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">USERMODE_DEBUGGING_THREAD_HOLDER</a>),</div>
<div class="line"><span class="lineno"> 1329</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1330</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a>);</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d">DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</a>:</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1337</span>        <span class="comment">// Perform the allocations for the &#39;!monitor&#39; command</span></div>
<div class="line"><span class="lineno"> 1338</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1339</span>        <a class="code hl_function" href="_configuration_8c.html#adc1de369fee20f1c13ce5da2c0fa5741">ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a>(PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>);</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baae351556ca7b4edd7ebd16bd6c316e4a0">DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK</a>:</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1346</span>        <span class="comment">// Perform the allocations for the &#39;!epthook&#39; command</span></div>
<div class="line"><span class="lineno"> 1347</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1348</span>        <a class="code hl_function" href="_configuration_8c.html#adc1de369fee20f1c13ce5da2c0fa5741">ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a>(PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>);</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa1b2ef691b6e1634f3abf8c476e17ea8b">DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK2</a>:</div>
<div class="line"><span class="lineno"> 1353</span> </div>
<div class="line"><span class="lineno"> 1354</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1355</span>        <span class="comment">// All the prealloc requests of regular EPT hooks are needed for the &#39;!epthook2&#39;</span></div>
<div class="line"><span class="lineno"> 1356</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1357</span>        <a class="code hl_function" href="_configuration_8c.html#af51d98af8c16c62303308f6f3ba91d1f">ConfigureEptHookReservePreallocatedPoolsForEptHooks</a>(PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>);</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa6d9c859f984031cd478130639e9714f3">DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_EVENT</a>:</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1364</span>        <span class="comment">// Request pages to be allocated for regular instant events</span></div>
<div class="line"><span class="lineno"> 1365</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1366</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a9a43e7c3f88b34c27ef48ffee07707e0">REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1367</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1368</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c">INSTANT_REGULAR_EVENT_BUFFER</a>);</div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1371</span>        <span class="comment">// Request pages to be allocated for regular instant events&#39;s actions</span></div>
<div class="line"><span class="lineno"> 1372</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1373</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a88064ae4d52a6ef17dfc68bc2366a625">REGULAR_INSTANT_EVENT_ACTION_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1374</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1375</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529">INSTANT_REGULAR_EVENT_ACTION_BUFFER</a>);</div>
<div class="line"><span class="lineno"> 1376</span> </div>
<div class="line"><span class="lineno"> 1377</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1378</span> </div>
<div class="line"><span class="lineno"> 1379</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa65692bc0793f8d227bff3198aa87d5da">DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_EVENT</a>:</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1382</span>        <span class="comment">// Request pages to be allocated for big instant events</span></div>
<div class="line"><span class="lineno"> 1383</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1384</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a9c2b21c71746a30f993c09fa8ae8c8f3">BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1385</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1386</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047">INSTANT_BIG_EVENT_BUFFER</a>);</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1389</span>        <span class="comment">// Request pages to be allocated for big instant events&#39;s actions</span></div>
<div class="line"><span class="lineno"> 1390</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1391</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a1e4cfd3362664680ff4230700c100c6d">BIG_INSTANT_EVENT_ACTION_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1392</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1393</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112">INSTANT_BIG_EVENT_ACTION_BUFFER</a>);</div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baadca1bcf9d755574f3a199f87bdbffa2d">DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_SAFE_BUFFER</a>:</div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1400</span>        <span class="comment">// Request pages to be allocated for regular safe buffer ($buffer) for events</span></div>
<div class="line"><span class="lineno"> 1401</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1402</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#a5754c08e99b8a43c9c13f6de8865a22c">REGULAR_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1403</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1404</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a44292aca123a05c8a57a90f69fbc477c">INSTANT_REGULAR_SAFE_BUFFER_FOR_EVENTS</a>);</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baacffb961740d1523cf770d72642dfc542">DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_SAFE_BUFFER</a>:</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1411</span>        <span class="comment">// Request pages to be allocated for big safe buffer ($buffer) for events</span></div>
<div class="line"><span class="lineno"> 1412</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1413</span>        <a class="code hl_function" href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a>(<a class="code hl_define" href="_constants_8h.html#ae615507242a271ec59be7758857cb7cc">BIG_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</a>,</div>
<div class="line"><span class="lineno"> 1414</span>                                     PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">Count</a>,</div>
<div class="line"><span class="lineno"> 1415</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a6f23c0aac3bb8088d8dfddfffe3904f2">INSTANT_BIG_SAFE_BUFFER_FOR_EVENTS</a>);</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1420</span> </div>
<div class="line"><span class="lineno"> 1421</span>        PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#a38aeca539089d3d847e570e03bb0dc83">DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</a>;</div>
<div class="line"><span class="lineno"> 1422</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1423</span>    }</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1426</span>    <span class="comment">// Invalidate and perform the allocations as we&#39;re in PASSIVE_LEVEL</span></div>
<div class="line"><span class="lineno"> 1427</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1428</span>    <a class="code hl_function" href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a>();</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>    PreallocRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1433</span>}</div>
<div class="ttc" id="a_configuration_8c_html_adc1de369fee20f1c13ce5da2c0fa5741"><div class="ttname"><a href="_configuration_8c.html#adc1de369fee20f1c13ce5da2c0fa5741">ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a></div><div class="ttdeci">VOID ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks(UINT32 Count)</div><div class="ttdoc">Allocate (reserve) extra pages for storing details of page hooks for memory monitor and regular hidde...</div><div class="ttdef"><b>Definition</b> Configuration.c:227</div></div>
<div class="ttc" id="a_configuration_8c_html_af51d98af8c16c62303308f6f3ba91d1f"><div class="ttname"><a href="_configuration_8c.html#af51d98af8c16c62303308f6f3ba91d1f">ConfigureEptHookReservePreallocatedPoolsForEptHooks</a></div><div class="ttdeci">VOID ConfigureEptHookReservePreallocatedPoolsForEptHooks(UINT32 Count)</div><div class="ttdoc">Allocate (reserve) pages for storing EPT hooks page hooks.</div><div class="ttdef"><b>Definition</b> Configuration.c:239</div></div>
<div class="ttc" id="a_constants_8h_html_a1e4cfd3362664680ff4230700c100c6d"><div class="ttname"><a href="_constants_8h.html#a1e4cfd3362664680ff4230700c100c6d">BIG_INSTANT_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">#define BIG_INSTANT_EVENT_ACTION_BUFFER</div><div class="ttdoc">Pre-allocated size for a big action + custom code or script buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:300</div></div>
<div class="ttc" id="a_constants_8h_html_a5754c08e99b8a43c9c13f6de8865a22c"><div class="ttname"><a href="_constants_8h.html#a5754c08e99b8a43c9c13f6de8865a22c">REGULAR_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</a></div><div class="ttdeci">#define REGULAR_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</div><div class="ttdoc">Pre-allocated size for a regular requested safe buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:306</div></div>
<div class="ttc" id="a_constants_8h_html_a88064ae4d52a6ef17dfc68bc2366a625"><div class="ttname"><a href="_constants_8h.html#a88064ae4d52a6ef17dfc68bc2366a625">REGULAR_INSTANT_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">#define REGULAR_INSTANT_EVENT_ACTION_BUFFER</div><div class="ttdoc">Pre-allocated size for a regular action + custom code or script buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:294</div></div>
<div class="ttc" id="a_constants_8h_html_a9a43e7c3f88b34c27ef48ffee07707e0"><div class="ttname"><a href="_constants_8h.html#a9a43e7c3f88b34c27ef48ffee07707e0">REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</a></div><div class="ttdeci">#define REGULAR_INSTANT_EVENT_CONDITIONAL_BUFFER</div><div class="ttdoc">Pre-allocated size for a regular event + conditions buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:282</div></div>
<div class="ttc" id="a_constants_8h_html_a9c2b21c71746a30f993c09fa8ae8c8f3"><div class="ttname"><a href="_constants_8h.html#a9c2b21c71746a30f993c09fa8ae8c8f3">BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</a></div><div class="ttdeci">#define BIG_INSTANT_EVENT_CONDITIONAL_BUFFER</div><div class="ttdoc">Pre-allocated size for a big event + conditions buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:288</div></div>
<div class="ttc" id="a_constants_8h_html_ae615507242a271ec59be7758857cb7cc"><div class="ttname"><a href="_constants_8h.html#ae615507242a271ec59be7758857cb7cc">BIG_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</a></div><div class="ttdeci">#define BIG_INSTANT_EVENT_REQUESTED_SAFE_BUFFER</div><div class="ttdoc">Pre-allocated size for a big requested safe buffer.</div><div class="ttdef"><b>Definition</b> Constants.h:312</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a13119f414e55e917801c5e61a2d98518">PROCESS_THREAD_HOLDER</a></div><div class="ttdeci">@ PROCESS_THREAD_HOLDER</div><div class="ttdef"><b>Definition</b> DataTypes.h:46</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a44292aca123a05c8a57a90f69fbc477c"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a44292aca123a05c8a57a90f69fbc477c">INSTANT_REGULAR_SAFE_BUFFER_FOR_EVENTS</a></div><div class="ttdeci">@ INSTANT_REGULAR_SAFE_BUFFER_FOR_EVENTS</div><div class="ttdef"><b>Definition</b> DataTypes.h:59</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a6f23c0aac3bb8088d8dfddfffe3904f2"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a6f23c0aac3bb8088d8dfddfffe3904f2">INSTANT_BIG_SAFE_BUFFER_FOR_EVENTS</a></div><div class="ttdeci">@ INSTANT_BIG_SAFE_BUFFER_FOR_EVENTS</div><div class="ttdef"><b>Definition</b> DataTypes.h:60</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a833485fa6115f1774b4b35458dcff047">INSTANT_BIG_EVENT_BUFFER</a></div><div class="ttdeci">@ INSTANT_BIG_EVENT_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:52</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a849c1cb700660cee59b27efe9fe12112">INSTANT_BIG_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">@ INSTANT_BIG_EVENT_ACTION_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:54</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63a8dc68bf9924329bc957120797a63c529">INSTANT_REGULAR_EVENT_ACTION_BUFFER</a></div><div class="ttdeci">@ INSTANT_REGULAR_EVENT_ACTION_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:53</div></div>
<div class="ttc" id="a_data_types_8h_html_ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c"><div class="ttname"><a href="_data_types_8h.html#ad130f0bae4db97169873223d0aad9a63aa092639835ffde01951b85c5c70e991c">INSTANT_REGULAR_EVENT_BUFFER</a></div><div class="ttdeci">@ INSTANT_REGULAR_EVENT_BUFFER</div><div class="ttdef"><b>Definition</b> DataTypes.h:51</div></div>
<div class="ttc" id="a_error_codes_8h_html_a38aeca539089d3d847e570e03bb0dc83"><div class="ttname"><a href="_error_codes_8h.html#a38aeca539089d3d847e570e03bb0dc83">DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</a></div><div class="ttdeci">#define DEBUGGER_ERROR_COULD_NOT_FIND_ALLOCATION_TYPE</div><div class="ttdoc">error, could not find the type of allocation</div><div class="ttdef"><b>Definition</b> ErrorCodes.h:282</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a03e9f251a31e86dcac849bd9d681aa6d"><div class="ttname"><a href="_pool_manager_8c.html#a03e9f251a31e86dcac849bd9d681aa6d">PoolManagerCheckAndPerformAllocationAndDeallocation</a></div><div class="ttdeci">BOOLEAN PoolManagerCheckAndPerformAllocationAndDeallocation()</div><div class="ttdoc">This function performs allocations from VMX non-root based on g_RequestNewAllocation.</div><div class="ttdef"><b>Definition</b> PoolManager.c:302</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a3660fd340db1240d410e847fb1ffe3d8"><div class="ttname"><a href="_pool_manager_8c.html#a3660fd340db1240d410e847fb1ffe3d8">PoolManagerRequestAllocation</a></div><div class="ttdeci">BOOLEAN PoolManagerRequestAllocation(SIZE_T Size, UINT32 Count, POOL_ALLOCATION_INTENTION Intention)</div><div class="ttdoc">Request to allocate new buffers.</div><div class="ttdef"><b>Definition</b> PoolManager.c:415</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa12eaac4806014a376257d95999b7344d">DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_MONITOR</div><div class="ttdef"><b>Definition</b> RequestStructures.h:156</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa1b2ef691b6e1634f3abf8c476e17ea8b"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa1b2ef691b6e1634f3abf8c476e17ea8b">DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK2</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK2</div><div class="ttdef"><b>Definition</b> RequestStructures.h:158</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa65692bc0793f8d227bff3198aa87d5da"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa65692bc0793f8d227bff3198aa87d5da">DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_EVENT</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_EVENT</div><div class="ttdef"><b>Definition</b> RequestStructures.h:160</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa6d9c859f984031cd478130639e9714f3"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa6d9c859f984031cd478130639e9714f3">DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_EVENT</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_EVENT</div><div class="ttdef"><b>Definition</b> RequestStructures.h:159</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baa7ae24692de1d370b040c1e9305366bf0">DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_THREAD_INTERCEPTION</div><div class="ttdef"><b>Definition</b> RequestStructures.h:155</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baacffb961740d1523cf770d72642dfc542"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baacffb961740d1523cf770d72642dfc542">DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_SAFE_BUFFER</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_BIG_SAFE_BUFFER</div><div class="ttdef"><b>Definition</b> RequestStructures.h:162</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baadca1bcf9d755574f3a199f87bdbffa2d"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baadca1bcf9d755574f3a199f87bdbffa2d">DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_SAFE_BUFFER</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_REGULAR_SAFE_BUFFER</div><div class="ttdef"><b>Definition</b> RequestStructures.h:161</div></div>
<div class="ttc" id="a_request_structures_8h_html_a8b2f1e9a8e3317ece5edce1f633d85baae351556ca7b4edd7ebd16bd6c316e4a0"><div class="ttname"><a href="_request_structures_8h.html#a8b2f1e9a8e3317ece5edce1f633d85baae351556ca7b4edd7ebd16bd6c316e4a0">DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK</a></div><div class="ttdeci">@ DEBUGGER_PREALLOC_COMMAND_TYPE_EPTHOOK</div><div class="ttdef"><b>Definition</b> RequestStructures.h:157</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_a6adbe0996a6cbf21690afd90352a1498"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a6adbe0996a6cbf21690afd90352a1498">_DEBUGGER_PREALLOC_COMMAND::Type</a></div><div class="ttdeci">DEBUGGER_PREALLOC_COMMAND_TYPE Type</div><div class="ttdef"><b>Definition</b> RequestStructures.h:175</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_a9baab220a9a337168c044a3553817555"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#a9baab220a9a337168c044a3553817555">_DEBUGGER_PREALLOC_COMMAND::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:177</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d_html_abd6285b435c030a8201639495e63533d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___p_r_e_a_l_l_o_c___c_o_m_m_a_n_d.html#abd6285b435c030a8201639495e63533d">_DEBUGGER_PREALLOC_COMMAND::Count</a></div><div class="ttdeci">UINT32 Count</div><div class="ttdef"><b>Definition</b> RequestStructures.h:176</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___h_o_l_d_e_r.html">_USERMODE_DEBUGGING_THREAD_HOLDER</a></div><div class="ttdoc">The holder for detail of each thread in process.</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:46</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a90d49ed0d4f0c40139d885b24e4c5b81" name="a90d49ed0d4f0c40139d885b24e4c5b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90d49ed0d4f0c40139d885b24e4c5b81">&#9670;&#160;</a></span>DebuggerCommandSearchMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSearchMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>SearchMemRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start searching memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SearchMemRequest</td><td>Request to search memory </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1135</span>{</div>
<div class="line"><span class="lineno"> 1136</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> SearchResultsStorage = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno"> 1137</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a> UsermodeBuffer       = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno"> 1138</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  AddressFrom          = 0;</div>
<div class="line"><span class="lineno"> 1139</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  AddressTo            = 0;</div>
<div class="line"><span class="lineno"> 1140</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>  CurrentValue         = 0;</div>
<div class="line"><span class="lineno"> 1141</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  ResultsIndex         = 0;</div>
<div class="line"><span class="lineno"> 1142</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>  CountOfResults       = 0;</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1145</span>    <span class="comment">// Check if process id is valid or not</span></div>
<div class="line"><span class="lineno"> 1146</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1147</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> != <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()) &amp;&amp; !<a class="code hl_function" href="hyperkd_2code_2common_2_common_8c.html#ae93e2ecf590a45b6ef7e67e137cc2e62">CommonIsProcessExist</a>(SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>))</div>
<div class="line"><span class="lineno"> 1148</span>    {</div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno"> 1150</span>    }</div>
<div class="line"><span class="lineno"> 1151</span> </div>
<div class="line"><span class="lineno"> 1152</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1153</span>    <span class="comment">// User-mode buffer is same as SearchMemRequest</span></div>
<div class="line"><span class="lineno"> 1154</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1155</span>    UsermodeBuffer = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *)SearchMemRequest;</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1158</span>    <span class="comment">// We store the user-mode data in a separate variable because</span></div>
<div class="line"><span class="lineno"> 1159</span>    <span class="comment">// we will use them later when we Zeroed the SearchMemRequest</span></div>
<div class="line"><span class="lineno"> 1160</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1161</span>    AddressFrom = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>;</div>
<div class="line"><span class="lineno"> 1162</span>    AddressTo   = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> + SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a20e406adff161a193962c60ae4501632">Length</a>;</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1165</span>    <span class="comment">// We support up to MaximumSearchResults search results</span></div>
<div class="line"><span class="lineno"> 1166</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1167</span>    SearchResultsStorage = <a class="code hl_function" href="_mem_8c.html#a9bd46383a9f12e1a8a1b59c1658d1bc8">PlatformMemAllocateZeroedNonPagedPool</a>(<a class="code hl_define" href="_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keywordflow">if</span> (SearchResultsStorage == NULL)</div>
<div class="line"><span class="lineno"> 1170</span>    {</div>
<div class="line"><span class="lineno"> 1171</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1172</span>        <span class="comment">// Not enough memory</span></div>
<div class="line"><span class="lineno"> 1173</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1174</span>        <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;</div>
<div class="line"><span class="lineno"> 1175</span>    }</div>
<div class="line"><span class="lineno"> 1176</span> </div>
<div class="line"><span class="lineno"> 1177</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1178</span>    <span class="comment">// Call the wrapper</span></div>
<div class="line"><span class="lineno"> 1179</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1180</span>    <a class="code hl_function" href="#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a>(SearchResultsStorage, SearchMemRequest, AddressFrom, AddressTo, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, &amp;CountOfResults);</div>
<div class="line"><span class="lineno"> 1181</span> </div>
<div class="line"><span class="lineno"> 1182</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1183</span>    <span class="comment">// In this point, we to store the results (if any) to the user-mode</span></div>
<div class="line"><span class="lineno"> 1184</span>    <span class="comment">// buffer SearchMemRequest itself is the user-mode buffer and we also</span></div>
<div class="line"><span class="lineno"> 1185</span>    <span class="comment">// checked from the previous function that the output buffer is at</span></div>
<div class="line"><span class="lineno"> 1186</span>    <span class="comment">// least SearchMemRequest bigger or equal to MaximumSearchResults * sizeof(UINT64)</span></div>
<div class="line"><span class="lineno"> 1187</span>    <span class="comment">// so we need to clear everything here, and also we should keep in mind that</span></div>
<div class="line"><span class="lineno"> 1188</span>    <span class="comment">// SearchMemRequest is no longer valid</span></div>
<div class="line"><span class="lineno"> 1189</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1190</span>    RtlZeroMemory(SearchMemRequest, <a class="code hl_define" href="_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1193</span>    <span class="comment">// It&#39;s time to move the results from our temporary buffer to the user-mode</span></div>
<div class="line"><span class="lineno"> 1194</span>    <span class="comment">// buffer, also there is something that we should check and that&#39;s the fact</span></div>
<div class="line"><span class="lineno"> 1195</span>    <span class="comment">// that we used aligned page addresses so the results should be checked to</span></div>
<div class="line"><span class="lineno"> 1196</span>    <span class="comment">// see whether the results are between the user&#39;s entered addresses or not</span></div>
<div class="line"><span class="lineno"> 1197</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1198</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a>; i++)</div>
<div class="line"><span class="lineno"> 1199</span>    {</div>
<div class="line"><span class="lineno"> 1200</span>        CurrentValue = SearchResultsStorage[i];</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>        <span class="keywordflow">if</span> (CurrentValue == (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL)</div>
<div class="line"><span class="lineno"> 1203</span>        {</div>
<div class="line"><span class="lineno"> 1204</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1205</span>            <span class="comment">// Nothing left to move</span></div>
<div class="line"><span class="lineno"> 1206</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1207</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1208</span>        }</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>        <span class="keywordflow">if</span> (CurrentValue &gt;= AddressFrom &amp;&amp; CurrentValue &lt;= AddressTo)</div>
<div class="line"><span class="lineno"> 1211</span>        {</div>
<div class="line"><span class="lineno"> 1212</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1213</span>            <span class="comment">// Move the variable</span></div>
<div class="line"><span class="lineno"> 1214</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1215</span>            UsermodeBuffer[ResultsIndex] = CurrentValue;</div>
<div class="line"><span class="lineno"> 1216</span>            ResultsIndex++;</div>
<div class="line"><span class="lineno"> 1217</span>        }</div>
<div class="line"><span class="lineno"> 1218</span>    }</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment">// Free the results pool</span></div>
<div class="line"><span class="lineno"> 1222</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1223</span>    <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>(SearchResultsStorage);</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1226</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ad413c7f23e00f0764dfa0ab21b6442a0"><div class="ttname"><a href="_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a></div><div class="ttdeci">unsigned __int64 * PUINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_constants_8h_html_a919acdd5bb356f5a912d3b23b1b927a7"><div class="ttname"><a href="_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a></div><div class="ttdeci">#define MaximumSearchResults</div><div class="ttdoc">maximum results that will be returned by !s* s* command</div><div class="ttdef"><b>Definition</b> Constants.h:514</div></div>
<div class="ttc" id="a_debugger_commands_8c_html_aa2b3b7d14e79251d6e4b20dff257500a"><div class="ttname"><a href="#aa2b3b7d14e79251d6e4b20dff257500a">SearchAddressWrapper</a></div><div class="ttdeci">BOOLEAN SearchAddressWrapper(PUINT64 AddressToSaveResults, PDEBUGGER_SEARCH_MEMORY SearchMemRequest, UINT64 StartAddress, UINT64 EndAddress, BOOLEAN IsDebuggeePaused, PUINT32 CountOfMatchedCases)</div><div class="ttdoc">The wrapper to check for validity of addresses and call the search routines for both physical and vir...</div><div class="ttdef"><b>Definition</b> DebuggerCommands.c:962</div></div>
<div class="ttc" id="a_mem_8c_html_a8ad365cfb6c54c3d6fdd745e6b4666f1"><div class="ttname"><a href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a></div><div class="ttdeci">VOID PlatformMemFreePool(PVOID BufferAddress)</div><div class="ttdoc">Free (dellocate) a non-paged buffer.</div><div class="ttdef"><b>Definition</b> Mem.c:86</div></div>
<div class="ttc" id="a_mem_8c_html_a9bd46383a9f12e1a8a1b59c1658d1bc8"><div class="ttname"><a href="_mem_8c.html#a9bd46383a9f12e1a8a1b59c1658d1bc8">PlatformMemAllocateZeroedNonPagedPool</a></div><div class="ttdeci">PVOID PlatformMemAllocateZeroedNonPagedPool(SIZE_T NumberOfBytes)</div><div class="ttdoc">Allocate a non-paged buffer (zeroed)</div><div class="ttdef"><b>Definition</b> Mem.c:69</div></div>
<div class="ttc" id="ahyperkd_2code_2common_2_common_8c_html_ae93e2ecf590a45b6ef7e67e137cc2e62"><div class="ttname"><a href="hyperkd_2code_2common_2_common_8c.html#ae93e2ecf590a45b6ef7e67e137cc2e62">CommonIsProcessExist</a></div><div class="ttdeci">BOOLEAN CommonIsProcessExist(UINT32 ProcId)</div><div class="ttdoc">Checks whether the process with ProcId exists or not.</div><div class="ttdef"><b>Definition</b> Common.c:24</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a20e406adff161a193962c60ae4501632"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a20e406adff161a193962c60ae4501632">_DEBUGGER_SEARCH_MEMORY::Length</a></div><div class="ttdeci">UINT64 Length</div><div class="ttdef"><b>Definition</b> RequestStructures.h:529</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a2286bb7292ad9a907133af3a8de82ac7"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">_DEBUGGER_SEARCH_MEMORY::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> RequestStructures.h:530</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a93f60f8bba58373d242567705f2d147a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">_DEBUGGER_SEARCH_MEMORY::Address</a></div><div class="ttdeci">UINT64 Address</div><div class="ttdef"><b>Definition</b> RequestStructures.h:528</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae149f6dd099f7dc3f64584a3b27f7d56" name="ae149f6dd099f7dc3f64584a3b27f7d56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae149f6dd099f7dc3f64584a3b27f7d56">&#9670;&#160;</a></span>DebuggerCommandSendGeneralBufferToDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSendGeneralBufferToDebugger </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#ad97915c6241a0c1642aa62839e661aa1">PDEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER</a></td>          <td class="paramname"><span class="paramname"><em>DebuggeeBufferRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send general buffers from the debuggee to the debugger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggeeBufferRequest</td><td>Request to buffer that will be sent to the debugger </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1297</span>{</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1299</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode to avoid deadlock</span></div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1301</span>    <a class="code hl_function" href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#aea644d30f2ae0f1573f9ac0a7c729686">DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno"> 1302</span>                    (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DebuggeeBufferRequest,</div>
<div class="line"><span class="lineno"> 1303</span>                    0,</div>
<div class="line"><span class="lineno"> 1304</span>                    0);</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>    DebuggeeBufferRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r.html#ac871117cd61b8e2eab2e16c2fba63c22">KernelResult</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1307</span> </div>
<div class="line"><span class="lineno"> 1308</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1309</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_aea644d30f2ae0f1573f9ac0a7c729686"><div class="ttname"><a href="_debugger_vmcalls_8h.html#aea644d30f2ae0f1573f9ac0a7c729686">DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SEND_GENERAL_BUFFER_TO_DEBUGGER</div><div class="ttdoc">VMCALL to send general buffers from debuggee user-mode to the debugger.</div><div class="ttdef"><b>Definition</b> DebuggerVmcalls.h:49</div></div>
<div class="ttc" id="a_export_8c_html_a12ce0403e6a293853c4f103d73403b07"><div class="ttname"><a href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a></div><div class="ttdeci">NTSTATUS VmFuncVmxVmcall(unsigned long long VmcallNumber, unsigned long long OptionalParam1, unsigned long long OptionalParam2, unsigned long long OptionalParam3)</div><div class="ttdoc">Export for running VMX VMCALLs.</div><div class="ttdef"><b>Definition</b> Export.c:683</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r_html_ac871117cd61b8e2eab2e16c2fba63c22"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___s_e_n_d___g_e_n_e_r_a_l___p_a_c_k_e_t___f_r_o_m___d_e_b_u_g_g_e_e___t_o___d_e_b_u_g_g_e_r.html#ac871117cd61b8e2eab2e16c2fba63c22">_DEBUGGEE_SEND_GENERAL_PACKET_FROM_DEBUGGEE_TO_DEBUGGER::KernelResult</a></div><div class="ttdeci">UINT32 KernelResult</div><div class="ttdef"><b>Definition</b> RequestStructures.h:388</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adea94a64fc961c2aa25be87907844586" name="adea94a64fc961c2aa25be87907844586"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea94a64fc961c2aa25be87907844586">&#9670;&#160;</a></span>DebuggerCommandSendMessage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSendMessage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a220681277ea06cfae1cec6d8cd06d3f9">PDEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a></td>          <td class="paramname"><span class="paramname"><em>DebuggerSendUsermodeMessageRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the user-mode buffer to debugger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerSendUsermodeMessageRequest</td><td>Request to send message to debugger </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1275</span>{</div>
<div class="line"><span class="lineno"> 1276</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1277</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode to avoid deadlock</span></div>
<div class="line"><span class="lineno"> 1278</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1279</span>    <a class="code hl_function" href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a24e3d1ecb000261d557dd795f205d51e">DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</a>,</div>
<div class="line"><span class="lineno"> 1280</span>                    (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)DebuggerSendUsermodeMessageRequest + (<a class="code hl_define" href="_request_structures_8h.html#a0437a8efeddd8a30372c9a44e41954e9">SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a>),</div>
<div class="line"><span class="lineno"> 1281</span>                    DebuggerSendUsermodeMessageRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#acbaabdfeca27bad0082ba08c3aae349d">Length</a>,</div>
<div class="line"><span class="lineno"> 1282</span>                    0);</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>    DebuggerSendUsermodeMessageRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#a045b45760aa92376f8ef1688c08cc175">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1287</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a24e3d1ecb000261d557dd795f205d51e"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a24e3d1ecb000261d557dd795f205d51e">DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SEND_MESSAGES_TO_DEBUGGER</div><div class="ttdoc">VMCALL to send messages to the debugger.</div><div class="ttdef"><b>Definition</b> DebuggerVmcalls.h:42</div></div>
<div class="ttc" id="a_request_structures_8h_html_a0437a8efeddd8a30372c9a44e41954e9"><div class="ttname"><a href="_request_structures_8h.html#a0437a8efeddd8a30372c9a44e41954e9">SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</a></div><div class="ttdeci">#define SIZEOF_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER</div><div class="ttdef"><b>Definition</b> RequestStructures.h:400</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r_html_a045b45760aa92376f8ef1688c08cc175"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#a045b45760aa92376f8ef1688c08cc175">_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:409</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r_html_acbaabdfeca27bad0082ba08c3aae349d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___u_s_e_r_m_o_d_e___m_e_s_s_a_g_e_s___t_o___d_e_b_u_g_g_e_r.html#acbaabdfeca27bad0082ba08c3aae349d">_DEBUGGER_SEND_USERMODE_MESSAGES_TO_DEBUGGER::Length</a></div><div class="ttdeci">UINT32 Length</div><div class="ttdef"><b>Definition</b> RequestStructures.h:410</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa8aa71f33a1a7c56f77864afb4641e" name="a7aa8aa71f33a1a7c56f77864afb4641e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa8aa71f33a1a7c56f77864afb4641e">&#9670;&#160;</a></span>DebuggerCommandSignalExecutionState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerCommandSignalExecutionState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a79b3c4ae30c99d53a4287aec1398db44">PDEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL</a></td>          <td class="paramname"><span class="paramname"><em>DebuggerFinishedExecutionRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the command finished signal. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DebuggerFinishedExecutionRequest</td><td>Request to signal debuggee about execution state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1256</span>{</div>
<div class="line"><span class="lineno"> 1257</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1258</span>    <span class="comment">// It&#39;s better to send the signal from vmx-root mode</span></div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1260</span>    <a class="code hl_function" href="_export_8c.html#a12ce0403e6a293853c4f103d73403b07">VmFuncVmxVmcall</a>(<a class="code hl_define" href="_debugger_vmcalls_8h.html#a043a8356fe9dcf434e61a92cbf30a237">DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</a>, 0, 0, 0);</div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>    DebuggerFinishedExecutionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l.html#a7f6eb4942fa94da828b9425c3d49882c">KernelStatus</a> = <a class="code hl_define" href="_error_codes_8h.html#aed656c58434eecb2d7e8c10e93aecff4">DEBUGGER_OPERATION_WAS_SUCCESSFUL</a>;</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno"> 1265</span>}</div>
<div class="ttc" id="a_debugger_vmcalls_8h_html_a043a8356fe9dcf434e61a92cbf30a237"><div class="ttname"><a href="_debugger_vmcalls_8h.html#a043a8356fe9dcf434e61a92cbf30a237">DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</a></div><div class="ttdeci">#define DEBUGGER_VMCALL_SIGNAL_DEBUGGER_EXECUTION_FINISHED</div><div class="ttdoc">VMCALL to signal debugger that debuggee finished execution of the command.</div><div class="ttdef"><b>Definition</b> DebuggerVmcalls.h:36</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l_html_a7f6eb4942fa94da828b9425c3d49882c"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_n_d___c_o_m_m_a_n_d___e_x_e_c_u_t_i_o_n___f_i_n_i_s_h_e_d___s_i_g_n_a_l.html#a7f6eb4942fa94da828b9425c3d49882c">_DEBUGGER_SEND_COMMAND_EXECUTION_FINISHED_SIGNAL::KernelStatus</a></div><div class="ttdeci">UINT32 KernelStatus</div><div class="ttdef"><b>Definition</b> RequestStructures.h:368</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cacf53abe149ebe3e2c43ad68d43e22" name="a6cacf53abe149ebe3e2c43ad68d43e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cacf53abe149ebe3e2c43ad68d43e22">&#9670;&#160;</a></span>DebuggerReadOrWriteMsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS DebuggerReadOrWriteMsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a4d767d7cb2f35f41f4644da283ed779b">PDEBUGGER_READ_AND_WRITE_ON_MSR</a></td>          <td class="paramname"><span class="paramname"><em>ReadOrWriteMsrRequest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>UserBuffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PSIZE_T</td>          <td class="paramname"><span class="paramname"><em>ReturnSize</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform rdmsr, wrmsr commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ReadOrWriteMsrRequest</td><td>Msr read/write request </td></tr>
    <tr><td class="paramname">UserBuffer</td><td>user buffer to save the results </td></tr>
    <tr><td class="paramname">ReturnSize</td><td>return size to user-mode buffers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  289</span>{</div>
<div class="line"><span class="lineno">  290</span>    NTSTATUS Status;</div>
<div class="line"><span class="lineno">  291</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>    ProcessorsCount;</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    ProcessorsCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="comment">// We don&#39;t check whether the MSR is in valid range of hardware or not</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// because the user might send a non-valid MSR which means sth to the</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">// Windows or VMM, e.g the range specified for VMMs in Hyper-v</span></div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">ActionType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3">DEBUGGER_MSR_WRITE</a>)</div>
<div class="line"><span class="lineno">  302</span>    {</div>
<div class="line"><span class="lineno">  303</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  304</span>        <span class="comment">// Set Msr to be applied on the target cores</span></div>
<div class="line"><span class="lineno">  305</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> == <a class="code hl_define" href="_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a>)</div>
<div class="line"><span class="lineno">  307</span>        {</div>
<div class="line"><span class="lineno">  308</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  309</span>            <span class="comment">// Means that we should apply it on all cores</span></div>
<div class="line"><span class="lineno">  310</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  311</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno">  312</span>            {</div>
<div class="line"><span class="lineno">  313</span>                <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a>   = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  314</span>                <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">Value</a>;</div>
<div class="line"><span class="lineno">  315</span>            }</div>
<div class="line"><span class="lineno">  316</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  317</span>            <span class="comment">// Broadcast to all cores to change their Msrs</span></div>
<div class="line"><span class="lineno">  318</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  319</span>            KeGenericCallDpc(<a class="code hl_function" href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#ac9051976c97907c7b77703fd5b8d5a79">DpcRoutineWriteMsrToAllCores</a>, 0x0);</div>
<div class="line"><span class="lineno">  320</span>        }</div>
<div class="line"><span class="lineno">  321</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  322</span>        {</div>
<div class="line"><span class="lineno">  323</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  324</span>            <span class="comment">// We have to change a single core&#39;s msr</span></div>
<div class="line"><span class="lineno">  325</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  328</span>            <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  329</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  330</span>            <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> &gt;= ProcessorsCount)</div>
<div class="line"><span class="lineno">  331</span>            {</div>
<div class="line"><span class="lineno">  332</span>                <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno">  333</span>            }</div>
<div class="line"><span class="lineno">  334</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  335</span>            <span class="comment">// Otherwise it&#39;s valid</span></div>
<div class="line"><span class="lineno">  336</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  337</span>            <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a>   = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  338</span>            <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">Value</a>;</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  341</span>            <span class="comment">// Execute it on a single core</span></div>
<div class="line"><span class="lineno">  342</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  343</span>            Status = <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>, (PVOID)<a class="code hl_function" href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a5db83f6e1cbc79c9147fabc0c3b97744">DpcRoutinePerformWriteMsr</a>, NULL);</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>            *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">return</span> Status;</div>
<div class="line"><span class="lineno">  347</span>        }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">// It&#39;s an wrmsr, nothing to return</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  352</span>        *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  353</span>        <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  354</span>    }</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">ActionType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e">DEBUGGER_MSR_READ</a>)</div>
<div class="line"><span class="lineno">  356</span>    {</div>
<div class="line"><span class="lineno">  357</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  358</span>        <span class="comment">// Set Msr to be applied on the target cores</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> == <a class="code hl_define" href="_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a>)</div>
<div class="line"><span class="lineno">  361</span>        {</div>
<div class="line"><span class="lineno">  362</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  363</span>            <span class="comment">// Means that we should apply it on all cores</span></div>
<div class="line"><span class="lineno">  364</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  365</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno">  366</span>            {</div>
<div class="line"><span class="lineno">  367</span>                <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  368</span>            }</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  371</span>            <span class="comment">// Broadcast to all cores to read their Msrs</span></div>
<div class="line"><span class="lineno">  372</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  373</span>            KeGenericCallDpc(<a class="code hl_function" href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#aeac723279c4734876a27723d78950f0a">DpcRoutineReadMsrToAllCores</a>, 0x0);</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  376</span>            <span class="comment">// When we reach here, all processors read their shits</span></div>
<div class="line"><span class="lineno">  377</span>            <span class="comment">// so we have to fill that fucking buffer for user mode</span></div>
<div class="line"><span class="lineno">  378</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  379</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno">  380</span>            {</div>
<div class="line"><span class="lineno">  381</span>                UserBuffer[i] = <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a>;</div>
<div class="line"><span class="lineno">  382</span>            }</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  385</span>            <span class="comment">// It&#39;s an rdmsr we have to return a value for all cores</span></div>
<div class="line"><span class="lineno">  386</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>            *ReturnSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>) * ProcessorsCount;</div>
<div class="line"><span class="lineno">  389</span>            <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  390</span>        }</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  392</span>        {</div>
<div class="line"><span class="lineno">  393</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  394</span>            <span class="comment">// Apply to one core</span></div>
<div class="line"><span class="lineno">  395</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  398</span>            <span class="comment">// Check if the core number is not invalid</span></div>
<div class="line"><span class="lineno">  399</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  400</span>            <span class="keywordflow">if</span> (ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a> &gt;= ProcessorsCount)</div>
<div class="line"><span class="lineno">  401</span>            {</div>
<div class="line"><span class="lineno">  402</span>                *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  403</span>                <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;</div>
<div class="line"><span class="lineno">  404</span>            }</div>
<div class="line"><span class="lineno">  405</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  406</span>            <span class="comment">// Otherwise it&#39;s valid</span></div>
<div class="line"><span class="lineno">  407</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  408</span>            <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">Msr</a> = ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">Msr</a>;</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  411</span>            <span class="comment">// Execute it on a single core</span></div>
<div class="line"><span class="lineno">  412</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  413</span>            Status = <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>, (PVOID)<a class="code hl_function" href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a6b602a352170d025aa12387207214382">DpcRoutinePerformReadMsr</a>, NULL);</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>            <span class="keywordflow">if</span> (Status != STATUS_SUCCESS)</div>
<div class="line"><span class="lineno">  416</span>            {</div>
<div class="line"><span class="lineno">  417</span>                *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  418</span>                <span class="keywordflow">return</span> Status;</div>
<div class="line"><span class="lineno">  419</span>            }</div>
<div class="line"><span class="lineno">  420</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  421</span>            <span class="comment">// Restore the result to the usermode</span></div>
<div class="line"><span class="lineno">  422</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  423</span>            UserBuffer[0] = <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[ReadOrWriteMsrRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">CoreNumber</a>].<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">MsrState</a>.<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">Value</a>;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>            *ReturnSize = <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>);</div>
<div class="line"><span class="lineno">  426</span>            <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  427</span>        }</div>
<div class="line"><span class="lineno">  428</span>    }</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    *ReturnSize = 0;</div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  432</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_constants_8h_html_ad4f1d4dd952194fa7b47a2ed193ea0ed"><div class="ttname"><a href="_constants_8h.html#ad4f1d4dd952194fa7b47a2ed193ea0ed">DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</a></div><div class="ttdeci">#define DEBUGGER_READ_AND_WRITE_ON_MSR_APPLY_ALL_CORES</div><div class="ttdoc">Read and write MSRs to all cores.</div><div class="ttdef"><b>Definition</b> Constants.h:599</div></div>
<div class="ttc" id="a_request_structures_8h_html_a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e"><div class="ttname"><a href="_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a3ef6fa35171ecbbaa97f3a88e619be3e">DEBUGGER_MSR_READ</a></div><div class="ttdeci">@ DEBUGGER_MSR_READ</div><div class="ttdef"><b>Definition</b> RequestStructures.h:431</div></div>
<div class="ttc" id="a_request_structures_8h_html_a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3"><div class="ttname"><a href="_request_structures_8h.html#a9e99d3b0c6a6357a5f021dc82422f789a8b4846619d6bec50232910290764fff3">DEBUGGER_MSR_WRITE</a></div><div class="ttdeci">@ DEBUGGER_MSR_WRITE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:432</div></div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a860d1d5fbe8605d03eda7327935c799e"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a></div><div class="ttdeci">NTSTATUS DpcRoutineRunTaskOnSingleCore(UINT32 CoreNumber, PVOID Routine, PVOID DeferredContext)</div><div class="ttdoc">This function synchronize the function execution for a single core You should only used it for one co...</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:35</div></div>
<div class="ttc" id="ahyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_a5db83f6e1cbc79c9147fabc0c3b97744"><div class="ttname"><a href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a5db83f6e1cbc79c9147fabc0c3b97744">DpcRoutinePerformWriteMsr</a></div><div class="ttdeci">VOID DpcRoutinePerformWriteMsr(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast msr write.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:128</div></div>
<div class="ttc" id="ahyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_a6b602a352170d025aa12387207214382"><div class="ttname"><a href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#a6b602a352170d025aa12387207214382">DpcRoutinePerformReadMsr</a></div><div class="ttdeci">VOID DpcRoutinePerformReadMsr(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast msr read.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:160</div></div>
<div class="ttc" id="ahyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_ac9051976c97907c7b77703fd5b8d5a79"><div class="ttname"><a href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#ac9051976c97907c7b77703fd5b8d5a79">DpcRoutineWriteMsrToAllCores</a></div><div class="ttdeci">VOID DpcRoutineWriteMsrToAllCores(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast Msr Write.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:192</div></div>
<div class="ttc" id="ahyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c_html_aeac723279c4734876a27723d78950f0a"><div class="ttname"><a href="hyperkd_2code_2debugger_2broadcast_2_dpc_routines_8c.html#aeac723279c4734876a27723d78950f0a">DpcRoutineReadMsrToAllCores</a></div><div class="ttdeci">VOID DpcRoutineReadMsrToAllCores(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Broadcast Msr read.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:226</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition</b> Global.h:17</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a1bc8c0010501f9125b025ecb933380d5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a1bc8c0010501f9125b025ecb933380d5">_DEBUGGER_READ_AND_WRITE_ON_MSR::CoreNumber</a></div><div class="ttdeci">UINT32 CoreNumber</div><div class="ttdef"><b>Definition</b> RequestStructures.h:442</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a38a6cf9e2ea5ef31a1f7e888db6dc649"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a38a6cf9e2ea5ef31a1f7e888db6dc649">_DEBUGGER_READ_AND_WRITE_ON_MSR::ActionType</a></div><div class="ttdeci">DEBUGGER_MSR_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:446</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_a3e43511772a5618a6bec9655e8a774d5"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#a3e43511772a5618a6bec9655e8a774d5">_DEBUGGER_READ_AND_WRITE_ON_MSR::Msr</a></div><div class="ttdeci">UINT64 Msr</div><div class="ttdef"><b>Definition</b> RequestStructures.h:441</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r_html_aec2dc73b7eb1f1d455f0399bcb49e929"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___r_e_a_d___a_n_d___w_r_i_t_e___o_n___m_s_r.html#aec2dc73b7eb1f1d455f0399bcb49e929">_DEBUGGER_READ_AND_WRITE_ON_MSR::Value</a></div><div class="ttdeci">UINT64 Value</div><div class="ttdef"><b>Definition</b> RequestStructures.h:447</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e_html_a3ca94b81f31339286eaa6f27eea5804e"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#a3ca94b81f31339286eaa6f27eea5804e">_PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE::Msr</a></div><div class="ttdeci">UINT64 Msr</div><div class="ttdef"><b>Definition</b> State.h:24</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e_html_af0a7d72554edcca419674fb5dbf3608d"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___m_s_r___r_e_a_d___o_r___w_r_i_t_e.html#af0a7d72554edcca419674fb5dbf3608d">_PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE::Value</a></div><div class="ttdeci">UINT64 Value</div><div class="ttdef"><b>Definition</b> State.h:25</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a5d5c22183a428958358e19d6434db8a7"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a5d5c22183a428958358e19d6434db8a7">_PROCESSOR_DEBUGGING_STATE::MsrState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_MSR_READ_OR_WRITE MsrState</div><div class="ttdef"><b>Definition</b> State.h:172</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a552399e58dff411c2c11f789f687f6d1" name="a552399e58dff411c2c11f789f687f6d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a552399e58dff411c2c11f789f687f6d1">&#9670;&#160;</a></span>PerformSearchAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PerformSearchAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>AddressToSaveResults</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>SearchMemRequest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>StartAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>EndAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsDebuggeePaused</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CountOfMatchedCases</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Search on virtual memory (not work on physical memory) </p>
<p>This function can be called from vmx-root mode Do NOT directly call this function as the virtual addresses should be valid on the target process memory layout instead call : SearchAddressWrapper the address between StartAddress and EndAddress should be contiguous</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AddressToSaveResults</td><td>Address to save the search results </td></tr>
    <tr><td class="paramname">SearchMemRequest</td><td>request structure of searching memory </td></tr>
    <tr><td class="paramname">StartAddress</td><td>valid start address based on target process </td></tr>
    <tr><td class="paramname">EndAddress</td><td>valid end address based on target process </td></tr>
    <tr><td class="paramname">IsDebuggeePaused</td><td>Set to true when the search is performed in the debugger mode </td></tr>
    <tr><td class="paramname">CountOfMatchedCases</td><td>Number of matched cases </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Whether the search was successful or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  682</span>{</div>
<div class="line"><span class="lineno">  683</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   CountOfOccurance      = 0;</div>
<div class="line"><span class="lineno">  684</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   Cmp64                 = 0;</div>
<div class="line"><span class="lineno">  685</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   IndexToArrayOfResults = 0;</div>
<div class="line"><span class="lineno">  686</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   LengthOfEachChunk     = 0;</div>
<div class="line"><span class="lineno">  687</span>    PVOID    TempSourceAddress     = 0;</div>
<div class="line"><span class="lineno">  688</span>    PVOID    SourceAddress         = 0;</div>
<div class="line"><span class="lineno">  689</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  StillMatch            = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  690</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   TempValue             = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  691</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> CurrentProcessCr3     = {0};</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  694</span>    <span class="comment">// set chunk size in each modification</span></div>
<div class="line"><span class="lineno">  695</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#ac297aee760a48c7a2d3e31599f435c11">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963ac785cd6f1dc37bf88ba9df2fbba318b3">SEARCH_BYTE</a>)</div>
<div class="line"><span class="lineno">  697</span>    {</div>
<div class="line"><span class="lineno">  698</span>        LengthOfEachChunk = 1;</div>
<div class="line"><span class="lineno">  699</span>    }</div>
<div class="line"><span class="lineno">  700</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#ac297aee760a48c7a2d3e31599f435c11">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963aeb789cc6940c5c8b268c10c51a401414">SEARCH_DWORD</a>)</div>
<div class="line"><span class="lineno">  701</span>    {</div>
<div class="line"><span class="lineno">  702</span>        LengthOfEachChunk = 4;</div>
<div class="line"><span class="lineno">  703</span>    }</div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#ac297aee760a48c7a2d3e31599f435c11">ByteSize</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963a62417cd5ba565c0ddb7556c17fc21429">SEARCH_QWORD</a>)</div>
<div class="line"><span class="lineno">  705</span>    {</div>
<div class="line"><span class="lineno">  706</span>        LengthOfEachChunk = 8;</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  709</span>    {</div>
<div class="line"><span class="lineno">  710</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  711</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  712</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  713</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  714</span>    }</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">// Check if address is virtual address or physical address</span></div>
<div class="line"><span class="lineno">  718</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f">SEARCH_VIRTUAL_MEMORY</a> ||</div>
<div class="line"><span class="lineno">  720</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  721</span>    {</div>
<div class="line"><span class="lineno">  722</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  723</span>        <span class="comment">// Search the memory</span></div>
<div class="line"><span class="lineno">  724</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  727</span>        <span class="comment">// Change the memory layout (cr3), if the user specified a</span></div>
<div class="line"><span class="lineno">  728</span>        <span class="comment">// special process</span></div>
<div class="line"><span class="lineno">  729</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  730</span>        <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  731</span>        {</div>
<div class="line"><span class="lineno">  732</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  733</span>            <span class="comment">// Switch to target process memory layout</span></div>
<div class="line"><span class="lineno">  734</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  735</span>            CurrentProcessCr3 = <a class="code hl_function" href="_switch_layout_8c.html#a25d1e7a8c5f5c7dd0c77e160c03b6d5d">SwitchToProcessMemoryLayoutByCr3</a>(<a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>());</div>
<div class="line"><span class="lineno">  736</span>        }</div>
<div class="line"><span class="lineno">  737</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  738</span>        {</div>
<div class="line"><span class="lineno">  739</span>            <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> != <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()))</div>
<div class="line"><span class="lineno">  740</span>            {</div>
<div class="line"><span class="lineno">  741</span>                CurrentProcessCr3 = <a class="code hl_function" href="_switch_layout_8c.html#aaca153bff30666b372f5aa10d8aa6e8d">SwitchToProcessMemoryLayout</a>(SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno">  742</span>            }</div>
<div class="line"><span class="lineno">  743</span>        }</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  746</span>        <span class="comment">// Here we iterate through the buffer we received from</span></div>
<div class="line"><span class="lineno">  747</span>        <span class="comment">// user-mode</span></div>
<div class="line"><span class="lineno">  748</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  749</span>        SourceAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)SearchMemRequest + <a class="code hl_define" href="_request_structures_8h.html#aa5b6353fd4b161cda4aa699659289c49">SIZEOF_DEBUGGER_SEARCH_MEMORY</a>);</div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> BaseIterator = (<span class="keywordtype">size_t</span>)StartAddress; BaseIterator &lt; ((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)EndAddress); BaseIterator += LengthOfEachChunk)</div>
<div class="line"><span class="lineno">  752</span>        {</div>
<div class="line"><span class="lineno">  753</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  754</span>            <span class="comment">// *** Search the memory ***</span></div>
<div class="line"><span class="lineno">  755</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  758</span>            <span class="comment">// Copy 64bit, 32bit or one byte value into Cmp64 buffer and then compare it</span></div>
<div class="line"><span class="lineno">  759</span>            <span class="comment">// Check if we should access the memory directly, or through safe memory</span></div>
<div class="line"><span class="lineno">  760</span>            <span class="comment">// routine from vmx-root</span></div>
<div class="line"><span class="lineno">  761</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  762</span>            <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  763</span>            {</div>
<div class="line"><span class="lineno">  764</span>                <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)BaseIterator, &amp;Cmp64, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  765</span>            }</div>
<div class="line"><span class="lineno">  766</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  767</span>            {</div>
<div class="line"><span class="lineno">  768</span>                RtlCopyMemory(&amp;Cmp64, (PVOID)BaseIterator, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  769</span>            }</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  772</span>            <span class="comment">// Get the searching bytes</span></div>
<div class="line"><span class="lineno">  773</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  774</span>            TempValue = *(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *)SourceAddress;</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  777</span>            <span class="comment">// Check whether the byte matches the source or not</span></div>
<div class="line"><span class="lineno">  778</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  779</span>            <span class="keywordflow">if</span> (Cmp64 == TempValue)</div>
<div class="line"><span class="lineno">  780</span>            {</div>
<div class="line"><span class="lineno">  781</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  782</span>                <span class="comment">// Indicate that it matches until now</span></div>
<div class="line"><span class="lineno">  783</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  784</span>                StillMatch = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  787</span>                <span class="comment">// Try to check each element (we don&#39;t start from the very first element as</span></div>
<div class="line"><span class="lineno">  788</span>                <span class="comment">// it checked before )</span></div>
<div class="line"><span class="lineno">  789</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  790</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = LengthOfEachChunk; i &lt; SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a6a268effd9f01433890e15e5f4b93f38">CountOf64Chunks</a>; i++)</div>
<div class="line"><span class="lineno">  791</span>                {</div>
<div class="line"><span class="lineno">  792</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  793</span>                    <span class="comment">// I know, we have a double check here ;)</span></div>
<div class="line"><span class="lineno">  794</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  795</span>                    TempSourceAddress = (PVOID)((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)SearchMemRequest + <a class="code hl_define" href="_request_structures_8h.html#aa5b6353fd4b161cda4aa699659289c49">SIZEOF_DEBUGGER_SEARCH_MEMORY</a> + (i * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)));</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  798</span>                    <span class="comment">// Add i to BaseIterator and recompute the Cmp64</span></div>
<div class="line"><span class="lineno">  799</span>                    <span class="comment">// Check if we should access the memory directly, or through safe memory</span></div>
<div class="line"><span class="lineno">  800</span>                    <span class="comment">// routine from vmx-root</span></div>
<div class="line"><span class="lineno">  801</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  802</span>                    <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  803</span>                    {</div>
<div class="line"><span class="lineno">  804</span>                        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)(BaseIterator + (LengthOfEachChunk * i)), &amp;Cmp64, LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  805</span>                    }</div>
<div class="line"><span class="lineno">  806</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  807</span>                    {</div>
<div class="line"><span class="lineno">  808</span>                        RtlCopyMemory(&amp;Cmp64, (PVOID)(BaseIterator + (LengthOfEachChunk * i)), LengthOfEachChunk);</div>
<div class="line"><span class="lineno">  809</span>                    }</div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  812</span>                    <span class="comment">// Check if we should access the memory directly,</span></div>
<div class="line"><span class="lineno">  813</span>                    <span class="comment">// or through safe memory routine from vmx-root</span></div>
<div class="line"><span class="lineno">  814</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  815</span>                    <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  816</span>                    {</div>
<div class="line"><span class="lineno">  817</span>                        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)TempSourceAddress, &amp;TempValue, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>));</div>
<div class="line"><span class="lineno">  818</span>                    }</div>
<div class="line"><span class="lineno">  819</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  820</span>                    {</div>
<div class="line"><span class="lineno">  821</span>                        TempValue = *(<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *)TempSourceAddress;</div>
<div class="line"><span class="lineno">  822</span>                    }</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>                    <span class="keywordflow">if</span> (!(Cmp64 == TempValue))</div>
<div class="line"><span class="lineno">  825</span>                    {</div>
<div class="line"><span class="lineno">  826</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  827</span>                        <span class="comment">// One thing didn&#39;t match so this is not the pattern</span></div>
<div class="line"><span class="lineno">  828</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  829</span>                        StillMatch = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  832</span>                        <span class="comment">// Break from the loop</span></div>
<div class="line"><span class="lineno">  833</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  834</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  835</span>                    }</div>
<div class="line"><span class="lineno">  836</span>                }</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  839</span>                <span class="comment">// Check if we find the pattern or not</span></div>
<div class="line"><span class="lineno">  840</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  841</span>                <span class="keywordflow">if</span> (StillMatch)</div>
<div class="line"><span class="lineno">  842</span>                {</div>
<div class="line"><span class="lineno">  843</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  844</span>                    <span class="comment">// We found the a matching address, let&#39;s save the</span></div>
<div class="line"><span class="lineno">  845</span>                    <span class="comment">// address for future use</span></div>
<div class="line"><span class="lineno">  846</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  847</span>                    CountOfOccurance++;</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>                    <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  850</span>                    {</div>
<div class="line"><span class="lineno">  851</span>                        <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  852</span>                        {</div>
<div class="line"><span class="lineno">  853</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  854</span>                            <span class="comment">// It&#39;s a physical memory</span></div>
<div class="line"><span class="lineno">  855</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  856</span>                            <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a0c38ca677b912fa03329447f5e235dc2">Log</a>(<span class="stringliteral">&quot;%llx\n&quot;</span>, <a class="code hl_function" href="_conversion_8c.html#ab7aedff95075e77cd8fbe128f01d2853">VirtualAddressToPhysicalAddress</a>((PVOID)BaseIterator));</div>
<div class="line"><span class="lineno">  857</span>                        }</div>
<div class="line"><span class="lineno">  858</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  859</span>                        {</div>
<div class="line"><span class="lineno">  860</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  861</span>                            <span class="comment">// It&#39;s a virtual memory</span></div>
<div class="line"><span class="lineno">  862</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  863</span>                            <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a0c38ca677b912fa03329447f5e235dc2">Log</a>(<span class="stringliteral">&quot;%llx\n&quot;</span>, BaseIterator);</div>
<div class="line"><span class="lineno">  864</span>                        }</div>
<div class="line"><span class="lineno">  865</span>                    }</div>
<div class="line"><span class="lineno">  866</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  867</span>                    {</div>
<div class="line"><span class="lineno">  868</span>                        <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  869</span>                        {</div>
<div class="line"><span class="lineno">  870</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  871</span>                            <span class="comment">// It&#39;s a physical memory</span></div>
<div class="line"><span class="lineno">  872</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  873</span>                            AddressToSaveResults[IndexToArrayOfResults] = <a class="code hl_function" href="_conversion_8c.html#ab7aedff95075e77cd8fbe128f01d2853">VirtualAddressToPhysicalAddress</a>((PVOID)BaseIterator);</div>
<div class="line"><span class="lineno">  874</span>                        }</div>
<div class="line"><span class="lineno">  875</span>                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  876</span>                        {</div>
<div class="line"><span class="lineno">  877</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  878</span>                            <span class="comment">// It&#39;s a virtual memory</span></div>
<div class="line"><span class="lineno">  879</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  880</span>                            AddressToSaveResults[IndexToArrayOfResults] = BaseIterator;</div>
<div class="line"><span class="lineno">  881</span>                        }</div>
<div class="line"><span class="lineno">  882</span>                    }</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  885</span>                    <span class="comment">// Increase the array pointer if it doesn&#39;t exceed the limitation</span></div>
<div class="line"><span class="lineno">  886</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  887</span>                    <span class="keywordflow">if</span> (<a class="code hl_define" href="_constants_8h.html#a919acdd5bb356f5a912d3b23b1b927a7">MaximumSearchResults</a> &gt; IndexToArrayOfResults)</div>
<div class="line"><span class="lineno">  888</span>                    {</div>
<div class="line"><span class="lineno">  889</span>                        IndexToArrayOfResults++;</div>
<div class="line"><span class="lineno">  890</span>                    }</div>
<div class="line"><span class="lineno">  891</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  892</span>                    {</div>
<div class="line"><span class="lineno">  893</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  894</span>                        <span class="comment">// The result buffer is full!</span></div>
<div class="line"><span class="lineno">  895</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  896</span>                        *CountOfMatchedCases = CountOfOccurance;</div>
<div class="line"><span class="lineno">  897</span>                        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  898</span>                    }</div>
<div class="line"><span class="lineno">  899</span>                }</div>
<div class="line"><span class="lineno">  900</span>            }</div>
<div class="line"><span class="lineno">  901</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  902</span>            {</div>
<div class="line"><span class="lineno">  903</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  904</span>                <span class="comment">// Not found in the place</span></div>
<div class="line"><span class="lineno">  905</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  906</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  907</span>            }</div>
<div class="line"><span class="lineno">  908</span>        }</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  911</span>        <span class="comment">// Restore the previous memory layout (cr3), if the user specified a</span></div>
<div class="line"><span class="lineno">  912</span>        <span class="comment">// special process</span></div>
<div class="line"><span class="lineno">  913</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  914</span>        <span class="keywordflow">if</span> (IsDebuggeePaused || SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> != <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()))</div>
<div class="line"><span class="lineno">  915</span>        {</div>
<div class="line"><span class="lineno">  916</span>            <a class="code hl_function" href="_switch_layout_8c.html#a1cf82918f5f7b7fe06a46a3e8418761d">SwitchToPreviousProcess</a>(CurrentProcessCr3);</div>
<div class="line"><span class="lineno">  917</span>        }</div>
<div class="line"><span class="lineno">  918</span>    }</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  920</span>    {</div>
<div class="line"><span class="lineno">  921</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  922</span>        <span class="comment">// That&#39;s an error, the physical memory is handled like virtual memory and</span></div>
<div class="line"><span class="lineno">  923</span>        <span class="comment">// thus we should never reach here</span></div>
<div class="line"><span class="lineno">  924</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  925</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, searching physical memory is not allowed without virtual address&quot;</span>);</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  928</span>    }</div>
<div class="line"><span class="lineno">  929</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  930</span>    {</div>
<div class="line"><span class="lineno">  931</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  932</span>        <span class="comment">// Invalid parameter</span></div>
<div class="line"><span class="lineno">  933</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  934</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  935</span>    }</div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  938</span>    <span class="comment">// As we&#39;re here the search is finished without error</span></div>
<div class="line"><span class="lineno">  939</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  940</span>    *CountOfMatchedCases = CountOfOccurance;</div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  942</span>}</div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a0c38ca677b912fa03329447f5e235dc2"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a0c38ca677b912fa03329447f5e235dc2">Log</a></div><div class="ttdeci">#define Log(format,...)</div><div class="ttdoc">Log without any prefix.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:129</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="a_layout_8c_html_af74e610cf3ad5dd8c972f536f2809429"><div class="ttname"><a href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a></div><div class="ttdeci">CR3_TYPE LayoutGetCurrentProcessCr3()</div><div class="ttdoc">Get cr3 of the target running process.</div><div class="ttdef"><b>Definition</b> Layout.c:55</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_ac3c23d5644111a6be18ca274f448e9ff"><div class="ttname"><a href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafe(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1101</div></div>
<div class="ttc" id="a_request_structures_8h_html_a62b2bbc3f6885590fa15669db073b963a62417cd5ba565c0ddb7556c17fc21429"><div class="ttname"><a href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963a62417cd5ba565c0ddb7556c17fc21429">SEARCH_QWORD</a></div><div class="ttdeci">@ SEARCH_QWORD</div><div class="ttdef"><b>Definition</b> RequestStructures.h:518</div></div>
<div class="ttc" id="a_request_structures_8h_html_a62b2bbc3f6885590fa15669db073b963ac785cd6f1dc37bf88ba9df2fbba318b3"><div class="ttname"><a href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963ac785cd6f1dc37bf88ba9df2fbba318b3">SEARCH_BYTE</a></div><div class="ttdeci">@ SEARCH_BYTE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:516</div></div>
<div class="ttc" id="a_request_structures_8h_html_a62b2bbc3f6885590fa15669db073b963aeb789cc6940c5c8b268c10c51a401414"><div class="ttname"><a href="_request_structures_8h.html#a62b2bbc3f6885590fa15669db073b963aeb789cc6940c5c8b268c10c51a401414">SEARCH_DWORD</a></div><div class="ttdeci">@ SEARCH_DWORD</div><div class="ttdef"><b>Definition</b> RequestStructures.h:517</div></div>
<div class="ttc" id="a_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c"><div class="ttname"><a href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:506</div></div>
<div class="ttc" id="a_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413"><div class="ttname"><a href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_PHYSICAL_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:504</div></div>
<div class="ttc" id="a_request_structures_8h_html_a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f"><div class="ttname"><a href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f">SEARCH_VIRTUAL_MEMORY</a></div><div class="ttdeci">@ SEARCH_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:505</div></div>
<div class="ttc" id="a_request_structures_8h_html_aa5b6353fd4b161cda4aa699659289c49"><div class="ttname"><a href="_request_structures_8h.html#aa5b6353fd4b161cda4aa699659289c49">SIZEOF_DEBUGGER_SEARCH_MEMORY</a></div><div class="ttdeci">#define SIZEOF_DEBUGGER_SEARCH_MEMORY</div><div class="ttdef"><b>Definition</b> RequestStructures.h:496</div></div>
<div class="ttc" id="a_switch_layout_8c_html_a1cf82918f5f7b7fe06a46a3e8418761d"><div class="ttname"><a href="_switch_layout_8c.html#a1cf82918f5f7b7fe06a46a3e8418761d">SwitchToPreviousProcess</a></div><div class="ttdeci">_Use_decl_annotations_ VOID SwitchToPreviousProcess(CR3_TYPE PreviousProcess)</div><div class="ttdoc">Switch to previous process's cr3.</div><div class="ttdef"><b>Definition</b> SwitchLayout.c:125</div></div>
<div class="ttc" id="a_switch_layout_8c_html_a25d1e7a8c5f5c7dd0c77e160c03b6d5d"><div class="ttname"><a href="_switch_layout_8c.html#a25d1e7a8c5f5c7dd0c77e160c03b6d5d">SwitchToProcessMemoryLayoutByCr3</a></div><div class="ttdeci">_Use_decl_annotations_ CR3_TYPE SwitchToProcessMemoryLayoutByCr3(CR3_TYPE TargetCr3)</div><div class="ttdoc">Switch to another process's cr3.</div><div class="ttdef"><b>Definition</b> SwitchLayout.c:99</div></div>
<div class="ttc" id="a_switch_layout_8c_html_aaca153bff30666b372f5aa10d8aa6e8d"><div class="ttname"><a href="_switch_layout_8c.html#aaca153bff30666b372f5aa10d8aa6e8d">SwitchToProcessMemoryLayout</a></div><div class="ttdeci">_Use_decl_annotations_ CR3_TYPE SwitchToProcessMemoryLayout(UINT32 ProcessId)</div><div class="ttdoc">Switch to another process's cr3.</div><div class="ttdef"><b>Definition</b> SwitchLayout.c:25</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition</b> BasicTypes.h:130</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_a6a268effd9f01433890e15e5f4b93f38"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a6a268effd9f01433890e15e5f4b93f38">_DEBUGGER_SEARCH_MEMORY::CountOf64Chunks</a></div><div class="ttdeci">UINT32 CountOf64Chunks</div><div class="ttdef"><b>Definition</b> RequestStructures.h:533</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_ac297aee760a48c7a2d3e31599f435c11"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#ac297aee760a48c7a2d3e31599f435c11">_DEBUGGER_SEARCH_MEMORY::ByteSize</a></div><div class="ttdeci">DEBUGGER_SEARCH_MEMORY_BYTE_SIZE ByteSize</div><div class="ttdef"><b>Definition</b> RequestStructures.h:532</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y_html_afd5dfd7402859985dd21a6cd8cf9e52d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">_DEBUGGER_SEARCH_MEMORY::MemoryType</a></div><div class="ttdeci">DEBUGGER_SEARCH_MEMORY_TYPE MemoryType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:531</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa2b3b7d14e79251d6e4b20dff257500a" name="aa2b3b7d14e79251d6e4b20dff257500a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2b3b7d14e79251d6e4b20dff257500a">&#9670;&#160;</a></span>SearchAddressWrapper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SearchAddressWrapper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ad413c7f23e00f0764dfa0ab21b6442a0">PUINT64</a></td>          <td class="paramname"><span class="paramname"><em>AddressToSaveResults</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a259329cf5d90fa23392810c8705398cf">PDEBUGGER_SEARCH_MEMORY</a></td>          <td class="paramname"><span class="paramname"><em>SearchMemRequest</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>StartAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>EndAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsDebuggeePaused</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a8e3d0f172defb4e820ad5df4ec48960c">PUINT32</a></td>          <td class="paramname"><span class="paramname"><em>CountOfMatchedCases</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The wrapper to check for validity of addresses and call the search routines for both physical and virtual memory. </p>
<p>This function can be called from vmx-root mode The address between start address and end address will be checked to make a contiguous address</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">AddressToSaveResults</td><td>Address to save the search results </td></tr>
    <tr><td class="paramname">SearchMemRequest</td><td>request structure of searching memory </td></tr>
    <tr><td class="paramname">StartAddress</td><td>start address of searching based on target process </td></tr>
    <tr><td class="paramname">EndAddress</td><td>start address of searching based on target process </td></tr>
    <tr><td class="paramname">IsDebuggeePaused</td><td>Set to true when the search is performed in the debugger mode </td></tr>
    <tr><td class="paramname">CountOfMatchedCases</td><td>Number of matched cases </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Whether there was any error or not </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  968</span>{</div>
<div class="line"><span class="lineno">  969</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> CurrentProcessCr3;</div>
<div class="line"><span class="lineno">  970</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   BaseAddress         = 0;</div>
<div class="line"><span class="lineno">  971</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   RealPhysicalAddress = 0;</div>
<div class="line"><span class="lineno">  972</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   TempValue           = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  973</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   TempStartAddress    = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  974</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  DoesBaseAddrSaved   = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  975</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  SearchResult        = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  978</span>    <span class="comment">// Reset the count of matched cases</span></div>
<div class="line"><span class="lineno">  979</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  980</span>    *CountOfMatchedCases = 0;</div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span>    <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504ae14e659c808936a0652a52719478054f">SEARCH_VIRTUAL_MEMORY</a>)</div>
<div class="line"><span class="lineno">  983</span>    {</div>
<div class="line"><span class="lineno">  984</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  985</span>        <span class="comment">// It&#39;s a virtual address search</span></div>
<div class="line"><span class="lineno">  986</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  989</span>        <span class="comment">// Align the page and search with alignment</span></div>
<div class="line"><span class="lineno">  990</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  991</span>        TempStartAddress = StartAddress;</div>
<div class="line"><span class="lineno">  992</span>        StartAddress     = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>(StartAddress);</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>        <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno">  995</span>        {</div>
<div class="line"><span class="lineno">  996</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  997</span>            <span class="comment">// Switch to new process&#39;s memory layout</span></div>
<div class="line"><span class="lineno">  998</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  999</span>            CurrentProcessCr3 = <a class="code hl_function" href="_switch_layout_8c.html#a25d1e7a8c5f5c7dd0c77e160c03b6d5d">SwitchToProcessMemoryLayoutByCr3</a>(<a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>());</div>
<div class="line"><span class="lineno"> 1000</span>        }</div>
<div class="line"><span class="lineno"> 1001</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1002</span>        {</div>
<div class="line"><span class="lineno"> 1003</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1004</span>            <span class="comment">// Switch to new process&#39;s memory layout</span></div>
<div class="line"><span class="lineno"> 1005</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1006</span>            CurrentProcessCr3 = <a class="code hl_function" href="_switch_layout_8c.html#aaca153bff30666b372f5aa10d8aa6e8d">SwitchToProcessMemoryLayout</a>(SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno"> 1007</span>        }</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1010</span>        <span class="comment">// We will try to find a contigues address</span></div>
<div class="line"><span class="lineno"> 1011</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1012</span>        <span class="keywordflow">while</span> (StartAddress &lt; EndAddress)</div>
<div class="line"><span class="lineno"> 1013</span>        {</div>
<div class="line"><span class="lineno"> 1014</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1015</span>            <span class="comment">// Check if address is valid or not</span></div>
<div class="line"><span class="lineno"> 1016</span>            <span class="comment">// Generally, we can use VirtualAddressToPhysicalAddressByProcessId</span></div>
<div class="line"><span class="lineno"> 1017</span>            <span class="comment">// but let&#39;s not change the cr3 multiple times</span></div>
<div class="line"><span class="lineno"> 1018</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1019</span>            TempValue = <a class="code hl_function" href="_conversion_8c.html#ab7aedff95075e77cd8fbe128f01d2853">VirtualAddressToPhysicalAddress</a>((PVOID)StartAddress);</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span>            <span class="keywordflow">if</span> (TempValue != 0)</div>
<div class="line"><span class="lineno"> 1022</span>            {</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1024</span>                <span class="comment">// Address is valid, let&#39;s add a page size to it</span></div>
<div class="line"><span class="lineno"> 1025</span>                <span class="comment">// nothing to do</span></div>
<div class="line"><span class="lineno"> 1026</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1027</span>                <span class="keywordflow">if</span> (!DoesBaseAddrSaved)</div>
<div class="line"><span class="lineno"> 1028</span>                {</div>
<div class="line"><span class="lineno"> 1029</span>                    BaseAddress       = TempStartAddress;</div>
<div class="line"><span class="lineno"> 1030</span>                    DoesBaseAddrSaved = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1031</span>                }</div>
<div class="line"><span class="lineno"> 1032</span>            }</div>
<div class="line"><span class="lineno"> 1033</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1034</span>            {</div>
<div class="line"><span class="lineno"> 1035</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1036</span>                <span class="comment">// Address is not valid anymore</span></div>
<div class="line"><span class="lineno"> 1037</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1038</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1039</span>            }</div>
<div class="line"><span class="lineno"> 1040</span> </div>
<div class="line"><span class="lineno"> 1041</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1042</span>            <span class="comment">// Make the start address ready for next address</span></div>
<div class="line"><span class="lineno"> 1043</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1044</span>            StartAddress += <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>;</div>
<div class="line"><span class="lineno"> 1045</span>        }</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1048</span>        <span class="comment">// Restore the original process</span></div>
<div class="line"><span class="lineno"> 1049</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1050</span>        <a class="code hl_function" href="_switch_layout_8c.html#a1cf82918f5f7b7fe06a46a3e8418761d">SwitchToPreviousProcess</a>(CurrentProcessCr3);</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1053</span>        <span class="comment">// All of the address chunk was valid</span></div>
<div class="line"><span class="lineno"> 1054</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1055</span>        <span class="keywordflow">if</span> (DoesBaseAddrSaved &amp;&amp; StartAddress &gt; BaseAddress)</div>
<div class="line"><span class="lineno"> 1056</span>        {</div>
<div class="line"><span class="lineno"> 1057</span>            SearchResult = <a class="code hl_function" href="#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a>(AddressToSaveResults,</div>
<div class="line"><span class="lineno"> 1058</span>                                                SearchMemRequest,</div>
<div class="line"><span class="lineno"> 1059</span>                                                BaseAddress,</div>
<div class="line"><span class="lineno"> 1060</span>                                                EndAddress,</div>
<div class="line"><span class="lineno"> 1061</span>                                                IsDebuggeePaused,</div>
<div class="line"><span class="lineno"> 1062</span>                                                CountOfMatchedCases);</div>
<div class="line"><span class="lineno"> 1063</span>        }</div>
<div class="line"><span class="lineno"> 1064</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1065</span>        {</div>
<div class="line"><span class="lineno"> 1066</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1067</span>            <span class="comment">// There was an error, address was probably not contiguous</span></div>
<div class="line"><span class="lineno"> 1068</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1069</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1070</span>        }</div>
<div class="line"><span class="lineno"> 1071</span>    }</div>
<div class="line"><span class="lineno"> 1072</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> == <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a>)</div>
<div class="line"><span class="lineno"> 1073</span>    {</div>
<div class="line"><span class="lineno"> 1074</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1075</span>        <span class="comment">// when we reached here, we know that it&#39;s a valid physical memory,</span></div>
<div class="line"><span class="lineno"> 1076</span>        <span class="comment">// so we change the structure and pass it as a virtual address to</span></div>
<div class="line"><span class="lineno"> 1077</span>        <span class="comment">// the search function</span></div>
<div class="line"><span class="lineno"> 1078</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1079</span>        RealPhysicalAddress = SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>;</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1082</span>        <span class="comment">// Change the start address</span></div>
<div class="line"><span class="lineno"> 1083</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1084</span>        <span class="keywordflow">if</span> (IsDebuggeePaused)</div>
<div class="line"><span class="lineno"> 1085</span>        {</div>
<div class="line"><span class="lineno"> 1086</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="_conversion_8c.html#a512f6b5eb5218445aa58489b8f9d8593">PhysicalAddressToVirtualAddressOnTargetProcess</a>((PVOID)StartAddress);</div>
<div class="line"><span class="lineno"> 1087</span>            EndAddress                = <a class="code hl_function" href="_conversion_8c.html#a512f6b5eb5218445aa58489b8f9d8593">PhysicalAddressToVirtualAddressOnTargetProcess</a>((PVOID)EndAddress);</div>
<div class="line"><span class="lineno"> 1088</span>        }</div>
<div class="line"><span class="lineno"> 1089</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a> == <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()))</div>
<div class="line"><span class="lineno"> 1090</span>        {</div>
<div class="line"><span class="lineno"> 1091</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="_conversion_8c.html#af7f8cac9416a0d6568c820e4437e672c">PhysicalAddressToVirtualAddress</a>(StartAddress);</div>
<div class="line"><span class="lineno"> 1092</span>            EndAddress                = <a class="code hl_function" href="_conversion_8c.html#af7f8cac9416a0d6568c820e4437e672c">PhysicalAddressToVirtualAddress</a>(EndAddress);</div>
<div class="line"><span class="lineno"> 1093</span>        }</div>
<div class="line"><span class="lineno"> 1094</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1095</span>        {</div>
<div class="line"><span class="lineno"> 1096</span>            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a> = <a class="code hl_function" href="_conversion_8c.html#ac6482780667d9d17160287439da81d3d">PhysicalAddressToVirtualAddressByProcessId</a>((PVOID)StartAddress,</div>
<div class="line"><span class="lineno"> 1097</span>                                                                                   SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno"> 1098</span>            EndAddress                = <a class="code hl_function" href="_conversion_8c.html#ac6482780667d9d17160287439da81d3d">PhysicalAddressToVirtualAddressByProcessId</a>((PVOID)EndAddress,</div>
<div class="line"><span class="lineno"> 1099</span>                                                                    SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a2286bb7292ad9a907133af3a8de82ac7">ProcessId</a>);</div>
<div class="line"><span class="lineno"> 1100</span>        }</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1103</span>        <span class="comment">// Change the type of memory</span></div>
<div class="line"><span class="lineno"> 1104</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1105</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504a7f8d2eefc188e4c88e6b759f7784800c">SEARCH_PHYSICAL_FROM_VIRTUAL_MEMORY</a>;</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1108</span>        <span class="comment">// Call the wrapper</span></div>
<div class="line"><span class="lineno"> 1109</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1110</span>        SearchResult = <a class="code hl_function" href="#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a>(AddressToSaveResults,</div>
<div class="line"><span class="lineno"> 1111</span>                                            SearchMemRequest,</div>
<div class="line"><span class="lineno"> 1112</span>                                            SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>,</div>
<div class="line"><span class="lineno"> 1113</span>                                            EndAddress,</div>
<div class="line"><span class="lineno"> 1114</span>                                            IsDebuggeePaused,</div>
<div class="line"><span class="lineno"> 1115</span>                                            CountOfMatchedCases);</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1118</span>        <span class="comment">// Restore the previous state</span></div>
<div class="line"><span class="lineno"> 1119</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1120</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#afd5dfd7402859985dd21a6cd8cf9e52d">MemoryType</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#a84380c5425f8362a9e7ebc8ae0d7a504abc233c6bd13bd067efef1cb07135b413">SEARCH_PHYSICAL_MEMORY</a>;</div>
<div class="line"><span class="lineno"> 1121</span>        SearchMemRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___s_e_a_r_c_h___m_e_m_o_r_y.html#a93f60f8bba58373d242567705f2d147a">Address</a>    = RealPhysicalAddress;</div>
<div class="line"><span class="lineno"> 1122</span>    }</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="keywordflow">return</span> SearchResult;</div>
<div class="line"><span class="lineno"> 1125</span>}</div>
<div class="ttc" id="a_conversion_8c_html_a512f6b5eb5218445aa58489b8f9d8593"><div class="ttname"><a href="_conversion_8c.html#a512f6b5eb5218445aa58489b8f9d8593">PhysicalAddressToVirtualAddressOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 PhysicalAddressToVirtualAddressOnTargetProcess(PVOID PhysicalAddress)</div><div class="ttdoc">Converts Physical Address to Virtual Address based on current process's kernel cr3.</div><div class="ttdef"><b>Definition</b> Conversion.c:137</div></div>
<div class="ttc" id="a_conversion_8c_html_ac6482780667d9d17160287439da81d3d"><div class="ttname"><a href="_conversion_8c.html#ac6482780667d9d17160287439da81d3d">PhysicalAddressToVirtualAddressByProcessId</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 PhysicalAddressToVirtualAddressByProcessId(PVOID PhysicalAddress, UINT32 ProcessId)</div><div class="ttdoc">Converts Physical Address to Virtual Address based on a specific process id.</div><div class="ttdef"><b>Definition</b> Conversion.c:42</div></div>
<div class="ttc" id="a_conversion_8c_html_af7f8cac9416a0d6568c820e4437e672c"><div class="ttname"><a href="_conversion_8c.html#af7f8cac9416a0d6568c820e4437e672c">PhysicalAddressToVirtualAddress</a></div><div class="ttdeci">_Use_decl_annotations_ UINT64 PhysicalAddressToVirtualAddress(UINT64 PhysicalAddress)</div><div class="ttdoc">Converts Physical Address to Virtual Address.</div><div class="ttdef"><b>Definition</b> Conversion.c:22</div></div>
<div class="ttc" id="a_debugger_commands_8c_html_a552399e58dff411c2c11f789f687f6d1"><div class="ttname"><a href="#a552399e58dff411c2c11f789f687f6d1">PerformSearchAddress</a></div><div class="ttdeci">BOOLEAN PerformSearchAddress(UINT64 *AddressToSaveResults, PDEBUGGER_SEARCH_MEMORY SearchMemRequest, UINT64 StartAddress, UINT64 EndAddress, BOOLEAN IsDebuggeePaused, PUINT32 CountOfMatchedCases)</div><div class="ttdoc">Search on virtual memory (not work on physical memory)</div><div class="ttdef"><b>Definition</b> DebuggerCommands.c:676</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition</b> common.h:69</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_aa02188de52b66a3aa5e1aecc6bd963ae"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a></div><div class="ttdeci">#define PAGE_ALIGN(Va)</div><div class="ttdoc">Aligning a page.</div><div class="ttdef"><b>Definition</b> common.h:75</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_fd401680aa8c7ceffc479e97f6bdc4df.html">hyperkd</a></li><li class="navelem"><a class="el" href="dir_587853473f29459994cc5353647295ff.html">code</a></li><li class="navelem"><a class="el" href="dir_366222a910cb7e5dbd8918e7b8c2300f.html">debugger</a></li><li class="navelem"><a class="el" href="dir_0fc101762e08047bdc63959491aca858.html">commands</a></li><li class="navelem"><a class="el" href="_debugger_commands_8c.html">DebuggerCommands.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
