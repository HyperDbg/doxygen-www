<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperkd/code/debugger/core/HaltedCore.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_halted_core_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">HaltedCore.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of applying events in halted cores.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a45953d9cb5db20789a88dffb93246d87" id="r_a45953d9cb5db20789a88dffb93246d87"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45953d9cb5db20789a88dffb93246d87">HaltedCoreTaskTest</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a45953d9cb5db20789a88dffb93246d87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the test task on halted core.  <br /></td></tr>
<tr class="separator:a45953d9cb5db20789a88dffb93246d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea1b886f9a8ea60c897b656b66e22b5e" id="r_aea1b886f9a8ea60c897b656b66e22b5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetTask, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:aea1b886f9a8ea60c897b656b66e22b5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the task on halted core.  <br /></td></tr>
<tr class="separator:aea1b886f9a8ea60c897b656b66e22b5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495328e6ad3239509d43e9170b3e4d69" id="r_a495328e6ad3239509d43e9170b3e4d69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a495328e6ad3239509d43e9170b3e4d69">HaltedCoreApplyTaskOnTargetCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetTask, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> LockAgainAfterTask, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a495328e6ad3239509d43e9170b3e4d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the task on a single halted core.  <br /></td></tr>
<tr class="separator:a495328e6ad3239509d43e9170b3e4d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cd34dbc54d14ab8a4fd5cdc4c307e34" id="r_a6cd34dbc54d14ab8a4fd5cdc4c307e34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cd34dbc54d14ab8a4fd5cdc4c307e34">HaltedCoreRunTaskOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetTask, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> LockAgainAfterTask, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a6cd34dbc54d14ab8a4fd5cdc4c307e34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the task on a single halted core.  <br /></td></tr>
<tr class="separator:a6cd34dbc54d14ab8a4fd5cdc4c307e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1941536fe5f56c09494b64a4920cd1f" id="r_ac1941536fe5f56c09494b64a4920cd1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac1941536fe5f56c09494b64a4920cd1f">HaltedCoreBroadcastTaskAllCores</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetTask, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> LockAgainAfterTask, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> Synchronize, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:ac1941536fe5f56c09494b64a4920cd1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast tasks to halted cores.  <br /></td></tr>
<tr class="separator:ac1941536fe5f56c09494b64a4920cd1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of applying events in halted cores. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.7 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2023-09-30</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a495328e6ad3239509d43e9170b3e4d69" name="a495328e6ad3239509d43e9170b3e4d69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a495328e6ad3239509d43e9170b3e4d69">&#9670;&#160;</a></span>HaltedCoreApplyTaskOnTargetCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> HaltedCoreApplyTaskOnTargetCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>TargetTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>LockAgainAfterTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the task on a single halted core. </p>
<p>This function should be called from VMX root-mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">TargetTask</td><td>The target task </td></tr>
    <tr><td class="paramname">LockAgainAfterTask</td><td>Lock the core after the task </td></tr>
    <tr><td class="paramname">Context</td><td>optional parameter passed to the functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  325</span>{</div>
<div class="line"><span class="lineno">  326</span>    <a class="code hl_struct" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">PROCESSOR_DEBUGGING_STATE</a> * DbgState = &amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[TargetCoreId];</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  329</span>    <span class="comment">// Activate running the halted task</span></div>
<div class="line"><span class="lineno">  330</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  331</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8a198fb109fc974a7a8bbab43b6be438">PerformHaltedTask</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a269fd3aad1fac0454ceed9075c944c8a">KernelStatus</a>       = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  334</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a0e4361d30047e9ec9443c4b490602f6d">LockAgainAfterTask</a> = LockAgainAfterTask;</div>
<div class="line"><span class="lineno">  335</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8e9ff1678a75061627e6f562a3442497">TargetTask</a>         = TargetTask;</div>
<div class="line"><span class="lineno">  336</span>    DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">HaltedCoreTask</a>.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a6cdb6316111383cf8f9f6087398fe470">Context</a>            = <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>;</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">// Unlock halted core</span></div>
<div class="line"><span class="lineno">  340</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  341</span>    <a class="code hl_function" href="_kd_8c.html#ad53861a47c60820feee3d0bc2351285a">KdUnlockTheHaltedCore</a>(DbgState);</div>
<div class="line"><span class="lineno">  342</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_kd_8c_html_ad53861a47c60820feee3d0bc2351285a"><div class="ttname"><a href="_kd_8c.html#ad53861a47c60820feee3d0bc2351285a">KdUnlockTheHaltedCore</a></div><div class="ttdeci">VOID KdUnlockTheHaltedCore(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">unlock the target core</div><div class="ttdef"><b>Definition</b> Kd.c:1812</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_dpc_8h_html_a446af93100756f0d846f1bfe80e30b4b"><div class="ttname"><a href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a></div><div class="ttdeci">NTKERNELAPI _In_opt_ PVOID Context</div><div class="ttdef"><b>Definition</b> Dpc.h:25</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a349ee1adc363d2e4323a35a68fae5646"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a></div><div class="ttdeci">PROCESSOR_DEBUGGING_STATE * g_DbgState</div><div class="ttdoc">Save the state and variables related to debugging on each to logical core.</div><div class="ttdef"><b>Definition</b> Global.h:17</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a0e4361d30047e9ec9443c4b490602f6d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a0e4361d30047e9ec9443c4b490602f6d">_DEBUGGEE_HALTED_CORE_TASK::LockAgainAfterTask</a></div><div class="ttdeci">BOOLEAN LockAgainAfterTask</div><div class="ttdef"><b>Definition</b> State.h:139</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a269fd3aad1fac0454ceed9075c944c8a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a269fd3aad1fac0454ceed9075c944c8a">_DEBUGGEE_HALTED_CORE_TASK::KernelStatus</a></div><div class="ttdeci">UINT64 KernelStatus</div><div class="ttdef"><b>Definition</b> State.h:142</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a6cdb6316111383cf8f9f6087398fe470"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a6cdb6316111383cf8f9f6087398fe470">_DEBUGGEE_HALTED_CORE_TASK::Context</a></div><div class="ttdeci">PVOID Context</div><div class="ttdef"><b>Definition</b> State.h:141</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a8a198fb109fc974a7a8bbab43b6be438"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8a198fb109fc974a7a8bbab43b6be438">_DEBUGGEE_HALTED_CORE_TASK::PerformHaltedTask</a></div><div class="ttdeci">BOOLEAN PerformHaltedTask</div><div class="ttdef"><b>Definition</b> State.h:138</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k_html_a8e9ff1678a75061627e6f562a3442497"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___h_a_l_t_e_d___c_o_r_e___t_a_s_k.html#a8e9ff1678a75061627e6f562a3442497">_DEBUGGEE_HALTED_CORE_TASK::TargetTask</a></div><div class="ttdeci">UINT64 TargetTask</div><div class="ttdef"><b>Definition</b> State.h:140</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html">_PROCESSOR_DEBUGGING_STATE</a></div><div class="ttdoc">Saves the debugger state.</div><div class="ttdef"><b>Definition</b> State.h:165</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_adcf7b3f5a76564010eace3a94979c699"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#adcf7b3f5a76564010eace3a94979c699">_PROCESSOR_DEBUGGING_STATE::HaltedCoreTask</a></div><div class="ttdeci">DEBUGGEE_HALTED_CORE_TASK HaltedCoreTask</div><div class="ttdef"><b>Definition</b> State.h:180</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1941536fe5f56c09494b64a4920cd1f" name="ac1941536fe5f56c09494b64a4920cd1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1941536fe5f56c09494b64a4920cd1f">&#9670;&#160;</a></span>HaltedCoreBroadcastTaskAllCores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> HaltedCoreBroadcastTaskAllCores </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>TargetTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>LockAgainAfterTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>Synchronize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Broadcast tasks to halted cores. </p>
<p>This function should be called from VMX root-mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">TargetTask</td><td>The target task </td></tr>
    <tr><td class="paramname">LockAgainAfterTask</td><td>Lock the core after the task </td></tr>
    <tr><td class="paramname">Synchronize</td><td>Whether the function should wait for all cores to synchronize and lock again or not </td></tr>
    <tr><td class="paramname">Context</td><td>optional parameter passed to the functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  404</span>{</div>
<div class="line"><span class="lineno">  405</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> ProcessorsCount;</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    ProcessorsCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  410</span>    <span class="comment">// Synchronization is not possible when the locking after the task is</span></div>
<div class="line"><span class="lineno">  411</span>    <span class="comment">// not expected</span></div>
<div class="line"><span class="lineno">  412</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordflow">if</span> (Synchronize &amp;&amp; !LockAgainAfterTask)</div>
<div class="line"><span class="lineno">  414</span>    {</div>
<div class="line"><span class="lineno">  415</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a>(<span class="stringliteral">&quot;Synchronization is not possible when the locking after the task is not expected&quot;</span>);</div>
<div class="line"><span class="lineno">  416</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  417</span>    }</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// Apply the task to all cores except current core</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno">  423</span>    {</div>
<div class="line"><span class="lineno">  424</span>        <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a> != i)</div>
<div class="line"><span class="lineno">  425</span>        {</div>
<div class="line"><span class="lineno">  426</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  427</span>            <span class="comment">// apply task to the target core</span></div>
<div class="line"><span class="lineno">  428</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  429</span>            <a class="code hl_function" href="#a495328e6ad3239509d43e9170b3e4d69">HaltedCoreApplyTaskOnTargetCore</a>(i, TargetTask, LockAgainAfterTask, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  430</span>        }</div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  432</span>        {</div>
<div class="line"><span class="lineno">  433</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  434</span>            <span class="comment">// Perform the task for the current core</span></div>
<div class="line"><span class="lineno">  435</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  436</span>            <a class="code hl_function" href="#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a>(DbgState, TargetTask, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  437</span>        }</div>
<div class="line"><span class="lineno">  438</span>    }</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="comment">// If synchronization is expected, we need to check to make sure</span></div>
<div class="line"><span class="lineno">  442</span>    <span class="comment">// all cores are synchronized (locked) at this point or not</span></div>
<div class="line"><span class="lineno">  443</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">if</span> (Synchronize)</div>
<div class="line"><span class="lineno">  445</span>    {</div>
<div class="line"><span class="lineno">  446</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno">  447</span>        {</div>
<div class="line"><span class="lineno">  448</span>            <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a> != i)</div>
<div class="line"><span class="lineno">  449</span>            {</div>
<div class="line"><span class="lineno">  450</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  451</span>                <span class="comment">// Wait until the core is locked again</span></div>
<div class="line"><span class="lineno">  452</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  453</span>                <span class="keywordflow">while</span> (<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno">  454</span>                {</div>
<div class="line"><span class="lineno">  455</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  456</span>                    <span class="comment">// Keep checking to make sure the target core finished the</span></div>
<div class="line"><span class="lineno">  457</span>                    <span class="comment">// execution its task and locked again</span></div>
<div class="line"><span class="lineno">  458</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  459</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="_kd_8c.html#ac229aecc3edc3d24c062528ccfd7e431">KdCheckTheHaltedCore</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[i]) == <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><span class="lineno">  460</span>                    {</div>
<div class="line"><span class="lineno">  461</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  462</span>                    }</div>
<div class="line"><span class="lineno">  463</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  464</span>                    {</div>
<div class="line"><span class="lineno">  465</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  466</span>                    }</div>
<div class="line"><span class="lineno">  467</span>                }</div>
<div class="line"><span class="lineno">  468</span>            }</div>
<div class="line"><span class="lineno">  469</span>        }</div>
<div class="line"><span class="lineno">  470</span>    }</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">// All cores locked again</span></div>
<div class="line"><span class="lineno">  474</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  476</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_halted_core_8c_html_a495328e6ad3239509d43e9170b3e4d69"><div class="ttname"><a href="#a495328e6ad3239509d43e9170b3e4d69">HaltedCoreApplyTaskOnTargetCore</a></div><div class="ttdeci">VOID HaltedCoreApplyTaskOnTargetCore(UINT32 TargetCoreId, UINT64 TargetTask, BOOLEAN LockAgainAfterTask, PVOID Context)</div><div class="ttdoc">Run the task on a single halted core.</div><div class="ttdef"><b>Definition</b> HaltedCore.c:321</div></div>
<div class="ttc" id="a_halted_core_8c_html_aea1b886f9a8ea60c897b656b66e22b5e"><div class="ttname"><a href="#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a></div><div class="ttdeci">VOID HaltedCorePerformTargetTask(PROCESSOR_DEBUGGING_STATE *DbgState, UINT64 TargetTask, PVOID Context)</div><div class="ttdoc">Perform the task on halted core.</div><div class="ttdef"><b>Definition</b> HaltedCore.c:45</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_abf506c814a6f717a87b5d808b828ef56"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a></div><div class="ttdeci">#define LogWarning(format,...)</div><div class="ttdoc">Log in the case of warning.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:99</div></div>
<div class="ttc" id="a_kd_8c_html_ac229aecc3edc3d24c062528ccfd7e431"><div class="ttname"><a href="_kd_8c.html#ac229aecc3edc3d24c062528ccfd7e431">KdCheckTheHaltedCore</a></div><div class="ttdeci">BOOLEAN KdCheckTheHaltedCore(PROCESSOR_DEBUGGING_STATE *DbgState)</div><div class="ttdoc">check the lock state of the target core</div><div class="ttdef"><b>Definition</b> Kd.c:1825</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:169</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea1b886f9a8ea60c897b656b66e22b5e" name="aea1b886f9a8ea60c897b656b66e22b5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea1b886f9a8ea60c897b656b66e22b5e">&#9670;&#160;</a></span>HaltedCorePerformTargetTask()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> HaltedCorePerformTargetTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>TargetTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the task on halted core. </p>
<p>This function should be called from VMX root-mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">TargetTask</td><td>The target task </td></tr>
    <tr><td class="paramname">Context</td><td>optional parameter passed to the functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   48</span>{</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">switch</span> (TargetTask)</div>
<div class="line"><span class="lineno">   50</span>    {</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#aa7058409e351e0ec55063b5335a8b247">DEBUGGER_HALTED_CORE_TASK_TEST</a>:</div>
<div class="line"><span class="lineno">   52</span>    {</div>
<div class="line"><span class="lineno">   53</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   54</span>        <span class="comment">// Perform the test task</span></div>
<div class="line"><span class="lineno">   55</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   56</span>        <a class="code hl_function" href="#a45953d9cb5db20789a88dffb93246d87">HaltedCoreTaskTest</a>(DbgState, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   58</span>    }</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a6cc6373c62dcebe395fbb3496c70a400">DEBUGGER_HALTED_CORE_TASK_RUN_VMCALL</a>:</div>
<div class="line"><span class="lineno">   61</span>    {</div>
<div class="line"><span class="lineno">   62</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>        <span class="comment">// Call the direct VMCALL test function</span></div>
<div class="line"><span class="lineno">   64</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ac290ebefde4db9be54d4837b0cd42981">DirectVmcallTest</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a289713a5f555f2e69a7438e456be37a8">DEBUGGER_HALTED_CORE_TASK_SET_PROCESS_INTERCEPTION</a>:</div>
<div class="line"><span class="lineno">   70</span>    {</div>
<div class="line"><span class="lineno">   71</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   72</span>        <span class="comment">// Enable process change detection</span></div>
<div class="line"><span class="lineno">   73</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   74</span>        <a class="code hl_function" href="_process_8c.html#acf5ada429575666de2260cb79a804ecf">ProcessEnableOrDisableThreadChangeMonitor</a>(DbgState, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code hl_define" href="_meta_macros_8h.html#ae43244af114f7d8f05e07f43db50e10b">PVOID_TO_BOOLEAN</a>(<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>));</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   77</span>    }</div>
<div class="line"><span class="lineno">   78</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#ac044f6ae950f0476439fb7388e82b476">DEBUGGER_HALTED_CORE_TASK_SET_THREAD_INTERCEPTION</a>:</div>
<div class="line"><span class="lineno">   79</span>    {</div>
<div class="line"><span class="lineno">   80</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   81</span>        <span class="comment">// Enable alert for thread changes</span></div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   83</span>        <a class="code hl_function" href="_thread_8c.html#ae9ca061b74ef1b8e8a3d999acf00d935">ThreadEnableOrDisableThreadChangeMonitor</a>(DbgState, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, <a class="code hl_define" href="_meta_macros_8h.html#ae43244af114f7d8f05e07f43db50e10b">PVOID_TO_BOOLEAN</a>(<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>));</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   86</span>    }</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#aef9275c3f862cde6490560462d7da1da">DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_READ</a>:</div>
<div class="line"><span class="lineno">   88</span>    {</div>
<div class="line"><span class="lineno">   89</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   90</span>        <span class="comment">// Change MSR bitmap for read (RDMSR)</span></div>
<div class="line"><span class="lineno">   91</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   92</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a773fbcacfeed03c2e50ca6df18d03f72">DirectVmcallChangeMsrBitmapRead</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#aed27eedc0e50447289336cea6fb01381">DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_WRITE</a>:</div>
<div class="line"><span class="lineno">   97</span>    {</div>
<div class="line"><span class="lineno">   98</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   99</span>        <span class="comment">// Change MSR bitmap for write (WRMSR)</span></div>
<div class="line"><span class="lineno">  100</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  101</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a770d59d681d1ac44e6367f44d067dbf3">DirectVmcallChangeMsrBitmapWrite</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  104</span>    }</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#ab1f3154ec19b762bd54fa9d74f2aac2f">DEBUGGER_HALTED_CORE_TASK_CHANGE_IO_BITMAP</a>:</div>
<div class="line"><span class="lineno">  106</span>    {</div>
<div class="line"><span class="lineno">  107</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  108</span>        <span class="comment">// Change I/O bitmap</span></div>
<div class="line"><span class="lineno">  109</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  110</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#af221ca80d9764b587caf9d83a2ad16ca">DirectVmcallChangeIoBitmap</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  113</span>    }</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a5aea543ce18a45f9ed075f9ba2b591a7">DEBUGGER_HALTED_CORE_TASK_SET_RDPMC_EXITING</a>:</div>
<div class="line"><span class="lineno">  115</span>    {</div>
<div class="line"><span class="lineno">  116</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  117</span>        <span class="comment">// Enable rdpmc exiting</span></div>
<div class="line"><span class="lineno">  118</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ad426ff302afb69ac57df7b0e5e826442">DirectVmcallEnableRdpmcExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  122</span>    }</div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a2460cf22b783df18331f7a2d04cb15db">DEBUGGER_HALTED_CORE_TASK_SET_RDTSC_EXITING</a>:</div>
<div class="line"><span class="lineno">  124</span>    {</div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">// Enable rdtsc/rdtscp exiting</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  128</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a96580f995951924b12dc127bc6edc159">DirectVmcallEnableRdtscpExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  131</span>    }</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a35c69bfa7d24fd349fb3763de6cba8da">DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_DEBUG_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  133</span>    {</div>
<div class="line"><span class="lineno">  134</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  135</span>        <span class="comment">// Enable mov to debug registers exiting</span></div>
<div class="line"><span class="lineno">  136</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  137</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ad5b68eeffb70efd558ea8abe032426cd">DirectVmcallEnableMov2DebugRegsExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  140</span>    }</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a0610f788869b37e20642819f3ba3d54e">DEBUGGER_HALTED_CORE_TASK_SET_EXCEPTION_BITMAP</a>:</div>
<div class="line"><span class="lineno">  142</span>    {</div>
<div class="line"><span class="lineno">  143</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  144</span>        <span class="comment">// Set exception bitmap</span></div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  146</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a8eb5d02ed384c1f1c71cb796da714eb6">DirectVmcallSetExceptionBitmap</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  149</span>    }</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a2c9c51a6f4634a4fd2e646792a1063a7">DEBUGGER_HALTED_CORE_TASK_ENABLE_EXTERNAL_INTERRUPT_EXITING</a>:</div>
<div class="line"><span class="lineno">  151</span>    {</div>
<div class="line"><span class="lineno">  152</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  153</span>        <span class="comment">// enable external interrupt exiting</span></div>
<div class="line"><span class="lineno">  154</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#afe9a86bd67a2ed4fafcd01a5af367145">DirectVmcallEnableExternalInterruptExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  158</span>    }</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#ad65308544912c417c8a535a797d65ca3">DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_CONTROL_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  160</span>    {</div>
<div class="line"><span class="lineno">  161</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="comment">// enable mov to CR exiting</span></div>
<div class="line"><span class="lineno">  163</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  164</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a060bd9ac4b40089a195a5df773dd14b2">DirectVmcallEnableMovToCrExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#ad12508c16f83224d13dc80e0abadd316">DEBUGGER_HALTED_CORE_TASK_ENABLE_SYSCALL_HOOK_EFER</a>:</div>
<div class="line"><span class="lineno">  169</span>    {</div>
<div class="line"><span class="lineno">  170</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  171</span>        <span class="comment">// enable syscall hook using EFER SCE bit</span></div>
<div class="line"><span class="lineno">  172</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  173</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#aaae7455307a77ee0670c9bf4b07adc90">DirectVmcallEnableEferSyscall</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a89d4702d15dc5918f31daf832a70da72">DEBUGGER_HALTED_CORE_TASK_INVEPT_ALL_CONTEXTS</a>:</div>
<div class="line"><span class="lineno">  178</span>    {</div>
<div class="line"><span class="lineno">  179</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  180</span>        <span class="comment">// invalidate EPT (All Contexts)</span></div>
<div class="line"><span class="lineno">  181</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  182</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a750881ad079d1c32a8450b6e60b06cee">DirectVmcallInvalidateEptAllContexts</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#abd6e5d4ed4cdd2681217e5df2dc56e56">DEBUGGER_HALTED_CORE_TASK_INVEPT_SINGLE_CONTEXT</a>:</div>
<div class="line"><span class="lineno">  187</span>    {</div>
<div class="line"><span class="lineno">  188</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  189</span>        <span class="comment">// invalidate EPT (A Single Context)</span></div>
<div class="line"><span class="lineno">  190</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  191</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a35a5e71c493c6f78bb7c9b3c28afa001">DirectVmcallInvalidateSingleContext</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  194</span>    }</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#ade71a2304b0ad38afd6f65292eef8831">DEBUGGER_HALTED_CORE_TASK_UNSET_EXCEPTION_BITMAP</a>:</div>
<div class="line"><span class="lineno">  196</span>    {</div>
<div class="line"><span class="lineno">  197</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  198</span>        <span class="comment">// unset exception bitmap on VMCS</span></div>
<div class="line"><span class="lineno">  199</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a39cf7886590750478440f6998c86194b">DirectVmcallUnsetExceptionBitmap</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  203</span>    }</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a47381471f07ce232e26e70d50b966183">DEBUGGER_HALTED_CORE_TASK_UNHOOK_SINGLE_PAGE</a>:</div>
<div class="line"><span class="lineno">  205</span>    {</div>
<div class="line"><span class="lineno">  206</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  207</span>        <span class="comment">// restore a single EPT entry and invalidate EPT cache</span></div>
<div class="line"><span class="lineno">  208</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a9ad170547a2317126671ee309e2317e2">DirectVmcallUnhookSinglePage</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a9392a3e4ceca1c62cae4426bb20bcf6a">DEBUGGER_HALTED_CORE_TASK_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</a>:</div>
<div class="line"><span class="lineno">  214</span>    {</div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">// disable external interrupt exiting only to clear !interrupt commands</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a82f6cef2e635da8ca122bc672494c64c">DirectVmcallSetDisableExternalInterruptExitingOnlyOnClearingInterruptEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a79e615b61e6af2ec4b8c26fc96705f5a">DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_READ</a>:</div>
<div class="line"><span class="lineno">  223</span>    {</div>
<div class="line"><span class="lineno">  224</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  225</span>        <span class="comment">// reset MSR Bitmap Read</span></div>
<div class="line"><span class="lineno">  226</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ac7c2ce124a2686a52326ac5058a50301">DirectVmcallResetMsrBitmapRead</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  230</span>    }</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#af3a758de8f6141bd2bf2a3779e4a261f">DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_WRITE</a>:</div>
<div class="line"><span class="lineno">  232</span>    {</div>
<div class="line"><span class="lineno">  233</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="comment">// reset MSR Bitmap Write</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a7193155eab60c0bdbd1095149ab96561">DirectVmcallResetMsrBitmapWrite</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a795acf60e1cf34338ac87269ffcf90d1">DEBUGGER_HALTED_CORE_TASK_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</a>:</div>
<div class="line"><span class="lineno">  241</span>    {</div>
<div class="line"><span class="lineno">  242</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  243</span>        <span class="comment">// reset exception bitmap on VMCS</span></div>
<div class="line"><span class="lineno">  244</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  245</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a0188bba50818d5ecff60f6828c830859">DirectVmcallResetExceptionBitmapOnlyOnClearingExceptionEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  248</span>    }</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a29529cdd190d32a22e9aa97ed9fb647e">DEBUGGER_HALTED_CORE_TASK_RESET_IO_BITMAP</a>:</div>
<div class="line"><span class="lineno">  250</span>    {</div>
<div class="line"><span class="lineno">  251</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  252</span>        <span class="comment">// reset I/O Bitmaps (A &amp; B)</span></div>
<div class="line"><span class="lineno">  253</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  254</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ac15259c4d6b51246989dd3468620b7dc">DirectVmcallResetIoBitmap</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  257</span>    }</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a2e80c0c965093eff8a73e0578b7bc8b6">DEBUGGER_HALTED_CORE_TASK_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</a>:</div>
<div class="line"><span class="lineno">  259</span>    {</div>
<div class="line"><span class="lineno">  260</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  261</span>        <span class="comment">// clear rdtsc exiting bit ONLY in the case of disabling the events for !tsc command</span></div>
<div class="line"><span class="lineno">  262</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#a0970d4ad0e15872e72d349afa9a8ebf9">DirectVmcallDisableRdtscExitingForClearingTscEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a284f5f23630be5a87c725898986f0e0f">DEBUGGER_HALTED_CORE_TASK_UNSET_RDPMC_EXITING</a>:</div>
<div class="line"><span class="lineno">  268</span>    {</div>
<div class="line"><span class="lineno">  269</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">// disable rdpmc exiting in primary cpu-based controls</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  272</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#af8df6274fe9a7bd9c75f85a5d0f97050">DirectVmcallDisableRdpmcExiting</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  275</span>    }</div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#adf4682b9a31a0cfffd11b4b7f11754b3">DEBUGGER_HALTED_CORE_TASK_DISABLE_SYSCALL_HOOK_EFER</a>:</div>
<div class="line"><span class="lineno">  277</span>    {</div>
<div class="line"><span class="lineno">  278</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  279</span>        <span class="comment">// disable syscall hook using EFER SCE bit</span></div>
<div class="line"><span class="lineno">  280</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  281</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#af3b2edcb12d67c4d97ece6a3b225c547">DirectVmcallDisableEferSyscallEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a7902023fbc79bf988c961239edb0b09f">DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</a>:</div>
<div class="line"><span class="lineno">  286</span>    {</div>
<div class="line"><span class="lineno">  287</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  288</span>        <span class="comment">// clear mov 2 hw dr exiting bit ONLY in the case of disabling the events for !dr command</span></div>
<div class="line"><span class="lineno">  289</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  290</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#ac0373435042fcd3303e1bcc283f76bf5">DirectVmcallDisableMov2DrExitingForClearingDrEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  293</span>    }</div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_halted_core_8h.html#a326d30bb187c4bed48731afd40fbb4f0">DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</a>:</div>
<div class="line"><span class="lineno">  295</span>    {</div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>        <span class="comment">// clear mov 2 cr exiting bit ONLY in the case of disabling the events for !crwrite command</span></div>
<div class="line"><span class="lineno">  298</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  299</span>        <a class="code hl_function" href="_direct_vmcall_8c.html#af0feddb268ebf455068b5c18e375a076">DirectVmcallDisableMov2CrExitingForClearingCrEvents</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>, (<a class="code hl_struct" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">DIRECT_VMCALL_PARAMETERS</a> *)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  302</span>    }</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  304</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a>(<span class="stringliteral">&quot;Warning, unknown broadcast on halted core received&quot;</span>);</div>
<div class="line"><span class="lineno">  305</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span>}</div>
<div class="ttc" id="a_direct_vmcall_8c_html_a0188bba50818d5ecff60f6828c830859"><div class="ttname"><a href="_direct_vmcall_8c.html#a0188bba50818d5ecff60f6828c830859">DirectVmcallResetExceptionBitmapOnlyOnClearingExceptionEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallResetExceptionBitmapOnlyOnClearingExceptionEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for resetting exception bitmap on VMCS</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:407</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a060bd9ac4b40089a195a5df773dd14b2"><div class="ttname"><a href="_direct_vmcall_8c.html#a060bd9ac4b40089a195a5df773dd14b2">DirectVmcallEnableMovToCrExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableMovToCrExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling mov to CR exiting</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:217</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a0970d4ad0e15872e72d349afa9a8ebf9"><div class="ttname"><a href="_direct_vmcall_8c.html#a0970d4ad0e15872e72d349afa9a8ebf9">DirectVmcallDisableRdtscExitingForClearingTscEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallDisableRdtscExitingForClearingTscEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for clearing rdtsc exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:446</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a35a5e71c493c6f78bb7c9b3c28afa001"><div class="ttname"><a href="_direct_vmcall_8c.html#a35a5e71c493c6f78bb7c9b3c28afa001">DirectVmcallInvalidateSingleContext</a></div><div class="ttdeci">NTSTATUS DirectVmcallInvalidateSingleContext(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for invalidating EPT (A Single Context)</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:293</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a39cf7886590750478440f6998c86194b"><div class="ttname"><a href="_direct_vmcall_8c.html#a39cf7886590750478440f6998c86194b">DirectVmcallUnsetExceptionBitmap</a></div><div class="ttdeci">NTSTATUS DirectVmcallUnsetExceptionBitmap(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for unsetting exception bitmap on VMCS</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:312</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a7193155eab60c0bdbd1095149ab96561"><div class="ttname"><a href="_direct_vmcall_8c.html#a7193155eab60c0bdbd1095149ab96561">DirectVmcallResetMsrBitmapWrite</a></div><div class="ttdeci">NTSTATUS DirectVmcallResetMsrBitmapWrite(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for resetting MSR Bitmap Write</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:388</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a750881ad079d1c32a8450b6e60b06cee"><div class="ttname"><a href="_direct_vmcall_8c.html#a750881ad079d1c32a8450b6e60b06cee">DirectVmcallInvalidateEptAllContexts</a></div><div class="ttdeci">NTSTATUS DirectVmcallInvalidateEptAllContexts(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for invalidating EPT (All Contexts)</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:274</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a770d59d681d1ac44e6367f44d067dbf3"><div class="ttname"><a href="_direct_vmcall_8c.html#a770d59d681d1ac44e6367f44d067dbf3">DirectVmcallChangeMsrBitmapWrite</a></div><div class="ttdeci">NTSTATUS DirectVmcallChangeMsrBitmapWrite(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for changing MSR Bitmap (Write)</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:84</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a773fbcacfeed03c2e50ca6df18d03f72"><div class="ttname"><a href="_direct_vmcall_8c.html#a773fbcacfeed03c2e50ca6df18d03f72">DirectVmcallChangeMsrBitmapRead</a></div><div class="ttdeci">NTSTATUS DirectVmcallChangeMsrBitmapRead(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for changing MSR Bitmap (Read)</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:65</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a82f6cef2e635da8ca122bc672494c64c"><div class="ttname"><a href="_direct_vmcall_8c.html#a82f6cef2e635da8ca122bc672494c64c">DirectVmcallSetDisableExternalInterruptExitingOnlyOnClearingInterruptEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallSetDisableExternalInterruptExitingOnlyOnClearingInterruptEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for disabling external interrupt exiting only to clear !interrupt commands</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:350</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a8eb5d02ed384c1f1c71cb796da714eb6"><div class="ttname"><a href="_direct_vmcall_8c.html#a8eb5d02ed384c1f1c71cb796da714eb6">DirectVmcallSetExceptionBitmap</a></div><div class="ttdeci">NTSTATUS DirectVmcallSetExceptionBitmap(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for setting exception bitmap</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:179</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a96580f995951924b12dc127bc6edc159"><div class="ttname"><a href="_direct_vmcall_8c.html#a96580f995951924b12dc127bc6edc159">DirectVmcallEnableRdtscpExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableRdtscpExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling rdtsc/rdtscp exiting</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:141</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_a9ad170547a2317126671ee309e2317e2"><div class="ttname"><a href="_direct_vmcall_8c.html#a9ad170547a2317126671ee309e2317e2">DirectVmcallUnhookSinglePage</a></div><div class="ttdeci">NTSTATUS DirectVmcallUnhookSinglePage(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for restoring a single EPT entry and invalidating EPT cache</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:331</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_aaae7455307a77ee0670c9bf4b07adc90"><div class="ttname"><a href="_direct_vmcall_8c.html#aaae7455307a77ee0670c9bf4b07adc90">DirectVmcallEnableEferSyscall</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableEferSyscall(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling syscall hook using EFER SCE bit</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:236</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ac0373435042fcd3303e1bcc283f76bf5"><div class="ttname"><a href="_direct_vmcall_8c.html#ac0373435042fcd3303e1bcc283f76bf5">DirectVmcallDisableMov2DrExitingForClearingDrEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallDisableMov2DrExitingForClearingDrEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for clearing mov 2 hw dr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:504</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ac15259c4d6b51246989dd3468620b7dc"><div class="ttname"><a href="_direct_vmcall_8c.html#ac15259c4d6b51246989dd3468620b7dc">DirectVmcallResetIoBitmap</a></div><div class="ttdeci">NTSTATUS DirectVmcallResetIoBitmap(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for resetting I/O Bitmaps (A &amp; B)</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:426</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ac290ebefde4db9be54d4837b0cd42981"><div class="ttname"><a href="_direct_vmcall_8c.html#ac290ebefde4db9be54d4837b0cd42981">DirectVmcallTest</a></div><div class="ttdeci">NTSTATUS DirectVmcallTest(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for test direct VMCALL</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:25</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ac7c2ce124a2686a52326ac5058a50301"><div class="ttname"><a href="_direct_vmcall_8c.html#ac7c2ce124a2686a52326ac5058a50301">DirectVmcallResetMsrBitmapRead</a></div><div class="ttdeci">NTSTATUS DirectVmcallResetMsrBitmapRead(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for resetting MSR Bitmap Read</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:369</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ad426ff302afb69ac57df7b0e5e826442"><div class="ttname"><a href="_direct_vmcall_8c.html#ad426ff302afb69ac57df7b0e5e826442">DirectVmcallEnableRdpmcExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableRdpmcExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling rdpmc exiting</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:122</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_ad5b68eeffb70efd558ea8abe032426cd"><div class="ttname"><a href="_direct_vmcall_8c.html#ad5b68eeffb70efd558ea8abe032426cd">DirectVmcallEnableMov2DebugRegsExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableMov2DebugRegsExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling mov to debug registers exiting</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:160</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_af0feddb268ebf455068b5c18e375a076"><div class="ttname"><a href="_direct_vmcall_8c.html#af0feddb268ebf455068b5c18e375a076">DirectVmcallDisableMov2CrExitingForClearingCrEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallDisableMov2CrExitingForClearingCrEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for clearing mov 2 cr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:524</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_af221ca80d9764b587caf9d83a2ad16ca"><div class="ttname"><a href="_direct_vmcall_8c.html#af221ca80d9764b587caf9d83a2ad16ca">DirectVmcallChangeIoBitmap</a></div><div class="ttdeci">NTSTATUS DirectVmcallChangeIoBitmap(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for changing IO Bitmap</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:103</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_af3b2edcb12d67c4d97ece6a3b225c547"><div class="ttname"><a href="_direct_vmcall_8c.html#af3b2edcb12d67c4d97ece6a3b225c547">DirectVmcallDisableEferSyscallEvents</a></div><div class="ttdeci">NTSTATUS DirectVmcallDisableEferSyscallEvents(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for disabling syscall hook using EFER SCE bit</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:484</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_af8df6274fe9a7bd9c75f85a5d0f97050"><div class="ttname"><a href="_direct_vmcall_8c.html#af8df6274fe9a7bd9c75f85a5d0f97050">DirectVmcallDisableRdpmcExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallDisableRdpmcExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for disabling rdpmc exiting in primary cpu-based controls</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:465</div></div>
<div class="ttc" id="a_direct_vmcall_8c_html_afe9a86bd67a2ed4fafcd01a5af367145"><div class="ttname"><a href="_direct_vmcall_8c.html#afe9a86bd67a2ed4fafcd01a5af367145">DirectVmcallEnableExternalInterruptExiting</a></div><div class="ttdeci">NTSTATUS DirectVmcallEnableExternalInterruptExiting(UINT32 CoreId, DIRECT_VMCALL_PARAMETERS *DirectVmcallOptions)</div><div class="ttdoc">routines for enabling external interrupt exiting</div><div class="ttdef"><b>Definition</b> DirectVmcall.c:198</div></div>
<div class="ttc" id="a_halted_core_8c_html_a45953d9cb5db20789a88dffb93246d87"><div class="ttname"><a href="#a45953d9cb5db20789a88dffb93246d87">HaltedCoreTaskTest</a></div><div class="ttdeci">VOID HaltedCoreTaskTest(PROCESSOR_DEBUGGING_STATE *DbgState, PVOID Context)</div><div class="ttdoc">Perform the test task on halted core.</div><div class="ttdef"><b>Definition</b> HaltedCore.c:24</div></div>
<div class="ttc" id="a_halted_core_8h_html_a0610f788869b37e20642819f3ba3d54e"><div class="ttname"><a href="_halted_core_8h.html#a0610f788869b37e20642819f3ba3d54e">DEBUGGER_HALTED_CORE_TASK_SET_EXCEPTION_BITMAP</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_SET_EXCEPTION_BITMAP</div><div class="ttdoc">Halted core task for setting exception bitmap.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:82</div></div>
<div class="ttc" id="a_halted_core_8h_html_a2460cf22b783df18331f7a2d04cb15db"><div class="ttname"><a href="_halted_core_8h.html#a2460cf22b783df18331f7a2d04cb15db">DEBUGGER_HALTED_CORE_TASK_SET_RDTSC_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_SET_RDTSC_EXITING</div><div class="ttdoc">Halted core task for enabling rdtsc/rdtscp exiting.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:70</div></div>
<div class="ttc" id="a_halted_core_8h_html_a284f5f23630be5a87c725898986f0e0f"><div class="ttname"><a href="_halted_core_8h.html#a284f5f23630be5a87c725898986f0e0f">DEBUGGER_HALTED_CORE_TASK_UNSET_RDPMC_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_UNSET_RDPMC_EXITING</div><div class="ttdoc">Halted core task for disabling rdpmc exiting in primary cpu-based controls.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:167</div></div>
<div class="ttc" id="a_halted_core_8h_html_a289713a5f555f2e69a7438e456be37a8"><div class="ttname"><a href="_halted_core_8h.html#a289713a5f555f2e69a7438e456be37a8">DEBUGGER_HALTED_CORE_TASK_SET_PROCESS_INTERCEPTION</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_SET_PROCESS_INTERCEPTION</div><div class="ttdoc">Halted core task for setting process interception.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:34</div></div>
<div class="ttc" id="a_halted_core_8h_html_a29529cdd190d32a22e9aa97ed9fb647e"><div class="ttname"><a href="_halted_core_8h.html#a29529cdd190d32a22e9aa97ed9fb647e">DEBUGGER_HALTED_CORE_TASK_RESET_IO_BITMAP</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_RESET_IO_BITMAP</div><div class="ttdoc">Halted core task for resetting I/O Bitmaps (A &amp; B)</div><div class="ttdef"><b>Definition</b> HaltedCore.h:154</div></div>
<div class="ttc" id="a_halted_core_8h_html_a2c9c51a6f4634a4fd2e646792a1063a7"><div class="ttname"><a href="_halted_core_8h.html#a2c9c51a6f4634a4fd2e646792a1063a7">DEBUGGER_HALTED_CORE_TASK_ENABLE_EXTERNAL_INTERRUPT_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_ENABLE_EXTERNAL_INTERRUPT_EXITING</div><div class="ttdoc">Halted core task for enabling external interrupt exiting.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:88</div></div>
<div class="ttc" id="a_halted_core_8h_html_a2e80c0c965093eff8a73e0578b7bc8b6"><div class="ttname"><a href="_halted_core_8h.html#a2e80c0c965093eff8a73e0578b7bc8b6">DEBUGGER_HALTED_CORE_TASK_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</div><div class="ttdoc">Halted core task for clearing rdtsc exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> HaltedCore.h:161</div></div>
<div class="ttc" id="a_halted_core_8h_html_a326d30bb187c4bed48731afd40fbb4f0"><div class="ttname"><a href="_halted_core_8h.html#a326d30bb187c4bed48731afd40fbb4f0">DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</div><div class="ttdoc">Halted core task for clearing mov 2 cr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> HaltedCore.h:187</div></div>
<div class="ttc" id="a_halted_core_8h_html_a35c69bfa7d24fd349fb3763de6cba8da"><div class="ttname"><a href="_halted_core_8h.html#a35c69bfa7d24fd349fb3763de6cba8da">DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_DEBUG_REGS_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_DEBUG_REGS_EXITING</div><div class="ttdoc">Halted core task for enabling mov to debug registers exiting.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:76</div></div>
<div class="ttc" id="a_halted_core_8h_html_a47381471f07ce232e26e70d50b966183"><div class="ttname"><a href="_halted_core_8h.html#a47381471f07ce232e26e70d50b966183">DEBUGGER_HALTED_CORE_TASK_UNHOOK_SINGLE_PAGE</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_UNHOOK_SINGLE_PAGE</div><div class="ttdoc">Halted core task for restoring a single EPT entry and invalidating EPT cache.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:124</div></div>
<div class="ttc" id="a_halted_core_8h_html_a5aea543ce18a45f9ed075f9ba2b591a7"><div class="ttname"><a href="_halted_core_8h.html#a5aea543ce18a45f9ed075f9ba2b591a7">DEBUGGER_HALTED_CORE_TASK_SET_RDPMC_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_SET_RDPMC_EXITING</div><div class="ttdoc">Halted core task for enabling rdpmc exiting.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:64</div></div>
<div class="ttc" id="a_halted_core_8h_html_a6cc6373c62dcebe395fbb3496c70a400"><div class="ttname"><a href="_halted_core_8h.html#a6cc6373c62dcebe395fbb3496c70a400">DEBUGGER_HALTED_CORE_TASK_RUN_VMCALL</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_RUN_VMCALL</div><div class="ttdoc">Halted core task for running VMCALLs.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:28</div></div>
<div class="ttc" id="a_halted_core_8h_html_a7902023fbc79bf988c961239edb0b09f"><div class="ttname"><a href="_halted_core_8h.html#a7902023fbc79bf988c961239edb0b09f">DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</div><div class="ttdoc">Halted core task for clearing mov 2 hw dr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> HaltedCore.h:180</div></div>
<div class="ttc" id="a_halted_core_8h_html_a795acf60e1cf34338ac87269ffcf90d1"><div class="ttname"><a href="_halted_core_8h.html#a795acf60e1cf34338ac87269ffcf90d1">DEBUGGER_HALTED_CORE_TASK_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</div><div class="ttdoc">Halted core task for resetting exception bitmap on VMCS.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:148</div></div>
<div class="ttc" id="a_halted_core_8h_html_a79e615b61e6af2ec4b8c26fc96705f5a"><div class="ttname"><a href="_halted_core_8h.html#a79e615b61e6af2ec4b8c26fc96705f5a">DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_READ</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_READ</div><div class="ttdoc">Halted core task for resetting MSR Bitmap Read.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:136</div></div>
<div class="ttc" id="a_halted_core_8h_html_a89d4702d15dc5918f31daf832a70da72"><div class="ttname"><a href="_halted_core_8h.html#a89d4702d15dc5918f31daf832a70da72">DEBUGGER_HALTED_CORE_TASK_INVEPT_ALL_CONTEXTS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_INVEPT_ALL_CONTEXTS</div><div class="ttdoc">Halted core task for invalidating EPT (All Contexts)</div><div class="ttdef"><b>Definition</b> HaltedCore.h:106</div></div>
<div class="ttc" id="a_halted_core_8h_html_a9392a3e4ceca1c62cae4426bb20bcf6a"><div class="ttname"><a href="_halted_core_8h.html#a9392a3e4ceca1c62cae4426bb20bcf6a">DEBUGGER_HALTED_CORE_TASK_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</div><div class="ttdoc">Halted core task for disabling external interrupt exiting only to clear !interrupt commands.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:130</div></div>
<div class="ttc" id="a_halted_core_8h_html_aa7058409e351e0ec55063b5335a8b247"><div class="ttname"><a href="_halted_core_8h.html#aa7058409e351e0ec55063b5335a8b247">DEBUGGER_HALTED_CORE_TASK_TEST</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_TEST</div><div class="ttdoc">Halted core task for testing purpose.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:22</div></div>
<div class="ttc" id="a_halted_core_8h_html_ab1f3154ec19b762bd54fa9d74f2aac2f"><div class="ttname"><a href="_halted_core_8h.html#ab1f3154ec19b762bd54fa9d74f2aac2f">DEBUGGER_HALTED_CORE_TASK_CHANGE_IO_BITMAP</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_CHANGE_IO_BITMAP</div><div class="ttdoc">Halted core task for changing I/O Bitmaps (A &amp; B)</div><div class="ttdef"><b>Definition</b> HaltedCore.h:58</div></div>
<div class="ttc" id="a_halted_core_8h_html_abd6e5d4ed4cdd2681217e5df2dc56e56"><div class="ttname"><a href="_halted_core_8h.html#abd6e5d4ed4cdd2681217e5df2dc56e56">DEBUGGER_HALTED_CORE_TASK_INVEPT_SINGLE_CONTEXT</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_INVEPT_SINGLE_CONTEXT</div><div class="ttdoc">Halted core task for invalidating EPT (A Single Context)</div><div class="ttdef"><b>Definition</b> HaltedCore.h:112</div></div>
<div class="ttc" id="a_halted_core_8h_html_ac044f6ae950f0476439fb7388e82b476"><div class="ttname"><a href="_halted_core_8h.html#ac044f6ae950f0476439fb7388e82b476">DEBUGGER_HALTED_CORE_TASK_SET_THREAD_INTERCEPTION</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_SET_THREAD_INTERCEPTION</div><div class="ttdoc">Halted core task for setting thread interception.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:40</div></div>
<div class="ttc" id="a_halted_core_8h_html_ad12508c16f83224d13dc80e0abadd316"><div class="ttname"><a href="_halted_core_8h.html#ad12508c16f83224d13dc80e0abadd316">DEBUGGER_HALTED_CORE_TASK_ENABLE_SYSCALL_HOOK_EFER</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_ENABLE_SYSCALL_HOOK_EFER</div><div class="ttdoc">Halted core task for enabling syscall hook using EFER SCE bit.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:100</div></div>
<div class="ttc" id="a_halted_core_8h_html_ad65308544912c417c8a535a797d65ca3"><div class="ttname"><a href="_halted_core_8h.html#ad65308544912c417c8a535a797d65ca3">DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_CONTROL_REGS_EXITING</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_ENABLE_MOV_TO_CONTROL_REGS_EXITING</div><div class="ttdoc">Halted core task for enabling mov to CR exiting.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:94</div></div>
<div class="ttc" id="a_halted_core_8h_html_ade71a2304b0ad38afd6f65292eef8831"><div class="ttname"><a href="_halted_core_8h.html#ade71a2304b0ad38afd6f65292eef8831">DEBUGGER_HALTED_CORE_TASK_UNSET_EXCEPTION_BITMAP</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_UNSET_EXCEPTION_BITMAP</div><div class="ttdoc">Halted core task for unsetting exception bitmap on VMCS.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:118</div></div>
<div class="ttc" id="a_halted_core_8h_html_adf4682b9a31a0cfffd11b4b7f11754b3"><div class="ttname"><a href="_halted_core_8h.html#adf4682b9a31a0cfffd11b4b7f11754b3">DEBUGGER_HALTED_CORE_TASK_DISABLE_SYSCALL_HOOK_EFER</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_DISABLE_SYSCALL_HOOK_EFER</div><div class="ttdoc">Halted core task for disabling syscall hook using EFER SCE bit.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:173</div></div>
<div class="ttc" id="a_halted_core_8h_html_aed27eedc0e50447289336cea6fb01381"><div class="ttname"><a href="_halted_core_8h.html#aed27eedc0e50447289336cea6fb01381">DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_WRITE</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_WRITE</div><div class="ttdoc">Halted core task for changing MSR Bitmap Write.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:52</div></div>
<div class="ttc" id="a_halted_core_8h_html_aef9275c3f862cde6490560462d7da1da"><div class="ttname"><a href="_halted_core_8h.html#aef9275c3f862cde6490560462d7da1da">DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_READ</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_CHANGE_MSR_BITMAP_READ</div><div class="ttdoc">Halted core task for changing MSR Bitmap Read.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:46</div></div>
<div class="ttc" id="a_halted_core_8h_html_af3a758de8f6141bd2bf2a3779e4a261f"><div class="ttname"><a href="_halted_core_8h.html#af3a758de8f6141bd2bf2a3779e4a261f">DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_WRITE</a></div><div class="ttdeci">#define DEBUGGER_HALTED_CORE_TASK_RESET_MSR_BITMAP_WRITE</div><div class="ttdoc">Halted core task for resetting MSR Bitmap Write.</div><div class="ttdef"><b>Definition</b> HaltedCore.h:142</div></div>
<div class="ttc" id="a_meta_macros_8h_html_ae43244af114f7d8f05e07f43db50e10b"><div class="ttname"><a href="_meta_macros_8h.html#ae43244af114f7d8f05e07f43db50e10b">PVOID_TO_BOOLEAN</a></div><div class="ttdeci">#define PVOID_TO_BOOLEAN(_var)</div><div class="ttdef"><b>Definition</b> MetaMacros.h:40</div></div>
<div class="ttc" id="a_process_8c_html_acf5ada429575666de2260cb79a804ecf"><div class="ttname"><a href="_process_8c.html#acf5ada429575666de2260cb79a804ecf">ProcessEnableOrDisableThreadChangeMonitor</a></div><div class="ttdeci">VOID ProcessEnableOrDisableThreadChangeMonitor(PROCESSOR_DEBUGGING_STATE *DbgState, BOOLEAN Enable, BOOLEAN IsSwitchByClockIntrrupt)</div><div class="ttdoc">Enable or disable the process change monitoring detection on the running core.</div><div class="ttdef"><b>Definition</b> Process.c:220</div></div>
<div class="ttc" id="a_thread_8c_html_ae9ca061b74ef1b8e8a3d999acf00d935"><div class="ttname"><a href="_thread_8c.html#ae9ca061b74ef1b8e8a3d999acf00d935">ThreadEnableOrDisableThreadChangeMonitor</a></div><div class="ttdeci">VOID ThreadEnableOrDisableThreadChangeMonitor(PROCESSOR_DEBUGGING_STATE *DbgState, BOOLEAN Enable, BOOLEAN IsSwitchByClockIntrrupt)</div><div class="ttdoc">Enable or disable the thread change monitoring detection on the running core.</div><div class="ttdef"><b>Definition</b> Thread.c:597</div></div>
<div class="ttc" id="astruct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s_html"><div class="ttname"><a href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html">_DIRECT_VMCALL_PARAMETERS</a></div><div class="ttdoc">Used for sending direct VMCALLs on the VMX root-mode.</div><div class="ttdef"><b>Definition</b> DataTypes.h:294</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cd34dbc54d14ab8a4fd5cdc4c307e34" name="a6cd34dbc54d14ab8a4fd5cdc4c307e34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cd34dbc54d14ab8a4fd5cdc4c307e34">&#9670;&#160;</a></span>HaltedCoreRunTaskOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> HaltedCoreRunTaskOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>TargetTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>LockAgainAfterTask</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the task on a single halted core. </p>
<p>This function should be called from VMX root-mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">TargetTask</td><td>The target task </td></tr>
    <tr><td class="paramname">LockAgainAfterTask</td><td>Lock the core after the task </td></tr>
    <tr><td class="paramname">Context</td><td>optional parameter passed to the functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  360</span>{</div>
<div class="line"><span class="lineno">  361</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  362</span>    <span class="comment">// Check if the task needs to be executed for the current</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="comment">// core or any other cores</span></div>
<div class="line"><span class="lineno">  364</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">if</span> (TargetCoreId == KeGetCurrentProcessorNumberEx(NULL))</div>
<div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  368</span>        <span class="comment">// *** Perform the task for the current core ***</span></div>
<div class="line"><span class="lineno">  369</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  370</span>        <a class="code hl_function" href="#aea1b886f9a8ea60c897b656b66e22b5e">HaltedCorePerformTargetTask</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a349ee1adc363d2e4323a35a68fae5646">g_DbgState</a>[TargetCoreId], TargetTask, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  371</span>    }</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  373</span>    {</div>
<div class="line"><span class="lineno">  374</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  375</span>        <span class="comment">// *** Perform the task for another core ***</span></div>
<div class="line"><span class="lineno">  376</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  379</span>        <span class="comment">// apply task to the target core</span></div>
<div class="line"><span class="lineno">  380</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  381</span>        <a class="code hl_function" href="#a495328e6ad3239509d43e9170b3e4d69">HaltedCoreApplyTaskOnTargetCore</a>(TargetCoreId, TargetTask, LockAgainAfterTask, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">  382</span>    }</div>
<div class="line"><span class="lineno">  383</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a45953d9cb5db20789a88dffb93246d87" name="a45953d9cb5db20789a88dffb93246d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45953d9cb5db20789a88dffb93246d87">&#9670;&#160;</a></span>HaltedCoreTaskTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> HaltedCoreTaskTest </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the test task on halted core. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">Context</td><td>optional parameter passed to the functions</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   25</span>{</div>
<div class="line"><span class="lineno">   26</span>    UNREFERENCED_PARAMETER(DbgState);</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   29</span>    <span class="comment">// Test target task</span></div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   31</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a>(<span class="stringliteral">&quot;Target test task executed on halted core, context: %llx&quot;</span>, <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>);</div>
<div class="line"><span class="lineno">   32</span>}</div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a97b0adbd65790fb90734daa8e5245a04"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a97b0adbd65790fb90734daa8e5245a04">LogInfo</a></div><div class="ttdeci">#define LogInfo(format,...)</div><div class="ttdoc">Define log variables.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:71</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_fd401680aa8c7ceffc479e97f6bdc4df.html">hyperkd</a></li><li class="navelem"><a class="el" href="dir_587853473f29459994cc5353647295ff.html">code</a></li><li class="navelem"><a class="el" href="dir_366222a910cb7e5dbd8918e7b8c2300f.html">debugger</a></li><li class="navelem"><a class="el" href="dir_d629efb810c74b142ece07b3d303a9df.html">core</a></li><li class="navelem"><a class="el" href="_halted_core_8c.html">HaltedCore.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
