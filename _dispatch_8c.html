<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperhv/code/interface/Dispatch.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_dispatch_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Dispatch.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of debugger functions for dispatching, triggering and emulating events.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afe94c002465675302db8afbbd3a33a64" id="r_afe94c002465675302db8afbbd3a33a64"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe94c002465675302db8afbbd3a33a64">DispatchEventEferSysret</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:afe94c002465675302db8afbbd3a33a64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to SYSRET events.  <br /></td></tr>
<tr class="separator:afe94c002465675302db8afbbd3a33a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0069e4231e27a13c9555e41aab6a022f" id="r_a0069e4231e27a13c9555e41aab6a022f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0069e4231e27a13c9555e41aab6a022f">DispatchEventEferSyscall</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a0069e4231e27a13c9555e41aab6a022f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to SYSCALL events.  <br /></td></tr>
<tr class="separator:a0069e4231e27a13c9555e41aab6a022f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c9d9d43e2cffb256cd84481e0cce22f" id="r_a5c9d9d43e2cffb256cd84481e0cce22f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5c9d9d43e2cffb256cd84481e0cce22f">DispatchEventCpuid</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a5c9d9d43e2cffb256cd84481e0cce22f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to CPUID events.  <br /></td></tr>
<tr class="separator:a5c9d9d43e2cffb256cd84481e0cce22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61e2dcbd730450008e8f6f4dcc6c7b42" id="r_a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a61e2dcbd730450008e8f6f4dcc6c7b42">DispatchEventTsc</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsRdtscp)</td></tr>
<tr class="memdesc:a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDTSC/RDTSCP events.  <br /></td></tr>
<tr class="separator:a61e2dcbd730450008e8f6f4dcc6c7b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3eb1bf639bc9644cf1c1f44c2eb8dff" id="r_ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3eb1bf639bc9644cf1c1f44c2eb8dff">DispatchEventVmcall</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to VMCALL events.  <br /></td></tr>
<tr class="separator:ac3eb1bf639bc9644cf1c1f44c2eb8dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab42e4975ea7a08129dc29a40c011017c" id="r_ab42e4975ea7a08129dc29a40c011017c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab42e4975ea7a08129dc29a40c011017c">DispatchEventMode</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#aae7e83f1666860f94b796560cdf1d308">DEBUGGER_EVENT_MODE_TYPE</a> TargetMode, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> HandleState)</td></tr>
<tr class="memdesc:ab42e4975ea7a08129dc29a40c011017c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to user-mode/kernel-mode execution trap events.  <br /></td></tr>
<tr class="separator:ab42e4975ea7a08129dc29a40c011017c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d04e9dee78b3fb4350c2f588877947" id="r_a83d04e9dee78b3fb4350c2f588877947"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a83d04e9dee78b3fb4350c2f588877947">DispatchEventMovToCr3</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a83d04e9dee78b3fb4350c2f588877947"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to mov 2 cr3 events.  <br /></td></tr>
<tr class="separator:a83d04e9dee78b3fb4350c2f588877947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9beef1729154452db4d14e11fbfa4478" id="r_a9beef1729154452db4d14e11fbfa4478"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9beef1729154452db4d14e11fbfa4478">DispatchEventIO</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a9beef1729154452db4d14e11fbfa4478"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to IO events.  <br /></td></tr>
<tr class="separator:a9beef1729154452db4d14e11fbfa4478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a5898e33596b5af4a62b43410c7729" id="r_a40a5898e33596b5af4a62b43410c7729"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40a5898e33596b5af4a62b43410c7729">DispatchEventRdmsr</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a40a5898e33596b5af4a62b43410c7729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDMSR events.  <br /></td></tr>
<tr class="separator:a40a5898e33596b5af4a62b43410c7729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3de50c27b4f63f330bc3b3f3948d74a" id="r_ae3de50c27b4f63f330bc3b3f3948d74a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae3de50c27b4f63f330bc3b3f3948d74a">DispatchEventWrmsr</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ae3de50c27b4f63f330bc3b3f3948d74a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to WRMSR events.  <br /></td></tr>
<tr class="separator:ae3de50c27b4f63f330bc3b3f3948d74a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bcf13ef8771eef5a5d7d2f375d3225f" id="r_a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3bcf13ef8771eef5a5d7d2f375d3225f">DispatchEventRdpmc</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to RDPMC events.  <br /></td></tr>
<tr class="separator:a3bcf13ef8771eef5a5d7d2f375d3225f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab29357f2d04f132cb67577cb62162ec8" id="r_ab29357f2d04f132cb67577cb62162ec8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab29357f2d04f132cb67577cb62162ec8">DispatchEventMov2DebugRegs</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ab29357f2d04f132cb67577cb62162ec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to MOV 2 DR events.  <br /></td></tr>
<tr class="separator:ab29357f2d04f132cb67577cb62162ec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbc945909fecd8ece6818d3424af63eb" id="r_acbc945909fecd8ece6818d3424af63eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acbc945909fecd8ece6818d3424af63eb">DispatchEventMovToFromControlRegisters</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:acbc945909fecd8ece6818d3424af63eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to mov to/from CR events.  <br /></td></tr>
<tr class="separator:acbc945909fecd8ece6818d3424af63eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b171149691c87a529b854ff8e2eb0b7" id="r_a2b171149691c87a529b854ff8e2eb0b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2b171149691c87a529b854ff8e2eb0b7">DispatchEventException</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a2b171149691c87a529b854ff8e2eb0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to EXCEPTION events.  <br /></td></tr>
<tr class="separator:a2b171149691c87a529b854ff8e2eb0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6c52a1c64aea43b90fcc571912d12ce" id="r_af6c52a1c64aea43b90fcc571912d12ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af6c52a1c64aea43b90fcc571912d12ce">DispatchEventExternalInterrupts</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:af6c52a1c64aea43b90fcc571912d12ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to external-interrupt events.  <br /></td></tr>
<tr class="separator:af6c52a1c64aea43b90fcc571912d12ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32237d4ff3cbaf648ff111a2ddbcdd03" id="r_a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a32237d4ff3cbaf648ff111a2ddbcdd03">DispatchEventHiddenHookExecCc</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to hidden hook exec CC events.  <br /></td></tr>
<tr class="separator:a32237d4ff3cbaf648ff111a2ddbcdd03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd5d2cff9ea39a842046b1af7a72c51" id="r_abdd5d2cff9ea39a842046b1af7a72c51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abdd5d2cff9ea39a842046b1af7a72c51">DispatchEventHiddenHookExecDetours</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:abdd5d2cff9ea39a842046b1af7a72c51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to hidden hook exec detours events.  <br /></td></tr>
<tr class="separator:abdd5d2cff9ea39a842046b1af7a72c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebd5f93678619ac6e74debd886d42988" id="r_aebd5f93678619ac6e74debd886d42988"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aebd5f93678619ac6e74debd886d42988">DispatchEventHiddenHookPageReadWriteExecuteReadPreEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *IsTriggeringPostEventAllowed)</td></tr>
<tr class="memdesc:aebd5f93678619ac6e74debd886d42988"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, read events (pre)  <br /></td></tr>
<tr class="separator:aebd5f93678619ac6e74debd886d42988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afed71e259f9f6c1e0524317b391cb2" id="r_a3afed71e259f9f6c1e0524317b391cb2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3afed71e259f9f6c1e0524317b391cb2">DispatchEventHiddenHookPageReadWriteExecuteWritePreEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *IsTriggeringPostEventAllowed)</td></tr>
<tr class="memdesc:a3afed71e259f9f6c1e0524317b391cb2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, write events (pre)  <br /></td></tr>
<tr class="separator:a3afed71e259f9f6c1e0524317b391cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85600db927f918baefeec1d3d03b84da" id="r_a85600db927f918baefeec1d3d03b84da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85600db927f918baefeec1d3d03b84da">DispatchEventHiddenHookPageReadWriteExecuteExecutePreEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *IsTriggeringPostEventAllowed)</td></tr>
<tr class="memdesc:a85600db927f918baefeec1d3d03b84da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, execute events (pre)  <br /></td></tr>
<tr class="separator:a85600db927f918baefeec1d3d03b84da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e48998eb9fc107f98f9759b9b323e0c" id="r_a4e48998eb9fc107f98f9759b9b323e0c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4e48998eb9fc107f98f9759b9b323e0c">DispatchEventHiddenHookPageReadWriteExecReadPostEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a4e48998eb9fc107f98f9759b9b323e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, read events (post)  <br /></td></tr>
<tr class="separator:a4e48998eb9fc107f98f9759b9b323e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b479b4139a23747b75523910f9b9417" id="r_a6b479b4139a23747b75523910f9b9417"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b479b4139a23747b75523910f9b9417">DispatchEventHiddenHookPageReadWriteExecWritePostEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:a6b479b4139a23747b75523910f9b9417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, write events (post)  <br /></td></tr>
<tr class="separator:a6b479b4139a23747b75523910f9b9417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab78373fcc45e3dc72db25e4475bbff24" id="r_ab78373fcc45e3dc72db25e4475bbff24"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab78373fcc45e3dc72db25e4475bbff24">DispatchEventHiddenHookPageReadWriteExecExecutePostEvent</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, PVOID <a class="el" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>)</td></tr>
<tr class="memdesc:ab78373fcc45e3dc72db25e4475bbff24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling debugger functions related to read &amp; write &amp; execute, execute events (post)  <br /></td></tr>
<tr class="separator:ab78373fcc45e3dc72db25e4475bbff24"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of debugger functions for dispatching, triggering and emulating events. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-09-21</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5c9d9d43e2cffb256cd84481e0cce22f" name="a5c9d9d43e2cffb256cd84481e0cce22f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c9d9d43e2cffb256cd84481e0cce22f">&#9670;&#160;</a></span>DispatchEventCpuid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventCpuid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to CPUID events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  114</span>{</div>
<div class="line"><span class="lineno">  115</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                                    <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>;</div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  120</span>    <span class="comment">// Check if attaching is for command dispatching in user debugger</span></div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// or a regular CPUID</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  123</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">UdCheckForCommand</a> != NULL &amp;&amp; <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">UdCheckForCommand</a>())</div>
<div class="line"><span class="lineno">  124</span>    {</div>
<div class="line"><span class="lineno">  125</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment">// It&#39;s a thread command for user debugger, no need to run the</span></div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">// actual CPUID instruction and change the registers</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  130</span>    }</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  133</span>    <span class="comment">// As the context to event trigger, we send the eax before the cpuid</span></div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// so that the debugger can both read the eax as it&#39;s now changed by</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// the cpuid instruction and also can modify the results</span></div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a90a1c733b10e8c67d5386fe109c4c572">g_TriggerEventForCpuids</a>)</div>
<div class="line"><span class="lineno">  138</span>    {</div>
<div class="line"><span class="lineno">  139</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  140</span>        <span class="comment">// Adjusting the core context (save EAX for the debugger)</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  142</span>        <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a> = VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a> &amp; 0xffffffff;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  146</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  147</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  148</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  149</span>                                                      (PVOID)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  150</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  151</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  154</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  155</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  157</span>        {</div>
<div class="line"><span class="lineno">  158</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  159</span>            <span class="comment">// Handle the CPUID event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  160</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  161</span>            <a class="code hl_function" href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a>(VCpu);</div>
<div class="line"><span class="lineno">  162</span>        }</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>        <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  166</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  167</span>        <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  168</span>        {</div>
<div class="line"><span class="lineno">  169</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  170</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  171</span>                                     (PVOID)<a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  172</span>                                     NULL,</div>
<div class="line"><span class="lineno">  173</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  174</span>        }</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  177</span>    {</div>
<div class="line"><span class="lineno">  178</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  179</span>        <span class="comment">// Otherwise and if there is no event, we should handle the CPUID</span></div>
<div class="line"><span class="lineno">  180</span>        <span class="comment">// normally</span></div>
<div class="line"><span class="lineno">  181</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  182</span>        <a class="code hl_function" href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a>(VCpu);</div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_callback_8c_html_a3b2b1cd1025b5caa035e0834e17fe925"><div class="ttname"><a href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a></div><div class="ttdeci">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE VmmCallbackTriggerEvents(VMM_EVENT_TYPE_ENUM EventType, VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE CallingStage, PVOID Context, BOOLEAN *PostEventRequired, GUEST_REGS *Regs)</div><div class="ttdoc">routines callback to trigger events</div><div class="ttdef"><b>Definition</b> Callback.c:154</div></div>
<div class="ttc" id="a_data_types_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf"><div class="ttname"><a href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</div><div class="ttdef"><b>Definition</b> DataTypes.h:93</div></div>
<div class="ttc" id="a_data_types_8h_html_ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e"><div class="ttname"><a href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a></div><div class="ttdeci">@ VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</div><div class="ttdef"><b>Definition</b> DataTypes.h:94</div></div>
<div class="ttc" id="a_global_variables_8h_html_a90a1c733b10e8c67d5386fe109c4c572"><div class="ttname"><a href="_global_variables_8h.html#a90a1c733b10e8c67d5386fe109c4c572">g_TriggerEventForCpuids</a></div><div class="ttdeci">BOOLEAN g_TriggerEventForCpuids</div><div class="ttdoc">Showes whether the cpuid handler is allowed to trigger an event or not.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:138</div></div>
<div class="ttc" id="a_global_variables_8h_html_aa97473c862a98f925b05ef0272432090"><div class="ttname"><a href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a></div><div class="ttdeci">VMM_CALLBACKS g_Callbacks</div><div class="ttdoc">List of callbacks.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:32</div></div>
<div class="ttc" id="a_hv_8c_html_a8e659558abb0c1a6977e68c59130dbc9"><div class="ttname"><a href="_hv_8c.html#a8e659558abb0c1a6977e68c59130dbc9">HvHandleCpuid</a></div><div class="ttdeci">VOID HvHandleCpuid(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle Cpuid Vmexits.</div><div class="ttdef"><b>Definition</b> Hv.c:67</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_dpc_8h_html_a446af93100756f0d846f1bfe80e30b4b"><div class="ttname"><a href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a></div><div class="ttdeci">NTKERNELAPI _In_opt_ PVOID Context</div><div class="ttdef"><b>Definition</b> Dpc.h:25</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a3510cc0182b1b0735d97a3dc67ebe432"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a></div><div class="ttdeci">enum _VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</div><div class="ttdoc">The status of triggering events.</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a></div><div class="ttdeci">@ VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</div><div class="ttdef"><b>Definition</b> Events.h:80</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ CPUID_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:123</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aae00ab92fdce5f90e65edb3bd10ae696"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">_VIRTUAL_MACHINE_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition</b> State.h:305</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_ab0d2caf9709eefa640c62964b4b3c20d"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ab0d2caf9709eefa640c62964b4b3c20d">_VMM_CALLBACKS::UdCheckForCommand</a></div><div class="ttdeci">UD_CHECK_FOR_COMMAND UdCheckForCommand</div><div class="ttdef"><b>Definition</b> VMM.h:217</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a346ed6ae20503154a9a8031491706b3e"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">GUEST_REGS::rax</a></div><div class="ttdeci">UINT64 rax</div><div class="ttdef"><b>Definition</b> BasicTypes.h:75</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0069e4231e27a13c9555e41aab6a022f" name="a0069e4231e27a13c9555e41aab6a022f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0069e4231e27a13c9555e41aab6a022f">&#9670;&#160;</a></span>DispatchEventEferSyscall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventEferSyscall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to SYSCALL events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreIndex</td><td>Current core's index </td></tr>
    <tr><td class="paramname">Regs</td><td>Guest's gp register </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   70</span>{</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   75</span>    <span class="comment">// We should trigger the event of SYSCALL here, we send the</span></div>
<div class="line"><span class="lineno">   76</span>    <span class="comment">// syscall number in rax</span></div>
<div class="line"><span class="lineno">   77</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   78</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a>,</div>
<div class="line"><span class="lineno">   79</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   80</span>                                                  (PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>,</div>
<div class="line"><span class="lineno">   81</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">   82</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   85</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">   86</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">   88</span>    {</div>
<div class="line"><span class="lineno">   89</span>        <a class="code hl_function" href="_efer_hook_8c.html#ac90baba1bf06921f9a5e8f0a7c0836a4">SyscallHookEmulateSYSCALL</a>(VCpu);</div>
<div class="line"><span class="lineno">   90</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">   97</span>    {</div>
<div class="line"><span class="lineno">   98</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a>,</div>
<div class="line"><span class="lineno">   99</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  100</span>                                 (PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>,</div>
<div class="line"><span class="lineno">  101</span>                                 NULL,</div>
<div class="line"><span class="lineno">  102</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  103</span>    }</div>
<div class="line"><span class="lineno">  104</span>}</div>
<div class="ttc" id="a_efer_hook_8c_html_ac90baba1bf06921f9a5e8f0a7c0836a4"><div class="ttname"><a href="_efer_hook_8c.html#ac90baba1bf06921f9a5e8f0a7c0836a4">SyscallHookEmulateSYSCALL</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN SyscallHookEmulateSYSCALL(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">This function emulates the SYSCALL execution.</div><div class="ttdef"><b>Definition</b> EferHook.c:115</div></div>
<div class="ttc" id="a_hv_8c_html_a384185281b4d93ce4a401d66848d9049"><div class="ttname"><a href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a></div><div class="ttdeci">VOID HvSuppressRipIncrement(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Suppress the incrementation of RIP.</div><div class="ttdef"><b>Definition</b> Hv.c:324</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da101288c457f5b31c0bff4cda6af0f331">SYSCALL_HOOK_EFER_SYSCALL</a></div><div class="ttdeci">@ SYSCALL_HOOK_EFER_SYSCALL</div><div class="ttdef"><b>Definition</b> Events.h:117</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe94c002465675302db8afbbd3a33a64" name="afe94c002465675302db8afbbd3a33a64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe94c002465675302db8afbbd3a33a64">&#9670;&#160;</a></span>DispatchEventEferSysret()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventEferSysret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to SYSRET events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreIndex</td><td>Current core's index </td></tr>
    <tr><td class="paramname">Regs</td><td>Guest's gp register </td></tr>
    <tr><td class="paramname">Context</td><td>Context of triggering the event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   26</span>{</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">// We should trigger the event of SYSRET here</span></div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   33</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a>,</div>
<div class="line"><span class="lineno">   34</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   35</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">   36</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">   37</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">   43</span>    {</div>
<div class="line"><span class="lineno">   44</span>        <a class="code hl_function" href="_efer_hook_8c.html#a3dfdd8d0afe5e4efafb11314e1660823">SyscallHookEmulateSYSRET</a>(VCpu);</div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">   46</span>    }</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   49</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">   52</span>    {</div>
<div class="line"><span class="lineno">   53</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a>,</div>
<div class="line"><span class="lineno">   54</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">   55</span>                                 <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">   56</span>                                 NULL,</div>
<div class="line"><span class="lineno">   57</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">   58</span>    }</div>
<div class="line"><span class="lineno">   59</span>}</div>
<div class="ttc" id="a_efer_hook_8c_html_a3dfdd8d0afe5e4efafb11314e1660823"><div class="ttname"><a href="_efer_hook_8c.html#a3dfdd8d0afe5e4efafb11314e1660823">SyscallHookEmulateSYSRET</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN SyscallHookEmulateSYSRET(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">This function emulates the SYSRET execution.</div><div class="ttdef"><b>Definition</b> EferHook.c:182</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daeee3aa3ce1846c251a566625ec524190">SYSCALL_HOOK_EFER_SYSRET</a></div><div class="ttdeci">@ SYSCALL_HOOK_EFER_SYSRET</div><div class="ttdef"><b>Definition</b> Events.h:118</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b171149691c87a529b854ff8e2eb0b7" name="a2b171149691c87a529b854ff8e2eb0b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b171149691c87a529b854ff8e2eb0b7">&#9670;&#160;</a></span>DispatchEventException()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventException </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to EXCEPTION events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  756</span>{</div>
<div class="line"><span class="lineno">  757</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  759</span>    VMEXIT_INTERRUPT_INFORMATION              InterruptExit       = {0};</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  762</span>    <span class="comment">// read the exit interruption information</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  764</span>    <a class="code hl_function" href="_vmx_8c.html#af411da3719b3f7f9198be1b8bc6c6874">VmxVmread32P</a>(VMCS_VMEXIT_INTERRUPTION_INFORMATION, &amp;InterruptExit.AsUInt);</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  767</span>    <span class="comment">// This type of vm-exit, can be either because of an !exception event,</span></div>
<div class="line"><span class="lineno">  768</span>    <span class="comment">// or it might be because we triggered APIC or X2APIC to generate an</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="comment">// NMI, we want to halt the debuggee. We perform the checks here to</span></div>
<div class="line"><span class="lineno">  770</span>    <span class="comment">// avoid triggering an event for NMIs when the debuggee requested it</span></div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  772</span>    <span class="keywordflow">if</span> (InterruptExit.InterruptionType == <a class="code hl_enumvalue" href="hyperhv_2header_2vmm_2vmx_2_events_8h.html#ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519">INTERRUPT_TYPE_NMI</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  773</span>        InterruptExit.Vector == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1">EXCEPTION_VECTOR_NMI</a>)</div>
<div class="line"><span class="lineno">  774</span>    {</div>
<div class="line"><span class="lineno">  775</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  776</span>        <span class="comment">// Check if we&#39;re waiting for an NMI on this core and if the guest is NOT in</span></div>
<div class="line"><span class="lineno">  777</span>        <span class="comment">// a instrument step-in (&#39;i&#39; command) routine</span></div>
<div class="line"><span class="lineno">  778</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  779</span>        <span class="keywordflow">if</span> (!VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">RegisterBreakOnMtf</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  780</span>            <a class="code hl_function" href="_vmx_broadcast_8c.html#a4a6e97bfd88306abb8f2851d159fa848">VmxBroadcastNmiHandler</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</div>
<div class="line"><span class="lineno">  781</span>        {</div>
<div class="line"><span class="lineno">  782</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  783</span>        }</div>
<div class="line"><span class="lineno">  784</span>    }</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  787</span>    <span class="comment">// *** When we reached here it means that this is not a NMI cause by guest,</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="comment">// probably an event ***</span></div>
<div class="line"><span class="lineno">  789</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  792</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  793</span>    <span class="comment">// As the context to event trigger, we send the vector or IDT Index</span></div>
<div class="line"><span class="lineno">  794</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  795</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  796</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  797</span>                                                  (PVOID)InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  798</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  799</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">// Now, we check if the guest enabled MTF for debugging (instrumentation stepping)</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">// This is because based on Intel SDM :</span></div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">// If the &quot;monitor trap flag&quot; VM-execution control is 1 and VM entry is</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment">// injecting a vectored event, an MTF VM exit is pending on the instruction</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="comment">// boundary before the first instruction following the VM entry</span></div>
<div class="line"><span class="lineno">  807</span>    <span class="comment">// and,</span></div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">// If VM entry is injecting a pending MTF VM exit, an MTF VM exit is pending on the</span></div>
<div class="line"><span class="lineno">  809</span>    <span class="comment">// instruction boundary before the first instruction following the VM entry</span></div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">// This is the case even if the &quot;monitor trap flag&quot; VM-execution control is 0</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="comment">// So, we&#39;ll ignore the injection of Exception in this case</span></div>
<div class="line"><span class="lineno">  813</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordflow">if</span> (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">RegisterBreakOnMtf</a>)</div>
<div class="line"><span class="lineno">  815</span>    {</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  817</span>    }</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  820</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  821</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  823</span>    {</div>
<div class="line"><span class="lineno">  824</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  825</span>        <span class="comment">// Handle exception (emulate or inject the event)</span></div>
<div class="line"><span class="lineno">  826</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  827</span>        <a class="code hl_function" href="_idt_emulation_8c.html#a15c1173efc7c60e61dbe11c328549e3c">IdtEmulationHandleExceptionAndNmi</a>(VCpu, InterruptExit);</div>
<div class="line"><span class="lineno">  828</span>    }</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  831</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  832</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  834</span>    {</div>
<div class="line"><span class="lineno">  835</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  836</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  837</span>                                 (PVOID)InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  838</span>                                 NULL,</div>
<div class="line"><span class="lineno">  839</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  840</span>    }</div>
<div class="line"><span class="lineno">  841</span>}</div>
<div class="ttc" id="a_idt_emulation_8c_html_a15c1173efc7c60e61dbe11c328549e3c"><div class="ttname"><a href="_idt_emulation_8c.html#a15c1173efc7c60e61dbe11c328549e3c">IdtEmulationHandleExceptionAndNmi</a></div><div class="ttdeci">VOID IdtEmulationHandleExceptionAndNmi(_Inout_ VIRTUAL_MACHINE_STATE *VCpu, _In_ VMEXIT_INTERRUPT_INFORMATION InterruptExit)</div><div class="ttdoc">Handle NMI and exception vm-exits.</div><div class="ttdef"><b>Definition</b> IdtEmulation.c:257</div></div>
<div class="ttc" id="a_vmx_8c_html_af411da3719b3f7f9198be1b8bc6c6874"><div class="ttname"><a href="_vmx_8c.html#af411da3719b3f7f9198be1b8bc6c6874">VmxVmread32P</a></div><div class="ttdeci">UCHAR VmxVmread32P(size_t Field, UINT32 *FieldValue)</div><div class="ttdoc">VMX VMREAD instruction (32-bit)</div><div class="ttdef"><b>Definition</b> Vmx.c:86</div></div>
<div class="ttc" id="a_vmx_broadcast_8c_html_a4a6e97bfd88306abb8f2851d159fa848"><div class="ttname"><a href="_vmx_broadcast_8c.html#a4a6e97bfd88306abb8f2851d159fa848">VmxBroadcastNmiHandler</a></div><div class="ttdeci">BOOLEAN VmxBroadcastNmiHandler(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN IsOnVmxNmiHandler)</div><div class="ttdoc">Handle broadcast NMIs in vmx-root mode.</div><div class="ttdef"><b>Definition</b> VmxBroadcast.c:187</div></div>
<div class="ttc" id="ahyperhv_2header_2vmm_2vmx_2_events_8h_html_ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519"><div class="ttname"><a href="hyperhv_2header_2vmm_2vmx_2_events_8h.html#ade7b98ff2f26b359a8d902773a55df03aac69152d78fe2d37d38dbb5b1c637519">INTERRUPT_TYPE_NMI</a></div><div class="ttdeci">@ INTERRUPT_TYPE_NMI</div><div class="ttdef"><b>Definition</b> Events.h:52</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da44de44f153661b8e9f651882510bc939">EXCEPTION_OCCURRED</a></div><div class="ttdeci">@ EXCEPTION_OCCURRED</div><div class="ttdef"><b>Definition</b> Events.h:140</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a3ac343b035094c215523687b053bb3f1">EXCEPTION_VECTOR_NMI</a></div><div class="ttdeci">@ EXCEPTION_VECTOR_NMI</div><div class="ttdef"><b>Definition</b> Events.h:26</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ac54b9b284d5db3c9e776ec27586af193"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac54b9b284d5db3c9e776ec27586af193">_VIRTUAL_MACHINE_STATE::RegisterBreakOnMtf</a></div><div class="ttdeci">BOOLEAN RegisterBreakOnMtf</div><div class="ttdef"><b>Definition</b> State.h:298</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6c52a1c64aea43b90fcc571912d12ce" name="af6c52a1c64aea43b90fcc571912d12ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6c52a1c64aea43b90fcc571912d12ce">&#9670;&#160;</a></span>DispatchEventExternalInterrupts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventExternalInterrupts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to external-interrupt events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  851</span>{</div>
<div class="line"><span class="lineno">  852</span>    VMEXIT_INTERRUPT_INFORMATION              InterruptExit = {0};</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  854</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="comment">// read the exit interruption information</span></div>
<div class="line"><span class="lineno">  858</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  859</span>    <a class="code hl_function" href="_vmx_8c.html#af411da3719b3f7f9198be1b8bc6c6874">VmxVmread32P</a>(VMCS_VMEXIT_INTERRUPTION_INFORMATION, &amp;InterruptExit.AsUInt);</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  862</span>    <span class="comment">// Check for immediate vm-exit mechanism</span></div>
<div class="line"><span class="lineno">  863</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">if</span> (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a8e7b60dd13a24ee494ce4f0d8547e671">WaitForImmediateVmexit</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  865</span>        InterruptExit.Vector == <a class="code hl_define" href="_vmx_mechanisms_8h.html#a0c5059c38c6528c2e0010613efc72643">IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</a>)</div>
<div class="line"><span class="lineno">  866</span>    {</div>
<div class="line"><span class="lineno">  867</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  868</span>        <span class="comment">// Disable vm-exit on external interrupts</span></div>
<div class="line"><span class="lineno">  869</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  870</span>        <a class="code hl_function" href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  873</span>        <span class="comment">// Not increase the RIP</span></div>
<div class="line"><span class="lineno">  874</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  875</span>        <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  878</span>        <span class="comment">// Handle immediate vm-exit mechanism</span></div>
<div class="line"><span class="lineno">  879</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  880</span>        <a class="code hl_function" href="_vmx_mechanisms_8c.html#a59d03e813d68a957b646f53bc00867b9">VmxMechanismHandleImmediateVmexit</a>(VCpu);</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  883</span>        <span class="comment">// No need to continue, it&#39;s a HyperDbg mechanism</span></div>
<div class="line"><span class="lineno">  884</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  885</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  886</span>    }</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  889</span>    <span class="comment">// Check process or thread change detections</span></div>
<div class="line"><span class="lineno">  890</span>    <span class="comment">// we cannot ignore injecting the interrupt to the guest if the target interrupt</span></div>
<div class="line"><span class="lineno">  891</span>    <span class="comment">// and process or thread proved to cause a system halt. it halts the system as</span></div>
<div class="line"><span class="lineno">  892</span>    <span class="comment">// we Windows expects to switch the thread while we&#39;re forcing it to not do it</span></div>
<div class="line"><span class="lineno">  893</span>    <span class="comment">// Windows fires a clk interrupt on core 0 and fires IPI on other cores</span></div>
<div class="line"><span class="lineno">  894</span>    <span class="comment">// to change a thread</span></div>
<div class="line"><span class="lineno">  895</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  896</span>    <span class="comment">// It seems that clock interrupt is not applied to all cores,</span></div>
<div class="line"><span class="lineno">  897</span>    <span class="comment">// (https://twitter.com/Intel80x86/status/1655461171280105472?s=20)</span></div>
<div class="line"><span class="lineno">  898</span>    <span class="comment">// So, we no longer check for clock interrupts only in core 0</span></div>
<div class="line"><span class="lineno">  899</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">if</span> ((<span class="comment">/* VCpu-&gt;CoreId == 0 &amp;&amp; */</span> InterruptExit.Vector == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5">CLOCK_INTERRUPT</a>) ||</div>
<div class="line"><span class="lineno">  901</span>        (VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a> != 0 &amp;&amp; InterruptExit.Vector == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8">IPI_INTERRUPT</a>))</div>
<div class="line"><span class="lineno">  902</span>    {</div>
<div class="line"><span class="lineno">  903</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">DebuggerCheckProcessOrThreadChange</a> != NULL)</div>
<div class="line"><span class="lineno">  904</span>        {</div>
<div class="line"><span class="lineno">  905</span>            <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">DebuggerCheckProcessOrThreadChange</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a>);</div>
<div class="line"><span class="lineno">  906</span>        }</div>
<div class="line"><span class="lineno">  907</span>    }</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  910</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  911</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  912</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  913</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  914</span>                                                  (PVOID)InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  915</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  916</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  919</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  920</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  921</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  922</span>    {</div>
<div class="line"><span class="lineno">  923</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  924</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  925</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  926</span>        <a class="code hl_function" href="_idt_emulation_8c.html#a7e398c6b4bc80396994ebdddef64ca16">IdtEmulationHandleExternalInterrupt</a>(VCpu, InterruptExit);</div>
<div class="line"><span class="lineno">  927</span>    }</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  930</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  931</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  933</span>    {</div>
<div class="line"><span class="lineno">  934</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  935</span>        <span class="comment">// Trigger the event</span></div>
<div class="line"><span class="lineno">  936</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  937</span>        <span class="comment">// As the context to event trigger, we send the vector index</span></div>
<div class="line"><span class="lineno">  938</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  939</span>        <span class="comment">// Keep in mind that interrupt might be inserted in pending list</span></div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">// because the guest is not in a interruptible state and will</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="comment">// be re-injected when the guest is ready for interrupts</span></div>
<div class="line"><span class="lineno">  942</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  943</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a>,</div>
<div class="line"><span class="lineno">  944</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  945</span>                                 (PVOID)InterruptExit.Vector,</div>
<div class="line"><span class="lineno">  946</span>                                 NULL,</div>
<div class="line"><span class="lineno">  947</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  948</span>    }</div>
<div class="line"><span class="lineno">  949</span>}</div>
<div class="ttc" id="a_hv_8c_html_a856a41c4038e4065c52eb90db0160ab2"><div class="ttname"><a href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a></div><div class="ttdeci">VOID HvSetExternalInterruptExiting(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set the External Interrupt Exiting.</div><div class="ttdef"><b>Definition</b> Hv.c:1055</div></div>
<div class="ttc" id="a_idt_emulation_8c_html_a7e398c6b4bc80396994ebdddef64ca16"><div class="ttname"><a href="_idt_emulation_8c.html#a7e398c6b4bc80396994ebdddef64ca16">IdtEmulationHandleExternalInterrupt</a></div><div class="ttdeci">VOID IdtEmulationHandleExternalInterrupt(_Inout_ VIRTUAL_MACHINE_STATE *VCpu, _In_ VMEXIT_INTERRUPT_INFORMATION InterruptExit)</div><div class="ttdoc">external-interrupt vm-exit handler</div><div class="ttdef"><b>Definition</b> IdtEmulation.c:415</div></div>
<div class="ttc" id="a_vmx_mechanisms_8c_html_a59d03e813d68a957b646f53bc00867b9"><div class="ttname"><a href="_vmx_mechanisms_8c.html#a59d03e813d68a957b646f53bc00867b9">VmxMechanismHandleImmediateVmexit</a></div><div class="ttdeci">VOID VmxMechanismHandleImmediateVmexit(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle immediate vm-exit after vm-entry.</div><div class="ttdef"><b>Definition</b> VmxMechanisms.c:106</div></div>
<div class="ttc" id="a_vmx_mechanisms_8h_html_a0c5059c38c6528c2e0010613efc72643"><div class="ttname"><a href="_vmx_mechanisms_8h.html#a0c5059c38c6528c2e0010613efc72643">IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</a></div><div class="ttdeci">#define IMMEDIATE_VMEXIT_MECHANISM_VECTOR_FOR_SELF_IPI</div><div class="ttdef"><b>Definition</b> VmxMechanisms.h:18</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da2603143abecb765f8d5975e4710e5729">EXTERNAL_INTERRUPT_OCCURRED</a></div><div class="ttdeci">@ EXTERNAL_INTERRUPT_OCCURRED</div><div class="ttdef"><b>Definition</b> Events.h:141</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a692efc86ae8e8aa1ff92ab7bddbe65d8">IPI_INTERRUPT</a></div><div class="ttdeci">@ IPI_INTERRUPT</div><div class="ttdef"><b>Definition</b> Events.h:63</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#af9640e4f7e36f7a6bf7c56e30a860349a960ecb203830d9b67611e6edf3f2c9a5">CLOCK_INTERRUPT</a></div><div class="ttdeci">@ CLOCK_INTERRUPT</div><div class="ttdef"><b>Definition</b> Events.h:62</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a8e7b60dd13a24ee494ce4f0d8547e671"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a8e7b60dd13a24ee494ce4f0d8547e671">_VIRTUAL_MACHINE_STATE::WaitForImmediateVmexit</a></div><div class="ttdeci">BOOLEAN WaitForImmediateVmexit</div><div class="ttdef"><b>Definition</b> State.h:295</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ad166851f334095bff309813f73ea394e"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">_VIRTUAL_MACHINE_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:306</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_a2ad2c625492f4f42a0cf63c5a826277e"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#a2ad2c625492f4f42a0cf63c5a826277e">_VMM_CALLBACKS::DebuggerCheckProcessOrThreadChange</a></div><div class="ttdeci">INTERCEPTION_CALLBACK_TRIGGER_CLOCK_AND_IPI DebuggerCheckProcessOrThreadChange</div><div class="ttdef"><b>Definition</b> VMM.h:220</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a32237d4ff3cbaf648ff111a2ddbcdd03" name="a32237d4ff3cbaf648ff111a2ddbcdd03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32237d4ff3cbaf648ff111a2ddbcdd03">&#9670;&#160;</a></span>DispatchEventHiddenHookExecCc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookExecCc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to hidden hook exec CC events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  961</span>{</div>
<div class="line"><span class="lineno">  962</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  965</span>    <span class="comment">// Triggering the pre-event (This command only support the</span></div>
<div class="line"><span class="lineno">  966</span>    <span class="comment">// pre-event, the post-event doesn&#39;t make sense in this command)</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  968</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea">HIDDEN_HOOK_EXEC_CC</a>,</div>
<div class="line"><span class="lineno">  969</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  970</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  971</span>                             &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  972</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>); <span class="comment">// it will crash if we pass it NULL</span></div>
<div class="line"><span class="lineno">  973</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae6b7bb6d9db9d890b9fdb1c0fb64adea">HIDDEN_HOOK_EXEC_CC</a></div><div class="ttdeci">@ HIDDEN_HOOK_EXEC_CC</div><div class="ttdef"><b>Definition</b> Events.h:112</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdd5d2cff9ea39a842046b1af7a72c51" name="abdd5d2cff9ea39a842046b1af7a72c51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd5d2cff9ea39a842046b1af7a72c51">&#9670;&#160;</a></span>DispatchEventHiddenHookExecDetours()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookExecDetours </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to hidden hook exec detours events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  985</span>{</div>
<div class="line"><span class="lineno">  986</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  989</span>    <span class="comment">// Triggering the pre-event (This command only support the</span></div>
<div class="line"><span class="lineno">  990</span>    <span class="comment">// pre-event, the post-event doesn&#39;t make sense in this command)</span></div>
<div class="line"><span class="lineno">  991</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  992</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0">HIDDEN_HOOK_EXEC_DETOURS</a>,</div>
<div class="line"><span class="lineno">  993</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  994</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno">  995</span>                             &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  996</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>); <span class="comment">// it will crash if we pass it NULL</span></div>
<div class="line"><span class="lineno">  997</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da7855c6424b4f6ae73f06fce56de6f8d0">HIDDEN_HOOK_EXEC_DETOURS</a></div><div class="ttdeci">@ HIDDEN_HOOK_EXEC_DETOURS</div><div class="ttdef"><b>Definition</b> Events.h:111</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab78373fcc45e3dc72db25e4475bbff24" name="ab78373fcc45e3dc72db25e4475bbff24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab78373fcc45e3dc72db25e4475bbff24">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecExecutePostEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookPageReadWriteExecExecutePostEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, execute events (post) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1382</span>{</div>
<div class="line"><span class="lineno"> 1383</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1384</span>    <span class="comment">// Triggering the post-event (for the execute hooks)</span></div>
<div class="line"><span class="lineno"> 1385</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1386</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dafebc29e2a0f13890247ba467038d9275">HIDDEN_HOOK_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1387</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1388</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1389</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1390</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1393</span>    <span class="comment">// Triggering the post-event (for the read &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1394</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1395</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed">HIDDEN_HOOK_READ_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1396</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1397</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1398</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1399</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1402</span>    <span class="comment">// Triggering the post-event (for the write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1403</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1404</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536">HIDDEN_HOOK_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1405</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1406</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1407</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1408</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1411</span>    <span class="comment">// Triggering the post-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1412</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1413</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1414</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1415</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1416</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1417</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1418</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536">HIDDEN_HOOK_WRITE_AND_EXECUTE</a></div><div class="ttdeci">@ HIDDEN_HOOK_WRITE_AND_EXECUTE</div><div class="ttdef"><b>Definition</b> Events.h:103</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed">HIDDEN_HOOK_READ_AND_EXECUTE</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ_AND_EXECUTE</div><div class="ttdef"><b>Definition</b> Events.h:102</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</div><div class="ttdef"><b>Definition</b> Events.h:100</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dafebc29e2a0f13890247ba467038d9275"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dafebc29e2a0f13890247ba467038d9275">HIDDEN_HOOK_EXECUTE</a></div><div class="ttdeci">@ HIDDEN_HOOK_EXECUTE</div><div class="ttdef"><b>Definition</b> Events.h:106</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e48998eb9fc107f98f9759b9b323e0c" name="a4e48998eb9fc107f98f9759b9b323e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e48998eb9fc107f98f9759b9b323e0c">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecReadPostEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookPageReadWriteExecReadPostEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, read events (post) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1290</span>{</div>
<div class="line"><span class="lineno"> 1291</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1292</span>    <span class="comment">// Triggering the post-event (for the read hooks)</span></div>
<div class="line"><span class="lineno"> 1293</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1294</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a>,</div>
<div class="line"><span class="lineno"> 1295</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1296</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1297</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1298</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1301</span>    <span class="comment">// Triggering the post-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1303</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1304</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1305</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1306</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1307</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1310</span>    <span class="comment">// Triggering the post-event (for the read &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1311</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1312</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed">HIDDEN_HOOK_READ_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1313</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1314</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1315</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1316</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1319</span>    <span class="comment">// Triggering the post-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1320</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1321</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1322</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1323</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1324</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1325</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1326</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ_AND_WRITE</div><div class="ttdef"><b>Definition</b> Events.h:101</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a></div><div class="ttdeci">@ HIDDEN_HOOK_READ</div><div class="ttdef"><b>Definition</b> Events.h:104</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85600db927f918baefeec1d3d03b84da" name="a85600db927f918baefeec1d3d03b84da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85600db927f918baefeec1d3d03b84da">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecuteExecutePreEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DispatchEventHiddenHookPageReadWriteExecuteExecutePreEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *</td>          <td class="paramname"><span class="paramname"><em>IsTriggeringPostEventAllowed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, execute events (pre) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
    <tr><td class="paramname">IsTriggeringPostEventAllowed</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1197</span>{</div>
<div class="line"><span class="lineno"> 1198</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno"> 1199</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq  = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1200</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1203</span>    <span class="comment">// Triggering the pre-event (for the execute hooks)</span></div>
<div class="line"><span class="lineno"> 1204</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1205</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dafebc29e2a0f13890247ba467038d9275">HIDDEN_HOOK_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1206</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1207</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1208</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1209</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1212</span>    {</div>
<div class="line"><span class="lineno"> 1213</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1214</span>    }</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1217</span>    {</div>
<div class="line"><span class="lineno"> 1218</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1219</span>    }</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1222</span>    <span class="comment">// Triggering the pre-event (for the read &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1223</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1224</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed">HIDDEN_HOOK_READ_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1225</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1226</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1227</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1228</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1231</span>    {</div>
<div class="line"><span class="lineno"> 1232</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1233</span>    }</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1236</span>    {</div>
<div class="line"><span class="lineno"> 1237</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1238</span>    }</div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1241</span>    <span class="comment">// Triggering the pre-event (for the write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1242</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1243</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536">HIDDEN_HOOK_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1244</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1245</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1246</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1247</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1250</span>    {</div>
<div class="line"><span class="lineno"> 1251</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1252</span>    }</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1255</span>    {</div>
<div class="line"><span class="lineno"> 1256</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1257</span>    }</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1260</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1261</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1262</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1263</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1264</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1265</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1266</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1267</span> </div>
<div class="line"><span class="lineno"> 1268</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1269</span>    {</div>
<div class="line"><span class="lineno"> 1270</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1271</span>    }</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1274</span>    {</div>
<div class="line"><span class="lineno"> 1275</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1276</span>    }</div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>    <span class="keywordflow">return</span> ShortCircuitingEvent;</div>
<div class="line"><span class="lineno"> 1279</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebd5f93678619ac6e74debd886d42988" name="aebd5f93678619ac6e74debd886d42988"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebd5f93678619ac6e74debd886d42988">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecuteReadPreEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DispatchEventHiddenHookPageReadWriteExecuteReadPreEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *</td>          <td class="paramname"><span class="paramname"><em>IsTriggeringPostEventAllowed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, read events (pre) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
    <tr><td class="paramname">IsTriggeringPostEventAllowed</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1009</span>{</div>
<div class="line"><span class="lineno"> 1010</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno"> 1011</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq  = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1012</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1015</span>    <span class="comment">// Triggering the pre-event (for the read hooks)</span></div>
<div class="line"><span class="lineno"> 1016</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1017</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae867265e725894418ee56eb70c167607">HIDDEN_HOOK_READ</a>,</div>
<div class="line"><span class="lineno"> 1018</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1019</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1020</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1021</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1024</span>    {</div>
<div class="line"><span class="lineno"> 1025</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1026</span>    }</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1029</span>    {</div>
<div class="line"><span class="lineno"> 1030</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1031</span>    }</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1034</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1035</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1036</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1037</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1038</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1039</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1040</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1043</span>    {</div>
<div class="line"><span class="lineno"> 1044</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1045</span>    }</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1048</span>    {</div>
<div class="line"><span class="lineno"> 1049</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1050</span>    }</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1053</span>    <span class="comment">// Triggering the pre-event (for the read &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1054</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1055</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dae588d64c419b39224b3310e5c13189ed">HIDDEN_HOOK_READ_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1056</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1057</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1058</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1059</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1062</span>    {</div>
<div class="line"><span class="lineno"> 1063</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1064</span>    }</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1067</span>    {</div>
<div class="line"><span class="lineno"> 1068</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1069</span>    }</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1072</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1073</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1074</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1075</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1076</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1077</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1078</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1081</span>    {</div>
<div class="line"><span class="lineno"> 1082</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1083</span>    }</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1086</span>    {</div>
<div class="line"><span class="lineno"> 1087</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1088</span>    }</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>    <span class="keywordflow">return</span> ShortCircuitingEvent;</div>
<div class="line"><span class="lineno"> 1091</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3afed71e259f9f6c1e0524317b391cb2" name="a3afed71e259f9f6c1e0524317b391cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3afed71e259f9f6c1e0524317b391cb2">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecuteWritePreEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DispatchEventHiddenHookPageReadWriteExecuteWritePreEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> *</td>          <td class="paramname"><span class="paramname"><em>IsTriggeringPostEventAllowed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, write events (pre) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
    <tr><td class="paramname">IsTriggeringPostEventAllowed</td><td>Is the caller required to trigger post event </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1103</span>{</div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno"> 1105</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq  = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1106</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">// Triggering the pre-event (for the write hooks)</span></div>
<div class="line"><span class="lineno"> 1110</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1111</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1112</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1113</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1114</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1115</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1118</span>    {</div>
<div class="line"><span class="lineno"> 1119</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1120</span>    }</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1123</span>    {</div>
<div class="line"><span class="lineno"> 1124</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1125</span>    }</div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1128</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1130</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1131</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1132</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1133</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1134</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1137</span>    {</div>
<div class="line"><span class="lineno"> 1138</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1139</span>    }</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1142</span>    {</div>
<div class="line"><span class="lineno"> 1143</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1144</span>    }</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1147</span>    <span class="comment">// Triggering the pre-event (for the write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1148</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1149</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536">HIDDEN_HOOK_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1150</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1151</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1152</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1153</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1154</span> </div>
<div class="line"><span class="lineno"> 1155</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1156</span>    {</div>
<div class="line"><span class="lineno"> 1157</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1158</span>    }</div>
<div class="line"><span class="lineno"> 1159</span> </div>
<div class="line"><span class="lineno"> 1160</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1161</span>    {</div>
<div class="line"><span class="lineno"> 1162</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1163</span>    }</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1166</span>    <span class="comment">// Triggering the pre-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1167</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1168</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1169</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1170</span>                                                  <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1171</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno"> 1172</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordflow">if</span> (EventTriggerResult == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno"> 1175</span>    {</div>
<div class="line"><span class="lineno"> 1176</span>        ShortCircuitingEvent = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1177</span>    }</div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno"> 1180</span>    {</div>
<div class="line"><span class="lineno"> 1181</span>        *IsTriggeringPostEventAllowed = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1182</span>    }</div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>    <span class="keywordflow">return</span> ShortCircuitingEvent;</div>
<div class="line"><span class="lineno"> 1185</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a></div><div class="ttdeci">@ HIDDEN_HOOK_WRITE</div><div class="ttdef"><b>Definition</b> Events.h:105</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b479b4139a23747b75523910f9b9417" name="a6b479b4139a23747b75523910f9b9417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b479b4139a23747b75523910f9b9417">&#9670;&#160;</a></span>DispatchEventHiddenHookPageReadWriteExecWritePostEvent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventHiddenHookPageReadWriteExecWritePostEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Context</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to read &amp; write &amp; execute, write events (post) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">Context</td><td>The context of the caller </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1337</span>{</div>
<div class="line"><span class="lineno"> 1338</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1339</span>    <span class="comment">// Triggering the post-event (for the write hooks)</span></div>
<div class="line"><span class="lineno"> 1340</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1341</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf0d6ee52cb6e4c9689dcec72c8ee25cb">HIDDEN_HOOK_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1342</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1343</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1344</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1345</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1348</span>    <span class="comment">// Triggering the post-event (for the read &amp; write hooks)</span></div>
<div class="line"><span class="lineno"> 1349</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1350</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dad808743389ae088141be0ebec72d3e1f">HIDDEN_HOOK_READ_AND_WRITE</a>,</div>
<div class="line"><span class="lineno"> 1351</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1352</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1353</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1354</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1355</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1356</span>    <span class="comment">// Triggering the post-event (for the write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1357</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1358</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da45d4837d81cf633772c0c6eff77eb536">HIDDEN_HOOK_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1359</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1360</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1361</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1362</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1363</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1364</span>    <span class="comment">// Triggering the post-event (for the read &amp; write &amp; execute hooks)</span></div>
<div class="line"><span class="lineno"> 1365</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1366</span>    <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf1f8a02ebe274ec75875a2f203b72b7d">HIDDEN_HOOK_READ_AND_WRITE_AND_EXECUTE</a>,</div>
<div class="line"><span class="lineno"> 1367</span>                             <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno"> 1368</span>                             <a class="code hl_variable" href="hyperhv_2header_2common_2_dpc_8h.html#a446af93100756f0d846f1bfe80e30b4b">Context</a>,</div>
<div class="line"><span class="lineno"> 1369</span>                             NULL,</div>
<div class="line"><span class="lineno"> 1370</span>                             VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno"> 1371</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9beef1729154452db4d14e11fbfa4478" name="a9beef1729154452db4d14e11fbfa4478"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9beef1729154452db4d14e11fbfa4478">&#9670;&#160;</a></span>DispatchEventIO()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventIO </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to IO events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  426</span>{</div>
<div class="line"><span class="lineno">  427</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult  = <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7ae516c2dd2efca662c8e3f6fd28b04f0d">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_NO_INITIALIZED</a>;</div>
<div class="line"><span class="lineno">  428</span>    VMX_EXIT_QUALIFICATION_IO_INSTRUCTION     IoQualification     = {.AsUInt = VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a02c526f56dd4a8b75459fe908e6e14d3">ExitQualification</a>};</div>
<div class="line"><span class="lineno">  429</span>    RFLAGS                                    Flags               = {0};</div>
<div class="line"><span class="lineno">  430</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">// Read Guest&#39;s RFLAGS</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  435</span>    <a class="code hl_function" href="_vmx_8c.html#a030c9345db1d1e6cdf76c3289f5090d9">VmxVmread64P</a>(VMCS_GUEST_RFLAGS, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *)&amp;Flags);</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  438</span>    <span class="comment">// As the context to event trigger, port address</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a>)</div>
<div class="line"><span class="lineno">  441</span>    {</div>
<div class="line"><span class="lineno">  442</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  443</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  444</span>                                                      (PVOID)IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  445</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  446</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  447</span>    }</div>
<div class="line"><span class="lineno">  448</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a8c9b3e408af80d53be16f30c569710f9">AccessOut</a>)</div>
<div class="line"><span class="lineno">  449</span>    {</div>
<div class="line"><span class="lineno">  450</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  451</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  452</span>                                                      (PVOID)IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  453</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  454</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  459</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  461</span>    {</div>
<div class="line"><span class="lineno">  462</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  463</span>        <span class="comment">// Call the I/O Handler</span></div>
<div class="line"><span class="lineno">  464</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  465</span>        <a class="code hl_function" href="_io_handler_8c.html#a8c882cef497ffae117ee4badbd7805dd">IoHandleIoVmExits</a>(VCpu, IoQualification, Flags);</div>
<div class="line"><span class="lineno">  466</span>    }</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  472</span>    {</div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a>)</div>
<div class="line"><span class="lineno">  474</span>        {</div>
<div class="line"><span class="lineno">  475</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  476</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  477</span>                                     (PVOID)IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  478</span>                                     NULL,</div>
<div class="line"><span class="lineno">  479</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  480</span>        }</div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IoQualification.DirectionOfAccess == <a class="code hl_enumvalue" href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a8c9b3e408af80d53be16f30c569710f9">AccessOut</a>)</div>
<div class="line"><span class="lineno">  482</span>        {</div>
<div class="line"><span class="lineno">  483</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  484</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  485</span>                                     (PVOID)IoQualification.PortNumber,</div>
<div class="line"><span class="lineno">  486</span>                                     NULL,</div>
<div class="line"><span class="lineno">  487</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  488</span>        }</div>
<div class="line"><span class="lineno">  489</span>    }</div>
<div class="line"><span class="lineno">  490</span>}</div>
<div class="ttc" id="a_io_handler_8c_html_a8c882cef497ffae117ee4badbd7805dd"><div class="ttname"><a href="_io_handler_8c.html#a8c882cef497ffae117ee4badbd7805dd">IoHandleIoVmExits</a></div><div class="ttdeci">VOID IoHandleIoVmExits(VIRTUAL_MACHINE_STATE *VCpu, VMX_EXIT_QUALIFICATION_IO_INSTRUCTION IoQualification, RFLAGS Flags)</div><div class="ttdoc">VM-Exit handler for I/O Instructions (in/out)</div><div class="ttdef"><b>Definition</b> IoHandler.c:24</div></div>
<div class="ttc" id="a_io_handler_8h_html_a7222041ea8f61c6d06952ddb7da9d4a6a8c9b3e408af80d53be16f30c569710f9"><div class="ttname"><a href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a8c9b3e408af80d53be16f30c569710f9">AccessOut</a></div><div class="ttdeci">@ AccessOut</div><div class="ttdef"><b>Definition</b> IoHandler.h:24</div></div>
<div class="ttc" id="a_io_handler_8h_html_a7222041ea8f61c6d06952ddb7da9d4a6a9caacbeb555fb90efe8f786a87b7105a"><div class="ttname"><a href="_io_handler_8h.html#a7222041ea8f61c6d06952ddb7da9d4a6a9caacbeb555fb90efe8f786a87b7105a">AccessIn</a></div><div class="ttdeci">@ AccessIn</div><div class="ttdef"><b>Definition</b> IoHandler.h:25</div></div>
<div class="ttc" id="a_vmx_8c_html_a030c9345db1d1e6cdf76c3289f5090d9"><div class="ttname"><a href="_vmx_8c.html#a030c9345db1d1e6cdf76c3289f5090d9">VmxVmread64P</a></div><div class="ttdeci">UCHAR VmxVmread64P(size_t Field, UINT64 *FieldValue)</div><div class="ttdoc">VMX VMREAD instruction (64-bit)</div><div class="ttdef"><b>Definition</b> Vmx.c:72</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a4d07669f2ae9f2911461c19e659081e7ae516c2dd2efca662c8e3f6fd28b04f0d"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7ae516c2dd2efca662c8e3f6fd28b04f0d">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_NO_INITIALIZED</a></div><div class="ttdeci">@ VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_NO_INITIALIZED</div><div class="ttdef"><b>Definition</b> Events.h:78</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da231fe69249739631c760bf0116db5ebc">OUT_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ OUT_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:135</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da6a202de571d60ac89bb974578614c435">IN_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ IN_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:134</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a02c526f56dd4a8b75459fe908e6e14d3"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a02c526f56dd4a8b75459fe908e6e14d3">_VIRTUAL_MACHINE_STATE::ExitQualification</a></div><div class="ttdeci">UINT32 ExitQualification</div><div class="ttdef"><b>Definition</b> State.h:308</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab42e4975ea7a08129dc29a40c011017c" name="ab42e4975ea7a08129dc29a40c011017c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab42e4975ea7a08129dc29a40c011017c">&#9670;&#160;</a></span>DispatchEventMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#aae7e83f1666860f94b796560cdf1d308">DEBUGGER_EVENT_MODE_TYPE</a></td>          <td class="paramname"><span class="paramname"><em>TargetMode</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>HandleState</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to user-mode/kernel-mode execution trap events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">IsUserMode</td><td>Whether the execution event caused by a switch from kernel-to-user or otherwise user-to-kernel </td></tr>
    <tr><td class="paramname">HandleState</td><td>whether the state should be handled by dispatcher or not</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  313</span>{</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  315</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  318</span>    <span class="comment">// As the context to event trigger, we send NULL</span></div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  320</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#afa6581e952ff0d7e78a6ff312ed942bd">g_ExecTrapInitialized</a>)</div>
<div class="line"><span class="lineno">  321</span>    {</div>
<div class="line"><span class="lineno">  322</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  323</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  325</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf21246cecb50b03bc8977c530ea47e7a">TRAP_EXECUTION_MODE_CHANGED</a>,</div>
<div class="line"><span class="lineno">  326</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  327</span>                                                      (PVOID)TargetMode,</div>
<div class="line"><span class="lineno">  328</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  329</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  332</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  333</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a> &amp;&amp; HandleState)</div>
<div class="line"><span class="lineno">  335</span>        {</div>
<div class="line"><span class="lineno">  336</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  337</span>            <span class="comment">// Handle the user-mode/kernel-mode execution trap event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  338</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>            <a class="code hl_function" href="_exec_trap_8c.html#af65579bb774da528e4cbb0804a1d1c2d">ExecTrapHandleMoveToAdjustedTrapState</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)TargetMode);</div>
<div class="line"><span class="lineno">  340</span>        }</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  343</span>        <span class="comment">// *** Post-event doesn&#39;t make sense for this kind of event! ***</span></div>
<div class="line"><span class="lineno">  344</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  345</span>    }</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  347</span>    {</div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  349</span>        <span class="comment">// Otherwise and if there is no event, we should handle the</span></div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">// user-mode/kernel-mode execution trap normally</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">if</span> (HandleState)</div>
<div class="line"><span class="lineno">  353</span>        {</div>
<div class="line"><span class="lineno">  354</span>            <a class="code hl_function" href="_exec_trap_8c.html#af65579bb774da528e4cbb0804a1d1c2d">ExecTrapHandleMoveToAdjustedTrapState</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)TargetMode);</div>
<div class="line"><span class="lineno">  355</span>        }</div>
<div class="line"><span class="lineno">  356</span>    }</div>
<div class="line"><span class="lineno">  357</span>}</div>
<div class="ttc" id="a_exec_trap_8c_html_af65579bb774da528e4cbb0804a1d1c2d"><div class="ttname"><a href="_exec_trap_8c.html#af65579bb774da528e4cbb0804a1d1c2d">ExecTrapHandleMoveToAdjustedTrapState</a></div><div class="ttdeci">VOID ExecTrapHandleMoveToAdjustedTrapState(VIRTUAL_MACHINE_STATE *VCpu, DEBUGGER_EVENT_MODE_TYPE TargetMode)</div><div class="ttdoc">Restore the execution of the trap to adjusted trap state.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:753</div></div>
<div class="ttc" id="a_global_variables_8h_html_afa6581e952ff0d7e78a6ff312ed942bd"><div class="ttname"><a href="_global_variables_8h.html#afa6581e952ff0d7e78a6ff312ed942bd">g_ExecTrapInitialized</a></div><div class="ttdeci">BOOLEAN g_ExecTrapInitialized</div><div class="ttdoc">Showes whether the execution trap handler is allowed to trigger an event or not.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:149</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf21246cecb50b03bc8977c530ea47e7a"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf21246cecb50b03bc8977c530ea47e7a">TRAP_EXECUTION_MODE_CHANGED</a></div><div class="ttdeci">@ TRAP_EXECUTION_MODE_CHANGED</div><div class="ttdef"><b>Definition</b> Events.h:169</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab29357f2d04f132cb67577cb62162ec8" name="ab29357f2d04f132cb67577cb62162ec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab29357f2d04f132cb67577cb62162ec8">&#9670;&#160;</a></span>DispatchEventMov2DebugRegs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMov2DebugRegs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to MOV 2 DR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  635</span>{</div>
<div class="line"><span class="lineno">  636</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  640</span>    <span class="comment">// Handle access to debug registers, if we should not ignore it, it is</span></div>
<div class="line"><span class="lineno">  641</span>    <span class="comment">// because on detecting thread scheduling we ignore the hardware debug</span></div>
<div class="line"><span class="lineno">  642</span>    <span class="comment">// registers modifications</span></div>
<div class="line"><span class="lineno">  643</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a> != NULL &amp;&amp;</div>
<div class="line"><span class="lineno">  645</span>        <a class="code hl_variable" href="_global_variables_8h.html#aa97473c862a98f925b05ef0272432090">g_Callbacks</a>.<a class="code hl_variable" href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a>,</div>
<div class="line"><span class="lineno">  646</span>                                                                              <a class="code hl_enumvalue" href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a>))</div>
<div class="line"><span class="lineno">  647</span>    {</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  649</span>    }</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  652</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  654</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a>,</div>
<div class="line"><span class="lineno">  655</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  656</span>                                                  NULL,</div>
<div class="line"><span class="lineno">  657</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  658</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  662</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  664</span>    {</div>
<div class="line"><span class="lineno">  665</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  666</span>        <span class="comment">// Handle RDPMC (emulate MOV 2 Debug Registers)</span></div>
<div class="line"><span class="lineno">  667</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  668</span>        <a class="code hl_function" href="_hv_8c.html#a17ca5235cf591dc0e8b36b4a850e4592">HvHandleMovDebugRegister</a>(VCpu);</div>
<div class="line"><span class="lineno">  669</span>    }</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  673</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  674</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  675</span>    {</div>
<div class="line"><span class="lineno">  676</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a>,</div>
<div class="line"><span class="lineno">  677</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  678</span>                                 NULL,</div>
<div class="line"><span class="lineno">  679</span>                                 NULL,</div>
<div class="line"><span class="lineno">  680</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  681</span>    }</div>
<div class="line"><span class="lineno">  682</span>}</div>
<div class="ttc" id="a_data_types_8h_html_acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd"><div class="ttname"><a href="_data_types_8h.html#acfd6753933f87f36dcdc4ca89a98c2bba8a119c7a070b95e9637dde60782d0efd">DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</a></div><div class="ttdeci">@ DEBUGGER_THREAD_PROCESS_TRACING_INTERCEPT_CLOCK_DEBUG_REGISTER_INTERCEPTION</div><div class="ttdef"><b>Definition</b> DataTypes.h:108</div></div>
<div class="ttc" id="a_hv_8c_html_a17ca5235cf591dc0e8b36b4a850e4592"><div class="ttname"><a href="_hv_8c.html#a17ca5235cf591dc0e8b36b4a850e4592">HvHandleMovDebugRegister</a></div><div class="ttdeci">VOID HvHandleMovDebugRegister(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle Mov to Debug Registers Exitings.</div><div class="ttdef"><b>Definition</b> Hv.c:748</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da1049ea359ccd219c39ef6a01f535f543">DEBUG_REGISTERS_ACCESSED</a></div><div class="ttdeci">@ DEBUG_REGISTERS_ACCESSED</div><div class="ttdef"><b>Definition</b> Events.h:146</div></div>
<div class="ttc" id="astruct___v_m_m___c_a_l_l_b_a_c_k_s_html_ac3c5e64853124cfbe9a766570cb99e1e"><div class="ttname"><a href="struct___v_m_m___c_a_l_l_b_a_c_k_s.html#ac3c5e64853124cfbe9a766570cb99e1e">_VMM_CALLBACKS::KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</a></div><div class="ttdeci">KD_QUERY_DEBUGGER_THREAD_OR_PROCESS_TRACING_DETAILS_BY_CORE_ID KdQueryDebuggerQueryThreadOrProcessTracingDetailsByCoreId</div><div class="ttdef"><b>Definition</b> VMM.h:222</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a83d04e9dee78b3fb4350c2f588877947" name="a83d04e9dee78b3fb4350c2f588877947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d04e9dee78b3fb4350c2f588877947">&#9670;&#160;</a></span>DispatchEventMovToCr3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMovToCr3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to mov 2 cr3 events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  367</span>{</div>
<div class="line"><span class="lineno">  368</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  369</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  372</span>    <span class="comment">// As the context to event trigger, we send NULL</span></div>
<div class="line"><span class="lineno">  373</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  374</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#afa6581e952ff0d7e78a6ff312ed942bd">g_ExecTrapInitialized</a>)</div>
<div class="line"><span class="lineno">  375</span>    {</div>
<div class="line"><span class="lineno">  376</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  377</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  378</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  379</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da857386fb54ce8d7f482bee444ff9e827">CONTROL_REGISTER_3_MODIFIED</a>,</div>
<div class="line"><span class="lineno">  380</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  381</span>                                                      NULL,</div>
<div class="line"><span class="lineno">  382</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  383</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  386</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  387</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  389</span>        {</div>
<div class="line"><span class="lineno">  390</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  391</span>            <span class="comment">// Handle the mov 2 cr3 event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  392</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  393</span>            <span class="comment">// ExecTrapHandleRestoringToNormalState(VCpu);</span></div>
<div class="line"><span class="lineno">  394</span>        }</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  397</span>        <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  398</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  400</span>        {</div>
<div class="line"><span class="lineno">  401</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da857386fb54ce8d7f482bee444ff9e827">CONTROL_REGISTER_3_MODIFIED</a>,</div>
<div class="line"><span class="lineno">  402</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  403</span>                                     NULL,</div>
<div class="line"><span class="lineno">  404</span>                                     NULL,</div>
<div class="line"><span class="lineno">  405</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  406</span>        }</div>
<div class="line"><span class="lineno">  407</span>    }</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  409</span>    {</div>
<div class="line"><span class="lineno">  410</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  411</span>        <span class="comment">// Otherwise and if there is no event, we should handle the</span></div>
<div class="line"><span class="lineno">  412</span>        <span class="comment">// mov 2 cr3 normally</span></div>
<div class="line"><span class="lineno">  413</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  414</span>        <span class="comment">// ExecTrapHandleRestoringToNormalState(VCpu);</span></div>
<div class="line"><span class="lineno">  415</span>    }</div>
<div class="line"><span class="lineno">  416</span>}</div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da857386fb54ce8d7f482bee444ff9e827"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da857386fb54ce8d7f482bee444ff9e827">CONTROL_REGISTER_3_MODIFIED</a></div><div class="ttdeci">@ CONTROL_REGISTER_3_MODIFIED</div><div class="ttdef"><b>Definition</b> Events.h:164</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbc945909fecd8ece6818d3424af63eb" name="acbc945909fecd8ece6818d3424af63eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbc945909fecd8ece6818d3424af63eb">&#9670;&#160;</a></span>DispatchEventMovToFromControlRegisters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventMovToFromControlRegisters </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to mov to/from CR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  692</span>{</div>
<div class="line"><span class="lineno">  693</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   ModifyReg;</div>
<div class="line"><span class="lineno">  694</span>    VMX_EXIT_QUALIFICATION_MOV_CR *           CrExitQualification;</div>
<div class="line"><span class="lineno">  695</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  696</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  697</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                                    ExitQualification   = 0;</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">// Read the exit qualification</span></div>
<div class="line"><span class="lineno">  701</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_function" href="_vmx_8c.html#af411da3719b3f7f9198be1b8bc6c6874">VmxVmread32P</a>(VMCS_EXIT_QUALIFICATION, &amp;ExitQualification);</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    CrExitQualification = (VMX_EXIT_QUALIFICATION_MOV_CR *)&amp;ExitQualification;</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="keywordflow">if</span> (CrExitQualification-&gt;AccessType == VMX_EXIT_QUALIFICATION_ACCESS_MOV_TO_CR)</div>
<div class="line"><span class="lineno">  707</span>    {</div>
<div class="line"><span class="lineno">  708</span>        ModifyReg = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  709</span>    }</div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  711</span>    {</div>
<div class="line"><span class="lineno">  712</span>        ModifyReg = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  713</span>    }</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  716</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  718</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(ModifyReg ? <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a> : <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a>,</div>
<div class="line"><span class="lineno">  719</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  720</span>                                                  (PVOID)CrExitQualification-&gt;ControlRegister,</div>
<div class="line"><span class="lineno">  721</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  722</span>                                                  VCpu-&gt;Regs);</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  725</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  726</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  727</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  728</span>    {</div>
<div class="line"><span class="lineno">  729</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  730</span>        <span class="comment">// Handle mov to/from control registers (emulate CR access)</span></div>
<div class="line"><span class="lineno">  731</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  732</span>        <a class="code hl_function" href="_hv_8c.html#a00cc8024816442f874bee6955dbad89c">HvHandleControlRegisterAccess</a>(VCpu, CrExitQualification);</div>
<div class="line"><span class="lineno">  733</span>    }</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  736</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  737</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  738</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  739</span>    {</div>
<div class="line"><span class="lineno">  740</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(ModifyReg ? <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a> : <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a>,</div>
<div class="line"><span class="lineno">  741</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  742</span>                                 (PVOID)CrExitQualification-&gt;ControlRegister,</div>
<div class="line"><span class="lineno">  743</span>                                 <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>,</div>
<div class="line"><span class="lineno">  744</span>                                 VCpu-&gt;Regs);</div>
<div class="line"><span class="lineno">  745</span>    }</div>
<div class="line"><span class="lineno">  746</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_hv_8c_html_a00cc8024816442f874bee6955dbad89c"><div class="ttname"><a href="_hv_8c.html#a00cc8024816442f874bee6955dbad89c">HvHandleControlRegisterAccess</a></div><div class="ttdeci">VOID HvHandleControlRegisterAccess(VIRTUAL_MACHINE_STATE *VCpu, VMX_EXIT_QUALIFICATION_MOV_CR *CrExitQualification)</div><div class="ttdoc">Handles Guest Access to control registers.</div><div class="ttdef"><b>Definition</b> Hv.c:136</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da60abbb3ddfdf7dcc63cefa0d14f03433">CONTROL_REGISTER_READ</a></div><div class="ttdeci">@ CONTROL_REGISTER_READ</div><div class="ttdef"><b>Definition</b> Events.h:163</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9f2f6a92ab0d60fbdec4fa215adf38f0">CONTROL_REGISTER_MODIFIED</a></div><div class="ttdeci">@ CONTROL_REGISTER_MODIFIED</div><div class="ttdef"><b>Definition</b> Events.h:162</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40a5898e33596b5af4a62b43410c7729" name="a40a5898e33596b5af4a62b43410c7729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a5898e33596b5af4a62b43410c7729">&#9670;&#160;</a></span>DispatchEventRdmsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventRdmsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDMSR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  500</span>{</div>
<div class="line"><span class="lineno">  501</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  507</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  508</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  509</span>                                                  (PVOID)(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff),</div>
<div class="line"><span class="lineno">  510</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  511</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  514</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  515</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  516</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  517</span>    {</div>
<div class="line"><span class="lineno">  518</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  519</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  520</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  521</span>        <a class="code hl_function" href="_msr_handlers_8c.html#acab5fb643fae7a845f5d3d71ce18e9ef">MsrHandleRdmsrVmexit</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  522</span>    }</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  528</span>    {</div>
<div class="line"><span class="lineno">  529</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  530</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  531</span>                                 (PVOID)(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff),</div>
<div class="line"><span class="lineno">  532</span>                                 NULL,</div>
<div class="line"><span class="lineno">  533</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  534</span>    }</div>
<div class="line"><span class="lineno">  535</span>}</div>
<div class="ttc" id="a_msr_handlers_8c_html_acab5fb643fae7a845f5d3d71ce18e9ef"><div class="ttname"><a href="_msr_handlers_8c.html#acab5fb643fae7a845f5d3d71ce18e9ef">MsrHandleRdmsrVmexit</a></div><div class="ttdeci">VOID MsrHandleRdmsrVmexit(PGUEST_REGS GuestRegs)</div><div class="ttdoc">Handles in the cases when RDMSR causes a vm-exit.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:21</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da5a3c774cfe921a82c832ce59284a4f93">RDMSR_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ RDMSR_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:128</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a9a9133a328f13d405c31df928307e9fd"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">GUEST_REGS::rcx</a></div><div class="ttdeci">UINT64 rcx</div><div class="ttdef"><b>Definition</b> BasicTypes.h:76</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bcf13ef8771eef5a5d7d2f375d3225f" name="a3bcf13ef8771eef5a5d7d2f375d3225f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bcf13ef8771eef5a5d7d2f375d3225f">&#9670;&#160;</a></span>DispatchEventRdpmc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventRdpmc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDPMC events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  590</span>{</div>
<div class="line"><span class="lineno">  591</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  592</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  595</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  596</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  597</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  598</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  599</span>                                                  NULL,</div>
<div class="line"><span class="lineno">  600</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  601</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  604</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  605</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  607</span>    {</div>
<div class="line"><span class="lineno">  608</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  609</span>        <span class="comment">// Handle RDPMC (emulate RDPMC)</span></div>
<div class="line"><span class="lineno">  610</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  611</span>        <a class="code hl_function" href="_counters_8c.html#a6a17cba3d8cbb06782a5856f9c3b766a">CounterEmulateRdpmc</a>(VCpu);</div>
<div class="line"><span class="lineno">  612</span>    }</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  615</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  618</span>    {</div>
<div class="line"><span class="lineno">  619</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  620</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  621</span>                                 NULL,</div>
<div class="line"><span class="lineno">  622</span>                                 NULL,</div>
<div class="line"><span class="lineno">  623</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  624</span>    }</div>
<div class="line"><span class="lineno">  625</span>}</div>
<div class="ttc" id="a_counters_8c_html_a6a17cba3d8cbb06782a5856f9c3b766a"><div class="ttname"><a href="_counters_8c.html#a6a17cba3d8cbb06782a5856f9c3b766a">CounterEmulateRdpmc</a></div><div class="ttdeci">VOID CounterEmulateRdpmc(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDPMC.</div><div class="ttdef"><b>Definition</b> Counters.c:62</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652dab13f256e40f039d31bd0be0f50279170">PMC_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ PMC_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:152</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a61e2dcbd730450008e8f6f4dcc6c7b42" name="a61e2dcbd730450008e8f6f4dcc6c7b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61e2dcbd730450008e8f6f4dcc6c7b42">&#9670;&#160;</a></span>DispatchEventTsc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventTsc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsRdtscp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to RDTSC/RDTSCP events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">IsRdtscp</td><td>Is a RDTSCP or RDTSC </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  195</span>{</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// As the context to event trigger, we send the false which means</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// it&#39;s an rdtsc (for rdtscp we set Context to true)</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">// Note : Using !tsc command in transparent-mode is not allowed</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  204</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  205</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  206</span>                                                  (PVOID)IsRdtscp,</div>
<div class="line"><span class="lineno">  207</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  208</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  214</span>    {</div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  216</span>        <span class="comment">// Handle rdtsc (emulate rdtsc/p)</span></div>
<div class="line"><span class="lineno">  217</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (IsRdtscp)</div>
<div class="line"><span class="lineno">  219</span>        {</div>
<div class="line"><span class="lineno">  220</span>            <a class="code hl_function" href="_counters_8c.html#a77b52df7e3438c2d559da7a36d1a0a20">CounterEmulateRdtscp</a>(VCpu);</div>
<div class="line"><span class="lineno">  221</span>        }</div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  223</span>        {</div>
<div class="line"><span class="lineno">  224</span>            <a class="code hl_function" href="_counters_8c.html#ae3ef454cf87233a1447b2ab674d8bb9f">CounterEmulateRdtsc</a>(VCpu);</div>
<div class="line"><span class="lineno">  225</span>        }</div>
<div class="line"><span class="lineno">  226</span>    }</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  232</span>    {</div>
<div class="line"><span class="lineno">  233</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  234</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  235</span>                                 (PVOID)IsRdtscp,</div>
<div class="line"><span class="lineno">  236</span>                                 NULL,</div>
<div class="line"><span class="lineno">  237</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  238</span>    }</div>
<div class="line"><span class="lineno">  239</span>}</div>
<div class="ttc" id="a_counters_8c_html_a77b52df7e3438c2d559da7a36d1a0a20"><div class="ttname"><a href="_counters_8c.html#a77b52df7e3438c2d559da7a36d1a0a20">CounterEmulateRdtscp</a></div><div class="ttdeci">VOID CounterEmulateRdtscp(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDTSCP.</div><div class="ttdef"><b>Definition</b> Counters.c:43</div></div>
<div class="ttc" id="a_counters_8c_html_ae3ef454cf87233a1447b2ab674d8bb9f"><div class="ttname"><a href="_counters_8c.html#ae3ef454cf87233a1447b2ab674d8bb9f">CounterEmulateRdtsc</a></div><div class="ttdeci">VOID CounterEmulateRdtsc(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Emulate RDTSC.</div><div class="ttdef"><b>Definition</b> Counters.c:21</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da8d4bc0d80db7c7272aaf0a74ec5823c7">TSC_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ TSC_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:151</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3eb1bf639bc9644cf1c1f44c2eb8dff" name="ac3eb1bf639bc9644cf1c1f44c2eb8dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3eb1bf639bc9644cf1c1f44c2eb8dff">&#9670;&#160;</a></span>DispatchEventVmcall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventVmcall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to VMCALL events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  249</span>{</div>
<div class="line"><span class="lineno">  250</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  251</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  254</span>    <span class="comment">// As the context to event trigger, we send NULL</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment">// Registers are the best source to know the purpose</span></div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a551f1bc8f7fe50864796298011256cbd">g_TriggerEventForVmcalls</a>)</div>
<div class="line"><span class="lineno">  258</span>    {</div>
<div class="line"><span class="lineno">  259</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  260</span>        <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  261</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  262</span>        EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47">VMCALL_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  263</span>                                                      <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  264</span>                                                      NULL,</div>
<div class="line"><span class="lineno">  265</span>                                                      &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  266</span>                                                      VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  269</span>        <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  272</span>        {</div>
<div class="line"><span class="lineno">  273</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  274</span>            <span class="comment">// Handle the VMCALL event in the case of triggering event</span></div>
<div class="line"><span class="lineno">  275</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  276</span>            <a class="code hl_function" href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a>(VCpu);</div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  280</span>        <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  281</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  283</span>        {</div>
<div class="line"><span class="lineno">  284</span>            <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da241b6e0e595d9cb958190ad87217c06b">CPUID_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  285</span>                                     <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  286</span>                                     NULL,</div>
<div class="line"><span class="lineno">  287</span>                                     NULL,</div>
<div class="line"><span class="lineno">  288</span>                                     VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  289</span>        }</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  292</span>    {</div>
<div class="line"><span class="lineno">  293</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  294</span>        <span class="comment">// Otherwise and if there is no event, we should handle the VMCALL</span></div>
<div class="line"><span class="lineno">  295</span>        <span class="comment">// normally</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>        <a class="code hl_function" href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a>(VCpu);</div>
<div class="line"><span class="lineno">  298</span>    }</div>
<div class="line"><span class="lineno">  299</span>}</div>
<div class="ttc" id="a_global_variables_8h_html_a551f1bc8f7fe50864796298011256cbd"><div class="ttname"><a href="_global_variables_8h.html#a551f1bc8f7fe50864796298011256cbd">g_TriggerEventForVmcalls</a></div><div class="ttdeci">BOOLEAN g_TriggerEventForVmcalls</div><div class="ttdoc">Showes whether the vmcall handler is allowed to trigger an event or not.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:131</div></div>
<div class="ttc" id="a_vmcall_8c_html_a1ed944cbbb3374497800e8babbdeef2c"><div class="ttname"><a href="_vmcall_8c.html#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a></div><div class="ttdeci">_Use_decl_annotations_ NTSTATUS VmxHandleVmcallVmExit(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Handle vm-exits of VMCALLs.</div><div class="ttdef"><b>Definition</b> Vmcall.c:74</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652daf3a1c84d32c23f7021ecf9717179fd47">VMCALL_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ VMCALL_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:157</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae3de50c27b4f63f330bc3b3f3948d74a" name="ae3de50c27b4f63f330bc3b3f3948d74a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3de50c27b4f63f330bc3b3f3948d74a">&#9670;&#160;</a></span>DispatchEventWrmsr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> DispatchEventWrmsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling debugger functions related to WRMSR events. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  545</span>{</div>
<div class="line"><span class="lineno">  546</span>    <a class="code hl_typedef" href="include_2_s_d_k_2_headers_2_events_8h.html#a3510cc0182b1b0735d97a3dc67ebe432">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_TYPE</a> EventTriggerResult;</div>
<div class="line"><span class="lineno">  547</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>                                   PostEventTriggerReq = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="comment">// Triggering the pre-event</span></div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  552</span>    EventTriggerResult = <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  553</span>                                                  <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdba58fa036799058eaf25e08f6e0ec491cf">VMM_CALLBACK_CALLING_STAGE_PRE_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  554</span>                                                  (PVOID)(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff),</div>
<div class="line"><span class="lineno">  555</span>                                                  &amp;PostEventTriggerReq,</div>
<div class="line"><span class="lineno">  556</span>                                                  VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="comment">// Check whether we need to short-circuiting event emulation or not</span></div>
<div class="line"><span class="lineno">  560</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordflow">if</span> (EventTriggerResult != <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a4d07669f2ae9f2911461c19e659081e7a18eae1d58b25493c6a6582affc07713b">VMM_CALLBACK_TRIGGERING_EVENT_STATUS_SUCCESSFUL_IGNORE_EVENT</a>)</div>
<div class="line"><span class="lineno">  562</span>    {</div>
<div class="line"><span class="lineno">  563</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  564</span>        <span class="comment">// Handle vm-exit and perform changes</span></div>
<div class="line"><span class="lineno">  565</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  566</span>        <a class="code hl_function" href="_msr_handlers_8c.html#a45e9291a2ab844cf31a38aa39a6131b9">MsrHandleWrmsrVmexit</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  567</span>    }</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="comment">// Check for the post-event triggering needs</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">if</span> (PostEventTriggerReq)</div>
<div class="line"><span class="lineno">  573</span>    {</div>
<div class="line"><span class="lineno">  574</span>        <a class="code hl_function" href="_callback_8c.html#a3b2b1cd1025b5caa035e0834e17fe925">VmmCallbackTriggerEvents</a>(<a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a>,</div>
<div class="line"><span class="lineno">  575</span>                                 <a class="code hl_enumvalue" href="_data_types_8h.html#ab1916ebf9ce6cfbfac78cdc125f22cdbac3b6ddfed250033a6b4db37b54a4a80e">VMM_CALLBACK_CALLING_STAGE_POST_EVENT_EMULATION</a>,</div>
<div class="line"><span class="lineno">  576</span>                                 (PVOID)(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff),</div>
<div class="line"><span class="lineno">  577</span>                                 NULL,</div>
<div class="line"><span class="lineno">  578</span>                                 VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>);</div>
<div class="line"><span class="lineno">  579</span>    }</div>
<div class="line"><span class="lineno">  580</span>}</div>
<div class="ttc" id="a_msr_handlers_8c_html_a45e9291a2ab844cf31a38aa39a6131b9"><div class="ttname"><a href="_msr_handlers_8c.html#a45e9291a2ab844cf31a38aa39a6131b9">MsrHandleWrmsrVmexit</a></div><div class="ttdeci">VOID MsrHandleWrmsrVmexit(PGUEST_REGS GuestRegs)</div><div class="ttdoc">Handles in the cases when RDMSR causes a vm-exit.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:162</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a535f73c021b8ec128d6acc987076652da9768cd88dc35c3a48b1b0cbf323cc05e">WRMSR_INSTRUCTION_EXECUTION</a></div><div class="ttdeci">@ WRMSR_INSTRUCTION_EXECUTION</div><div class="ttdef"><b>Definition</b> Events.h:129</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_e536aab728f7b0abbbf7dc8fdcfcc81b.html">hyperhv</a></li><li class="navelem"><a class="el" href="dir_1ae2c003efa9a319fe8e6b483281e084.html">code</a></li><li class="navelem"><a class="el" href="dir_ad3459180219538b2125a8cc559818a6.html">interface</a></li><li class="navelem"><a class="el" href="_dispatch_8c.html">Dispatch.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
