<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperkd/code/debugger/user-level/Ud.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_ud_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Ud.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Routines related to user mode debugging.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a86574ff4fedfd90b7552bf5d4f8d66a2" id="r_a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a86574ff4fedfd90b7552bf5d4f8d66a2">UdInitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">initialize user debugger  <br /></td></tr>
<tr class="separator:a86574ff4fedfd90b7552bf5d4f8d66a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8e27ff0bdd3e135b4e39c7cf7b5805" id="r_a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7c8e27ff0bdd3e135b4e39c7cf7b5805">UdUninitializeUserDebugger</a> ()</td></tr>
<tr class="memdesc:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="mdescLeft">&#160;</td><td class="mdescRight">uninitialize user debugger  <br /></td></tr>
<tr class="separator:a7c8e27ff0bdd3e135b4e39c7cf7b5805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341566fede69a4d98bc71badd18a4973" id="r_a341566fede69a4d98bc71badd18a4973"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails)</td></tr>
<tr class="memdesc:a341566fede69a4d98bc71badd18a4973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restore the thread to the original direction.  <br /></td></tr>
<tr class="separator:a341566fede69a4d98bc71badd18a4973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b049cfd213a9037a5d33810dcabb67" id="r_a85b049cfd213a9037a5d33810dcabb67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails)</td></tr>
<tr class="memdesc:a85b049cfd213a9037a5d33810dcabb67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Continue the thread.  <br /></td></tr>
<tr class="separator:a85b049cfd213a9037a5d33810dcabb67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6511ae87f747db8b9448846c7bed8565" id="r_a6511ae87f747db8b9448846c7bed8565"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_request_structures_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a> SteppingType)</td></tr>
<tr class="memdesc:a6511ae87f747db8b9448846c7bed8565"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform stepping though the instructions in target thread.  <br /></td></tr>
<tr class="separator:a6511ae87f747db8b9448846c7bed8565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1952ae25243278fc748ce38a16183410" id="r_a1952ae25243278fc748ce38a16183410"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_request_structures_8h.html#a246fe957e8b56ed0c8607f0f4a706d0b">DEBUGGER_UD_COMMAND_ACTION_TYPE</a> UserAction, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam1, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam2, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam3, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam4)</td></tr>
<tr class="memdesc:a1952ae25243278fc748ce38a16183410"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform the user-mode commands.  <br /></td></tr>
<tr class="separator:a1952ae25243278fc748ce38a16183410"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe8e59191c78460477ae89d3e9daf751" id="r_afe8e59191c78460477ae89d3e9daf751"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afe8e59191c78460477ae89d3e9daf751">UdCheckForCommand</a> ()</td></tr>
<tr class="memdesc:afe8e59191c78460477ae89d3e9daf751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for the user-mode commands.  <br /></td></tr>
<tr class="separator:afe8e59191c78460477ae89d3e9daf751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a511f72fa77e4eadf393c2e0d6dc8f" id="r_a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56a511f72fa77e4eadf393c2e0d6dc8f">UdDispatchUsermodeCommands</a> (<a class="el" href="_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a> ActionRequest)</td></tr>
<tr class="memdesc:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispatch the user-mode commands.  <br /></td></tr>
<tr class="separator:a56a511f72fa77e4eadf393c2e0d6dc8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a382dd16eb179d5548591aa4468ffbc05" id="r_a382dd16eb179d5548591aa4468ffbc05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a> (<a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails)</td></tr>
<tr class="memdesc:a382dd16eb179d5548591aa4468ffbc05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spin on nop sled in user-mode to halt the debuggee.  <br /></td></tr>
<tr class="separator:a382dd16eb179d5548591aa4468ffbc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b34356fa5078db5eceab1194735f60a" id="r_a6b34356fa5078db5eceab1194735f60a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6b34356fa5078db5eceab1194735f60a">UdPrePausingReasons</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails, <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:a6b34356fa5078db5eceab1194735f60a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle special reasons pre-pausings.  <br /></td></tr>
<tr class="separator:a6b34356fa5078db5eceab1194735f60a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ebe34618715108270c71344983e4af3" id="r_a5ebe34618715108270c71344983e4af3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5ebe34618715108270c71344983e4af3">UdCheckAndHandleBreakpointsAndDebugBreaks</a> (<a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *DbgState, <a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a> Reason, <a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a> EventDetails)</td></tr>
<tr class="memdesc:a5ebe34618715108270c71344983e4af3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle #DBs and #BPs for kernel debugger.  <br /></td></tr>
<tr class="separator:a5ebe34618715108270c71344983e4af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Routines related to user mode debugging. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-01-06</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5ebe34618715108270c71344983e4af3" name="a5ebe34618715108270c71344983e4af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ebe34618715108270c71344983e4af3">&#9670;&#160;</a></span>UdCheckAndHandleBreakpointsAndDebugBreaks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckAndHandleBreakpointsAndDebugBreaks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a></td>          <td class="paramname"><span class="paramname"><em>Reason</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>EventDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle #DBs and #BPs for kernel debugger. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  446</span>{</div>
<div class="line"><span class="lineno">  447</span>    <a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>           PausePacket;</div>
<div class="line"><span class="lineno">  448</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                               ExitInstructionLength   = 0;</div>
<div class="line"><span class="lineno">  449</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                              SizeOfSafeBufferToRead  = 0;</div>
<div class="line"><span class="lineno">  450</span>    RFLAGS                              Rflags                  = {0};</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  452</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a>  ThreadDebuggingDetails  = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  453</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                              LastVmexitRip           = <a class="code hl_function" href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a>(DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">CoreId</a>);</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  456</span>    <span class="comment">// Breaking only supported in vmx-root mode, and if user-debugger is</span></div>
<div class="line"><span class="lineno">  457</span>    <span class="comment">// loaded</span></div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> &amp;&amp; <a class="code hl_function" href="_export_8c.html#a661e93cb9bae66f67ebef08fb9122fff">VmFuncVmxGetCurrentExecutionMode</a>() == <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><span class="lineno">  460</span>    {</div>
<div class="line"><span class="lineno">  461</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  462</span>    }</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  465</span>    <span class="comment">// Check entry of paused thread</span></div>
<div class="line"><span class="lineno">  466</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  467</span>    ProcessDebuggingDetails = <a class="code hl_function" href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a>(<a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()));</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><span class="lineno">  470</span>    {</div>
<div class="line"><span class="lineno">  471</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  472</span>        <span class="comment">// Token not found!</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  475</span>    }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">// Find the thread entry and if not found, create one for it</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  480</span>    ThreadDebuggingDetails = <a class="code hl_function" href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a>(<a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentThreadId()), ProcessDebuggingDetails);</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><span class="lineno">  483</span>    {</div>
<div class="line"><span class="lineno">  484</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  485</span>        <span class="comment">// Sth went wrong!</span></div>
<div class="line"><span class="lineno">  486</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  487</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  488</span>    }</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">// Set it as active thread debugging</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  493</span>    ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">ActiveThreadId</a> = ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">ThreadId</a>;</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">// Perform the pre-pausing tasks</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  498</span>    <a class="code hl_function" href="#a6b34356fa5078db5eceab1194735f60a">UdPrePausingReasons</a>(DbgState, ThreadDebuggingDetails, Reason, EventDetails);</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  501</span>    <span class="comment">// *** Fill the pausing structure ***</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    RtlZeroMemory(&amp;PausePacket, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>));</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">// Set the pausing reason</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  509</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">PausingReason</a> = Reason;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">// Set process debugging information</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  514</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">ProcessId</a>             = <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId());</div>
<div class="line"><span class="lineno">  515</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">ThreadId</a>              = <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentThreadId());</div>
<div class="line"><span class="lineno">  516</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">ProcessDebuggingToken</a> = ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="comment">// Set the RIP and mode of execution</span></div>
<div class="line"><span class="lineno">  520</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  521</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">Rip</a>     = LastVmexitRip;</div>
<div class="line"><span class="lineno">  522</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">Is32Bit</a> = <a class="code hl_function" href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a>();</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// Set rflags for finding the results of conditional jumps</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  527</span>    Rflags.AsUInt      = <a class="code hl_function" href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a>();</div>
<div class="line"><span class="lineno">  528</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aea873749ec75709b18d9b89fb20fde78">Rflags</a> = Rflags.AsUInt;</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment">// Set the event tag (if it&#39;s an event)</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> (EventDetails != NULL)</div>
<div class="line"><span class="lineno">  534</span>    {</div>
<div class="line"><span class="lineno">  535</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">EventTag</a>          = EventDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">Tag</a>;</div>
<div class="line"><span class="lineno">  536</span>        PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a708d93ee8ee8523b8b41e8a99d146bae">EventCallingStage</a> = EventDetails-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a6101dc9a0fb47c16e38046ca1eecaa31">Stage</a>;</div>
<div class="line"><span class="lineno">  537</span>    }</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// Read the instruction len</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> (DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a> != 0)</div>
<div class="line"><span class="lineno">  543</span>    {</div>
<div class="line"><span class="lineno">  544</span>        ExitInstructionLength = DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">InstructionLengthHint</a>;</div>
<div class="line"><span class="lineno">  545</span>    }</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  547</span>    {</div>
<div class="line"><span class="lineno">  548</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  549</span>        <span class="comment">// Reading instruction length (VMCS_VMEXIT_INSTRUCTION_LENGTH) proved to</span></div>
<div class="line"><span class="lineno">  550</span>        <span class="comment">// provide wrong results, so we won&#39;t use it</span></div>
<div class="line"><span class="lineno">  551</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  554</span>        <span class="comment">// Compute the amount of buffer we can read without problem</span></div>
<div class="line"><span class="lineno">  555</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  556</span>        SizeOfSafeBufferToRead = (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)(LastVmexitRip &amp; 0xfff);</div>
<div class="line"><span class="lineno">  557</span>        SizeOfSafeBufferToRead += <a class="code hl_define" href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">if</span> (SizeOfSafeBufferToRead &gt;= <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>)</div>
<div class="line"><span class="lineno">  560</span>        {</div>
<div class="line"><span class="lineno">  561</span>            SizeOfSafeBufferToRead = SizeOfSafeBufferToRead - <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a>;</div>
<div class="line"><span class="lineno">  562</span>            SizeOfSafeBufferToRead = <a class="code hl_define" href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a> - SizeOfSafeBufferToRead;</div>
<div class="line"><span class="lineno">  563</span>        }</div>
<div class="line"><span class="lineno">  564</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  565</span>        {</div>
<div class="line"><span class="lineno">  566</span>            SizeOfSafeBufferToRead = <a class="code hl_define" href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a>;</div>
<div class="line"><span class="lineno">  567</span>        }</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  570</span>        <span class="comment">// Set the length to notify debuggee</span></div>
<div class="line"><span class="lineno">  571</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  572</span>        ExitInstructionLength = SizeOfSafeBufferToRead;</div>
<div class="line"><span class="lineno">  573</span>    }</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  576</span>    <span class="comment">// Set the reading length of bytes (for instruction disassembling)</span></div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  578</span>    PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">ReadInstructionLen</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a>)ExitInstructionLength;</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  581</span>    <span class="comment">// Find the current instruction</span></div>
<div class="line"><span class="lineno">  582</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  583</span>    <a class="code hl_function" href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a>(LastVmexitRip,</div>
<div class="line"><span class="lineno">  584</span>                                              &amp;PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af8522eb09dc5c1d44b3fbf0f2bceda07">InstructionBytesOnRip</a>,</div>
<div class="line"><span class="lineno">  585</span>                                              ExitInstructionLength);</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  588</span>    <span class="comment">// Copy registers to the pause packet</span></div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  590</span>    RtlCopyMemory(&amp;PausePacket.<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">GuestRegs</a>, DbgState-&gt;<a class="code hl_variable" href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a03193009392aadd7037d6d0ce743efd4">Regs</a>, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a>));</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  593</span>    <span class="comment">// Send the pause packet, along with RIP and an indication</span></div>
<div class="line"><span class="lineno">  594</span>    <span class="comment">// to pause to the user debugger</span></div>
<div class="line"><span class="lineno">  595</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  596</span>    <a class="code hl_function" href="_callback_8c.html#aba6bd0c693cac7a80bd56987ee22574a">LogCallbackSendBuffer</a>(<a class="code hl_define" href="_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a>,</div>
<div class="line"><span class="lineno">  597</span>                          &amp;PausePacket,</div>
<div class="line"><span class="lineno">  598</span>                          <span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">DEBUGGEE_UD_PAUSED_PACKET</a>),</div>
<div class="line"><span class="lineno">  599</span>                          <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="comment">// Halt the thread on nop sleds</span></div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  604</span>    <a class="code hl_function" href="#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a>(ThreadDebuggingDetails, ProcessDebuggingDetails);</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  607</span>    <span class="comment">// Everything was okay</span></div>
<div class="line"><span class="lineno">  608</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  610</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a733d0f343ddcccaeec221bbbb20483c7"><div class="ttname"><a href="_attaching_8c.html#a733d0f343ddcccaeec221bbbb20483c7">AttachingFindProcessDebuggingDetailsByProcessId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByProcessId(UINT32 ProcessId)</div><div class="ttdoc">Find user-mode debugging details for threads by process Id.</div><div class="ttdef"><b>Definition</b> Attaching.c:187</div></div>
<div class="ttc" id="a_basic_types_8h_html_a09f1a1fb2293e33483cc8d44aefb1eb1"><div class="ttname"><a href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></div><div class="ttdeci">unsigned short UINT16</div><div class="ttdef"><b>Definition</b> BasicTypes.h:47</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_callback_8c_html_aba6bd0c693cac7a80bd56987ee22574a"><div class="ttname"><a href="_callback_8c.html#aba6bd0c693cac7a80bd56987ee22574a">LogCallbackSendBuffer</a></div><div class="ttdeci">BOOLEAN LogCallbackSendBuffer(_In_ UINT32 OperationCode, _In_reads_bytes_(BufferLength) PVOID Buffer, _In_ UINT32 BufferLength, _In_ BOOLEAN Priority)</div><div class="ttdoc">routines callback for sending buffer</div><div class="ttdef"><b>Definition</b> Callback.c:123</div></div>
<div class="ttc" id="a_constants_8h_html_a7d47482024b99d93c486dabbdbfca6d2"><div class="ttname"><a href="_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a></div><div class="ttdeci">#define OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</div><div class="ttdef"><b>Definition</b> Constants.h:387</div></div>
<div class="ttc" id="a_constants_8h_html_abc19f528c1665033d9ac7f477a26c608"><div class="ttname"><a href="_constants_8h.html#abc19f528c1665033d9ac7f477a26c608">MAXIMUM_INSTR_SIZE</a></div><div class="ttdeci">#define MAXIMUM_INSTR_SIZE</div><div class="ttdoc">maximum instruction size in Intel</div><div class="ttdef"><b>Definition</b> Constants.h:468</div></div>
<div class="ttc" id="a_export_8c_html_a65a0cf94fa34ebb1f4150ed97fa7abc0"><div class="ttname"><a href="_export_8c.html#a65a0cf94fa34ebb1f4150ed97fa7abc0">VmFuncGetRflags</a></div><div class="ttdeci">UINT64 VmFuncGetRflags()</div><div class="ttdoc">Read guest's RFLAGS.</div><div class="ttdef"><b>Definition</b> Export.c:352</div></div>
<div class="ttc" id="a_export_8c_html_a661e93cb9bae66f67ebef08fb9122fff"><div class="ttname"><a href="_export_8c.html#a661e93cb9bae66f67ebef08fb9122fff">VmFuncVmxGetCurrentExecutionMode</a></div><div class="ttdeci">BOOLEAN VmFuncVmxGetCurrentExecutionMode()</div><div class="ttdoc">Get the current VMX operation state.</div><div class="ttdef"><b>Definition</b> Export.c:552</div></div>
<div class="ttc" id="a_export_8c_html_ab49740d6ce5d1c5f90828b66496dcb4c"><div class="ttname"><a href="_export_8c.html#ab49740d6ce5d1c5f90828b66496dcb4c">VmFuncGetLastVmexitRip</a></div><div class="ttdeci">UINT64 VmFuncGetLastVmexitRip(UINT32 CoreId)</div><div class="ttdoc">get the last vm-exit RIP</div><div class="ttdef"><b>Definition</b> Export.c:318</div></div>
<div class="ttc" id="a_kd_8c_html_a814437795a9e923d352b848630625a56"><div class="ttname"><a href="_kd_8c.html#a814437795a9e923d352b848630625a56">KdIsGuestOnUsermode32Bit</a></div><div class="ttdeci">BOOLEAN KdIsGuestOnUsermode32Bit()</div><div class="ttdoc">determines if the guest was in 32-bit user-mode or 64-bit (long mode)</div><div class="ttdef"><b>Definition</b> Kd.c:3107</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4b9c8387e09821a8668975ec6119782e"><div class="ttname"><a href="_memory_mapper_8c.html#a4b9c8387e09821a8668975ec6119782e">MemoryMapperReadMemorySafeOnTargetProcess</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafeOnTargetProcess(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer on the target process memory (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1120</div></div>
<div class="ttc" id="a_meta_macros_8h_html_ad790279846c85a5a453f2e7a4e02abad"><div class="ttname"><a href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a></div><div class="ttdeci">#define HANDLE_TO_UINT32(_var)</div><div class="ttdef"><b>Definition</b> MetaMacros.h:39</div></div>
<div class="ttc" id="a_thread_holder_8c_html_ac752176641e6314d84738f2f323cec68"><div class="ttname"><a href="_thread_holder_8c.html#ac752176641e6314d84738f2f323cec68">ThreadHolderFindOrCreateThreadDebuggingDetail</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderFindOrCreateThreadDebuggingDetail(UINT32 ThreadId, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetail)</div><div class="ttdoc">Find or create user-mode debugging details for threads.</div><div class="ttdef"><b>Definition</b> ThreadHolder.c:257</div></div>
<div class="ttc" id="a_ud_8c_html_a382dd16eb179d5548591aa4468ffbc05"><div class="ttname"><a href="#a382dd16eb179d5548591aa4468ffbc05">UdSpinThreadOnNop</a></div><div class="ttdeci">VOID UdSpinThreadOnNop(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails)</div><div class="ttdoc">Spin on nop sled in user-mode to halt the debuggee.</div><div class="ttdef"><b>Definition</b> Ud.c:379</div></div>
<div class="ttc" id="a_ud_8c_html_a6b34356fa5078db5eceab1194735f60a"><div class="ttname"><a href="#a6b34356fa5078db5eceab1194735f60a">UdPrePausingReasons</a></div><div class="ttdeci">VOID UdPrePausingReasons(PROCESSOR_DEBUGGING_STATE *DbgState, PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGEE_PAUSING_REASON Reason, PDEBUGGER_TRIGGERED_EVENT_DETAILS EventDetails)</div><div class="ttdoc">Handle special reasons pre-pausings.</div><div class="ttdef"><b>Definition</b> Ud.c:409</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_ae304ded1a8cbb4e772d97aec7510c9d2"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a></div><div class="ttdeci">BOOLEAN g_UserDebuggerState</div><div class="ttdoc">shows whether the user debugger is enabled or disabled</div><div class="ttdef"><b>Definition</b> Global.h:109</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition</b> common.h:69</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">_DEBUGGEE_UD_PAUSED_PACKET</a></div><div class="ttdoc">The structure of pausing packet in uHyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:229</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a0145af02a2814d6a0272b961169d0356"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a0145af02a2814d6a0272b961169d0356">_DEBUGGEE_UD_PAUSED_PACKET::GuestRegs</a></div><div class="ttdeci">GUEST_REGS GuestRegs</div><div class="ttdef"><b>Definition</b> DataTypes.h:241</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a18f93b90e7be5065db4ca0acf4addfdf"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a18f93b90e7be5065db4ca0acf4addfdf">_DEBUGGEE_UD_PAUSED_PACKET::PausingReason</a></div><div class="ttdeci">DEBUGGEE_PAUSING_REASON PausingReason</div><div class="ttdef"><b>Definition</b> DataTypes.h:233</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a2193543107e5c824870e3c027403db13"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a2193543107e5c824870e3c027403db13">_DEBUGGEE_UD_PAUSED_PACKET::ReadInstructionLen</a></div><div class="ttdeci">UINT16 ReadInstructionLen</div><div class="ttdef"><b>Definition</b> DataTypes.h:240</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a3e56574a7c4011c34c087b31cbb75979"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a3e56574a7c4011c34c087b31cbb75979">_DEBUGGEE_UD_PAUSED_PACKET::Rip</a></div><div class="ttdeci">UINT64 Rip</div><div class="ttdef"><b>Definition</b> DataTypes.h:230</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a708d93ee8ee8523b8b41e8a99d146bae"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a708d93ee8ee8523b8b41e8a99d146bae">_DEBUGGEE_UD_PAUSED_PACKET::EventCallingStage</a></div><div class="ttdeci">VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE EventCallingStage</div><div class="ttdef"><b>Definition</b> DataTypes.h:238</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a7ae9dfd624d3677a5aaf1c13cfb587d8"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a7ae9dfd624d3677a5aaf1c13cfb587d8">_DEBUGGEE_UD_PAUSED_PACKET::Is32Bit</a></div><div class="ttdeci">BOOLEAN Is32Bit</div><div class="ttdef"><b>Definition</b> DataTypes.h:232</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_a8241688f61ab475b180e4686f3685723"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#a8241688f61ab475b180e4686f3685723">_DEBUGGEE_UD_PAUSED_PACKET::ProcessDebuggingToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingToken</div><div class="ttdef"><b>Definition</b> DataTypes.h:231</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_abd4a87f9106cc80d3d2a35f418684b86"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#abd4a87f9106cc80d3d2a35f418684b86">_DEBUGGEE_UD_PAUSED_PACKET::EventTag</a></div><div class="ttdeci">UINT64 EventTag</div><div class="ttdef"><b>Definition</b> DataTypes.h:237</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aea873749ec75709b18d9b89fb20fde78"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aea873749ec75709b18d9b89fb20fde78">_DEBUGGEE_UD_PAUSED_PACKET::Rflags</a></div><div class="ttdeci">UINT64 Rflags</div><div class="ttdef"><b>Definition</b> DataTypes.h:236</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_aeff5c8c0b5217e3f98b3d37e408f6283"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#aeff5c8c0b5217e3f98b3d37e408f6283">_DEBUGGEE_UD_PAUSED_PACKET::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition</b> DataTypes.h:235</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_af634ca2741eb2f229798a1f0fb65511d"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af634ca2741eb2f229798a1f0fb65511d">_DEBUGGEE_UD_PAUSED_PACKET::ProcessId</a></div><div class="ttdeci">UINT32 ProcessId</div><div class="ttdef"><b>Definition</b> DataTypes.h:234</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html_af8522eb09dc5c1d44b3fbf0f2bceda07"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html#af8522eb09dc5c1d44b3fbf0f2bceda07">_DEBUGGEE_UD_PAUSED_PACKET::InstructionBytesOnRip</a></div><div class="ttdeci">BYTE InstructionBytesOnRip[MAXIMUM_INSTR_SIZE]</div><div class="ttdef"><b>Definition</b> DataTypes.h:239</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a4eed19d8d35fa2c8378db39e95dd9ef2"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a4eed19d8d35fa2c8378db39e95dd9ef2">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Tag</a></div><div class="ttdeci">UINT64 Tag</div><div class="ttdef"><b>Definition</b> DataTypes.h:193</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s_html_a6101dc9a0fb47c16e38046ca1eecaa31"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___t_r_i_g_g_e_r_e_d___e_v_e_n_t___d_e_t_a_i_l_s.html#a6101dc9a0fb47c16e38046ca1eecaa31">_DEBUGGER_TRIGGERED_EVENT_DETAILS::Stage</a></div><div class="ttdeci">VMM_CALLBACK_EVENT_CALLING_STAGE_TYPE Stage</div><div class="ttdef"><b>Definition</b> DataTypes.h:195</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a03193009392aadd7037d6d0ce743efd4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a03193009392aadd7037d6d0ce743efd4">_PROCESSOR_DEBUGGING_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition</b> State.h:168</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_a090832a74d330cde891a17bdd5b236e3"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#a090832a74d330cde891a17bdd5b236e3">_PROCESSOR_DEBUGGING_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:169</div></div>
<div class="ttc" id="astruct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e_html_ac0735b6e84ce3ae397f74cfd5b4eabb4"><div class="ttname"><a href="struct___p_r_o_c_e_s_s_o_r___d_e_b_u_g_g_i_n_g___s_t_a_t_e.html#ac0735b6e84ce3ae397f74cfd5b4eabb4">_PROCESSOR_DEBUGGING_STATE::InstructionLengthHint</a></div><div class="ttdeci">UINT16 InstructionLengthHint</div><div class="ttdef"><b>Definition</b> State.h:182</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_PROCESS_DETAILS</a></div><div class="ttdoc">Description of each active thread in user-mode attaching mechanism.</div><div class="ttdef"><b>Definition</b> Attaching.h:49</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_aac3f928359d06bdd7572a4bd67c86429"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">_USERMODE_DEBUGGING_PROCESS_DETAILS::Token</a></div><div class="ttdeci">UINT64 Token</div><div class="ttdef"><b>Definition</b> Attaching.h:50</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ac7497bb7cd3585fdc424075cae9ff98c"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac7497bb7cd3585fdc424075cae9ff98c">_USERMODE_DEBUGGING_PROCESS_DETAILS::ActiveThreadId</a></div><div class="ttdeci">UINT32 ActiveThreadId</div><div class="ttdef"><b>Definition</b> Attaching.h:53</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">_USERMODE_DEBUGGING_THREAD_DETAILS</a></div><div class="ttdoc">Details of each thread in process.</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:33</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a726606b3498458de98f6cb19e6873df0"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a726606b3498458de98f6cb19e6873df0">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadId</a></div><div class="ttdeci">UINT32 ThreadId</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:34</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a></div><div class="ttdef"><b>Definition</b> BasicTypes.h:70</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afe8e59191c78460477ae89d3e9daf751" name="afe8e59191c78460477ae89d3e9daf751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe8e59191c78460477ae89d3e9daf751">&#9670;&#160;</a></span>UdCheckForCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdCheckForCommand </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for the user-mode commands. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  258</span>{</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_THREAD_DETAILS</a> ThreadDebuggingDetails;</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="comment">// Check if user-debugger is initialized or not</span></div>
<div class="line"><span class="lineno">  263</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  264</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><span class="lineno">  265</span>    {</div>
<div class="line"><span class="lineno">  266</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    ThreadDebuggingDetails = <a class="code hl_function" href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a>(<a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()),</div>
<div class="line"><span class="lineno">  270</span>                                                                                       <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentThreadId()));</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails)</div>
<div class="line"><span class="lineno">  273</span>    {</div>
<div class="line"><span class="lineno">  274</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  275</span>    }</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="comment">// If we reached here, the current thread is in debugger attached mechanism</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="comment">// now we check whether it&#39;s a regular CPUID or a debugger paused thread CPUID</span></div>
<div class="line"><span class="lineno">  280</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">if</span> (!ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a>)</div>
<div class="line"><span class="lineno">  282</span>    {</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  284</span>    }</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  287</span>    <span class="comment">// Here, we&#39;re sure that this thread is looking for command, let</span></div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// see if we find anything</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code hl_define" href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a>; i++)</div>
<div class="line"><span class="lineno">  291</span>    {</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">if</span> (ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> != <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>)</div>
<div class="line"><span class="lineno">  293</span>        {</div>
<div class="line"><span class="lineno">  294</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  295</span>            <span class="comment">// Perform the command</span></div>
<div class="line"><span class="lineno">  296</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>            <a class="code hl_function" href="#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a>(ThreadDebuggingDetails,</div>
<div class="line"><span class="lineno">  298</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a>,</div>
<div class="line"><span class="lineno">  299</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a>,</div>
<div class="line"><span class="lineno">  300</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a>,</div>
<div class="line"><span class="lineno">  301</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a>,</div>
<div class="line"><span class="lineno">  302</span>                             ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a>);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  305</span>            <span class="comment">// Remove the command</span></div>
<div class="line"><span class="lineno">  306</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  307</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">OptionalParam1</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  308</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">OptionalParam2</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  309</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">OptionalParam3</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  310</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">OptionalParam4</a> = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)NULL;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  313</span>            <span class="comment">// At last disable it</span></div>
<div class="line"><span class="lineno">  314</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  315</span>            ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">UdAction</a>[i].<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">ActionType</a> = <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a>;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  318</span>            <span class="comment">// only one command at a time</span></div>
<div class="line"><span class="lineno">  319</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  320</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  321</span>        }</div>
<div class="line"><span class="lineno">  322</span>    }</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  325</span>    <span class="comment">// Won&#39;t change the registers for cpuid</span></div>
<div class="line"><span class="lineno">  326</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  328</span>}</div>
<div class="ttc" id="a_attaching_8h_html_a71a7b969b4769247f9e1c54276f6514f"><div class="ttname"><a href="_attaching_8h.html#a71a7b969b4769247f9e1c54276f6514f">MAX_USER_ACTIONS_FOR_THREADS</a></div><div class="ttdeci">#define MAX_USER_ACTIONS_FOR_THREADS</div><div class="ttdoc">Maximum actions in paused threads storage.</div><div class="ttdef"><b>Definition</b> Attaching.h:22</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a"><div class="ttname"><a href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a8d10bc5059f14f2b3d00d7d6edb4182a">DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_NONE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:867</div></div>
<div class="ttc" id="a_thread_holder_8c_html_aae54fde00233fd8e30b197ab1a64a555"><div class="ttname"><a href="_thread_holder_8c.html#aae54fde00233fd8e30b197ab1a64a555">ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadHolderGetProcessThreadDetailsByProcessIdAndThreadId(UINT32 ProcessId, UINT32 ThreadId)</div><div class="ttdoc">Find the active threads of the process from process id.</div><div class="ttdef"><b>Definition</b> ThreadHolder.c:109</div></div>
<div class="ttc" id="a_ud_8c_html_a1952ae25243278fc748ce38a16183410"><div class="ttname"><a href="#a1952ae25243278fc748ce38a16183410">UdPerformCommand</a></div><div class="ttdeci">BOOLEAN UdPerformCommand(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGER_UD_COMMAND_ACTION_TYPE UserAction, UINT64 OptionalParam1, UINT64 OptionalParam2, UINT64 OptionalParam3, UINT64 OptionalParam4)</div><div class="ttdoc">Perform the user-mode commands.</div><div class="ttdef"><b>Definition</b> Ud.c:205</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a0342fbe7f03915834f74d7154874145f"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a0342fbe7f03915834f74d7154874145f">_DEBUGGER_UD_COMMAND_ACTION::ActionType</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION_TYPE ActionType</div><div class="ttdef"><b>Definition</b> RequestStructures.h:880</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a479258f824cfd17a0f610d9bcefce1a1"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a479258f824cfd17a0f610d9bcefce1a1">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam1</a></div><div class="ttdeci">UINT64 OptionalParam1</div><div class="ttdef"><b>Definition</b> RequestStructures.h:881</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5bd4a1a8d6a407cf98eb4f84597fa233"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5bd4a1a8d6a407cf98eb4f84597fa233">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam3</a></div><div class="ttdeci">UINT64 OptionalParam3</div><div class="ttdef"><b>Definition</b> RequestStructures.h:883</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_a5e2412025f8524952d364840ba658829"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#a5e2412025f8524952d364840ba658829">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam4</a></div><div class="ttdeci">UINT64 OptionalParam4</div><div class="ttdef"><b>Definition</b> RequestStructures.h:884</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n_html_ad76de86942302644cd6c27e446bb9b4a"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___a_c_t_i_o_n.html#ad76de86942302644cd6c27e446bb9b4a">_DEBUGGER_UD_COMMAND_ACTION::OptionalParam2</a></div><div class="ttdeci">UINT64 OptionalParam2</div><div class="ttdef"><b>Definition</b> RequestStructures.h:882</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a9b52613ecdffc1e60ac1ca9e956d1416"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a9b52613ecdffc1e60ac1ca9e956d1416">_USERMODE_DEBUGGING_THREAD_DETAILS::UdAction</a></div><div class="ttdeci">DEBUGGER_UD_COMMAND_ACTION UdAction[MAX_USER_ACTIONS_FOR_THREADS]</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:37</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_afcd7f63e2118dbfefdac3e7c79fda7fc"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">_USERMODE_DEBUGGING_THREAD_DETAILS::IsPaused</a></div><div class="ttdeci">BOOLEAN IsPaused</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:36</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85b049cfd213a9037a5d33810dcabb67" name="a85b049cfd213a9037a5d33810dcabb67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b049cfd213a9037a5d33810dcabb67">&#9670;&#160;</a></span>UdContinueThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdContinueThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Continue the thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  119</span>{</div>
<div class="line"><span class="lineno">  120</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// Configure the RIP and RSP again</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_function" href="#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a>(ThreadDebuggingDetails);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  126</span>    <span class="comment">// Continue the current instruction won&#39;t pass it</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_function" href="_export_8c.html#ad357512be8732352fac0e4a03676e458">VmFuncSuppressRipIncrement</a>(KeGetCurrentProcessorNumberEx(NULL));</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  131</span>    <span class="comment">// It&#39;s not paused anymore!</span></div>
<div class="line"><span class="lineno">  132</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  133</span>    ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  134</span>}</div>
<div class="ttc" id="a_export_8c_html_ad357512be8732352fac0e4a03676e458"><div class="ttname"><a href="_export_8c.html#ad357512be8732352fac0e4a03676e458">VmFuncSuppressRipIncrement</a></div><div class="ttdeci">VOID VmFuncSuppressRipIncrement(UINT32 CoreId)</div><div class="ttdoc">Suppress the incrementation of RIP.</div><div class="ttdef"><b>Definition</b> Export.c:34</div></div>
<div class="ttc" id="a_ud_8c_html_a341566fede69a4d98bc71badd18a4973"><div class="ttname"><a href="#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a></div><div class="ttdeci">VOID UdRestoreToOriginalDirection(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails)</div><div class="ttdoc">Restore the thread to the original direction.</div><div class="ttdef"><b>Definition</b> Ud.c:102</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56a511f72fa77e4eadf393c2e0d6dc8f" name="a56a511f72fa77e4eadf393c2e0d6dc8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a511f72fa77e4eadf393c2e0d6dc8f">&#9670;&#160;</a></span>UdDispatchUsermodeCommands()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdDispatchUsermodeCommands </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a510b3c0106ca6b73316f747e1557baef">PDEBUGGER_UD_COMMAND_PACKET</a></td>          <td class="paramname"><span class="paramname"><em>ActionRequest</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dispatch the user-mode commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ActionRequest</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  338</span>{</div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_struct" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a> ProcessDebuggingDetails;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">// Find the thread debugging detail of the thread</span></div>
<div class="line"><span class="lineno">  343</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>    ProcessDebuggingDetails = <a class="code hl_function" href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a>(ActionRequest-&gt;<a class="code hl_variable" href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">ProcessDebuggingDetailToken</a>);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">if</span> (!ProcessDebuggingDetails)</div>
<div class="line"><span class="lineno">  347</span>    {</div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  349</span>        <span class="comment">// Token not found!</span></div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// Based on the documentation, HyperDbg stops intercepting threads</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">// when the debugger sent the first command, but if user presses</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">// CTRL+C again, all the threads (or new threads) that will enter</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="comment">// the user-mode will be intercepted</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">if</span> (ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">IsOnThreadInterceptingPhase</a>)</div>
<div class="line"><span class="lineno">  361</span>    {</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_function" href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a>(ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#aac3f928359d06bdd7572a4bd67c86429">Token</a>, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  363</span>    }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  366</span>    <span class="comment">// Apply the command to all threads or just one thread</span></div>
<div class="line"><span class="lineno">  367</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a>(ProcessDebuggingDetails, ActionRequest);</div>
<div class="line"><span class="lineno">  369</span>}</div>
<div class="ttc" id="a_attaching_8c_html_a7f67611f7474cb9199c0b941fcf82a85"><div class="ttname"><a href="_attaching_8c.html#a7f67611f7474cb9199c0b941fcf82a85">AttachingConfigureInterceptingThreads</a></div><div class="ttdeci">BOOLEAN AttachingConfigureInterceptingThreads(UINT64 ProcessDebuggingToken, BOOLEAN Enable)</div><div class="ttdoc">Enable or disable the thread intercepting phase.</div><div class="ttdef"><b>Definition</b> Attaching.c:695</div></div>
<div class="ttc" id="a_attaching_8c_html_ab826f65586e0a294b97e505c6affe8b5"><div class="ttname"><a href="_attaching_8c.html#ab826f65586e0a294b97e505c6affe8b5">AttachingFindProcessDebuggingDetailsByToken</a></div><div class="ttdeci">PUSERMODE_DEBUGGING_PROCESS_DETAILS AttachingFindProcessDebuggingDetailsByToken(UINT64 Token)</div><div class="ttdoc">Find user-mode debugging details for threads by token.</div><div class="ttdef"><b>Definition</b> Attaching.c:164</div></div>
<div class="ttc" id="a_thread_holder_8c_html_a090fda3da0d1eaee5abdaf2fe8d6079c"><div class="ttname"><a href="_thread_holder_8c.html#a090fda3da0d1eaee5abdaf2fe8d6079c">ThreadHolderApplyActionToPausedThreads</a></div><div class="ttdeci">BOOLEAN ThreadHolderApplyActionToPausedThreads(PUSERMODE_DEBUGGING_PROCESS_DETAILS ProcessDebuggingDetails, PDEBUGGER_UD_COMMAND_PACKET ActionRequest)</div><div class="ttdoc">Apply the action of the user debugger to a specific thread or all threads.</div><div class="ttdef"><b>Definition</b> ThreadHolder.c:364</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t_html_ae384ab33099a5fc4d9d5b3b597ae1b39"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___u_d___c_o_m_m_a_n_d___p_a_c_k_e_t.html#ae384ab33099a5fc4d9d5b3b597ae1b39">_DEBUGGER_UD_COMMAND_PACKET::ProcessDebuggingDetailToken</a></div><div class="ttdeci">UINT64 ProcessDebuggingDetailToken</div><div class="ttdef"><b>Definition</b> RequestStructures.h:895</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ad3d6574cef84c00d549493d88c62e68f"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ad3d6574cef84c00d549493d88c62e68f">_USERMODE_DEBUGGING_PROCESS_DETAILS::IsOnThreadInterceptingPhase</a></div><div class="ttdeci">BOOLEAN IsOnThreadInterceptingPhase</div><div class="ttdef"><b>Definition</b> Attaching.h:64</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86574ff4fedfd90b7552bf5d4f8d66a2" name="a86574ff4fedfd90b7552bf5d4f8d66a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86574ff4fedfd90b7552bf5d4f8d66a2">&#9670;&#160;</a></span>UdInitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdInitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initialize user debugger </p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{</div>
<div class="line"><span class="lineno">   23</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="comment">// Check if it&#39;s already initialized or not, we&#39;ll ignore it if it&#39;s</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">// previously initialized</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   27</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><span class="lineno">   28</span>    {</div>
<div class="line"><span class="lineno">   29</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   30</span>    }</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   33</span>    <span class="comment">// Check if we have functions we need for attaching mechanism</span></div>
<div class="line"><span class="lineno">   34</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_user_access_8h.html#a2e58e91ee1d41c311736e026efcfe134">g_PsGetProcessPeb</a> == NULL || <a class="code hl_variable" href="_user_access_8h.html#a7e5eee7c3615d4c3a4b2e080eebf3046">g_PsGetProcessWow64Process</a> == NULL || <a class="code hl_variable" href="_user_access_8h.html#a114772f502575fa8e6ff36c9fab0bf3e">g_ZwQueryInformationProcess</a> == NULL)</div>
<div class="line"><span class="lineno">   36</span>    {</div>
<div class="line"><span class="lineno">   37</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unable to find needed functions for user-debugger&quot;</span>);</div>
<div class="line"><span class="lineno">   38</span>        <span class="comment">// return FALSE;</span></div>
<div class="line"><span class="lineno">   39</span>    }</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// Start the seed of user-mode debugging thread</span></div>
<div class="line"><span class="lineno">   43</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a6cc09230cf7303d0513330bed82491b0">g_SeedOfUserDebuggingDetails</a> = <a class="code hl_define" href="_constants_8h.html#a4a9c35cd734dd9a54b542d173e53eeee">DebuggerThreadDebuggingTagStartSeed</a>;</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// Initialize the thread debugging details list</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_function" href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a>(&amp;<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a>);</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   52</span>    <span class="comment">// Enable vm-exit on Hardware debug exceptions and breakpoints</span></div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">// so, intercept #DBs and #BP by changing exception bitmap (one core)</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_function" href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a>();</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// Request to allocate buffers for thread holder of threads</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_function" href="_thread_holder_8c.html#a437f8737b54482ae346eb1bcacd672d0">ThreadHolderAllocateThreadHoldingBuffers</a>();</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// Indicate that the user debugger is active</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   65</span>    <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   68</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_a74d9c313b40b008235ca3ca0e40628d3"><div class="ttname"><a href="_broadcast_8c.html#a74d9c313b40b008235ca3ca0e40628d3">BroadcastEnableDbAndBpExitingAllCores</a></div><div class="ttdeci">VOID BroadcastEnableDbAndBpExitingAllCores()</div><div class="ttdoc">routines to set vm-exit on all #DBs and #BP on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:35</div></div>
<div class="ttc" id="a_constants_8h_html_a4a9c35cd734dd9a54b542d173e53eeee"><div class="ttname"><a href="_constants_8h.html#a4a9c35cd734dd9a54b542d173e53eeee">DebuggerThreadDebuggingTagStartSeed</a></div><div class="ttdeci">#define DebuggerThreadDebuggingTagStartSeed</div><div class="ttdoc">The seeds that user-mode thread detail token start with it.</div><div class="ttdef"><b>Definition</b> Constants.h:229</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="a_thread_holder_8c_html_a437f8737b54482ae346eb1bcacd672d0"><div class="ttname"><a href="_thread_holder_8c.html#a437f8737b54482ae346eb1bcacd672d0">ThreadHolderAllocateThreadHoldingBuffers</a></div><div class="ttdeci">VOID ThreadHolderAllocateThreadHoldingBuffers()</div><div class="ttdoc">Pre allocate buffer for thread holder.</div><div class="ttdef"><b>Definition</b> ThreadHolder.c:21</div></div>
<div class="ttc" id="a_user_access_8h_html_a114772f502575fa8e6ff36c9fab0bf3e"><div class="ttname"><a href="_user_access_8h.html#a114772f502575fa8e6ff36c9fab0bf3e">g_ZwQueryInformationProcess</a></div><div class="ttdeci">ZwQueryInformationProcess g_ZwQueryInformationProcess</div><div class="ttdoc">Address of ZwQueryInformationProcess.</div><div class="ttdef"><b>Definition</b> UserAccess.h:187</div></div>
<div class="ttc" id="a_user_access_8h_html_a2e58e91ee1d41c311736e026efcfe134"><div class="ttname"><a href="_user_access_8h.html#a2e58e91ee1d41c311736e026efcfe134">g_PsGetProcessPeb</a></div><div class="ttdeci">PsGetProcessPeb g_PsGetProcessPeb</div><div class="ttdoc">Address of PsGetProcessPeb.</div><div class="ttdef"><b>Definition</b> UserAccess.h:193</div></div>
<div class="ttc" id="a_user_access_8h_html_a7e5eee7c3615d4c3a4b2e080eebf3046"><div class="ttname"><a href="_user_access_8h.html#a7e5eee7c3615d4c3a4b2e080eebf3046">g_PsGetProcessWow64Process</a></div><div class="ttdeci">PsGetProcessWow64Process g_PsGetProcessWow64Process</div><div class="ttdoc">Address of PsGetProcessWow64Process.</div><div class="ttdef"><b>Definition</b> UserAccess.h:199</div></div>
<div class="ttc" id="a_windows_8h_html_ad211c1678754ed394322f51a9e909c4a"><div class="ttname"><a href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a></div><div class="ttdeci">FORCEINLINE VOID InitializeListHead(_Out_ PLIST_ENTRY ListHead)</div><div class="ttdef"><b>Definition</b> Windows.h:41</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a3a003d2c59562062fe921cd2754440f7"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a3a003d2c59562062fe921cd2754440f7">g_ProcessDebuggingDetailsListHead</a></div><div class="ttdeci">LIST_ENTRY g_ProcessDebuggingDetailsListHead</div><div class="ttdoc">List header of thread debugging details.</div><div class="ttdef"><b>Definition</b> Global.h:152</div></div>
<div class="ttc" id="ahyperkd_2header_2globals_2_global_8h_html_a6cc09230cf7303d0513330bed82491b0"><div class="ttname"><a href="hyperkd_2header_2globals_2_global_8h.html#a6cc09230cf7303d0513330bed82491b0">g_SeedOfUserDebuggingDetails</a></div><div class="ttdeci">UINT64 g_SeedOfUserDebuggingDetails</div><div class="ttdoc">Seed for tokens of unique details buffer for threads.</div><div class="ttdef"><b>Definition</b> Global.h:139</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1952ae25243278fc748ce38a16183410" name="a1952ae25243278fc748ce38a16183410"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1952ae25243278fc748ce38a16183410">&#9670;&#160;</a></span>UdPerformCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> UdPerformCommand </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a246fe957e8b56ed0c8607f0f4a706d0b">DEBUGGER_UD_COMMAND_ACTION_TYPE</a></td>          <td class="paramname"><span class="paramname"><em>UserAction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam3</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam4</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform the user-mode commands. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">UserAction</td><td></td></tr>
    <tr><td class="paramname">OptionalParam1</td><td></td></tr>
    <tr><td class="paramname">OptionalParam2</td><td></td></tr>
    <tr><td class="paramname">OptionalParam3</td><td></td></tr>
    <tr><td class="paramname">OptionalParam4</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  211</span>{</div>
<div class="line"><span class="lineno">  212</span>    UNREFERENCED_PARAMETER(OptionalParam2);</div>
<div class="line"><span class="lineno">  213</span>    UNREFERENCED_PARAMETER(OptionalParam3);</div>
<div class="line"><span class="lineno">  214</span>    UNREFERENCED_PARAMETER(OptionalParam4);</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  217</span>    <span class="comment">// Perform the command</span></div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">switch</span> (UserAction)</div>
<div class="line"><span class="lineno">  220</span>    {</div>
<div class="line"><span class="lineno">  221</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d">DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</a>:</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  224</span>        <span class="comment">// Continue the thread normally</span></div>
<div class="line"><span class="lineno">  225</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  226</span>        <a class="code hl_function" href="#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a>(ThreadDebuggingDetails);</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde">DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</a>:</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  233</span>        <span class="comment">// Stepping through the instructions</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  235</span>        <a class="code hl_function" href="#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a>(ThreadDebuggingDetails, (<a class="code hl_typedef" href="_request_structures_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  242</span>        <span class="comment">// Invalid user action</span></div>
<div class="line"><span class="lineno">  243</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  244</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  249</span>}</div>
<div class="ttc" id="a_request_structures_8h_html_a802b099f77f70d5fde80220454df2190"><div class="ttname"><a href="_request_structures_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a></div><div class="ttdeci">enum _DEBUGGER_REMOTE_STEPPING_REQUEST DEBUGGER_REMOTE_STEPPING_REQUEST</div><div class="ttdoc">stepping and tracking types</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde"><div class="ttname"><a href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1a9ef67974ab1682d82fbf4feebc05fcde">DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_REGULAR_STEP</div><div class="ttdef"><b>Definition</b> RequestStructures.h:870</div></div>
<div class="ttc" id="a_request_structures_8h_html_ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d"><div class="ttname"><a href="_request_structures_8h.html#ad87c3f70d0c62885d9fa07518b5802a1afb4083783dd81d465b89aa4abfdd6b4d">DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</a></div><div class="ttdeci">@ DEBUGGER_UD_COMMAND_ACTION_TYPE_CONTINUE</div><div class="ttdef"><b>Definition</b> RequestStructures.h:869</div></div>
<div class="ttc" id="a_ud_8c_html_a6511ae87f747db8b9448846c7bed8565"><div class="ttname"><a href="#a6511ae87f747db8b9448846c7bed8565">UdStepInstructions</a></div><div class="ttdeci">VOID UdStepInstructions(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails, DEBUGGER_REMOTE_STEPPING_REQUEST SteppingType)</div><div class="ttdoc">Perform stepping though the instructions in target thread.</div><div class="ttdef"><b>Definition</b> Ud.c:144</div></div>
<div class="ttc" id="a_ud_8c_html_a85b049cfd213a9037a5d33810dcabb67"><div class="ttname"><a href="#a85b049cfd213a9037a5d33810dcabb67">UdContinueThread</a></div><div class="ttdeci">VOID UdContinueThread(PUSERMODE_DEBUGGING_THREAD_DETAILS ThreadDebuggingDetails)</div><div class="ttdoc">Continue the thread.</div><div class="ttdef"><b>Definition</b> Ud.c:118</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b34356fa5078db5eceab1194735f60a" name="a6b34356fa5078db5eceab1194735f60a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b34356fa5078db5eceab1194735f60a">&#9670;&#160;</a></span>UdPrePausingReasons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdPrePausingReasons </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperkd_2header_2debugger_2core_2_state_8h.html#aa35afece6adc9a29a7bf7a2e76476037">PROCESSOR_DEBUGGING_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>DbgState</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_connection_8h.html#ac834b5b60f3a3213636632ea482a26a3">DEBUGGEE_PAUSING_REASON</a></td>          <td class="paramname"><span class="paramname"><em>Reason</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad502772c412e6f5dd67d557fdc3a4322">PDEBUGGER_TRIGGERED_EVENT_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>EventDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle special reasons pre-pausings. </p>
<p>This function can be used in vmx-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DbgState</td><td>The state of the debugger on the current core </td></tr>
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">Reason</td><td></td></tr>
    <tr><td class="paramname">EventDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  414</span>{</div>
<div class="line"><span class="lineno">  415</span>    UNREFERENCED_PARAMETER(DbgState);</div>
<div class="line"><span class="lineno">  416</span>    UNREFERENCED_PARAMETER(ThreadDebuggingDetails);</div>
<div class="line"><span class="lineno">  417</span>    UNREFERENCED_PARAMETER(EventDetails);</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// *** Handle events before pausing ***</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>    <span class="keywordflow">switch</span> (Reason)</div>
<div class="line"><span class="lineno">  423</span>    {</div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a>:</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  429</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="line"><span class="lineno">  431</span>}</div>
<div class="ttc" id="a_connection_8h_html_a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5"><div class="ttname"><a href="_connection_8h.html#a6e2be89205e735ebae644cf4850ac21ba369b24d73385054023d8aba1a5d3c8b5">DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</a></div><div class="ttdeci">@ DEBUGGEE_PAUSING_REASON_DEBUGGEE_GENERAL_DEBUG_BREAK</div><div class="ttdef"><b>Definition</b> Connection.h:41</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a341566fede69a4d98bc71badd18a4973" name="a341566fede69a4d98bc71badd18a4973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341566fede69a4d98bc71badd18a4973">&#9670;&#160;</a></span>UdRestoreToOriginalDirection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdRestoreToOriginalDirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restore the thread to the original direction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  103</span>{</div>
<div class="line"><span class="lineno">  104</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  105</span>    <span class="comment">// Configure the RIP again</span></div>
<div class="line"><span class="lineno">  106</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_function" href="_export_8c.html#a0a712a6517e84746a34bcfc6a50a15fa">VmFuncSetRip</a>(ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">ThreadRip</a>);</div>
<div class="line"><span class="lineno">  108</span>}</div>
<div class="ttc" id="a_export_8c_html_a0a712a6517e84746a34bcfc6a50a15fa"><div class="ttname"><a href="_export_8c.html#a0a712a6517e84746a34bcfc6a50a15fa">VmFuncSetRip</a></div><div class="ttdeci">VOID VmFuncSetRip(UINT64 Rip)</div><div class="ttdoc">Set guest's RIP.</div><div class="ttdef"><b>Definition</b> Export.c:387</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s_html_a174db30b0f4e22cefa4a26c91c903e41"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">_USERMODE_DEBUGGING_THREAD_DETAILS::ThreadRip</a></div><div class="ttdeci">UINT64 ThreadRip</div><div class="ttdef"><b>Definition</b> ThreadHolder.h:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a382dd16eb179d5548591aa4468ffbc05" name="a382dd16eb179d5548591aa4468ffbc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a382dd16eb179d5548591aa4468ffbc05">&#9670;&#160;</a></span>UdSpinThreadOnNop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdSpinThreadOnNop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_attaching_8h.html#ac289d6b25a670c70d1f6a5105788fb04">PUSERMODE_DEBUGGING_PROCESS_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ProcessDebuggingDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spin on nop sled in user-mode to halt the debuggee. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
    <tr><td class="paramname">ProcessDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  381</span>{</div>
<div class="line"><span class="lineno">  382</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// Save the RIP for future return</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  385</span>    ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#a174db30b0f4e22cefa4a26c91c903e41">ThreadRip</a> = <a class="code hl_function" href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a>();</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="comment">// Set the rip to new spinning address</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  390</span>    <a class="code hl_function" href="_export_8c.html#a0a712a6517e84746a34bcfc6a50a15fa">VmFuncSetRip</a>(ProcessDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac2d3522e9585dce69980ff651c53cb1d">UsermodeReservedBuffer</a>);</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  393</span>    <span class="comment">// Indicate that it&#39;s spinning</span></div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  395</span>    ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  396</span>}</div>
<div class="ttc" id="a_export_8c_html_adcc46211db99d7ad7e48e04fda4cf416"><div class="ttname"><a href="_export_8c.html#adcc46211db99d7ad7e48e04fda4cf416">VmFuncGetRip</a></div><div class="ttdeci">UINT64 VmFuncGetRip()</div><div class="ttdoc">Read guest's RIP.</div><div class="ttdef"><b>Definition</b> Export.c:375</div></div>
<div class="ttc" id="astruct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s_html_ac2d3522e9585dce69980ff651c53cb1d"><div class="ttname"><a href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___p_r_o_c_e_s_s___d_e_t_a_i_l_s.html#ac2d3522e9585dce69980ff651c53cb1d">_USERMODE_DEBUGGING_PROCESS_DETAILS::UsermodeReservedBuffer</a></div><div class="ttdeci">UINT64 UsermodeReservedBuffer</div><div class="ttdef"><b>Definition</b> Attaching.h:57</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6511ae87f747db8b9448846c7bed8565" name="a6511ae87f747db8b9448846c7bed8565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6511ae87f747db8b9448846c7bed8565">&#9670;&#160;</a></span>UdStepInstructions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdStepInstructions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_thread_holder_8h.html#adfafd6862ce9b62e3351c15dbd8b089d">PUSERMODE_DEBUGGING_THREAD_DETAILS</a></td>          <td class="paramname"><span class="paramname"><em>ThreadDebuggingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_request_structures_8h.html#a802b099f77f70d5fde80220454df2190">DEBUGGER_REMOTE_STEPPING_REQUEST</a></td>          <td class="paramname"><span class="paramname"><em>SteppingType</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform stepping though the instructions in target thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ThreadDebuggingDetails</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  146</span>{</div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  148</span>    <span class="comment">// Configure the RIP</span></div>
<div class="line"><span class="lineno">  149</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  150</span>    <a class="code hl_function" href="#a341566fede69a4d98bc71badd18a4973">UdRestoreToOriginalDirection</a>(ThreadDebuggingDetails);</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">switch</span> (SteppingType)</div>
<div class="line"><span class="lineno">  153</span>    {</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</a>:</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  157</span>        <span class="comment">// Set the trap-flag</span></div>
<div class="line"><span class="lineno">  158</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  159</span>        <a class="code hl_function" href="_export_8c.html#a8f68fa306b093e98466bd4f16cd16035">VmFuncSetRflagTrapFlag</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  162</span>        <span class="comment">// Indicate that we should set the trap flag to the FALSE next time on</span></div>
<div class="line"><span class="lineno">  163</span>        <span class="comment">// the same process/thread</span></div>
<div class="line"><span class="lineno">  164</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_breakpoint_commands_8c.html#ac0e535f6d443deb15a20ffbf8e2252c6">BreakpointRestoreTheTrapFlagOnceTriggered</a>(<a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentProcessId()), <a class="code hl_define" href="_meta_macros_8h.html#ad790279846c85a5a453f2e7a4e02abad">HANDLE_TO_UINT32</a>(PsGetCurrentThreadId())))</div>
<div class="line"><span class="lineno">  166</span>        {</div>
<div class="line"><span class="lineno">  167</span>            <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a>(<span class="stringliteral">&quot;Warning, it is currently not possible to add the current process/thread to the list of processes &quot;</span></div>
<div class="line"><span class="lineno">  168</span>                       <span class="stringliteral">&quot;where the trap flag should be masked. Please ensure that you manually unset the trap flag&quot;</span>);</div>
<div class="line"><span class="lineno">  169</span>        }</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_request_structures_8h.html#a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</a>:</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  179</span>    }</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  182</span>    <span class="comment">// Continue the current instruction won&#39;t pass it</span></div>
<div class="line"><span class="lineno">  183</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_function" href="_export_8c.html#ad357512be8732352fac0e4a03676e458">VmFuncSuppressRipIncrement</a>(KeGetCurrentProcessorNumberEx(NULL));</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">// It&#39;s not paused anymore!</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  189</span>    ThreadDebuggingDetails-&gt;<a class="code hl_variable" href="struct___u_s_e_r_m_o_d_e___d_e_b_u_g_g_i_n_g___t_h_r_e_a_d___d_e_t_a_i_l_s.html#afcd7f63e2118dbfefdac3e7c79fda7fc">IsPaused</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  190</span>}</div>
<div class="ttc" id="a_breakpoint_commands_8c_html_ac0e535f6d443deb15a20ffbf8e2252c6"><div class="ttname"><a href="_breakpoint_commands_8c.html#ac0e535f6d443deb15a20ffbf8e2252c6">BreakpointRestoreTheTrapFlagOnceTriggered</a></div><div class="ttdeci">BOOLEAN BreakpointRestoreTheTrapFlagOnceTriggered(UINT32 ProcessId, UINT32 ThreadId)</div><div class="ttdoc">This function makes sure to unset the RFLAGS.TF on next trigger of #DB on the target process/thread.</div><div class="ttdef"><b>Definition</b> BreakpointCommands.c:174</div></div>
<div class="ttc" id="a_export_8c_html_a8f68fa306b093e98466bd4f16cd16035"><div class="ttname"><a href="_export_8c.html#a8f68fa306b093e98466bd4f16cd16035">VmFuncSetRflagTrapFlag</a></div><div class="ttdeci">VOID VmFuncSetRflagTrapFlag(BOOLEAN Set)</div><div class="ttdoc">Set Rflag's trap flag.</div><div class="ttdef"><b>Definition</b> Export.c:110</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_abf506c814a6f717a87b5d808b828ef56"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#abf506c814a6f717a87b5d808b828ef56">LogWarning</a></div><div class="ttdeci">#define LogWarning(format,...)</div><div class="ttdoc">Log in the case of warning.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:99</div></div>
<div class="ttc" id="a_request_structures_8h_html_a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe"><div class="ttname"><a href="_request_structures_8h.html#a712ecf490a024ef4e89274a9075b3d5ba65fd7f83ac0cea94ffc166049c18fffe">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_IN</div><div class="ttdef"><b>Definition</b> RequestStructures.h:992</div></div>
<div class="ttc" id="a_request_structures_8h_html_a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315"><div class="ttname"><a href="_request_structures_8h.html#a712ecf490a024ef4e89274a9075b3d5ba981ecc65ffc870c95bc3c9ebb638f315">DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</a></div><div class="ttdeci">@ DEBUGGER_REMOTE_STEPPING_REQUEST_STEP_OVER</div><div class="ttdef"><b>Definition</b> RequestStructures.h:996</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c8e27ff0bdd3e135b4e39c7cf7b5805" name="a7c8e27ff0bdd3e135b4e39c7cf7b5805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8e27ff0bdd3e135b4e39c7cf7b5805">&#9670;&#160;</a></span>UdUninitializeUserDebugger()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UdUninitializeUserDebugger </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>uninitialize user debugger </p>
<p>this function should be called on vmx non-root</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   78</span>{</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a>)</div>
<div class="line"><span class="lineno">   80</span>    {</div>
<div class="line"><span class="lineno">   81</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   82</span>        <span class="comment">// Indicate that the user debugger is not active</span></div>
<div class="line"><span class="lineno">   83</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   84</span>        <a class="code hl_variable" href="hyperkd_2header_2globals_2_global_8h.html#ae304ded1a8cbb4e772d97aec7510c9d2">g_UserDebuggerState</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   87</span>        <span class="comment">// Free and deallocate all the buffers (pools) relating to</span></div>
<div class="line"><span class="lineno">   88</span>        <span class="comment">// thread debugging details</span></div>
<div class="line"><span class="lineno">   89</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">   90</span>        <a class="code hl_function" href="_attaching_8c.html#ad16b106f9f7b6a857bafc12252bcfadd">AttachingRemoveAndFreeAllProcessDebuggingDetails</a>();</div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="line"><span class="lineno">   92</span>}</div>
<div class="ttc" id="a_attaching_8c_html_ad16b106f9f7b6a857bafc12252bcfadd"><div class="ttname"><a href="_attaching_8c.html#ad16b106f9f7b6a857bafc12252bcfadd">AttachingRemoveAndFreeAllProcessDebuggingDetails</a></div><div class="ttdeci">VOID AttachingRemoveAndFreeAllProcessDebuggingDetails()</div><div class="ttdoc">Remove and deallocate all thread debuggig details.</div><div class="ttdef"><b>Definition</b> Attaching.c:229</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_fd401680aa8c7ceffc479e97f6bdc4df.html">hyperkd</a></li><li class="navelem"><a class="el" href="dir_587853473f29459994cc5353647295ff.html">code</a></li><li class="navelem"><a class="el" href="dir_366222a910cb7e5dbd8918e7b8c2300f.html">debugger</a></li><li class="navelem"><a class="el" href="dir_5b295181e1984a926e957f167892ca57.html">user-level</a></li><li class="navelem"><a class="el" href="_ud_8c.html">Ud.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
