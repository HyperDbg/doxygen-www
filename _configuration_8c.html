<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperhv/code/interface/Configuration.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_configuration_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Configuration.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Configuration interface for hypervisor events.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab3a6af0209221a2a25ae9201fc60f1cf" id="r_ab3a6af0209221a2a25ae9201fc60f1cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3a6af0209221a2a25ae9201fc60f1cf">ConfigureEnableMovToCr3ExitingOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:ab3a6af0209221a2a25ae9201fc60f1cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for debugging threads (enable mov-to-cr3 exiting)  <br /></td></tr>
<tr class="separator:ab3a6af0209221a2a25ae9201fc60f1cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b26f0e861226a28347668799ce3f45e" id="r_a1b26f0e861226a28347668799ce3f45e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b26f0e861226a28347668799ce3f45e">ConfigureInitializeExecTrapOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a1b26f0e861226a28347668799ce3f45e"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing user-mode, kernel-mode exec trap  <br /></td></tr>
<tr class="separator:a1b26f0e861226a28347668799ce3f45e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43c62c45378725295f24cbcc094c15b6" id="r_a43c62c45378725295f24cbcc094c15b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a43c62c45378725295f24cbcc094c15b6">ConfigureUninitializeExecTrapOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a43c62c45378725295f24cbcc094c15b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for uninitializing user-mode, kernel-mode exec trap  <br /></td></tr>
<tr class="separator:a43c62c45378725295f24cbcc094c15b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ba9a32992d91af37190d377c727e7f6" id="r_a0ba9a32992d91af37190d377c727e7f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ba9a32992d91af37190d377c727e7f6">ConfigureExecTrapAddProcessToWatchingList</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:a0ba9a32992d91af37190d377c727e7f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the target process to the watching list.  <br /></td></tr>
<tr class="separator:a0ba9a32992d91af37190d377c727e7f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1efec5051f2996a76d234bc01ac41bf" id="r_af1efec5051f2996a76d234bc01ac41bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1efec5051f2996a76d234bc01ac41bf">ConfigureExecTrapRemoveProcessFromWatchingList</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:af1efec5051f2996a76d234bc01ac41bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the target process from the watching list.  <br /></td></tr>
<tr class="separator:af1efec5051f2996a76d234bc01ac41bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e72ac48176ecf52fe48443a9903593" id="r_ac0e72ac48176ecf52fe48443a9903593"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac0e72ac48176ecf52fe48443a9903593">ConfigureModeBasedExecHookUninitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:ac0e72ac48176ecf52fe48443a9903593"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing Mode-based execution hooks  <br /></td></tr>
<tr class="separator:ac0e72ac48176ecf52fe48443a9903593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87af14fc672b4f22dd8bf9aa06133bfe" id="r_a87af14fc672b4f22dd8bf9aa06133bfe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a87af14fc672b4f22dd8bf9aa06133bfe">ConfigureDirtyLoggingInitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a87af14fc672b4f22dd8bf9aa06133bfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for initializing dirty logging mechanism  <br /></td></tr>
<tr class="separator:a87af14fc672b4f22dd8bf9aa06133bfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a4d4056b23b71fe99f68da92ec7a4ea" id="r_a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5a4d4056b23b71fe99f68da92ec7a4ea">ConfigureDirtyLoggingUninitializeOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for uninitializing dirty logging mechanism  <br /></td></tr>
<tr class="separator:a5a4d4056b23b71fe99f68da92ec7a4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c7fc6c4f8d88ccb2fe6308242bf56b" id="r_aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5c7fc6c4f8d88ccb2fe6308242bf56b">ConfigureDisableMovToCr3ExitingOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for debugging threads (disable mov-to-cr3 exiting)  <br /></td></tr>
<tr class="separator:aa5c7fc6c4f8d88ccb2fe6308242bf56b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfe8ffc9a78f0f643eb7acc8034e4d6c" id="r_adfe8ffc9a78f0f643eb7acc8034e4d6c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfe8ffc9a78f0f643eb7acc8034e4d6c">ConfigureEnableEferSyscallEventsOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:adfe8ffc9a78f0f643eb7acc8034e4d6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for enabling syscall hooks on all cores  <br /></td></tr>
<tr class="separator:adfe8ffc9a78f0f643eb7acc8034e4d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c34667ae652718d0b8a15a84e6ccc7f" id="r_a9c34667ae652718d0b8a15a84e6ccc7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9c34667ae652718d0b8a15a84e6ccc7f">ConfigureDisableEferSyscallEventsOnAllProcessors</a> ()</td></tr>
<tr class="memdesc:a9c34667ae652718d0b8a15a84e6ccc7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for disabling syscall hooks on all cores  <br /></td></tr>
<tr class="separator:a9c34667ae652718d0b8a15a84e6ccc7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a254f9f215ff46e11941c1e1dcb770ca5" id="r_a254f9f215ff46e11941c1e1dcb770ca5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a254f9f215ff46e11941c1e1dcb770ca5">ConfigureEptHookUnHookAllByHookingTag</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> HookingTag)</td></tr>
<tr class="memdesc:a254f9f215ff46e11941c1e1dcb770ca5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all hooks from the hooked pages list using Hooking Tag.  <br /></td></tr>
<tr class="separator:a254f9f215ff46e11941c1e1dcb770ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b0b0313ad16cd496dc2402b9741e587" id="r_a3b0b0313ad16cd496dc2402b9741e587"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3b0b0313ad16cd496dc2402b9741e587">ConfigureEptHookUnHookSingleHookByHookingTagFromVmxRoot</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> HookingTag, <a class="el" href="_data_types_8h.html#a27c1e2d2980e51cf66a1c72b3f08ba13">EPT_SINGLE_HOOK_UNHOOKING_DETAILS</a> *TargetUnhookingDetails)</td></tr>
<tr class="memdesc:a3b0b0313ad16cd496dc2402b9741e587"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove single hook from the hooked pages by the given hooking tag.  <br /></td></tr>
<tr class="separator:a3b0b0313ad16cd496dc2402b9741e587"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6129e5f85312a405e0509e2c45351bf" id="r_ad6129e5f85312a405e0509e2c45351bf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6129e5f85312a405e0509e2c45351bf">ConfigureEptHookUnHookSingleAddress</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VirtualAddress, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> PhysAddress, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:ad6129e5f85312a405e0509e2c45351bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove single hook from the hooked pages list and invalidate TLB.  <br /></td></tr>
<tr class="separator:ad6129e5f85312a405e0509e2c45351bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3d7477b90e15cb7d2d2bf6f297a143b" id="r_ac3d7477b90e15cb7d2d2bf6f297a143b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac3d7477b90e15cb7d2d2bf6f297a143b">ConfigureEptHookUnHookSingleAddressFromVmxRoot</a> (<a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VirtualAddress, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> PhysAddress, <a class="el" href="_data_types_8h.html#a27c1e2d2980e51cf66a1c72b3f08ba13">EPT_SINGLE_HOOK_UNHOOKING_DETAILS</a> *TargetUnhookingDetails)</td></tr>
<tr class="memdesc:ac3d7477b90e15cb7d2d2bf6f297a143b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove single hook from the hooked pages list and invalidate TLB.  <br /></td></tr>
<tr class="separator:ac3d7477b90e15cb7d2d2bf6f297a143b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc1de369fee20f1c13ce5da2c0fa5741" id="r_adc1de369fee20f1c13ce5da2c0fa5741"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adc1de369fee20f1c13ce5da2c0fa5741">ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Count)</td></tr>
<tr class="memdesc:adc1de369fee20f1c13ce5da2c0fa5741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate (reserve) extra pages for storing details of page hooks for memory monitor and regular hidden breakpoit exec EPT hooks.  <br /></td></tr>
<tr class="separator:adc1de369fee20f1c13ce5da2c0fa5741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af51d98af8c16c62303308f6f3ba91d1f" id="r_af51d98af8c16c62303308f6f3ba91d1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af51d98af8c16c62303308f6f3ba91d1f">ConfigureEptHookReservePreallocatedPoolsForEptHooks</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> Count)</td></tr>
<tr class="memdesc:af51d98af8c16c62303308f6f3ba91d1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate (reserve) pages for storing EPT hooks page hooks.  <br /></td></tr>
<tr class="separator:af51d98af8c16c62303308f6f3ba91d1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa62d4e17a65f5e1024f37e3c2bf0b38" id="r_aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaa62d4e17a65f5e1024f37e3c2bf0b38">ConfigureEptHook</a> (PVOID TargetAddress, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function invokes a VMCALL to set the hook and broadcast the exiting for the breakpoints on exception bitmap.  <br /></td></tr>
<tr class="separator:aaa62d4e17a65f5e1024f37e3c2bf0b38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62f7ef4d19e12ebb556aacc7336a258b" id="r_a62f7ef4d19e12ebb556aacc7336a258b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a62f7ef4d19e12ebb556aacc7336a258b">ConfigureEptHookFromVmxRoot</a> (PVOID TargetAddress)</td></tr>
<tr class="memdesc:a62f7ef4d19e12ebb556aacc7336a258b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function invokes a direct VMCALL to setup the hook.  <br /></td></tr>
<tr class="separator:a62f7ef4d19e12ebb556aacc7336a258b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67644a4cbc1a7a2d4c6382588357f585" id="r_a67644a4cbc1a7a2d4c6382588357f585"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a67644a4cbc1a7a2d4c6382588357f585">ConfigureEptHook2</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID TargetAddress, PVOID HookFunction, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:a67644a4cbc1a7a2d4c6382588357f585"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook (inline)  <br /></td></tr>
<tr class="separator:a67644a4cbc1a7a2d4c6382588357f585"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4069f3b063b90661ebd402a98202a4" id="r_ade4069f3b063b90661ebd402a98202a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ade4069f3b063b90661ebd402a98202a4">ConfigureEptHookMonitor</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, <a class="el" href="_data_types_8h.html#ad14bc163543c2acede2c878c50aeca14">EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR</a> *HookingDetails, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> ProcessId)</td></tr>
<tr class="memdesc:ade4069f3b063b90661ebd402a98202a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.  <br /></td></tr>
<tr class="separator:ade4069f3b063b90661ebd402a98202a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e8b90baa0b31ae1606aaaa607295d3" id="r_ac9e8b90baa0b31ae1606aaaa607295d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac9e8b90baa0b31ae1606aaaa607295d3">ConfigureEptHook2FromVmxRoot</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID TargetAddress, PVOID HookFunction)</td></tr>
<tr class="memdesc:ac9e8b90baa0b31ae1606aaaa607295d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook (inline EPT hook)  <br /></td></tr>
<tr class="separator:ac9e8b90baa0b31ae1606aaaa607295d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924bb7e1c684b4a3c9f4f25bd2909420" id="r_a924bb7e1c684b4a3c9f4f25bd2909420"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a924bb7e1c684b4a3c9f4f25bd2909420">ConfigureEptHookMonitorFromVmxRoot</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, <a class="el" href="_data_types_8h.html#ad14bc163543c2acede2c878c50aeca14">EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR</a> *MemoryAddressDetails)</td></tr>
<tr class="memdesc:a924bb7e1c684b4a3c9f4f25bd2909420"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook.  <br /></td></tr>
<tr class="separator:a924bb7e1c684b4a3c9f4f25bd2909420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae487c6cde6eab0c8b5c934900e02f77" id="r_aae487c6cde6eab0c8b5c934900e02f77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae487c6cde6eab0c8b5c934900e02f77">ConfigureEptHookModifyInstructionFetchState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:aae487c6cde6eab0c8b5c934900e02f77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for execution (execute) @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:aae487c6cde6eab0c8b5c934900e02f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3273428c5505c7af8a08a2319c8e688" id="r_af3273428c5505c7af8a08a2319c8e688"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3273428c5505c7af8a08a2319c8e688">ConfigureEptHookModifyPageReadState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:af3273428c5505c7af8a08a2319c8e688"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for read @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:af3273428c5505c7af8a08a2319c8e688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701db01cdd2fb70134e209fe80d23236" id="r_a701db01cdd2fb70134e209fe80d23236"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a701db01cdd2fb70134e209fe80d23236">ConfigureEptHookModifyPageWriteState</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> CoreId, PVOID PhysicalAddress, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsUnset)</td></tr>
<tr class="memdesc:a701db01cdd2fb70134e209fe80d23236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change PML EPT state for write @detail should be called from VMX-root.  <br /></td></tr>
<tr class="separator:a701db01cdd2fb70134e209fe80d23236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae420ed37e0594e55d9b5842fc06ef7b7" id="r_ae420ed37e0594e55d9b5842fc06ef7b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae420ed37e0594e55d9b5842fc06ef7b7">ConfigureEnableEferSyscallHookOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:ae420ed37e0594e55d9b5842fc06ef7b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for enabling EFER syscall hooks on a single core  <br /></td></tr>
<tr class="separator:ae420ed37e0594e55d9b5842fc06ef7b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34a96b88916b2d0614736d7915afaa38" id="r_a34a96b88916b2d0614736d7915afaa38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34a96b88916b2d0614736d7915afaa38">ConfigureSetEferSyscallOrSysretHookType</a> (<a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a> SyscallHookType)</td></tr>
<tr class="memdesc:a34a96b88916b2d0614736d7915afaa38"><td class="mdescLeft">&#160;</td><td class="mdescRight">routines for setting EFER syscall or sysret hooks type  <br /></td></tr>
<tr class="separator:a34a96b88916b2d0614736d7915afaa38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cefdf192b6214caca28a2d3472dabe" id="r_aa8cefdf192b6214caca28a2d3472dabe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa8cefdf192b6214caca28a2d3472dabe">ConfigureSetExternalInterruptExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:aa8cefdf192b6214caca28a2d3472dabe"><td class="mdescLeft">&#160;</td><td class="mdescRight">set external interrupt exiting on a single core  <br /></td></tr>
<tr class="separator:aa8cefdf192b6214caca28a2d3472dabe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a736c9678fb16d3340e7b963ce779d85e" id="r_a736c9678fb16d3340e7b963ce779d85e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a736c9678fb16d3340e7b963ce779d85e">ConfigureEnableRdtscExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a736c9678fb16d3340e7b963ce779d85e"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable RDTSC exiting on a single core  <br /></td></tr>
<tr class="separator:a736c9678fb16d3340e7b963ce779d85e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d05c72969eddee7308d4fd44522c34" id="r_a40d05c72969eddee7308d4fd44522c34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40d05c72969eddee7308d4fd44522c34">ConfigureEnableRdpmcExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a40d05c72969eddee7308d4fd44522c34"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable RDPMC exiting on a single core  <br /></td></tr>
<tr class="separator:a40d05c72969eddee7308d4fd44522c34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528c7a4faebda601e8f256629cd8c324" id="r_a528c7a4faebda601e8f256629cd8c324"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a528c7a4faebda601e8f256629cd8c324">ConfigureEnableMovToDebugRegistersExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId)</td></tr>
<tr class="memdesc:a528c7a4faebda601e8f256629cd8c324"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable mov 2 debug register exiting on a single core  <br /></td></tr>
<tr class="separator:a528c7a4faebda601e8f256629cd8c324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1440df6523c738461133801841828def" id="r_a1440df6523c738461133801841828def"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1440df6523c738461133801841828def">ConfigureSetExceptionBitmapOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> BitMask)</td></tr>
<tr class="memdesc:a1440df6523c738461133801841828def"><td class="mdescLeft">&#160;</td><td class="mdescRight">set exception bitmap on a single core  <br /></td></tr>
<tr class="separator:a1440df6523c738461133801841828def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c7a84afe5fc98e8bd9dff575bc4591" id="r_a37c7a84afe5fc98e8bd9dff575bc4591"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37c7a84afe5fc98e8bd9dff575bc4591">ConfigureEnableMovToControlRegisterExitingOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#aec65406a861ee0f07b61245e0ae32a00">DEBUGGER_EVENT_OPTIONS</a> *BroadcastingOption)</td></tr>
<tr class="memdesc:a37c7a84afe5fc98e8bd9dff575bc4591"><td class="mdescLeft">&#160;</td><td class="mdescRight">enable mov 2 control register on a single core  <br /></td></tr>
<tr class="separator:a37c7a84afe5fc98e8bd9dff575bc4591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85d8b0bc91e6f1a0013eb07af520504f" id="r_a85d8b0bc91e6f1a0013eb07af520504f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85d8b0bc91e6f1a0013eb07af520504f">ConfigureChangeMsrBitmapWriteOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> MsrMask)</td></tr>
<tr class="memdesc:a85d8b0bc91e6f1a0013eb07af520504f"><td class="mdescLeft">&#160;</td><td class="mdescRight">change the mask of msr bitmaps for write on a single core  <br /></td></tr>
<tr class="separator:a85d8b0bc91e6f1a0013eb07af520504f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae43ea56fe71188fc168438908e6f4d1e" id="r_ae43ea56fe71188fc168438908e6f4d1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae43ea56fe71188fc168438908e6f4d1e">ConfigureChangeMsrBitmapReadOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> MsrMask)</td></tr>
<tr class="memdesc:ae43ea56fe71188fc168438908e6f4d1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">change the mask of msr bitmaps for read on a single core  <br /></td></tr>
<tr class="separator:ae43ea56fe71188fc168438908e6f4d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80befb4c3f298c82e7ff79d4a219fc11" id="r_a80befb4c3f298c82e7ff79d4a219fc11"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80befb4c3f298c82e7ff79d4a219fc11">ConfigureChangeIoBitmapOnSingleCore</a> (<a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> TargetCoreId, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Port)</td></tr>
<tr class="memdesc:a80befb4c3f298c82e7ff79d4a219fc11"><td class="mdescLeft">&#160;</td><td class="mdescRight">change I/O port bitmap on a single core  <br /></td></tr>
<tr class="separator:a80befb4c3f298c82e7ff79d4a219fc11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Configuration interface for hypervisor events. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2023-01-26</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a80befb4c3f298c82e7ff79d4a219fc11" name="a80befb4c3f298c82e7ff79d4a219fc11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80befb4c3f298c82e7ff79d4a219fc11">&#9670;&#160;</a></span>ConfigureChangeIoBitmapOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeIoBitmapOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Port</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change I/O port bitmap on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">Port</td><td>Target port in I/O bitmap</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  569</span>{</div>
<div class="line"><span class="lineno">  570</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a4ce952e8ebd61cde6d6dcc118fb77541">DpcRoutinePerformChangeIoBitmapOnSingleCore</a>, (PVOID)Port);</div>
<div class="line"><span class="lineno">  571</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a4ce952e8ebd61cde6d6dcc118fb77541"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a4ce952e8ebd61cde6d6dcc118fb77541">DpcRoutinePerformChangeIoBitmapOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeIoBitmapOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change I/O bitmap on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:419</div></div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a860d1d5fbe8605d03eda7327935c799e"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a></div><div class="ttdeci">NTSTATUS DpcRoutineRunTaskOnSingleCore(UINT32 CoreNumber, PVOID Routine, PVOID DeferredContext)</div><div class="ttdoc">This function synchronize the function execution for a single core You should only used it for one co...</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae43ea56fe71188fc168438908e6f4d1e" name="ae43ea56fe71188fc168438908e6f4d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae43ea56fe71188fc168438908e6f4d1e">&#9670;&#160;</a></span>ConfigureChangeMsrBitmapReadOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeMsrBitmapReadOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>MsrMask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change the mask of msr bitmaps for read on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">MsrMask</td><td>The ECX in MSR (mask)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  555</span>{</div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a64193ff039021b05cfee8e048af68c31">DpcRoutinePerformChangeMsrBitmapReadOnSingleCore</a>, (PVOID)MsrMask);</div>
<div class="line"><span class="lineno">  557</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a64193ff039021b05cfee8e048af68c31"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a64193ff039021b05cfee8e048af68c31">DpcRoutinePerformChangeMsrBitmapReadOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeMsrBitmapReadOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change msr bitmap read on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:161</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85d8b0bc91e6f1a0013eb07af520504f" name="a85d8b0bc91e6f1a0013eb07af520504f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85d8b0bc91e6f1a0013eb07af520504f">&#9670;&#160;</a></span>ConfigureChangeMsrBitmapWriteOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureChangeMsrBitmapWriteOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>MsrMask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>change the mask of msr bitmaps for write on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">MsrMask</td><td>The ECX in MSR (mask)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  541</span>{</div>
<div class="line"><span class="lineno">  542</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a7b111e2caa07e0259a61102db2ba61af">DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore</a>, (PVOID)MsrMask);</div>
<div class="line"><span class="lineno">  543</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a7b111e2caa07e0259a61102db2ba61af"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a7b111e2caa07e0259a61102db2ba61af">DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformChangeMsrBitmapWriteOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change msr bitmap write on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:189</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87af14fc672b4f22dd8bf9aa06133bfe" name="a87af14fc672b4f22dd8bf9aa06133bfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87af14fc672b4f22dd8bf9aa06133bfe">&#9670;&#160;</a></span>ConfigureDirtyLoggingInitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDirtyLoggingInitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing dirty logging mechanism </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   95</span>{</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_function" href="_dirty_logging_8c.html#a585fdbe53a7e659f5e2e01c6d6d492e8">DirtyLoggingInitialize</a>();</div>
<div class="line"><span class="lineno">   97</span>}</div>
<div class="ttc" id="a_dirty_logging_8c_html_a585fdbe53a7e659f5e2e01c6d6d492e8"><div class="ttname"><a href="_dirty_logging_8c.html#a585fdbe53a7e659f5e2e01c6d6d492e8">DirtyLoggingInitialize</a></div><div class="ttdeci">BOOLEAN DirtyLoggingInitialize()</div><div class="ttdoc">Initialize the dirty logging mechanism.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:21</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a4d4056b23b71fe99f68da92ec7a4ea" name="a5a4d4056b23b71fe99f68da92ec7a4ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a4d4056b23b71fe99f68da92ec7a4ea">&#9670;&#160;</a></span>ConfigureDirtyLoggingUninitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDirtyLoggingUninitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for uninitializing dirty logging mechanism </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_function" href="_dirty_logging_8c.html#aaf90fc3d8b6829ba9a11d32c02987020">DirtyLoggingUninitialize</a>();</div>
<div class="line"><span class="lineno">  108</span>}</div>
<div class="ttc" id="a_dirty_logging_8c_html_aaf90fc3d8b6829ba9a11d32c02987020"><div class="ttname"><a href="_dirty_logging_8c.html#aaf90fc3d8b6829ba9a11d32c02987020">DirtyLoggingUninitialize</a></div><div class="ttdeci">VOID DirtyLoggingUninitialize()</div><div class="ttdoc">Initialize the dirty logging mechanism.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:182</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c34667ae652718d0b8a15a84e6ccc7f" name="a9c34667ae652718d0b8a15a84e6ccc7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c34667ae652718d0b8a15a84e6ccc7f">&#9670;&#160;</a></span>ConfigureDisableEferSyscallEventsOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDisableEferSyscallEventsOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for disabling syscall hooks on all cores </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  144</span>{</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_function" href="_broadcast_8c.html#af9be4a566740f2a21d9d173dfc5b9768">BroadcastDisableEferSyscallEventsOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">  146</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_af9be4a566740f2a21d9d173dfc5b9768"><div class="ttname"><a href="_broadcast_8c.html#af9be4a566740f2a21d9d173dfc5b9768">BroadcastDisableEferSyscallEventsOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastDisableEferSyscallEventsOnAllProcessors()</div><div class="ttdoc">routines for disabling syscall hooks on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:513</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5c7fc6c4f8d88ccb2fe6308242bf56b" name="aa5c7fc6c4f8d88ccb2fe6308242bf56b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c7fc6c4f8d88ccb2fe6308242bf56b">&#9670;&#160;</a></span>ConfigureDisableMovToCr3ExitingOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureDisableMovToCr3ExitingOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for debugging threads (disable mov-to-cr3 exiting) </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  117</span>{</div>
<div class="line"><span class="lineno">  118</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  119</span>    <span class="comment">// Indicate that the future #PFs should or should not be checked with user debugger</span></div>
<div class="line"><span class="lineno">  120</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_variable" href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_function" href="_broadcast_8c.html#afbdc3a135b42022a6041d1c69c1b18f3">BroadcastDisableMovToCr3ExitingOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">  124</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_broadcast_8c_html_afbdc3a135b42022a6041d1c69c1b18f3"><div class="ttname"><a href="_broadcast_8c.html#afbdc3a135b42022a6041d1c69c1b18f3">BroadcastDisableMovToCr3ExitingOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastDisableMovToCr3ExitingOnAllProcessors()</div><div class="ttdoc">routines for debugging threads (disable mov-to-cr3 exiting)</div><div class="ttdef"><b>Definition</b> Broadcast.c:491</div></div>
<div class="ttc" id="a_global_variables_8h_html_a2945717b38be3209d407eb31dc9d5f4b"><div class="ttname"><a href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a></div><div class="ttdeci">BOOLEAN g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</div><div class="ttdoc">Whether the page-fault and cr3 vm-exits in vmx-root should check the #PFs or the PML4....</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:114</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adfe8ffc9a78f0f643eb7acc8034e4d6c" name="adfe8ffc9a78f0f643eb7acc8034e4d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfe8ffc9a78f0f643eb7acc8034e4d6c">&#9670;&#160;</a></span>ConfigureEnableEferSyscallEventsOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableEferSyscallEventsOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for enabling syscall hooks on all cores </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  133</span>{</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_function" href="_broadcast_8c.html#a2b511aee80072559f2f867c8216fcc54">BroadcastEnableEferSyscallEventsOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">  135</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_a2b511aee80072559f2f867c8216fcc54"><div class="ttname"><a href="_broadcast_8c.html#a2b511aee80072559f2f867c8216fcc54">BroadcastEnableEferSyscallEventsOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastEnableEferSyscallEventsOnAllProcessors()</div><div class="ttdoc">routines for enabling syscall hooks on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:502</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae420ed37e0594e55d9b5842fc06ef7b7" name="ae420ed37e0594e55d9b5842fc06ef7b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae420ed37e0594e55d9b5842fc06ef7b7">&#9670;&#160;</a></span>ConfigureEnableEferSyscallHookOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableEferSyscallHookOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for enabling EFER syscall hooks on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  427</span>{</div>
<div class="line"><span class="lineno">  428</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a3aecac4c6c92d962339067855d42795a">DpcRoutinePerformEnableEferSyscallHookOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  429</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a3aecac4c6c92d962339067855d42795a"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a3aecac4c6c92d962339067855d42795a">DpcRoutinePerformEnableEferSyscallHookOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableEferSyscallHookOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Enable syscall hook EFER on a single core.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:390</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37c7a84afe5fc98e8bd9dff575bc4591" name="a37c7a84afe5fc98e8bd9dff575bc4591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37c7a84afe5fc98e8bd9dff575bc4591">&#9670;&#160;</a></span>ConfigureEnableMovToControlRegisterExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToControlRegisterExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#aec65406a861ee0f07b61245e0ae32a00">DEBUGGER_EVENT_OPTIONS</a> *</td>          <td class="paramname"><span class="paramname"><em>BroadcastingOption</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable mov 2 control register on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">BroadcastingOption</td><td>The optional broadcasting fields</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  527</span>{</div>
<div class="line"><span class="lineno">  528</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a74fb9eac323256ebbd4d9231cecf265e">DpcRoutinePerformEnableMovToControlRegisterExiting</a>, &amp;BroadcastingOption);</div>
<div class="line"><span class="lineno">  529</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a74fb9eac323256ebbd4d9231cecf265e"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a74fb9eac323256ebbd4d9231cecf265e">DpcRoutinePerformEnableMovToControlRegisterExiting</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableMovToControlRegisterExiting(KDPC *Dpc, DEBUGGER_EVENT_OPTIONS *EventOptions, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Set the Mov to Control Registers Exitings.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:333</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3a6af0209221a2a25ae9201fc60f1cf" name="ab3a6af0209221a2a25ae9201fc60f1cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3a6af0209221a2a25ae9201fc60f1cf">&#9670;&#160;</a></span>ConfigureEnableMovToCr3ExitingOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToCr3ExitingOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for debugging threads (enable mov-to-cr3 exiting) </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{</div>
<div class="line"><span class="lineno">   23</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="comment">// Indicate that the future #PFs should or should not be checked with user debugger</span></div>
<div class="line"><span class="lineno">   25</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   26</span>    <a class="code hl_variable" href="_global_variables_8h.html#a2945717b38be3209d407eb31dc9d5f4b">g_CheckPageFaultsAndMov2Cr3VmexitsWithUserDebugger</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>    <a class="code hl_function" href="_broadcast_8c.html#ad399387aeaaae4be8180107318d1ed62">BroadcastEnableMovToCr3ExitingOnAllProcessors</a>();</div>
<div class="line"><span class="lineno">   29</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_broadcast_8c_html_ad399387aeaaae4be8180107318d1ed62"><div class="ttname"><a href="_broadcast_8c.html#ad399387aeaaae4be8180107318d1ed62">BroadcastEnableMovToCr3ExitingOnAllProcessors</a></div><div class="ttdeci">VOID BroadcastEnableMovToCr3ExitingOnAllProcessors()</div><div class="ttdoc">routines for debugging threads (enable mov-to-cr3 exiting)</div><div class="ttdef"><b>Definition</b> Broadcast.c:436</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a528c7a4faebda601e8f256629cd8c324" name="a528c7a4faebda601e8f256629cd8c324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a528c7a4faebda601e8f256629cd8c324">&#9670;&#160;</a></span>ConfigureEnableMovToDebugRegistersExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableMovToDebugRegistersExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable mov 2 debug register exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  499</span>{</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#aef7db7dd1e1f564dd5db438db232c4ef">DpcRoutinePerformEnableMovToDebugRegistersExiting</a>, NULL);</div>
<div class="line"><span class="lineno">  501</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_aef7db7dd1e1f564dd5db438db232c4ef"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#aef7db7dd1e1f564dd5db438db232c4ef">DpcRoutinePerformEnableMovToDebugRegistersExiting</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableMovToDebugRegistersExiting(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Set the Mov to Debug Registers Exitings.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:304</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40d05c72969eddee7308d4fd44522c34" name="a40d05c72969eddee7308d4fd44522c34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d05c72969eddee7308d4fd44522c34">&#9670;&#160;</a></span>ConfigureEnableRdpmcExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableRdpmcExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable RDPMC exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  486</span>{</div>
<div class="line"><span class="lineno">  487</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a6fe8d23e3fd81eecba6f28a50f454222">DpcRoutinePerformEnableRdpmcExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  488</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a6fe8d23e3fd81eecba6f28a50f454222"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a6fe8d23e3fd81eecba6f28a50f454222">DpcRoutinePerformEnableRdpmcExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableRdpmcExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">set rdpmc exiting</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:246</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a736c9678fb16d3340e7b963ce779d85e" name="a736c9678fb16d3340e7b963ce779d85e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a736c9678fb16d3340e7b963ce779d85e">&#9670;&#160;</a></span>ConfigureEnableRdtscExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEnableRdtscExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enable RDTSC exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  473</span>{</div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a508772fcbdb9d34fd81501639eb996e1">DpcRoutinePerformEnableRdtscExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  475</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a508772fcbdb9d34fd81501639eb996e1"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a508772fcbdb9d34fd81501639eb996e1">DpcRoutinePerformEnableRdtscExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformEnableRdtscExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">set rdtsc/rdtscp exiting</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:217</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa62d4e17a65f5e1024f37e3c2bf0b38" name="aaa62d4e17a65f5e1024f37e3c2bf0b38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa62d4e17a65f5e1024f37e3c2bf0b38">&#9670;&#160;</a></span>ConfigureEptHook()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHook </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>TargetAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function invokes a VMCALL to set the hook and broadcast the exiting for the breakpoints on exception bitmap. </p>
<p>this command uses hidden breakpoints (0xcc) to hook, THIS FUNCTION SHOULD BE CALLED WHEN THE VMLAUNCH ALREADY EXECUTED, it is because, broadcasting to enable exception bitmap for breakpoint is not clear here, if we want to broadcast to enable exception bitmaps on all cores when vmlaunch is not executed then that's ok but a user might call this function when we didn't configure the vmcs, it's a problem! we can solve it by giving a hint to vmcs configure function to make it ok for future configuration but that sounds stupid, I think it's better to not support this feature. Btw, debugger won't use this function in the above mentioned method, so we won't have any problem with this :)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id to translate based on that process's cr3 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  262</span>{</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#abcbdb9cd3dbdf238b8b5d484522855e3">EptHook</a>(TargetAddress, ProcessId);</div>
<div class="line"><span class="lineno">  264</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_abcbdb9cd3dbdf238b8b5d484522855e3"><div class="ttname"><a href="_ept_hook_8c.html#abcbdb9cd3dbdf238b8b5d484522855e3">EptHook</a></div><div class="ttdeci">BOOLEAN EptHook(PVOID TargetAddress, UINT32 ProcessId)</div><div class="ttdoc">This function invokes a VMCALL to set the hook and broadcast the exiting for the breakpoints on excep...</div><div class="ttdef"><b>Definition</b> EptHook.c:605</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a67644a4cbc1a7a2d4c6382588357f585" name="a67644a4cbc1a7a2d4c6382588357f585"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67644a4cbc1a7a2d4c6382588357f585">&#9670;&#160;</a></span>ConfigureEptHook2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHook2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>TargetAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>HookFunction</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook (inline) </p>
<p>this command uses hidden detours, this NOT be called from vmx-root mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>ID of the target core </td></tr>
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked </td></tr>
    <tr><td class="paramname">HookFunction</td><td>The function that will be called when hook triggered </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id to translate based on that process's cr3</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  299</span>{</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a2935a49abe92cf51319ef81e20f8ac14">EptHookInlineHook</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId],</div>
<div class="line"><span class="lineno">  301</span>                             TargetAddress,</div>
<div class="line"><span class="lineno">  302</span>                             HookFunction,</div>
<div class="line"><span class="lineno">  303</span>                             ProcessId);</div>
<div class="line"><span class="lineno">  304</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a2935a49abe92cf51319ef81e20f8ac14"><div class="ttname"><a href="_ept_hook_8c.html#a2935a49abe92cf51319ef81e20f8ac14">EptHookInlineHook</a></div><div class="ttdeci">BOOLEAN EptHookInlineHook(VIRTUAL_MACHINE_STATE *VCpu, PVOID TargetAddress, PVOID HookFunction, UINT32 ProcessId)</div><div class="ttdoc">This function applies EPT hook 2 (inline) to the target EPT table.</div><div class="ttdef"><b>Definition</b> EptHook.c:1542</div></div>
<div class="ttc" id="a_global_variables_8h_html_a04bac1f4beef0dcf1ce1a4d9ce72ea76"><div class="ttname"><a href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a></div><div class="ttdeci">VIRTUAL_MACHINE_STATE * g_GuestState</div><div class="ttdoc">Save the state and variables related to virtualization on each to logical core.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:38</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac9e8b90baa0b31ae1606aaaa607295d3" name="ac9e8b90baa0b31ae1606aaaa607295d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e8b90baa0b31ae1606aaaa607295d3">&#9670;&#160;</a></span>ConfigureEptHook2FromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHook2FromVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>TargetAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>HookFunction</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook (inline EPT hook) </p>
<p>this command uses hidden detours, this should be called from vmx-root mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>ID of the target core </td></tr>
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked </td></tr>
    <tr><td class="paramname">HookFunction</td><td>The function that will be called when hook triggered</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  341</span>{</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a5b9714c9baeabde116049cd66622a00a">EptHookInlineHookFromVmxRoot</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId],</div>
<div class="line"><span class="lineno">  343</span>                                        TargetAddress,</div>
<div class="line"><span class="lineno">  344</span>                                        HookFunction);</div>
<div class="line"><span class="lineno">  345</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a5b9714c9baeabde116049cd66622a00a"><div class="ttname"><a href="_ept_hook_8c.html#a5b9714c9baeabde116049cd66622a00a">EptHookInlineHookFromVmxRoot</a></div><div class="ttdeci">BOOLEAN EptHookInlineHookFromVmxRoot(VIRTUAL_MACHINE_STATE *VCpu, PVOID TargetAddress, PVOID HookFunction)</div><div class="ttdoc">This function applies EPT inline to the target EPT table.</div><div class="ttdef"><b>Definition</b> EptHook.c:1613</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adc1de369fee20f1c13ce5da2c0fa5741" name="adc1de369fee20f1c13ce5da2c0fa5741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc1de369fee20f1c13ce5da2c0fa5741">&#9670;&#160;</a></span>ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Count</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate (reserve) extra pages for storing details of page hooks for memory monitor and regular hidden breakpoit exec EPT hooks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Count</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  228</span>{</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_function" href="_ept_hook_8c.html#abb1bb8e5caaed9c63ffcfad80a2d0ebd">EptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a>(Count);</div>
<div class="line"><span class="lineno">  230</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_abb1bb8e5caaed9c63ffcfad80a2d0ebd"><div class="ttname"><a href="_ept_hook_8c.html#abb1bb8e5caaed9c63ffcfad80a2d0ebd">EptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks</a></div><div class="ttdeci">VOID EptHookAllocateExtraHookingPagesForMemoryMonitorsAndExecEptHooks(UINT32 Count)</div><div class="ttdoc">Allocate (reserve) extra pages for storing details of page hooks for memory monitor and regular hidde...</div><div class="ttdef"><b>Definition</b> EptHook.c:110</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62f7ef4d19e12ebb556aacc7336a258b" name="a62f7ef4d19e12ebb556aacc7336a258b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62f7ef4d19e12ebb556aacc7336a258b">&#9670;&#160;</a></span>ConfigureEptHookFromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookFromVmxRoot </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>TargetAddress</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function invokes a direct VMCALL to setup the hook. </p>
<p>the caller of this function should make sure to 1) broadcast to all cores to intercept breakpoints (#BPs) and after calling this function 2) the caller should broadcast to all cores to invalidate their EPTPs</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetAddress</td><td>The address of function or memory address to be hooked</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  279</span>{</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a1d3773a49e29eaf03835b7a064817646">EptHookFromVmxRoot</a>(TargetAddress);</div>
<div class="line"><span class="lineno">  281</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a1d3773a49e29eaf03835b7a064817646"><div class="ttname"><a href="_ept_hook_8c.html#a1d3773a49e29eaf03835b7a064817646">EptHookFromVmxRoot</a></div><div class="ttdeci">BOOLEAN EptHookFromVmxRoot(PVOID TargetAddress)</div><div class="ttdoc">This function invokes a direct VMCALL to setup the hook.</div><div class="ttdef"><b>Definition</b> EptHook.c:631</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aae487c6cde6eab0c8b5c934900e02f77" name="aae487c6cde6eab0c8b5c934900e02f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae487c6cde6eab0c8b5c934900e02f77">&#9670;&#160;</a></span>ConfigureEptHookModifyInstructionFetchState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyInstructionFetchState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>PhysicalAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsUnset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for execution (execute) @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>Current Core ID </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  378</span>{</div>
<div class="line"><span class="lineno">  379</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a54499f05708f5cf69df924d7cf92ba89">EptHookModifyInstructionFetchState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  380</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a54499f05708f5cf69df924d7cf92ba89"><div class="ttname"><a href="_ept_hook_8c.html#a54499f05708f5cf69df924d7cf92ba89">EptHookModifyInstructionFetchState</a></div><div class="ttdeci">BOOLEAN EptHookModifyInstructionFetchState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for execution (execute) @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:2566</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3273428c5505c7af8a08a2319c8e688" name="af3273428c5505c7af8a08a2319c8e688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3273428c5505c7af8a08a2319c8e688">&#9670;&#160;</a></span>ConfigureEptHookModifyPageReadState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyPageReadState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>PhysicalAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsUnset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for read @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  396</span>{</div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a1dc01f084128845b23788d6f384df6ab">EptHookModifyPageReadState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  398</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a1dc01f084128845b23788d6f384df6ab"><div class="ttname"><a href="_ept_hook_8c.html#a1dc01f084128845b23788d6f384df6ab">EptHookModifyPageReadState</a></div><div class="ttdeci">BOOLEAN EptHookModifyPageReadState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for read @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:2624</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a701db01cdd2fb70134e209fe80d23236" name="a701db01cdd2fb70134e209fe80d23236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a701db01cdd2fb70134e209fe80d23236">&#9670;&#160;</a></span>ConfigureEptHookModifyPageWriteState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookModifyPageWriteState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>PhysicalAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsUnset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Change PML EPT state for write @detail should be called from VMX-root. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">PhysicalAddress</td><td>Target physical address </td></tr>
    <tr><td class="paramname">IsUnset</td><td>Is unsetting bit or setting bit</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  414</span>{</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a04587a27698f5cc43cd9c2c13a6736c5">EptHookModifyPageWriteState</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], PhysicalAddress, IsUnset);</div>
<div class="line"><span class="lineno">  416</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a04587a27698f5cc43cd9c2c13a6736c5"><div class="ttname"><a href="_ept_hook_8c.html#a04587a27698f5cc43cd9c2c13a6736c5">EptHookModifyPageWriteState</a></div><div class="ttdeci">BOOLEAN EptHookModifyPageWriteState(VIRTUAL_MACHINE_STATE *VCpu, PVOID PhysicalAddress, BOOLEAN IsUnset)</div><div class="ttdoc">Change PML EPT state for write @detail should be called from VMX-root.</div><div class="ttdef"><b>Definition</b> EptHook.c:2682</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ade4069f3b063b90661ebd402a98202a4" name="ade4069f3b063b90661ebd402a98202a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade4069f3b063b90661ebd402a98202a4">&#9670;&#160;</a></span>ConfigureEptHookMonitor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookMonitor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad14bc163543c2acede2c878c50aeca14">EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR</a> *</td>          <td class="paramname"><span class="paramname"><em>HookingDetails</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook. </p>
<p>this command uses hidden detours, this NOT be called from vmx-root mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>ID of the target core </td></tr>
    <tr><td class="paramname">HookingDetails</td><td>Monitor hooking detail </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id to translate based on that process's cr3</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  321</span>{</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#acc6e339c3d8b2700e46862591cd5458b">EptHookMonitorHook</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId],</div>
<div class="line"><span class="lineno">  323</span>                              HookingDetails,</div>
<div class="line"><span class="lineno">  324</span>                              ProcessId);</div>
<div class="line"><span class="lineno">  325</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_acc6e339c3d8b2700e46862591cd5458b"><div class="ttname"><a href="_ept_hook_8c.html#acc6e339c3d8b2700e46862591cd5458b">EptHookMonitorHook</a></div><div class="ttdeci">BOOLEAN EptHookMonitorHook(VIRTUAL_MACHINE_STATE *VCpu, EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR *HookingDetails, UINT32 ProcessId)</div><div class="ttdoc">This function applies monitor hooks to the target EPT table.</div><div class="ttdef"><b>Definition</b> EptHook.c:1582</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a924bb7e1c684b4a3c9f4f25bd2909420" name="a924bb7e1c684b4a3c9f4f25bd2909420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a924bb7e1c684b4a3c9f4f25bd2909420">&#9670;&#160;</a></span>ConfigureEptHookMonitorFromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookMonitorFromVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>CoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#ad14bc163543c2acede2c878c50aeca14">EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR</a> *</td>          <td class="paramname"><span class="paramname"><em>MemoryAddressDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates a buffer in VMX Non Root Mode and then invokes a VMCALL to set the hook. </p>
<p>this command uses hidden detours, this should be called from vmx-root mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">CoreId</td><td>ID of the target core </td></tr>
    <tr><td class="paramname">MemoryAddressDetails</td><td>Monitor hooking details</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the hook was successful or false if there was an error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  360</span>{</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a308b3a4a443a479190f2f09599eae906">EptHookMonitorFromVmxRoot</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CoreId], MemoryAddressDetails);</div>
<div class="line"><span class="lineno">  362</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a308b3a4a443a479190f2f09599eae906"><div class="ttname"><a href="_ept_hook_8c.html#a308b3a4a443a479190f2f09599eae906">EptHookMonitorFromVmxRoot</a></div><div class="ttdeci">BOOLEAN EptHookMonitorFromVmxRoot(VIRTUAL_MACHINE_STATE *VCpu, EPT_HOOKS_ADDRESS_DETAILS_FOR_MEMORY_MONITOR *MemoryAddressDetails)</div><div class="ttdoc">This function applies EPT monitor hooks to the target EPT table.</div><div class="ttdef"><b>Definition</b> EptHook.c:1651</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af51d98af8c16c62303308f6f3ba91d1f" name="af51d98af8c16c62303308f6f3ba91d1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af51d98af8c16c62303308f6f3ba91d1f">&#9670;&#160;</a></span>ConfigureEptHookReservePreallocatedPoolsForEptHooks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureEptHookReservePreallocatedPoolsForEptHooks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>Count</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate (reserve) pages for storing EPT hooks page hooks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Count</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  240</span>{</div>
<div class="line"><span class="lineno">  241</span>    <a class="code hl_function" href="_ept_hook_8c.html#a5bc373b3d6bea35f4e06a221bec6a90b">EptHookReservePreallocatedPoolsForEptHooks</a>(Count);</div>
<div class="line"><span class="lineno">  242</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a5bc373b3d6bea35f4e06a221bec6a90b"><div class="ttname"><a href="_ept_hook_8c.html#a5bc373b3d6bea35f4e06a221bec6a90b">EptHookReservePreallocatedPoolsForEptHooks</a></div><div class="ttdeci">VOID EptHookReservePreallocatedPoolsForEptHooks(UINT32 Count)</div><div class="ttdoc">Reserve pre-allocated pools for EPT hooks.</div><div class="ttdef"><b>Definition</b> EptHook.c:70</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a254f9f215ff46e11941c1e1dcb770ca5" name="a254f9f215ff46e11941c1e1dcb770ca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a254f9f215ff46e11941c1e1dcb770ca5">&#9670;&#160;</a></span>ConfigureEptHookUnHookAllByHookingTag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookUnHookAllByHookingTag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>HookingTag</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove all hooks from the hooked pages list using Hooking Tag. </p>
<p>Should be called from vmx non-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">HookingTag</td><td>The hooking tag to remove all hooks</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN If unhook was successful it returns true or if it was not successful returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  158</span>{</div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a5304ad90d3cc4ecdc64a7c4868877435">EptHookUnHookAllByHookingTag</a>(HookingTag);</div>
<div class="line"><span class="lineno">  160</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a5304ad90d3cc4ecdc64a7c4868877435"><div class="ttname"><a href="_ept_hook_8c.html#a5304ad90d3cc4ecdc64a7c4868877435">EptHookUnHookAllByHookingTag</a></div><div class="ttdeci">BOOLEAN EptHookUnHookAllByHookingTag(UINT64 HookingTag)</div><div class="ttdoc">Remove all hooks from the hooked pages by the given hooking tag.</div><div class="ttdef"><b>Definition</b> EptHook.c:2296</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6129e5f85312a405e0509e2c45351bf" name="ad6129e5f85312a405e0509e2c45351bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6129e5f85312a405e0509e2c45351bf">&#9670;&#160;</a></span>ConfigureEptHookUnHookSingleAddress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookUnHookSingleAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>VirtualAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>PhysAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove single hook from the hooked pages list and invalidate TLB. </p>
<p>Should be called from vmx non-root</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VirtualAddress</td><td>Virtual address to unhook </td></tr>
    <tr><td class="paramname">PhysAddress</td><td>Physical address to unhook (optional) </td></tr>
    <tr><td class="paramname">ProcessId</td><td>The process id of target process</td></tr>
  </table>
  </dd>
</dl>
<p>in unhooking for some hooks only physical address is availables</p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN If unhook was successful it returns true or if it was not successful returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  191</span>{</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a24ce2115ab4514ec8eed08d0911b64d6">EptHookUnHookSingleAddress</a>(VirtualAddress, PhysAddress, ProcessId);</div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a24ce2115ab4514ec8eed08d0911b64d6"><div class="ttname"><a href="_ept_hook_8c.html#a24ce2115ab4514ec8eed08d0911b64d6">EptHookUnHookSingleAddress</a></div><div class="ttdeci">BOOLEAN EptHookUnHookSingleAddress(UINT64 VirtualAddress, UINT64 PhysAddress, UINT32 ProcessId)</div><div class="ttdoc">Remove single hook from the hooked pages list and invalidate TLB.</div><div class="ttdef"><b>Definition</b> EptHook.c:2370</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3d7477b90e15cb7d2d2bf6f297a143b" name="ac3d7477b90e15cb7d2d2bf6f297a143b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3d7477b90e15cb7d2d2bf6f297a143b">&#9670;&#160;</a></span>ConfigureEptHookUnHookSingleAddressFromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookUnHookSingleAddressFromVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>VirtualAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>PhysAddress</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#a27c1e2d2980e51cf66a1c72b3f08ba13">EPT_SINGLE_HOOK_UNHOOKING_DETAILS</a> *</td>          <td class="paramname"><span class="paramname"><em>TargetUnhookingDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove single hook from the hooked pages list and invalidate TLB. </p>
<p>Should be called from vmx root-mode and it's the responsibility of caller to broadcast to all cores to remove the target physical address and invalidate EPT and modify exception bitmap (#BPs) if needed</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VirtualAddress</td><td>Virtual address to unhook </td></tr>
    <tr><td class="paramname">PhysAddress</td><td>Physical address to unhook (optional) </td></tr>
    <tr><td class="paramname">TargetUnhookingDetails</td><td>Target data for the caller to restore EPT entry and invalidate EPT caches. Only when applied in VMX-root mode directly</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN If unhook was successful it returns true or if it was not successful returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  212</span>{</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#a80ec91bc8431e536aa32d2e182444f17">EptHookUnHookSingleAddressFromVmxRoot</a>(VirtualAddress,</div>
<div class="line"><span class="lineno">  214</span>                                                 PhysAddress,</div>
<div class="line"><span class="lineno">  215</span>                                                 TargetUnhookingDetails);</div>
<div class="line"><span class="lineno">  216</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_a80ec91bc8431e536aa32d2e182444f17"><div class="ttname"><a href="_ept_hook_8c.html#a80ec91bc8431e536aa32d2e182444f17">EptHookUnHookSingleAddressFromVmxRoot</a></div><div class="ttdeci">BOOLEAN EptHookUnHookSingleAddressFromVmxRoot(UINT64 VirtualAddress, UINT64 PhysAddress, EPT_SINGLE_HOOK_UNHOOKING_DETAILS *TargetUnhookingDetails)</div><div class="ttdoc">Remove single hook from the hooked pages list and invalidate TLB.</div><div class="ttdef"><b>Definition</b> EptHook.c:2404</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b0b0313ad16cd496dc2402b9741e587" name="a3b0b0313ad16cd496dc2402b9741e587"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b0b0313ad16cd496dc2402b9741e587">&#9670;&#160;</a></span>ConfigureEptHookUnHookSingleHookByHookingTagFromVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureEptHookUnHookSingleHookByHookingTagFromVmxRoot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>HookingTag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#a27c1e2d2980e51cf66a1c72b3f08ba13">EPT_SINGLE_HOOK_UNHOOKING_DETAILS</a> *</td>          <td class="paramname"><span class="paramname"><em>TargetUnhookingDetails</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove single hook from the hooked pages by the given hooking tag. </p>
<p>Should be called from Vmx root-mode</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">HookingTag</td><td>The hooking tag to unhook </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN If unhook was successful it returns true or if it was not successful returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  172</span>{</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_ept_hook_8c.html#af811dff7684ead032bf5439bfab2b928">EptHookUnHookSingleHookByHookingTagFromVmxRoot</a>(HookingTag, TargetUnhookingDetails);</div>
<div class="line"><span class="lineno">  174</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_af811dff7684ead032bf5439bfab2b928"><div class="ttname"><a href="_ept_hook_8c.html#af811dff7684ead032bf5439bfab2b928">EptHookUnHookSingleHookByHookingTagFromVmxRoot</a></div><div class="ttdeci">BOOLEAN EptHookUnHookSingleHookByHookingTagFromVmxRoot(UINT64 HookingTag, EPT_SINGLE_HOOK_UNHOOKING_DETAILS *TargetUnhookingDetails)</div><div class="ttdoc">Remove single hook from the hooked pages by the given hooking tag.</div><div class="ttdef"><b>Definition</b> EptHook.c:2339</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ba9a32992d91af37190d377c727e7f6" name="a0ba9a32992d91af37190d377c727e7f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ba9a32992d91af37190d377c727e7f6">&#9670;&#160;</a></span>ConfigureExecTrapAddProcessToWatchingList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureExecTrapAddProcessToWatchingList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the target process to the watching list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   61</span>{</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_exec_trap_8c.html#ae57b218aacbb56f7e91df45486f3ef47">ExecTrapAddProcessToWatchingList</a>(ProcessId);</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="a_exec_trap_8c_html_ae57b218aacbb56f7e91df45486f3ef47"><div class="ttname"><a href="_exec_trap_8c.html#ae57b218aacbb56f7e91df45486f3ef47">ExecTrapAddProcessToWatchingList</a></div><div class="ttdeci">BOOLEAN ExecTrapAddProcessToWatchingList(UINT32 ProcessId)</div><div class="ttdoc">Add the target process to the watching list.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:894</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af1efec5051f2996a76d234bc01ac41bf" name="af1efec5051f2996a76d234bc01ac41bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1efec5051f2996a76d234bc01ac41bf">&#9670;&#160;</a></span>ConfigureExecTrapRemoveProcessFromWatchingList()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureExecTrapRemoveProcessFromWatchingList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>ProcessId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the target process from the watching list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ProcessId</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   73</span>{</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_exec_trap_8c.html#aa7ef8278f2f66d2ff1c9b28c85ecae16">ExecTrapRemoveProcessFromWatchingList</a>(ProcessId);</div>
<div class="line"><span class="lineno">   75</span>}</div>
<div class="ttc" id="a_exec_trap_8c_html_aa7ef8278f2f66d2ff1c9b28c85ecae16"><div class="ttname"><a href="_exec_trap_8c.html#aa7ef8278f2f66d2ff1c9b28c85ecae16">ExecTrapRemoveProcessFromWatchingList</a></div><div class="ttdeci">BOOLEAN ExecTrapRemoveProcessFromWatchingList(UINT32 ProcessId)</div><div class="ttdoc">Remove the target process from the watching list.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:909</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b26f0e861226a28347668799ce3f45e" name="a1b26f0e861226a28347668799ce3f45e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b26f0e861226a28347668799ce3f45e">&#9670;&#160;</a></span>ConfigureInitializeExecTrapOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ConfigureInitializeExecTrapOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing user-mode, kernel-mode exec trap </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="_exec_trap_8c.html#add9956ac777904d17c0263f2bea40d4d">ExecTrapInitialize</a>();</div>
<div class="line"><span class="lineno">   40</span>}</div>
<div class="ttc" id="a_exec_trap_8c_html_add9956ac777904d17c0263f2bea40d4d"><div class="ttname"><a href="_exec_trap_8c.html#add9956ac777904d17c0263f2bea40d4d">ExecTrapInitialize</a></div><div class="ttdeci">BOOLEAN ExecTrapInitialize()</div><div class="ttdoc">Initialize the reversing machine based on service request.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:497</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e72ac48176ecf52fe48443a9903593" name="ac0e72ac48176ecf52fe48443a9903593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e72ac48176ecf52fe48443a9903593">&#9670;&#160;</a></span>ConfigureModeBasedExecHookUninitializeOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureModeBasedExecHookUninitializeOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for initializing Mode-based execution hooks </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   84</span>{</div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_function" href="_mode_based_exec_hook_8c.html#a17a8e377b4679423f8c80f9dab0f113a">ModeBasedExecHookUninitialize</a>();</div>
<div class="line"><span class="lineno">   86</span>}</div>
<div class="ttc" id="a_mode_based_exec_hook_8c_html_a17a8e377b4679423f8c80f9dab0f113a"><div class="ttname"><a href="_mode_based_exec_hook_8c.html#a17a8e377b4679423f8c80f9dab0f113a">ModeBasedExecHookUninitialize</a></div><div class="ttdeci">VOID ModeBasedExecHookUninitialize()</div><div class="ttdoc">Uinitialize the needed structure for hooking mode execution.</div><div class="ttdef"><b>Definition</b> ModeBasedExecHook.c:247</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a34a96b88916b2d0614736d7915afaa38" name="a34a96b88916b2d0614736d7915afaa38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a96b88916b2d0614736d7915afaa38">&#9670;&#160;</a></span>ConfigureSetEferSyscallOrSysretHookType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureSetEferSyscallOrSysretHookType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="include_2_s_d_k_2_headers_2_events_8h.html#ad59706f68fe9056c1b7f4c7ee5b809ab">DEBUGGER_EVENT_SYSCALL_SYSRET_TYPE</a></td>          <td class="paramname"><span class="paramname"><em>SyscallHookType</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for setting EFER syscall or sysret hooks type </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SyscallHookType</td><td>Type of hook</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  440</span>{</div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06">DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</a>)</div>
<div class="line"><span class="lineno">  442</span>    {</div>
<div class="line"><span class="lineno">  443</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  444</span>    }</div>
<div class="line"><span class="lineno">  445</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (SyscallHookType == <a class="code hl_enumvalue" href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4">DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</a>)</div>
<div class="line"><span class="lineno">  446</span>    {</div>
<div class="line"><span class="lineno">  447</span>        <a class="code hl_variable" href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  448</span>    }</div>
<div class="line"><span class="lineno">  449</span>}</div>
<div class="ttc" id="a_global_variables_8h_html_a79454511c45c422bb27a2d4429b65a53"><div class="ttname"><a href="_global_variables_8h.html#a79454511c45c422bb27a2d4429b65a53">g_IsUnsafeSyscallOrSysretHandling</a></div><div class="ttdeci">BOOLEAN g_IsUnsafeSyscallOrSysretHandling</div><div class="ttdoc">Shows whether the debuggee is waiting for an trap step or not.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:101</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61ac2c2eb597f451618da795d66856123f4">DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</a></div><div class="ttdeci">@ DEBUGGER_EVENT_SYSCALL_SYSRET_SAFE_ACCESS_MEMORY</div><div class="ttdef"><b>Definition</b> Events.h:192</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a603add14bd7b96e83bdd990c53449b61af4d0ab42e46b060da271e41fe24fbc06">DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</a></div><div class="ttdeci">@ DEBUGGER_EVENT_SYSCALL_SYSRET_HANDLE_ALL_UD</div><div class="ttdef"><b>Definition</b> Events.h:193</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1440df6523c738461133801841828def" name="a1440df6523c738461133801841828def"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1440df6523c738461133801841828def">&#9670;&#160;</a></span>ConfigureSetExceptionBitmapOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureSetExceptionBitmapOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>BitMask</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set exception bitmap on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core) </td></tr>
    <tr><td class="paramname">BitMask</td><td>The bit mask of exception bitmap</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  513</span>{</div>
<div class="line"><span class="lineno">  514</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#ae81da9f18268df6f043f0f715099bdce">DpcRoutinePerformSetExceptionBitmapOnSingleCore</a>, (PVOID)BitMask);</div>
<div class="line"><span class="lineno">  515</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_ae81da9f18268df6f043f0f715099bdce"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#ae81da9f18268df6f043f0f715099bdce">DpcRoutinePerformSetExceptionBitmapOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformSetExceptionBitmapOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">change exception bitmap on a single core</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:275</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8cefdf192b6214caca28a2d3472dabe" name="aa8cefdf192b6214caca28a2d3472dabe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8cefdf192b6214caca28a2d3472dabe">&#9670;&#160;</a></span>ConfigureSetExternalInterruptExitingOnSingleCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureSetExternalInterruptExitingOnSingleCore </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>TargetCoreId</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set external interrupt exiting on a single core </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TargetCoreId</td><td>The target core's ID (to just run on this core)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  460</span>{</div>
<div class="line"><span class="lineno">  461</span>    <a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a860d1d5fbe8605d03eda7327935c799e">DpcRoutineRunTaskOnSingleCore</a>(TargetCoreId, (PVOID)<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#acb4f0c4f4fc5c02f54f30cff5f4c8192">DpcRoutinePerformSetExternalInterruptExitingOnSingleCore</a>, NULL);</div>
<div class="line"><span class="lineno">  462</span>}</div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_acb4f0c4f4fc5c02f54f30cff5f4c8192"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#acb4f0c4f4fc5c02f54f30cff5f4c8192">DpcRoutinePerformSetExternalInterruptExitingOnSingleCore</a></div><div class="ttdeci">VOID DpcRoutinePerformSetExternalInterruptExitingOnSingleCore(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">Enable external interrupt exiting on a single core.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:361</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43c62c45378725295f24cbcc094c15b6" name="a43c62c45378725295f24cbcc094c15b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43c62c45378725295f24cbcc094c15b6">&#9670;&#160;</a></span>ConfigureUninitializeExecTrapOnAllProcessors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ConfigureUninitializeExecTrapOnAllProcessors </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>routines for uninitializing user-mode, kernel-mode exec trap </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   49</span>{</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_function" href="_exec_trap_8c.html#af6305fef8652aa0c6b3035abe039078d">ExecTrapUninitialize</a>();</div>
<div class="line"><span class="lineno">   51</span>}</div>
<div class="ttc" id="a_exec_trap_8c_html_af6305fef8652aa0c6b3035abe039078d"><div class="ttname"><a href="_exec_trap_8c.html#af6305fef8652aa0c6b3035abe039078d">ExecTrapUninitialize</a></div><div class="ttdeci">VOID ExecTrapUninitialize()</div><div class="ttdoc">Uinitialize the needed structure for the reversing machine.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:605</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_e536aab728f7b0abbbf7dc8fdcfcc81b.html">hyperhv</a></li><li class="navelem"><a class="el" href="dir_1ae2c003efa9a319fe8e6b483281e084.html">code</a></li><li class="navelem"><a class="el" href="dir_ad3459180219538b2125a8cc559818a6.html">interface</a></li><li class="navelem"><a class="el" href="_configuration_8c.html">Configuration.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
