<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperhv/code/vmm/vmx/Vmcall.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_vmcall_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Vmcall.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The main VMCALL and Hypercall handler.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb2db351906635747d5d3ea68af9b639" id="r_abb2db351906635747d5d3ea68af9b639"><td class="memItemLeft" align="right" valign="top">_Use_decl_annotations_ NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abb2db351906635747d5d3ea68af9b639">VmxHypervVmcallHandler</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a> GuestRegs)</td></tr>
<tr class="memdesc:abb2db351906635747d5d3ea68af9b639"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle vm-exits of VMCALLs.  <br /></td></tr>
<tr class="separator:abb2db351906635747d5d3ea68af9b639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed944cbbb3374497800e8babbdeef2c" id="r_a1ed944cbbb3374497800e8babbdeef2c"><td class="memItemLeft" align="right" valign="top">_Use_decl_annotations_ NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ed944cbbb3374497800e8babbdeef2c">VmxHandleVmcallVmExit</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a1ed944cbbb3374497800e8babbdeef2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle vm-exits of VMCALLs.  <br /></td></tr>
<tr class="separator:a1ed944cbbb3374497800e8babbdeef2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c15cc199604be3bab9e2f8c08b9a15" id="r_a25c15cc199604be3bab9e2f8c08b9a15"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a25c15cc199604be3bab9e2f8c08b9a15">VmxVmcallDirectVmcallHandler</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VmcallNumber, <a class="el" href="_data_types_8h.html#a383e83b385245a30831fd6369c7353b6">DIRECT_VMCALL_PARAMETERS</a> *DirectVmcallOptions)</td></tr>
<tr class="memdesc:a25c15cc199604be3bab9e2f8c08b9a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Direct Vmcall Handler.  <br /></td></tr>
<tr class="separator:a25c15cc199604be3bab9e2f8c08b9a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ae450a3b4c62812dcb42e8cb54cdd2" id="r_a85ae450a3b4c62812dcb42e8cb54cdd2"><td class="memItemLeft" align="right" valign="top">_Use_decl_annotations_ NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85ae450a3b4c62812dcb42e8cb54cdd2">VmxVmcallHandler</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VmcallNumber, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam1, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam2, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> OptionalParam3)</td></tr>
<tr class="memdesc:a85ae450a3b4c62812dcb42e8cb54cdd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main Vmcall Handler.  <br /></td></tr>
<tr class="separator:a85ae450a3b4c62812dcb42e8cb54cdd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33cfb4436bd44e0edfc347cd877103df" id="r_a33cfb4436bd44e0edfc347cd877103df"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33cfb4436bd44e0edfc347cd877103df">VmcallTest</a> (_In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Param1, _In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Param2, _In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> Param3)</td></tr>
<tr class="memdesc:a33cfb4436bd44e0edfc347cd877103df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test Vmcall (VMCALL_TEST)  <br /></td></tr>
<tr class="separator:a33cfb4436bd44e0edfc347cd877103df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The main VMCALL and Hypercall handler. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-04-11</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a33cfb4436bd44e0edfc347cd877103df" name="a33cfb4436bd44e0edfc347cd877103df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33cfb4436bd44e0edfc347cd877103df">&#9670;&#160;</a></span>VmcallTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS VmcallTest </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Param1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Param2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>Param3</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test Vmcall (VMCALL_TEST) </p>
<p>Test function which shows a message to test a successful VMCALL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Param1</td><td></td></tr>
    <tr><td class="paramname">Param2</td><td></td></tr>
    <tr><td class="paramname">Param3</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  484</span>{</div>
<div class="line"><span class="lineno">  485</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;VmcallTest called with @Param1 = 0x%llx , @Param2 = 0x%llx , @Param3 = 0x%llx&quot;</span>,</div>
<div class="line"><span class="lineno">  486</span>                 Param1,</div>
<div class="line"><span class="lineno">  487</span>                 Param2,</div>
<div class="line"><span class="lineno">  488</span>                 Param3);</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">// Send one byte buffer to show that Hypervisor</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">// is successfully loaded</span></div>
<div class="line"><span class="lineno">  493</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  494</span>    <a class="code hl_function" href="_callback_8c.html#aba6bd0c693cac7a80bd56987ee22574a">LogCallbackSendBuffer</a>(<a class="code hl_define" href="_constants_8h.html#a9f661f43a2301721d3ce5d0956095a86">OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</a>,</div>
<div class="line"><span class="lineno">  495</span>                          <span class="stringliteral">&quot;$&quot;</span>,</div>
<div class="line"><span class="lineno">  496</span>                          <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>),</div>
<div class="line"><span class="lineno">  497</span>                          <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  500</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aebb9e13210d88d43e32e735ada43a425"><div class="ttname"><a href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a></div><div class="ttdeci">char CHAR</div><div class="ttdef"><b>Definition</b> BasicTypes.h:31</div></div>
<div class="ttc" id="a_callback_8c_html_aba6bd0c693cac7a80bd56987ee22574a"><div class="ttname"><a href="_callback_8c.html#aba6bd0c693cac7a80bd56987ee22574a">LogCallbackSendBuffer</a></div><div class="ttdeci">BOOLEAN LogCallbackSendBuffer(_In_ UINT32 OperationCode, _In_reads_bytes_(BufferLength) PVOID Buffer, _In_ UINT32 BufferLength, _In_ BOOLEAN Priority)</div><div class="ttdoc">routines callback for sending buffer</div><div class="ttdef"><b>Definition</b> Callback.c:123</div></div>
<div class="ttc" id="a_constants_8h_html_a9f661f43a2301721d3ce5d0956095a86"><div class="ttname"><a href="_constants_8h.html#a9f661f43a2301721d3ce5d0956095a86">OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</a></div><div class="ttdeci">#define OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</div><div class="ttdef"><b>Definition</b> Constants.h:380</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a108126279e46f4d46d25abe24da43fdc"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a></div><div class="ttdeci">#define LogDebugInfo(format,...)</div><div class="ttdoc">Log, initialize boot information and debug information.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:155</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ed944cbbb3374497800e8babbdeef2c" name="a1ed944cbbb3374497800e8babbdeef2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ed944cbbb3374497800e8babbdeef2c">&#9670;&#160;</a></span>VmxHandleVmcallVmExit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Use_decl_annotations_ NTSTATUS VmxHandleVmcallVmExit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle vm-exits of VMCALLs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   75</span>{</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>      IsHyperDbgVmcall = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_struct" href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a> * GuestRegs        = VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>;</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    IsHyperDbgVmcall = (GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a8c9ee2201d6334cdd8386785d242dc2c">r10</a> == 0x48564653 &amp;&amp; GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#ae60171ce8fbc006bf50e1238df2705e2">r11</a> == 0x564d43414c4c &amp;&amp; GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a3d6ecd2e50ac54f06231fdf1c721ecc4">r12</a> == 0x4e4f485950455256);</div>
<div class="line"><span class="lineno">   80</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   81</span>    <span class="comment">// Check if it&#39;s our routines that request the VMCALL, or it relates to the Hyper-V</span></div>
<div class="line"><span class="lineno">   82</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">if</span> (IsHyperDbgVmcall)</div>
<div class="line"><span class="lineno">   84</span>    {</div>
<div class="line"><span class="lineno">   85</span>        GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a> = <a class="code hl_function" href="#a85ae450a3b4c62812dcb42e8cb54cdd2">VmxVmcallHandler</a>(VCpu,</div>
<div class="line"><span class="lineno">   86</span>                                          GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a>,</div>
<div class="line"><span class="lineno">   87</span>                                          GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#aec9eaf1f15df1582b6f00119516a8e08">rdx</a>,</div>
<div class="line"><span class="lineno">   88</span>                                          GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a69d2cf3302625883a5c7e067328c1714">r8</a>,</div>
<div class="line"><span class="lineno">   89</span>                                          GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a52c8a777462e3d62c533b319475d1b66">r9</a>);</div>
<div class="line"><span class="lineno">   90</span>    }</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   92</span>    {</div>
<div class="line"><span class="lineno">   93</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="#abb2db351906635747d5d3ea68af9b639">VmxHypervVmcallHandler</a>(VCpu, GuestRegs);</div>
<div class="line"><span class="lineno">   94</span>    }</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">   97</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition</b> BasicTypes.h:39</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_vmcall_8c_html_a85ae450a3b4c62812dcb42e8cb54cdd2"><div class="ttname"><a href="#a85ae450a3b4c62812dcb42e8cb54cdd2">VmxVmcallHandler</a></div><div class="ttdeci">_Use_decl_annotations_ NTSTATUS VmxVmcallHandler(VIRTUAL_MACHINE_STATE *VCpu, UINT64 VmcallNumber, UINT64 OptionalParam1, UINT64 OptionalParam2, UINT64 OptionalParam3)</div><div class="ttdoc">Main Vmcall Handler.</div><div class="ttdef"><b>Definition</b> Vmcall.c:132</div></div>
<div class="ttc" id="a_vmcall_8c_html_abb2db351906635747d5d3ea68af9b639"><div class="ttname"><a href="#abb2db351906635747d5d3ea68af9b639">VmxHypervVmcallHandler</a></div><div class="ttdeci">_Use_decl_annotations_ NTSTATUS VmxHypervVmcallHandler(VIRTUAL_MACHINE_STATE *VCpu, PGUEST_REGS GuestRegs)</div><div class="ttdoc">Handle vm-exits of VMCALLs.</div><div class="ttdef"><b>Definition</b> Vmcall.c:24</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aae00ab92fdce5f90e65edb3bd10ae696"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">_VIRTUAL_MACHINE_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition</b> State.h:305</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html">GUEST_REGS</a></div><div class="ttdef"><b>Definition</b> BasicTypes.h:70</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a346ed6ae20503154a9a8031491706b3e"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">GUEST_REGS::rax</a></div><div class="ttdeci">UINT64 rax</div><div class="ttdef"><b>Definition</b> BasicTypes.h:75</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a3d6ecd2e50ac54f06231fdf1c721ecc4"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a3d6ecd2e50ac54f06231fdf1c721ecc4">GUEST_REGS::r12</a></div><div class="ttdeci">UINT64 r12</div><div class="ttdef"><b>Definition</b> BasicTypes.h:87</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a52c8a777462e3d62c533b319475d1b66"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a52c8a777462e3d62c533b319475d1b66">GUEST_REGS::r9</a></div><div class="ttdeci">UINT64 r9</div><div class="ttdef"><b>Definition</b> BasicTypes.h:84</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a69d2cf3302625883a5c7e067328c1714"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a69d2cf3302625883a5c7e067328c1714">GUEST_REGS::r8</a></div><div class="ttdeci">UINT64 r8</div><div class="ttdef"><b>Definition</b> BasicTypes.h:83</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a8c9ee2201d6334cdd8386785d242dc2c"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a8c9ee2201d6334cdd8386785d242dc2c">GUEST_REGS::r10</a></div><div class="ttdeci">UINT64 r10</div><div class="ttdef"><b>Definition</b> BasicTypes.h:85</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a9a9133a328f13d405c31df928307e9fd"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">GUEST_REGS::rcx</a></div><div class="ttdeci">UINT64 rcx</div><div class="ttdef"><b>Definition</b> BasicTypes.h:76</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_ae60171ce8fbc006bf50e1238df2705e2"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#ae60171ce8fbc006bf50e1238df2705e2">GUEST_REGS::r11</a></div><div class="ttdeci">UINT64 r11</div><div class="ttdef"><b>Definition</b> BasicTypes.h:86</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_aec9eaf1f15df1582b6f00119516a8e08"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#aec9eaf1f15df1582b6f00119516a8e08">GUEST_REGS::rdx</a></div><div class="ttdeci">UINT64 rdx</div><div class="ttdef"><b>Definition</b> BasicTypes.h:77</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb2db351906635747d5d3ea68af9b639" name="abb2db351906635747d5d3ea68af9b639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2db351906635747d5d3ea68af9b639">&#9670;&#160;</a></span>VmxHypervVmcallHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Use_decl_annotations_ NTSTATUS VmxHypervVmcallHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a2bd4673df5e6e2fb371d770f3f2886d9">PGUEST_REGS</a></td>          <td class="paramname"><span class="paramname"><em>GuestRegs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle vm-exits of VMCALLs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">GuestRegs</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   25</span>{</div>
<div class="line"><span class="lineno">   26</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                GuestRsp   = <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>;</div>
<div class="line"><span class="lineno">   27</span>    <a class="code hl_union" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">HYPERCALL_INPUT_VALUE</a> InputValue = {.<a class="code hl_variable" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#ac12e9fbaade150adcb08a42a6c1ba0b7">Flags</a> = GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a>};</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordflow">switch</span> (InputValue.<a class="code hl_variable" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#aa1a02ca1af482c8ff51855f4707dee7a">Fields</a>.<a class="code hl_variable" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#a5f045db6ab6a6ef3239992dab8103568">CallCode</a>)</div>
<div class="line"><span class="lineno">   30</span>    {</div>
<div class="line"><span class="lineno">   31</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634">HvSwitchVirtualAddressSpace</a>:</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea">HvFlushVirtualAddressSpace</a>:</div>
<div class="line"><span class="lineno">   33</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e">HvFlushVirtualAddressList</a>:</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a">HvCallFlushVirtualAddressSpaceEx</a>:</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870">HvCallFlushVirtualAddressListEx</a>:</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>        <a class="code hl_function" href="_vpid_8c.html#ab4309ec8728f358679e7cd16a9d8b579">VpidInvvpidAllContext</a>();</div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de">HvCallFlushGuestPhysicalAddressSpace</a>:</div>
<div class="line"><span class="lineno">   41</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289">HvCallFlushGuestPhysicalAddressList</a>:</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>        <a class="code hl_function" href="_invept_8c.html#a7c73091dea8c657cef945340f4bd2808">EptInveptSingleContext</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a4c5c6fd61c83853d21e270e87cdea179">EptPointer</a>.AsUInt);</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   45</span>    }</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   48</span>    <span class="comment">// Save the guest rsp as it will be modified during the Hyper-V&#39;s</span></div>
<div class="line"><span class="lineno">   49</span>    <span class="comment">// VMCALL process</span></div>
<div class="line"><span class="lineno">   50</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   51</span>    GuestRsp = GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a04918d3fe8010c01a6bd3f1ba4e11bc2">rsp</a>;</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">// Let the top-level hypervisor to manage it</span></div>
<div class="line"><span class="lineno">   55</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_function" href="_inline_asm_8h.html#aa8723c83da95e9100e486e69700cfbf8">AsmHypervVmcall</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)GuestRegs);</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">// Restore the guest&#39;s RSP</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   61</span>    GuestRegs-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a04918d3fe8010c01a6bd3f1ba4e11bc2">rsp</a> = GuestRsp;</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">   64</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a8a9df53f35cb95dddbe3c564259e01ad"><div class="ttname"><a href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a></div><div class="ttdeci">#define NULL64_ZERO</div><div class="ttdef"><b>Definition</b> BasicTypes.h:52</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
<div class="ttc" id="a_inline_asm_8h_html_aa8723c83da95e9100e486e69700cfbf8"><div class="ttname"><a href="_inline_asm_8h.html#aa8723c83da95e9100e486e69700cfbf8">AsmHypervVmcall</a></div><div class="ttdeci">void AsmHypervVmcall(unsigned long long GuestRegisters)</div><div class="ttdoc">Hyper-v vmcall handler.</div></div>
<div class="ttc" id="a_invept_8c_html_a7c73091dea8c657cef945340f4bd2808"><div class="ttname"><a href="_invept_8c.html#a7c73091dea8c657cef945340f4bd2808">EptInveptSingleContext</a></div><div class="ttdeci">UCHAR EptInveptSingleContext(_In_ UINT64 EptPointer)</div><div class="ttdoc">Invalidates a single context in ept cache table.</div><div class="ttdef"><b>Definition</b> Invept.c:40</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634">HvSwitchVirtualAddressSpace</a></div><div class="ttdeci">@ HvSwitchVirtualAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:173</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870">HvCallFlushVirtualAddressListEx</a></div><div class="ttdeci">@ HvCallFlushVirtualAddressListEx</div><div class="ttdef"><b>Definition</b> Vmx.h:189</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e">HvFlushVirtualAddressList</a></div><div class="ttdeci">@ HvFlushVirtualAddressList</div><div class="ttdef"><b>Definition</b> Vmx.h:175</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea">HvFlushVirtualAddressSpace</a></div><div class="ttdeci">@ HvFlushVirtualAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:174</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a">HvCallFlushVirtualAddressSpaceEx</a></div><div class="ttdeci">@ HvCallFlushVirtualAddressSpaceEx</div><div class="ttdef"><b>Definition</b> Vmx.h:188</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289">HvCallFlushGuestPhysicalAddressList</a></div><div class="ttdeci">@ HvCallFlushGuestPhysicalAddressList</div><div class="ttdef"><b>Definition</b> Vmx.h:280</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de"><div class="ttname"><a href="_vmx_8h.html#a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de">HvCallFlushGuestPhysicalAddressSpace</a></div><div class="ttdeci">@ HvCallFlushGuestPhysicalAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:279</div></div>
<div class="ttc" id="a_vpid_8c_html_ab4309ec8728f358679e7cd16a9d8b579"><div class="ttname"><a href="_vpid_8c.html#ab4309ec8728f358679e7cd16a9d8b579">VpidInvvpidAllContext</a></div><div class="ttdeci">VOID VpidInvvpidAllContext()</div><div class="ttdoc">INVVPID All Contexts.</div><div class="ttdef"><b>Definition</b> Vpid.c:74</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a4c5c6fd61c83853d21e270e87cdea179"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a4c5c6fd61c83853d21e270e87cdea179">_VIRTUAL_MACHINE_STATE::EptPointer</a></div><div class="ttdeci">EPT_POINTER EptPointer</div><div class="ttdef"><b>Definition</b> State.h:341</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a04918d3fe8010c01a6bd3f1ba4e11bc2"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a04918d3fe8010c01a6bd3f1ba4e11bc2">GUEST_REGS::rsp</a></div><div class="ttdeci">UINT64 rsp</div><div class="ttdef"><b>Definition</b> BasicTypes.h:79</div></div>
<div class="ttc" id="aunion___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e_html"><div class="ttname"><a href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a></div><div class="ttdoc">Hypercalls for Hyper-V.</div><div class="ttdef"><b>Definition</b> Vmx.h:150</div></div>
<div class="ttc" id="aunion___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e_html_a5f045db6ab6a6ef3239992dab8103568"><div class="ttname"><a href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#a5f045db6ab6a6ef3239992dab8103568">_HYPERCALL_INPUT_VALUE::CallCode</a></div><div class="ttdeci">UINT64 CallCode</div><div class="ttdef"><b>Definition</b> Vmx.h:154</div></div>
<div class="ttc" id="aunion___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e_html_aa1a02ca1af482c8ff51855f4707dee7a"><div class="ttname"><a href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#aa1a02ca1af482c8ff51855f4707dee7a">_HYPERCALL_INPUT_VALUE::Fields</a></div><div class="ttdeci">struct _HYPERCALL_INPUT_VALUE::@48 Fields</div></div>
<div class="ttc" id="aunion___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e_html_ac12e9fbaade150adcb08a42a6c1ba0b7"><div class="ttname"><a href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#ac12e9fbaade150adcb08a42a6c1ba0b7">_HYPERCALL_INPUT_VALUE::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition</b> Vmx.h:151</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a25c15cc199604be3bab9e2f8c08b9a15" name="a25c15cc199604be3bab9e2f8c08b9a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25c15cc199604be3bab9e2f8c08b9a15">&#9670;&#160;</a></span>VmxVmcallDirectVmcallHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS VmxVmcallDirectVmcallHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>VmcallNumber</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_data_types_8h.html#a383e83b385245a30831fd6369c7353b6">DIRECT_VMCALL_PARAMETERS</a> *</td>          <td class="paramname"><span class="paramname"><em>DirectVmcallOptions</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Direct Vmcall Handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">VmcallNumber</td><td>The number of the VMCALL </td></tr>
    <tr><td class="paramname">DirectVmcallOptions</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  112</span>{</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a85ae450a3b4c62812dcb42e8cb54cdd2">VmxVmcallHandler</a>(VCpu,</div>
<div class="line"><span class="lineno">  114</span>                            VmcallNumber,</div>
<div class="line"><span class="lineno">  115</span>                            DirectVmcallOptions-&gt;<a class="code hl_variable" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#afa70a893c4cfe5cb7db3e8647ddc032e">OptionalParam1</a>,</div>
<div class="line"><span class="lineno">  116</span>                            DirectVmcallOptions-&gt;<a class="code hl_variable" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#a39944d056bfb507eee85169f70d88ef8">OptionalParam2</a>,</div>
<div class="line"><span class="lineno">  117</span>                            DirectVmcallOptions-&gt;<a class="code hl_variable" href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#a96645e12e6930efdcb96156de9ef9a74">OptionalParam3</a>);</div>
<div class="line"><span class="lineno">  118</span>}</div>
<div class="ttc" id="astruct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s_html_a39944d056bfb507eee85169f70d88ef8"><div class="ttname"><a href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#a39944d056bfb507eee85169f70d88ef8">_DIRECT_VMCALL_PARAMETERS::OptionalParam2</a></div><div class="ttdeci">UINT64 OptionalParam2</div><div class="ttdef"><b>Definition</b> DataTypes.h:296</div></div>
<div class="ttc" id="astruct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s_html_a96645e12e6930efdcb96156de9ef9a74"><div class="ttname"><a href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#a96645e12e6930efdcb96156de9ef9a74">_DIRECT_VMCALL_PARAMETERS::OptionalParam3</a></div><div class="ttdeci">UINT64 OptionalParam3</div><div class="ttdef"><b>Definition</b> DataTypes.h:297</div></div>
<div class="ttc" id="astruct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s_html_afa70a893c4cfe5cb7db3e8647ddc032e"><div class="ttname"><a href="struct___d_i_r_e_c_t___v_m_c_a_l_l___p_a_r_a_m_e_t_e_r_s.html#afa70a893c4cfe5cb7db3e8647ddc032e">_DIRECT_VMCALL_PARAMETERS::OptionalParam1</a></div><div class="ttdeci">UINT64 OptionalParam1</div><div class="ttdef"><b>Definition</b> DataTypes.h:295</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a85ae450a3b4c62812dcb42e8cb54cdd2" name="a85ae450a3b4c62812dcb42e8cb54cdd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ae450a3b4c62812dcb42e8cb54cdd2">&#9670;&#160;</a></span>VmxVmcallHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">_Use_decl_annotations_ NTSTATUS VmxVmcallHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>VmcallNumber</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>OptionalParam3</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main Vmcall Handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state </td></tr>
    <tr><td class="paramname">VmcallNumber</td><td></td></tr>
    <tr><td class="paramname">OptionalParam1</td><td></td></tr>
    <tr><td class="paramname">OptionalParam2</td><td></td></tr>
    <tr><td class="paramname">OptionalParam3</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>NTSTATUS </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  137</span>{</div>
<div class="line"><span class="lineno">  138</span>    NTSTATUS VmcallStatus = <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  141</span>    <span class="comment">// Check for top-level driver&#39;s VMCALLs</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">if</span> (VmcallNumber &gt; <a class="code hl_define" href="_constants_8h.html#afc31005953fd893f042528c9b0bf81e7">TOP_LEVEL_DRIVERS_VMCALL_STARTING_NUMBER</a> &amp;&amp; VmcallNumber &lt;= <a class="code hl_define" href="_constants_8h.html#a9d406fd011f106e2d6c00a427eb4b913">TOP_LEVEL_DRIVERS_VMCALL_ENDING_NUMBER</a>)</div>
<div class="line"><span class="lineno">  144</span>    {</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="_callback_8c.html#ae1efe5ee85ef9928e98de253b2f42baa">VmmCallbackVmcallHandler</a>(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">CoreId</a>, VmcallNumber, OptionalParam1, OptionalParam2, OptionalParam3))</div>
<div class="line"><span class="lineno">  146</span>        {</div>
<div class="line"><span class="lineno">  147</span>            <span class="keywordflow">return</span> STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  148</span>        }</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  150</span>        {</div>
<div class="line"><span class="lineno">  151</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  152</span>        }</div>
<div class="line"><span class="lineno">  153</span>    }</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  156</span>    <span class="comment">// Only 32bit of Vmcall is valid, this way we can use the upper 32 bit of the Vmcall</span></div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="keywordflow">switch</span> (VmcallNumber)</div>
<div class="line"><span class="lineno">  159</span>    {</div>
<div class="line"><span class="lineno">  160</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a7b45a0cbafe7472996868357b52f1265">VMCALL_TEST</a>:</div>
<div class="line"><span class="lineno">  161</span>    {</div>
<div class="line"><span class="lineno">  162</span>        VmcallStatus = <a class="code hl_function" href="#a33cfb4436bd44e0edfc347cd877103df">VmcallTest</a>(OptionalParam1, OptionalParam2, OptionalParam3);</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a589357d083b5353f74c07972e1448924">VMCALL_VMXOFF</a>:</div>
<div class="line"><span class="lineno">  166</span>    {</div>
<div class="line"><span class="lineno">  167</span>        <a class="code hl_function" href="_vmx_8c.html#ad9193ed1677033cd08c5d5b7788b15c7">VmxVmxoff</a>(VCpu);</div>
<div class="line"><span class="lineno">  168</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  171</span>    }</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a2f893b27a9a2cedec9f4c499011dce0a">VMCALL_CHANGE_PAGE_ATTRIB</a>:</div>
<div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span>        <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  HookResult = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  175</span>        <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> ProcCr3    = {.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = OptionalParam3};</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        HookResult = <a class="code hl_function" href="_ept_hook_8c.html#aadbcf1945213c68375c8871dbecc3971">EptHookPerformPageHookMonitorAndInlineHook</a>(VCpu,</div>
<div class="line"><span class="lineno">  178</span>                                                                (PVOID)OptionalParam1 <span class="comment">/* hook details */</span>,</div>
<div class="line"><span class="lineno">  179</span>                                                                ProcCr3 <span class="comment">/* Process cr3 */</span>,</div>
<div class="line"><span class="lineno">  180</span>                                                                (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam2 <span class="comment">/* PageHookMask */</span>);</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>        VmcallStatus = (HookResult == <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) ? STATUS_SUCCESS : <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a45441c9962f57151b6e7ac243bdb396f">VMCALL_INVEPT_SINGLE_CONTEXT</a>:</div>
<div class="line"><span class="lineno">  187</span>    {</div>
<div class="line"><span class="lineno">  188</span>        <a class="code hl_function" href="_invept_8c.html#a7c73091dea8c657cef945340f4bd2808">EptInveptSingleContext</a>(OptionalParam1);</div>
<div class="line"><span class="lineno">  189</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  190</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  191</span>    }</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a19cc3e737fde0dbb0b6bcaa07f323550">VMCALL_INVEPT_ALL_CONTEXTS</a>:</div>
<div class="line"><span class="lineno">  193</span>    {</div>
<div class="line"><span class="lineno">  194</span>        <a class="code hl_function" href="_invept_8c.html#a1f3a0ce01874877f718413e6e19ce956">EptInveptAllContexts</a>();</div>
<div class="line"><span class="lineno">  195</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  197</span>    }</div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a97a25939f7d07934b25028b877965889">VMCALL_UNHOOK_ALL_PAGES</a>:</div>
<div class="line"><span class="lineno">  199</span>    {</div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_function" href="_ept_hook_8c.html#a0b2a50efc209dfa3aedcd756c7128607">EptHookRestoreAllHooksToOriginalEntry</a>(VCpu);</div>
<div class="line"><span class="lineno">  201</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  202</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  203</span>    }</div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ae88058c24e03982fb3b9b268eceb9c39">VMCALL_UNHOOK_SINGLE_PAGE</a>:</div>
<div class="line"><span class="lineno">  205</span>    {</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="_ept_hook_8c.html#a03c810703f75ca09341a4d70e02293c3">EptHookRestoreSingleHookToOriginalEntry</a>(VCpu, OptionalParam1, OptionalParam2))</div>
<div class="line"><span class="lineno">  207</span>            VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  209</span>            VmcallStatus = <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  212</span>    }</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#abbb3d99ced0391c88b695b06603b31dd">VMCALL_ENABLE_SYSCALL_HOOK_EFER</a>:</div>
<div class="line"><span class="lineno">  214</span>    {</div>
<div class="line"><span class="lineno">  215</span>        <a class="code hl_function" href="_efer_hook_8c.html#a018ba30cbafd5ebc786414637eb7b8f3">SyscallHookConfigureEFER</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  216</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  218</span>    }</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#acb8a7542446710304e8de981abb62528">VMCALL_DISABLE_SYSCALL_HOOK_EFER</a>:</div>
<div class="line"><span class="lineno">  220</span>    {</div>
<div class="line"><span class="lineno">  221</span>        <a class="code hl_function" href="_efer_hook_8c.html#a018ba30cbafd5ebc786414637eb7b8f3">SyscallHookConfigureEFER</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  222</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  223</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  224</span>    }</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#affdc952605558fc2311612448745464f">VMCALL_CHANGE_MSR_BITMAP_READ</a>:</div>
<div class="line"><span class="lineno">  226</span>    {</div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_function" href="_msr_handlers_8c.html#a8ea9efcef215456094dece3d242b612c">MsrHandlePerformMsrBitmapReadChange</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  228</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  230</span>    }</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a5d3db56f2450003c021cbeb98f11ae89">VMCALL_CHANGE_MSR_BITMAP_WRITE</a>:</div>
<div class="line"><span class="lineno">  232</span>    {</div>
<div class="line"><span class="lineno">  233</span>        <a class="code hl_function" href="_msr_handlers_8c.html#a74d6269ab230748466e8eb585032ced2">MsrHandlePerformMsrBitmapWriteChange</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  234</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  236</span>    }</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a84bc6a52b61013c70607768974cf38e3">VMCALL_SET_RDTSC_EXITING</a>:</div>
<div class="line"><span class="lineno">  238</span>    {</div>
<div class="line"><span class="lineno">  239</span>        <a class="code hl_function" href="_hv_8c.html#aaac0cbfd9d2c9a2d4c4263bf58051322">HvSetRdtscExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  240</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  242</span>    }</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a1e7f57f4bbbbb320e00e7d1533e15228">VMCALL_SET_RDPMC_EXITING</a>:</div>
<div class="line"><span class="lineno">  244</span>    {</div>
<div class="line"><span class="lineno">  245</span>        <a class="code hl_function" href="_hv_8c.html#a0d721b297a9930e02bfb88191a2e0b78">HvSetPmcVmexit</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  246</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  247</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  248</span>    }</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a95a7f87dabddcb74056419965555608d">VMCALL_SET_EXCEPTION_BITMAP</a>:</div>
<div class="line"><span class="lineno">  250</span>    {</div>
<div class="line"><span class="lineno">  251</span>        <a class="code hl_function" href="_hv_8c.html#ad9fc64fae8bbc000a6e8949e78547027">HvSetExceptionBitmap</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  252</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  254</span>    }</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ac61778ddf78383144987deb0e48cddf1">VMCALL_ENABLE_MOV_TO_DEBUG_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  256</span>    {</div>
<div class="line"><span class="lineno">  257</span>        <a class="code hl_function" href="_hv_8c.html#a372b26d4b4571db93597414725289f0c">HvSetMovDebugRegsExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  258</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  260</span>    }</div>
<div class="line"><span class="lineno">  261</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#acaa5481bef551455b84d24e6888a162a">VMCALL_ENABLE_EXTERNAL_INTERRUPT_EXITING</a>:</div>
<div class="line"><span class="lineno">  262</span>    {</div>
<div class="line"><span class="lineno">  263</span>        <a class="code hl_function" href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  264</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  265</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a8779c1a5dc3675bd60df12b85e9fc5a3">VMCALL_CHANGE_IO_BITMAP</a>:</div>
<div class="line"><span class="lineno">  268</span>    {</div>
<div class="line"><span class="lineno">  269</span>        <a class="code hl_function" href="_io_handler_8c.html#acba84b9a16038184a36622a0e69722c4">IoHandlePerformIoBitmapChange</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  270</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#aa23cf4e06f34a78d1efc1049c0c7c9a3">VMCALL_SET_HIDDEN_CC_BREAKPOINT</a>:</div>
<div class="line"><span class="lineno">  274</span>    {</div>
<div class="line"><span class="lineno">  275</span>        <a class="code hl_typedef" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>  HookResult = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  276</span>        <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> ProcCr3    = {.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = OptionalParam2};</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>        HookResult = <a class="code hl_function" href="_ept_hook_8c.html#a32f950fc6247cece400187114bac26ab">EptHookPerformPageHook</a>(VCpu,</div>
<div class="line"><span class="lineno">  279</span>                                            (PVOID)OptionalParam1, <span class="comment">/* TargetAddress */</span></div>
<div class="line"><span class="lineno">  280</span>                                            ProcCr3);              <span class="comment">/* process cr3 */</span></div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>        VmcallStatus = (HookResult == <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) ? STATUS_SUCCESS : <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  285</span>    }</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ae132a6e82064b05fd1b83d979becf8ae">VMCALL_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</a>:</div>
<div class="line"><span class="lineno">  287</span>    {</div>
<div class="line"><span class="lineno">  288</span>        <a class="code hl_function" href="_protected_hv_8c.html#acfa018e728fa09f93e9c6539983d34c9">ProtectedHvExternalInterruptExitingForDisablingInterruptCommands</a>(VCpu);</div>
<div class="line"><span class="lineno">  289</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  290</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  291</span>    }</div>
<div class="line"><span class="lineno">  292</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ac692eb720991db54bdc0930c114f5c1a">VMCALL_UNSET_RDTSC_EXITING</a>:</div>
<div class="line"><span class="lineno">  293</span>    {</div>
<div class="line"><span class="lineno">  294</span>        <a class="code hl_function" href="_hv_8c.html#aaac0cbfd9d2c9a2d4c4263bf58051322">HvSetRdtscExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  295</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  296</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  299</span>    }</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ac8d7501d6f143271e221bb79410c1c8e">VMCALL_UNSET_RDPMC_EXITING</a>:</div>
<div class="line"><span class="lineno">  301</span>    {</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_function" href="_hv_8c.html#a0d721b297a9930e02bfb88191a2e0b78">HvSetPmcVmexit</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  303</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  305</span>    }</div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a13c945f82e78bd3ec1f1b008c6e9fbde">VMCALL_DISABLE_MOV_TO_DEBUG_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  307</span>    {</div>
<div class="line"><span class="lineno">  308</span>        <a class="code hl_function" href="_hv_8c.html#a372b26d4b4571db93597414725289f0c">HvSetMovDebugRegsExiting</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  309</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  311</span>    }</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a449984f06abf0354c5972bd93ab7529a">VMCALL_RESET_MSR_BITMAP_READ</a>:</div>
<div class="line"><span class="lineno">  313</span>    {</div>
<div class="line"><span class="lineno">  314</span>        <a class="code hl_function" href="_msr_handlers_8c.html#ad08fe98ebb27cd63bf38bdd39774903b">MsrHandlePerformMsrBitmapReadReset</a>(VCpu);</div>
<div class="line"><span class="lineno">  315</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  316</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  317</span>    }</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a2b7d10892af0a5d9c6e3a52b1e39607b">VMCALL_RESET_MSR_BITMAP_WRITE</a>:</div>
<div class="line"><span class="lineno">  319</span>    {</div>
<div class="line"><span class="lineno">  320</span>        <a class="code hl_function" href="_msr_handlers_8c.html#a76fcb889d44411cc8f0090892b0c9592">MsrHandlePerformMsrBitmapWriteReset</a>(VCpu);</div>
<div class="line"><span class="lineno">  321</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  323</span>    }</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a38a75ce57ba1b289882445153d869180">VMCALL_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</a>:</div>
<div class="line"><span class="lineno">  325</span>    {</div>
<div class="line"><span class="lineno">  326</span>        <a class="code hl_function" href="_protected_hv_8c.html#a233dcc156894424ce522de64fab25c50">ProtectedHvResetExceptionBitmapToClearEvents</a>(VCpu);</div>
<div class="line"><span class="lineno">  327</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  329</span>    }</div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ae621273430ce3a493c7273f90ddd9f0f">VMCALL_RESET_IO_BITMAP</a>:</div>
<div class="line"><span class="lineno">  331</span>    {</div>
<div class="line"><span class="lineno">  332</span>        <a class="code hl_function" href="_io_handler_8c.html#a54b01254d943b0ad2dbf7d97cb705671">IoHandlePerformIoBitmapReset</a>(VCpu);</div>
<div class="line"><span class="lineno">  333</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  335</span>    }</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#adda7559b8d2c6fc39e913a3270c87ee6">VMCALL_ENABLE_MOV_TO_CONTROL_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  337</span>    {</div>
<div class="line"><span class="lineno">  338</span>        <a class="code hl_function" href="_hv_8c.html#aaa9e7c2c5105db2e85d896167df615f7">HvSetMovControlRegsExiting</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>, OptionalParam1, OptionalParam2);</div>
<div class="line"><span class="lineno">  339</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  340</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  341</span>    }</div>
<div class="line"><span class="lineno">  342</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a82ef48fcf230df2686944075151b7eb3">VMCALL_DISABLE_MOV_TO_CONTROL_REGS_EXITING</a>:</div>
<div class="line"><span class="lineno">  343</span>    {</div>
<div class="line"><span class="lineno">  344</span>        <a class="code hl_function" href="_hv_8c.html#aaa9e7c2c5105db2e85d896167df615f7">HvSetMovControlRegsExiting</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, OptionalParam1, OptionalParam2);</div>
<div class="line"><span class="lineno">  345</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  347</span>    }</div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a816614b9895fb357bc7eee01714a3806">VMCALL_ENABLE_MOV_TO_CR3_EXITING</a>:</div>
<div class="line"><span class="lineno">  349</span>    {</div>
<div class="line"><span class="lineno">  350</span>        <a class="code hl_function" href="_hv_8c.html#ac7fa8f843553c4aebe992e88c71bbb79">HvSetMovToCr3Vmexit</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  351</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  353</span>    }</div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#af5e421b53efd853799e3450565d6a16f">VMCALL_DISABLE_MOV_TO_CR3_EXITING</a>:</div>
<div class="line"><span class="lineno">  355</span>    {</div>
<div class="line"><span class="lineno">  356</span>        <a class="code hl_function" href="_hv_8c.html#ac7fa8f843553c4aebe992e88c71bbb79">HvSetMovToCr3Vmexit</a>(VCpu, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  357</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  359</span>    }</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a495cdfcf6ee1a5136c4f45e5fc8c2848">VMCALL_UNSET_EXCEPTION_BITMAP</a>:</div>
<div class="line"><span class="lineno">  361</span>    {</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_function" href="_hv_8c.html#a256ea8c6d02ec0645069b0df50683700">HvUnsetExceptionBitmap</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  363</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  365</span>    }</div>
<div class="line"><span class="lineno">  366</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a053f2981fbad868a5dd053a1df1bac20">VMCALL_SET_VM_ENTRY_LOAD_DEBUG_CONTROLS</a>:</div>
<div class="line"><span class="lineno">  367</span>    {</div>
<div class="line"><span class="lineno">  368</span>        <a class="code hl_function" href="_hv_8c.html#ac9aefb71e380eac56389960ac66cddc1">HvSetLoadDebugControls</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  369</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  370</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  371</span>    }</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a0a886d0b99e07a1f987b19b08a8713a2">VMCALL_UNSET_VM_ENTRY_LOAD_DEBUG_CONTROLS</a>:</div>
<div class="line"><span class="lineno">  373</span>    {</div>
<div class="line"><span class="lineno">  374</span>        <a class="code hl_function" href="_hv_8c.html#ac9aefb71e380eac56389960ac66cddc1">HvSetLoadDebugControls</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  375</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a2601ab46e40f83ee118167579d20228d">VMCALL_SET_VM_EXIT_SAVE_DEBUG_CONTROLS</a>:</div>
<div class="line"><span class="lineno">  379</span>    {</div>
<div class="line"><span class="lineno">  380</span>        <a class="code hl_function" href="_hv_8c.html#a437b35822e82e1192228e3f8e767a4ab">HvSetSaveDebugControls</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  381</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  383</span>    }</div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ac26259df2e2de916949e5228b1d8bb37">VMCALL_UNSET_VM_EXIT_SAVE_DEBUG_CONTROLS</a>:</div>
<div class="line"><span class="lineno">  385</span>    {</div>
<div class="line"><span class="lineno">  386</span>        <a class="code hl_function" href="_hv_8c.html#a437b35822e82e1192228e3f8e767a4ab">HvSetSaveDebugControls</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  387</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  388</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  389</span>    }</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a5512b08230236da375c1c1b1dc5a151d">VMCALL_SET_VM_EXIT_ON_NMIS</a>:</div>
<div class="line"><span class="lineno">  391</span>    {</div>
<div class="line"><span class="lineno">  392</span>        <a class="code hl_function" href="_hv_8c.html#a19458423f77db01c301caf54c301b24c">HvSetNmiExiting</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  393</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a8cc1375f7c22268460a5a026343e0443">VMCALL_UNSET_VM_EXIT_ON_NMIS</a>:</div>
<div class="line"><span class="lineno">  397</span>    {</div>
<div class="line"><span class="lineno">  398</span>        <a class="code hl_function" href="_hv_8c.html#a19458423f77db01c301caf54c301b24c">HvSetNmiExiting</a>(<a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  399</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  401</span>    }</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#ade9df4e3f1141974c97a539ef86773a7">VMCALL_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</a>:</div>
<div class="line"><span class="lineno">  403</span>    {</div>
<div class="line"><span class="lineno">  404</span>        <a class="code hl_function" href="_protected_hv_8c.html#a20725f9a6b9e6a01bcb7b8aab91a0fdc">ProtectedHvDisableRdtscExitingForDisablingTscCommands</a>(VCpu);</div>
<div class="line"><span class="lineno">  405</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  406</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  407</span>    }</div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#aeacaa8a476a8d6503dbdc38ceb76ad08">VMCALL_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</a>:</div>
<div class="line"><span class="lineno">  409</span>    {</div>
<div class="line"><span class="lineno">  410</span>        <a class="code hl_function" href="_protected_hv_8c.html#af4e0bd1fd26a9f505b3945e83a59163e">ProtectedHvDisableMovDebugRegsExitingForDisablingDrCommands</a>(VCpu);</div>
<div class="line"><span class="lineno">  411</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  413</span>    }</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#adcc0063dc632ac87771ff6ddb0f77888">VMCALL_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</a>:</div>
<div class="line"><span class="lineno">  415</span>    {</div>
<div class="line"><span class="lineno">  416</span>        <a class="code hl_function" href="_protected_hv_8c.html#aef7502e82b65841aa7d61907ba088c6d">ProtectedHvDisableMovControlRegsExitingForDisablingCrCommands</a>(VCpu, OptionalParam1, OptionalParam2);</div>
<div class="line"><span class="lineno">  417</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  418</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a699aaf657adf0f1a1f7156061dff374e">VMCALL_ENABLE_DIRTY_LOGGING_MECHANISM</a>:</div>
<div class="line"><span class="lineno">  421</span>    {</div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="_dirty_logging_8c.html#aefbc17df23cab83401c9c139905a031e">DirtyLoggingEnable</a>(VCpu))</div>
<div class="line"><span class="lineno">  423</span>        {</div>
<div class="line"><span class="lineno">  424</span>            VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  425</span>        }</div>
<div class="line"><span class="lineno">  426</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  427</span>        {</div>
<div class="line"><span class="lineno">  428</span>            VmcallStatus = <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  429</span>        }</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  432</span>    }</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#a2cb048ec03fa4ba521710982aafe593b">VMCALL_DISABLE_DIRTY_LOGGING_MECHANISM</a>:</div>
<div class="line"><span class="lineno">  434</span>    {</div>
<div class="line"><span class="lineno">  435</span>        <a class="code hl_function" href="_dirty_logging_8c.html#a390c4a8eb2b303b1abc997e837a2013a">DirtyLoggingDisable</a>(VCpu);</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  439</span>    }</div>
<div class="line"><span class="lineno">  440</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#adbb237e5c9c3352dbebe59f9bd1f6457">VMCALL_CHANGE_TO_MBEC_SUPPORTED_EPTP</a>:</div>
<div class="line"><span class="lineno">  441</span>    {</div>
<div class="line"><span class="lineno">  442</span>        <a class="code hl_function" href="_exec_trap_8c.html#aab11493ed60e326089cdeb660835bbbc">ExecTrapChangeToUserDisabledMbecEptp</a>(VCpu);</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  446</span>    }</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#aad3efe006994731884e3ded8171696db">VMCALL_RESTORE_TO_NORMAL_EPTP</a>:</div>
<div class="line"><span class="lineno">  448</span>    {</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_function" href="_exec_trap_8c.html#a22855316678446d7d33cda0836a1ee70">ExecTrapRestoreToNormalEptp</a>(VCpu);</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  452</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  453</span>    }</div>
<div class="line"><span class="lineno">  454</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="_vmcall_8h.html#aafe3a3005e59a1e74faf8417efe70ddd">VMCALL_DISABLE_OR_ENABLE_MBEC</a>:</div>
<div class="line"><span class="lineno">  455</span>    {</div>
<div class="line"><span class="lineno">  456</span>        <a class="code hl_function" href="_mode_based_exec_hook_8c.html#ad0a46e8a40650a0c0776ccef469c345e">ModeBasedExecHookEnableOrDisable</a>(VCpu, (<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)OptionalParam1);</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>        VmcallStatus = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  462</span>    {</div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unsupported VMCALL&quot;</span>);</div>
<div class="line"><span class="lineno">  464</span>        VmcallStatus = <a class="code hl_define" href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a>;</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  466</span>    }</div>
<div class="line"><span class="lineno">  467</span>    }</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">return</span> VmcallStatus;</div>
<div class="line"><span class="lineno">  470</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_callback_8c_html_ae1efe5ee85ef9928e98de253b2f42baa"><div class="ttname"><a href="_callback_8c.html#ae1efe5ee85ef9928e98de253b2f42baa">VmmCallbackVmcallHandler</a></div><div class="ttdeci">BOOLEAN VmmCallbackVmcallHandler(UINT32 CoreId, UINT64 VmcallNumber, UINT64 OptionalParam1, UINT64 OptionalParam2, UINT64 OptionalParam3)</div><div class="ttdoc">routine callback to handle external VMCALLs</div><div class="ttdef"><b>Definition</b> Callback.c:200</div></div>
<div class="ttc" id="a_constants_8h_html_a9d406fd011f106e2d6c00a427eb4b913"><div class="ttname"><a href="_constants_8h.html#a9d406fd011f106e2d6c00a427eb4b913">TOP_LEVEL_DRIVERS_VMCALL_ENDING_NUMBER</a></div><div class="ttdeci">#define TOP_LEVEL_DRIVERS_VMCALL_ENDING_NUMBER</div><div class="ttdoc">The start number of VMCALL number allowed to be used by top-level drivers.</div><div class="ttdef"><b>Definition</b> Constants.h:348</div></div>
<div class="ttc" id="a_constants_8h_html_afc31005953fd893f042528c9b0bf81e7"><div class="ttname"><a href="_constants_8h.html#afc31005953fd893f042528c9b0bf81e7">TOP_LEVEL_DRIVERS_VMCALL_STARTING_NUMBER</a></div><div class="ttdeci">#define TOP_LEVEL_DRIVERS_VMCALL_STARTING_NUMBER</div><div class="ttdoc">The start number of VMCALL number allowed to be used by top-level drivers.</div><div class="ttdef"><b>Definition</b> Constants.h:341</div></div>
<div class="ttc" id="a_dirty_logging_8c_html_a390c4a8eb2b303b1abc997e837a2013a"><div class="ttname"><a href="_dirty_logging_8c.html#a390c4a8eb2b303b1abc997e837a2013a">DirtyLoggingDisable</a></div><div class="ttdeci">VOID DirtyLoggingDisable(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Disables the dirty logging mechanism in VMX-root mode.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:156</div></div>
<div class="ttc" id="a_dirty_logging_8c_html_aefbc17df23cab83401c9c139905a031e"><div class="ttname"><a href="_dirty_logging_8c.html#aefbc17df23cab83401c9c139905a031e">DirtyLoggingEnable</a></div><div class="ttdeci">BOOLEAN DirtyLoggingEnable(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Enables the dirty logging mechanism in VMX-root mode.</div><div class="ttdef"><b>Definition</b> DirtyLogging.c:105</div></div>
<div class="ttc" id="a_efer_hook_8c_html_a018ba30cbafd5ebc786414637eb7b8f3"><div class="ttname"><a href="_efer_hook_8c.html#a018ba30cbafd5ebc786414637eb7b8f3">SyscallHookConfigureEFER</a></div><div class="ttdeci">VOID SyscallHookConfigureEFER(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN EnableEFERSyscallHook)</div><div class="ttdoc">This function enables or disables EFER syscall hoo.</div><div class="ttdef"><b>Definition</b> EferHook.c:31</div></div>
<div class="ttc" id="a_ept_hook_8c_html_a03c810703f75ca09341a4d70e02293c3"><div class="ttname"><a href="_ept_hook_8c.html#a03c810703f75ca09341a4d70e02293c3">EptHookRestoreSingleHookToOriginalEntry</a></div><div class="ttdeci">BOOLEAN EptHookRestoreSingleHookToOriginalEntry(VIRTUAL_MACHINE_STATE *VCpu, SIZE_T PhysicalAddress, UINT64 OriginalEntry)</div><div class="ttdoc">Remove and Invalidate Hook in TLB (Hidden Detours and if counter of hidden breakpoint is zero)</div><div class="ttdef"><b>Definition</b> EptHook.c:656</div></div>
<div class="ttc" id="a_ept_hook_8c_html_a0b2a50efc209dfa3aedcd756c7128607"><div class="ttname"><a href="_ept_hook_8c.html#a0b2a50efc209dfa3aedcd756c7128607">EptHookRestoreAllHooksToOriginalEntry</a></div><div class="ttdeci">VOID EptHookRestoreAllHooksToOriginalEntry(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Remove and Invalidate Hook in TLB.</div><div class="ttdef"><b>Definition</b> EptHook.c:704</div></div>
<div class="ttc" id="a_ept_hook_8c_html_a32f950fc6247cece400187114bac26ab"><div class="ttname"><a href="_ept_hook_8c.html#a32f950fc6247cece400187114bac26ab">EptHookPerformPageHook</a></div><div class="ttdeci">BOOLEAN EptHookPerformPageHook(VIRTUAL_MACHINE_STATE *VCpu, PVOID TargetAddress, CR3_TYPE ProcessCr3)</div><div class="ttdoc">The main function that performs EPT page hook with hidden breakpoint.</div><div class="ttdef"><b>Definition</b> EptHook.c:474</div></div>
<div class="ttc" id="a_ept_hook_8c_html_aadbcf1945213c68375c8871dbecc3971"><div class="ttname"><a href="_ept_hook_8c.html#aadbcf1945213c68375c8871dbecc3971">EptHookPerformPageHookMonitorAndInlineHook</a></div><div class="ttdeci">BOOLEAN EptHookPerformPageHookMonitorAndInlineHook(VIRTUAL_MACHINE_STATE *VCpu, PVOID HookingDetails, CR3_TYPE ProcessCr3, UINT32 PageHookMask)</div><div class="ttdoc">The main function that performs EPT page hook with hidden detours and monitor.</div><div class="ttdef"><b>Definition</b> EptHook.c:980</div></div>
<div class="ttc" id="a_exec_trap_8c_html_a22855316678446d7d33cda0836a1ee70"><div class="ttname"><a href="_exec_trap_8c.html#a22855316678446d7d33cda0836a1ee70">ExecTrapRestoreToNormalEptp</a></div><div class="ttdeci">VOID ExecTrapRestoreToNormalEptp(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">restore to normal EPTP</div><div class="ttdef"><b>Definition</b> ExecTrap.c:671</div></div>
<div class="ttc" id="a_exec_trap_8c_html_aab11493ed60e326089cdeb660835bbbc"><div class="ttname"><a href="_exec_trap_8c.html#aab11493ed60e326089cdeb660835bbbc">ExecTrapChangeToUserDisabledMbecEptp</a></div><div class="ttdeci">VOID ExecTrapChangeToUserDisabledMbecEptp(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">change to user-disabled MBEC EPTP</div><div class="ttdef"><b>Definition</b> ExecTrap.c:711</div></div>
<div class="ttc" id="a_hv_8c_html_a0d721b297a9930e02bfb88191a2e0b78"><div class="ttname"><a href="_hv_8c.html#a0d721b297a9930e02bfb88191a2e0b78">HvSetPmcVmexit</a></div><div class="ttdeci">VOID HvSetPmcVmexit(BOOLEAN Set)</div><div class="ttdoc">Set vm-exit for rdpmc instructions.</div><div class="ttdef"><b>Definition</b> Hv.c:509</div></div>
<div class="ttc" id="a_hv_8c_html_a19458423f77db01c301caf54c301b24c"><div class="ttname"><a href="_hv_8c.html#a19458423f77db01c301caf54c301b24c">HvSetNmiExiting</a></div><div class="ttdeci">VOID HvSetNmiExiting(BOOLEAN Set)</div><div class="ttdoc">Set the NMI Exiting.</div><div class="ttdef"><b>Definition</b> Hv.c:953</div></div>
<div class="ttc" id="a_hv_8c_html_a256ea8c6d02ec0645069b0df50683700"><div class="ttname"><a href="_hv_8c.html#a256ea8c6d02ec0645069b0df50683700">HvUnsetExceptionBitmap</a></div><div class="ttdeci">VOID HvUnsetExceptionBitmap(VIRTUAL_MACHINE_STATE *VCpu, UINT32 IdtIndex)</div><div class="ttdoc">Unset exception bitmap in VMCS.</div><div class="ttdef"><b>Definition</b> Hv.c:1039</div></div>
<div class="ttc" id="a_hv_8c_html_a372b26d4b4571db93597414725289f0c"><div class="ttname"><a href="_hv_8c.html#a372b26d4b4571db93597414725289f0c">HvSetMovDebugRegsExiting</a></div><div class="ttdeci">VOID HvSetMovDebugRegsExiting(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set or unset the Mov to Debug Registers Exiting.</div><div class="ttdef"><b>Definition</b> Hv.c:1121</div></div>
<div class="ttc" id="a_hv_8c_html_a437b35822e82e1192228e3f8e767a4ab"><div class="ttname"><a href="_hv_8c.html#a437b35822e82e1192228e3f8e767a4ab">HvSetSaveDebugControls</a></div><div class="ttdeci">VOID HvSetSaveDebugControls(BOOLEAN Set)</div><div class="ttdoc">Set SAVE DEBUG CONTROLS on Vm-exit controls.</div><div class="ttdef"><b>Definition</b> Hv.c:433</div></div>
<div class="ttc" id="a_hv_8c_html_a856a41c4038e4065c52eb90db0160ab2"><div class="ttname"><a href="_hv_8c.html#a856a41c4038e4065c52eb90db0160ab2">HvSetExternalInterruptExiting</a></div><div class="ttdeci">VOID HvSetExternalInterruptExiting(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set the External Interrupt Exiting.</div><div class="ttdef"><b>Definition</b> Hv.c:1055</div></div>
<div class="ttc" id="a_hv_8c_html_aaa9e7c2c5105db2e85d896167df615f7"><div class="ttname"><a href="_hv_8c.html#aaa9e7c2c5105db2e85d896167df615f7">HvSetMovControlRegsExiting</a></div><div class="ttdeci">VOID HvSetMovControlRegsExiting(BOOLEAN Set, UINT64 ControlRegister, UINT64 MaskRegister)</div><div class="ttdoc">Set vm-exit for mov-to-cr0/4.</div><div class="ttdef"><b>Definition</b> Hv.c:543</div></div>
<div class="ttc" id="a_hv_8c_html_aaac0cbfd9d2c9a2d4c4263bf58051322"><div class="ttname"><a href="_hv_8c.html#aaac0cbfd9d2c9a2d4c4263bf58051322">HvSetRdtscExiting</a></div><div class="ttdeci">VOID HvSetRdtscExiting(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set the RDTSC/P Exiting.</div><div class="ttdef"><b>Definition</b> Hv.c:1108</div></div>
<div class="ttc" id="a_hv_8c_html_ac7fa8f843553c4aebe992e88c71bbb79"><div class="ttname"><a href="_hv_8c.html#ac7fa8f843553c4aebe992e88c71bbb79">HvSetMovToCr3Vmexit</a></div><div class="ttdeci">VOID HvSetMovToCr3Vmexit(VIRTUAL_MACHINE_STATE *VCpu, BOOLEAN Set)</div><div class="ttdoc">Set vm-exit for mov-to-cr3.</div><div class="ttdef"><b>Definition</b> Hv.c:558</div></div>
<div class="ttc" id="a_hv_8c_html_ac9aefb71e380eac56389960ac66cddc1"><div class="ttname"><a href="_hv_8c.html#ac9aefb71e380eac56389960ac66cddc1">HvSetLoadDebugControls</a></div><div class="ttdeci">VOID HvSetLoadDebugControls(BOOLEAN Set)</div><div class="ttdoc">Set LOAD DEBUG CONTROLS on Vm-entry controls.</div><div class="ttdef"><b>Definition</b> Hv.c:402</div></div>
<div class="ttc" id="a_hv_8c_html_ad9fc64fae8bbc000a6e8949e78547027"><div class="ttname"><a href="_hv_8c.html#ad9fc64fae8bbc000a6e8949e78547027">HvSetExceptionBitmap</a></div><div class="ttdeci">VOID HvSetExceptionBitmap(VIRTUAL_MACHINE_STATE *VCpu, UINT32 IdtIndex)</div><div class="ttdoc">Set exception bitmap in VMCS.</div><div class="ttdef"><b>Definition</b> Hv.c:1022</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="a_invept_8c_html_a1f3a0ce01874877f718413e6e19ce956"><div class="ttname"><a href="_invept_8c.html#a1f3a0ce01874877f718413e6e19ce956">EptInveptAllContexts</a></div><div class="ttdeci">UCHAR EptInveptAllContexts()</div><div class="ttdoc">Invalidates all contexts in EPT cache table.</div><div class="ttdef"><b>Definition</b> Invept.c:54</div></div>
<div class="ttc" id="a_io_handler_8c_html_a54b01254d943b0ad2dbf7d97cb705671"><div class="ttname"><a href="_io_handler_8c.html#a54b01254d943b0ad2dbf7d97cb705671">IoHandlePerformIoBitmapReset</a></div><div class="ttdeci">VOID IoHandlePerformIoBitmapReset(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Reset I/O Bitmap.</div><div class="ttdef"><b>Definition</b> IoHandler.c:268</div></div>
<div class="ttc" id="a_io_handler_8c_html_acba84b9a16038184a36622a0e69722c4"><div class="ttname"><a href="_io_handler_8c.html#acba84b9a16038184a36622a0e69722c4">IoHandlePerformIoBitmapChange</a></div><div class="ttdeci">VOID IoHandlePerformIoBitmapChange(VIRTUAL_MACHINE_STATE *VCpu, UINT32 Port)</div><div class="ttdoc">Change I/O Bitmap.</div><div class="ttdef"><b>Definition</b> IoHandler.c:241</div></div>
<div class="ttc" id="a_mode_based_exec_hook_8c_html_ad0a46e8a40650a0c0776ccef469c345e"><div class="ttname"><a href="_mode_based_exec_hook_8c.html#ad0a46e8a40650a0c0776ccef469c345e">ModeBasedExecHookEnableOrDisable</a></div><div class="ttdeci">VOID ModeBasedExecHookEnableOrDisable(VIRTUAL_MACHINE_STATE *VCpu, UINT32 State)</div><div class="ttdoc">Enable/disable MBEC.</div><div class="ttdef"><b>Definition</b> ModeBasedExecHook.c:161</div></div>
<div class="ttc" id="a_msr_handlers_8c_html_a74d6269ab230748466e8eb585032ced2"><div class="ttname"><a href="_msr_handlers_8c.html#a74d6269ab230748466e8eb585032ced2">MsrHandlePerformMsrBitmapWriteChange</a></div><div class="ttdeci">VOID MsrHandlePerformMsrBitmapWriteChange(VIRTUAL_MACHINE_STATE *VCpu, UINT32 MsrMask)</div><div class="ttdoc">Change MSR Bitmap for write.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:469</div></div>
<div class="ttc" id="a_msr_handlers_8c_html_a76fcb889d44411cc8f0090892b0c9592"><div class="ttname"><a href="_msr_handlers_8c.html#a76fcb889d44411cc8f0090892b0c9592">MsrHandlePerformMsrBitmapWriteReset</a></div><div class="ttdeci">VOID MsrHandlePerformMsrBitmapWriteReset(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Reset MSR Bitmap for write.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:500</div></div>
<div class="ttc" id="a_msr_handlers_8c_html_a8ea9efcef215456094dece3d242b612c"><div class="ttname"><a href="_msr_handlers_8c.html#a8ea9efcef215456094dece3d242b612c">MsrHandlePerformMsrBitmapReadChange</a></div><div class="ttdeci">VOID MsrHandlePerformMsrBitmapReadChange(VIRTUAL_MACHINE_STATE *VCpu, UINT32 MsrMask)</div><div class="ttdoc">Change MSR Bitmap for read.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:422</div></div>
<div class="ttc" id="a_msr_handlers_8c_html_ad08fe98ebb27cd63bf38bdd39774903b"><div class="ttname"><a href="_msr_handlers_8c.html#ad08fe98ebb27cd63bf38bdd39774903b">MsrHandlePerformMsrBitmapReadReset</a></div><div class="ttdeci">VOID MsrHandlePerformMsrBitmapReadReset(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Reset MSR Bitmap for read.</div><div class="ttdef"><b>Definition</b> MsrHandlers.c:453</div></div>
<div class="ttc" id="a_protected_hv_8c_html_a20725f9a6b9e6a01bcb7b8aab91a0fdc"><div class="ttname"><a href="_protected_hv_8c.html#a20725f9a6b9e6a01bcb7b8aab91a0fdc">ProtectedHvDisableRdtscExitingForDisablingTscCommands</a></div><div class="ttdeci">VOID ProtectedHvDisableRdtscExitingForDisablingTscCommands(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Clear events of !tsc.</div><div class="ttdef"><b>Definition</b> ProtectedHv.c:570</div></div>
<div class="ttc" id="a_protected_hv_8c_html_a233dcc156894424ce522de64fab25c50"><div class="ttname"><a href="_protected_hv_8c.html#a233dcc156894424ce522de64fab25c50">ProtectedHvResetExceptionBitmapToClearEvents</a></div><div class="ttdeci">VOID ProtectedHvResetExceptionBitmapToClearEvents(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Reset exception bitmap in VMCS because of clearing !exception commands.</div><div class="ttdef"><b>Definition</b> ProtectedHv.c:141</div></div>
<div class="ttc" id="a_protected_hv_8c_html_acfa018e728fa09f93e9c6539983d34c9"><div class="ttname"><a href="_protected_hv_8c.html#acfa018e728fa09f93e9c6539983d34c9">ProtectedHvExternalInterruptExitingForDisablingInterruptCommands</a></div><div class="ttdeci">VOID ProtectedHvExternalInterruptExitingForDisablingInterruptCommands(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Clear events of !interrupt.</div><div class="ttdef"><b>Definition</b> ProtectedHv.c:269</div></div>
<div class="ttc" id="a_protected_hv_8c_html_aef7502e82b65841aa7d61907ba088c6d"><div class="ttname"><a href="_protected_hv_8c.html#aef7502e82b65841aa7d61907ba088c6d">ProtectedHvDisableMovControlRegsExitingForDisablingCrCommands</a></div><div class="ttdeci">VOID ProtectedHvDisableMovControlRegsExitingForDisablingCrCommands(VIRTUAL_MACHINE_STATE *VCpu, UINT64 ControlRegister, UINT64 MaskRegister)</div><div class="ttdoc">Clear events of !crwrite.</div><div class="ttdef"><b>Definition</b> ProtectedHv.c:609</div></div>
<div class="ttc" id="a_protected_hv_8c_html_af4e0bd1fd26a9f505b3945e83a59163e"><div class="ttname"><a href="_protected_hv_8c.html#af4e0bd1fd26a9f505b3945e83a59163e">ProtectedHvDisableMovDebugRegsExitingForDisablingDrCommands</a></div><div class="ttdeci">VOID ProtectedHvDisableMovDebugRegsExitingForDisablingDrCommands(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Clear events of !dr.</div><div class="ttdef"><b>Definition</b> ProtectedHv.c:595</div></div>
<div class="ttc" id="a_vmcall_8c_html_a33cfb4436bd44e0edfc347cd877103df"><div class="ttname"><a href="#a33cfb4436bd44e0edfc347cd877103df">VmcallTest</a></div><div class="ttdeci">NTSTATUS VmcallTest(_In_ UINT64 Param1, _In_ UINT64 Param2, _In_ UINT64 Param3)</div><div class="ttdoc">Test Vmcall (VMCALL_TEST)</div><div class="ttdef"><b>Definition</b> Vmcall.c:481</div></div>
<div class="ttc" id="a_vmcall_8h_html_a053f2981fbad868a5dd053a1df1bac20"><div class="ttname"><a href="_vmcall_8h.html#a053f2981fbad868a5dd053a1df1bac20">VMCALL_SET_VM_ENTRY_LOAD_DEBUG_CONTROLS</a></div><div class="ttdeci">#define VMCALL_SET_VM_ENTRY_LOAD_DEBUG_CONTROLS</div><div class="ttdoc">VMCALL to set VM-entry LOAD DEBUG CONTROLS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:200</div></div>
<div class="ttc" id="a_vmcall_8h_html_a0a886d0b99e07a1f987b19b08a8713a2"><div class="ttname"><a href="_vmcall_8h.html#a0a886d0b99e07a1f987b19b08a8713a2">VMCALL_UNSET_VM_ENTRY_LOAD_DEBUG_CONTROLS</a></div><div class="ttdeci">#define VMCALL_UNSET_VM_ENTRY_LOAD_DEBUG_CONTROLS</div><div class="ttdoc">VMCALL to unset VM-entry LOAD DEBUG CONTROLS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:208</div></div>
<div class="ttc" id="a_vmcall_8h_html_a13c945f82e78bd3ec1f1b008c6e9fbde"><div class="ttname"><a href="_vmcall_8h.html#a13c945f82e78bd3ec1f1b008c6e9fbde">VMCALL_DISABLE_MOV_TO_DEBUG_REGS_EXITING</a></div><div class="ttdeci">#define VMCALL_DISABLE_MOV_TO_DEBUG_REGS_EXITING</div><div class="ttdoc">VMCALL to disable mov to debug registers exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:148</div></div>
<div class="ttc" id="a_vmcall_8h_html_a19cc3e737fde0dbb0b6bcaa07f323550"><div class="ttname"><a href="_vmcall_8h.html#a19cc3e737fde0dbb0b6bcaa07f323550">VMCALL_INVEPT_ALL_CONTEXTS</a></div><div class="ttdeci">#define VMCALL_INVEPT_ALL_CONTEXTS</div><div class="ttdoc">VMCALL to invalidate EPT (All Contexts)</div><div class="ttdef"><b>Definition</b> Vmcall.h:40</div></div>
<div class="ttc" id="a_vmcall_8h_html_a1e7f57f4bbbbb320e00e7d1533e15228"><div class="ttname"><a href="_vmcall_8h.html#a1e7f57f4bbbbb320e00e7d1533e15228">VMCALL_SET_RDPMC_EXITING</a></div><div class="ttdeci">#define VMCALL_SET_RDPMC_EXITING</div><div class="ttdoc">VMCALL to enable rdpmc exiting in primary cpu-based controls.</div><div class="ttdef"><b>Definition</b> Vmcall.h:94</div></div>
<div class="ttc" id="a_vmcall_8h_html_a2601ab46e40f83ee118167579d20228d"><div class="ttname"><a href="_vmcall_8h.html#a2601ab46e40f83ee118167579d20228d">VMCALL_SET_VM_EXIT_SAVE_DEBUG_CONTROLS</a></div><div class="ttdeci">#define VMCALL_SET_VM_EXIT_SAVE_DEBUG_CONTROLS</div><div class="ttdoc">VMCALL to set VM-exit SAVE DEBUG CONTROLS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:216</div></div>
<div class="ttc" id="a_vmcall_8h_html_a2b7d10892af0a5d9c6e3a52b1e39607b"><div class="ttname"><a href="_vmcall_8h.html#a2b7d10892af0a5d9c6e3a52b1e39607b">VMCALL_RESET_MSR_BITMAP_WRITE</a></div><div class="ttdeci">#define VMCALL_RESET_MSR_BITMAP_WRITE</div><div class="ttdoc">VMCALL to reset MSR Bitmap Write.</div><div class="ttdef"><b>Definition</b> Vmcall.h:160</div></div>
<div class="ttc" id="a_vmcall_8h_html_a2cb048ec03fa4ba521710982aafe593b"><div class="ttname"><a href="_vmcall_8h.html#a2cb048ec03fa4ba521710982aafe593b">VMCALL_DISABLE_DIRTY_LOGGING_MECHANISM</a></div><div class="ttdeci">#define VMCALL_DISABLE_DIRTY_LOGGING_MECHANISM</div><div class="ttdoc">VMCALL to disable dirty logging (PML) mechanism.</div><div class="ttdef"><b>Definition</b> Vmcall.h:280</div></div>
<div class="ttc" id="a_vmcall_8h_html_a2f893b27a9a2cedec9f4c499011dce0a"><div class="ttname"><a href="_vmcall_8h.html#a2f893b27a9a2cedec9f4c499011dce0a">VMCALL_CHANGE_PAGE_ATTRIB</a></div><div class="ttdeci">#define VMCALL_CHANGE_PAGE_ATTRIB</div><div class="ttdoc">VMCALL to Hook Change the attribute bits of the EPT Table.</div><div class="ttdef"><b>Definition</b> Vmcall.h:34</div></div>
<div class="ttc" id="a_vmcall_8h_html_a38a75ce57ba1b289882445153d869180"><div class="ttname"><a href="_vmcall_8h.html#a38a75ce57ba1b289882445153d869180">VMCALL_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</a></div><div class="ttdeci">#define VMCALL_RESET_EXCEPTION_BITMAP_ONLY_ON_CLEARING_EXCEPTION_EVENTS</div><div class="ttdoc">VMCALL to reset exception bitmap on VMCS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:168</div></div>
<div class="ttc" id="a_vmcall_8h_html_a449984f06abf0354c5972bd93ab7529a"><div class="ttname"><a href="_vmcall_8h.html#a449984f06abf0354c5972bd93ab7529a">VMCALL_RESET_MSR_BITMAP_READ</a></div><div class="ttdeci">#define VMCALL_RESET_MSR_BITMAP_READ</div><div class="ttdoc">VMCALL to reset MSR Bitmap Read.</div><div class="ttdef"><b>Definition</b> Vmcall.h:154</div></div>
<div class="ttc" id="a_vmcall_8h_html_a45441c9962f57151b6e7ac243bdb396f"><div class="ttname"><a href="_vmcall_8h.html#a45441c9962f57151b6e7ac243bdb396f">VMCALL_INVEPT_SINGLE_CONTEXT</a></div><div class="ttdeci">#define VMCALL_INVEPT_SINGLE_CONTEXT</div><div class="ttdoc">VMCALL to invalidate EPT (A Single Context)</div><div class="ttdef"><b>Definition</b> Vmcall.h:46</div></div>
<div class="ttc" id="a_vmcall_8h_html_a495cdfcf6ee1a5136c4f45e5fc8c2848"><div class="ttname"><a href="_vmcall_8h.html#a495cdfcf6ee1a5136c4f45e5fc8c2848">VMCALL_UNSET_EXCEPTION_BITMAP</a></div><div class="ttdeci">#define VMCALL_UNSET_EXCEPTION_BITMAP</div><div class="ttdoc">VMCALL to unset exception bitmap on VMCS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:192</div></div>
<div class="ttc" id="a_vmcall_8h_html_a5512b08230236da375c1c1b1dc5a151d"><div class="ttname"><a href="_vmcall_8h.html#a5512b08230236da375c1c1b1dc5a151d">VMCALL_SET_VM_EXIT_ON_NMIS</a></div><div class="ttdeci">#define VMCALL_SET_VM_EXIT_ON_NMIS</div><div class="ttdoc">VMCALL to cause vm-exit on NMIs.</div><div class="ttdef"><b>Definition</b> Vmcall.h:230</div></div>
<div class="ttc" id="a_vmcall_8h_html_a589357d083b5353f74c07972e1448924"><div class="ttname"><a href="_vmcall_8h.html#a589357d083b5353f74c07972e1448924">VMCALL_VMXOFF</a></div><div class="ttdeci">#define VMCALL_VMXOFF</div><div class="ttdoc">VMCALL to Call VMXOFF to turn off the hypervisor.</div><div class="ttdef"><b>Definition</b> Vmcall.h:28</div></div>
<div class="ttc" id="a_vmcall_8h_html_a5d3db56f2450003c021cbeb98f11ae89"><div class="ttname"><a href="_vmcall_8h.html#a5d3db56f2450003c021cbeb98f11ae89">VMCALL_CHANGE_MSR_BITMAP_WRITE</a></div><div class="ttdeci">#define VMCALL_CHANGE_MSR_BITMAP_WRITE</div><div class="ttdoc">VMCALL to change MSR Bitmap Write.</div><div class="ttdef"><b>Definition</b> Vmcall.h:82</div></div>
<div class="ttc" id="a_vmcall_8h_html_a699aaf657adf0f1a1f7156061dff374e"><div class="ttname"><a href="_vmcall_8h.html#a699aaf657adf0f1a1f7156061dff374e">VMCALL_ENABLE_DIRTY_LOGGING_MECHANISM</a></div><div class="ttdeci">#define VMCALL_ENABLE_DIRTY_LOGGING_MECHANISM</div><div class="ttdoc">VMCALL to enable dirty logging (PML) mechanism.</div><div class="ttdef"><b>Definition</b> Vmcall.h:274</div></div>
<div class="ttc" id="a_vmcall_8h_html_a7b45a0cbafe7472996868357b52f1265"><div class="ttname"><a href="_vmcall_8h.html#a7b45a0cbafe7472996868357b52f1265">VMCALL_TEST</a></div><div class="ttdeci">#define VMCALL_TEST</div><div class="ttdoc">VMCALL to test hypervisor.</div><div class="ttdef"><b>Definition</b> Vmcall.h:22</div></div>
<div class="ttc" id="a_vmcall_8h_html_a816614b9895fb357bc7eee01714a3806"><div class="ttname"><a href="_vmcall_8h.html#a816614b9895fb357bc7eee01714a3806">VMCALL_ENABLE_MOV_TO_CR3_EXITING</a></div><div class="ttdeci">#define VMCALL_ENABLE_MOV_TO_CR3_EXITING</div><div class="ttdoc">VMCALL to enable cr3 exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:180</div></div>
<div class="ttc" id="a_vmcall_8h_html_a82ef48fcf230df2686944075151b7eb3"><div class="ttname"><a href="_vmcall_8h.html#a82ef48fcf230df2686944075151b7eb3">VMCALL_DISABLE_MOV_TO_CONTROL_REGS_EXITING</a></div><div class="ttdeci">#define VMCALL_DISABLE_MOV_TO_CONTROL_REGS_EXITING</div><div class="ttdoc">VMCALL to disable mov to CR exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:261</div></div>
<div class="ttc" id="a_vmcall_8h_html_a84bc6a52b61013c70607768974cf38e3"><div class="ttname"><a href="_vmcall_8h.html#a84bc6a52b61013c70607768974cf38e3">VMCALL_SET_RDTSC_EXITING</a></div><div class="ttdeci">#define VMCALL_SET_RDTSC_EXITING</div><div class="ttdoc">VMCALL to enable rdtsc/rdtscp exiting in primary cpu-based controls.</div><div class="ttdef"><b>Definition</b> Vmcall.h:88</div></div>
<div class="ttc" id="a_vmcall_8h_html_a8779c1a5dc3675bd60df12b85e9fc5a3"><div class="ttname"><a href="_vmcall_8h.html#a8779c1a5dc3675bd60df12b85e9fc5a3">VMCALL_CHANGE_IO_BITMAP</a></div><div class="ttdeci">#define VMCALL_CHANGE_IO_BITMAP</div><div class="ttdoc">VMCALL to change I/O Bitmaps (A &amp; B)</div><div class="ttdef"><b>Definition</b> Vmcall.h:118</div></div>
<div class="ttc" id="a_vmcall_8h_html_a8cc1375f7c22268460a5a026343e0443"><div class="ttname"><a href="_vmcall_8h.html#a8cc1375f7c22268460a5a026343e0443">VMCALL_UNSET_VM_EXIT_ON_NMIS</a></div><div class="ttdeci">#define VMCALL_UNSET_VM_EXIT_ON_NMIS</div><div class="ttdoc">VMCALL to not cause vm-exit on NMIs.</div><div class="ttdef"><b>Definition</b> Vmcall.h:236</div></div>
<div class="ttc" id="a_vmcall_8h_html_a95a7f87dabddcb74056419965555608d"><div class="ttname"><a href="_vmcall_8h.html#a95a7f87dabddcb74056419965555608d">VMCALL_SET_EXCEPTION_BITMAP</a></div><div class="ttdeci">#define VMCALL_SET_EXCEPTION_BITMAP</div><div class="ttdoc">VMCALL to set exception bitmap on VMCS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:100</div></div>
<div class="ttc" id="a_vmcall_8h_html_a97a25939f7d07934b25028b877965889"><div class="ttname"><a href="_vmcall_8h.html#a97a25939f7d07934b25028b877965889">VMCALL_UNHOOK_ALL_PAGES</a></div><div class="ttdeci">#define VMCALL_UNHOOK_ALL_PAGES</div><div class="ttdoc">VMCALL to remove a all physical addresses from hook list.</div><div class="ttdef"><b>Definition</b> Vmcall.h:52</div></div>
<div class="ttc" id="a_vmcall_8h_html_aa23cf4e06f34a78d1efc1049c0c7c9a3"><div class="ttname"><a href="_vmcall_8h.html#aa23cf4e06f34a78d1efc1049c0c7c9a3">VMCALL_SET_HIDDEN_CC_BREAKPOINT</a></div><div class="ttdeci">#define VMCALL_SET_HIDDEN_CC_BREAKPOINT</div><div class="ttdoc">VMCALL to put hidden breakpoints (using EPT)</div><div class="ttdef"><b>Definition</b> Vmcall.h:124</div></div>
<div class="ttc" id="a_vmcall_8h_html_aad3efe006994731884e3ded8171696db"><div class="ttname"><a href="_vmcall_8h.html#aad3efe006994731884e3ded8171696db">VMCALL_RESTORE_TO_NORMAL_EPTP</a></div><div class="ttdeci">#define VMCALL_RESTORE_TO_NORMAL_EPTP</div><div class="ttdoc">VMCALL to restore EPTP to normal EPTP.</div><div class="ttdef"><b>Definition</b> Vmcall.h:292</div></div>
<div class="ttc" id="a_vmcall_8h_html_aafe3a3005e59a1e74faf8417efe70ddd"><div class="ttname"><a href="_vmcall_8h.html#aafe3a3005e59a1e74faf8417efe70ddd">VMCALL_DISABLE_OR_ENABLE_MBEC</a></div><div class="ttdeci">#define VMCALL_DISABLE_OR_ENABLE_MBEC</div><div class="ttdoc">VMCALL to enable/disable MBEC.</div><div class="ttdef"><b>Definition</b> Vmcall.h:298</div></div>
<div class="ttc" id="a_vmcall_8h_html_abbb3d99ced0391c88b695b06603b31dd"><div class="ttname"><a href="_vmcall_8h.html#abbb3d99ced0391c88b695b06603b31dd">VMCALL_ENABLE_SYSCALL_HOOK_EFER</a></div><div class="ttdeci">#define VMCALL_ENABLE_SYSCALL_HOOK_EFER</div><div class="ttdoc">VMCALL to enable syscall hook using EFER SCE bit.</div><div class="ttdef"><b>Definition</b> Vmcall.h:64</div></div>
<div class="ttc" id="a_vmcall_8h_html_ac26259df2e2de916949e5228b1d8bb37"><div class="ttname"><a href="_vmcall_8h.html#ac26259df2e2de916949e5228b1d8bb37">VMCALL_UNSET_VM_EXIT_SAVE_DEBUG_CONTROLS</a></div><div class="ttdeci">#define VMCALL_UNSET_VM_EXIT_SAVE_DEBUG_CONTROLS</div><div class="ttdoc">VMCALL to unset VM-exit SAVE DEBUG CONTROLS.</div><div class="ttdef"><b>Definition</b> Vmcall.h:224</div></div>
<div class="ttc" id="a_vmcall_8h_html_ac61778ddf78383144987deb0e48cddf1"><div class="ttname"><a href="_vmcall_8h.html#ac61778ddf78383144987deb0e48cddf1">VMCALL_ENABLE_MOV_TO_DEBUG_REGS_EXITING</a></div><div class="ttdeci">#define VMCALL_ENABLE_MOV_TO_DEBUG_REGS_EXITING</div><div class="ttdoc">VMCALL to enable mov to debug registers exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:106</div></div>
<div class="ttc" id="a_vmcall_8h_html_ac692eb720991db54bdc0930c114f5c1a"><div class="ttname"><a href="_vmcall_8h.html#ac692eb720991db54bdc0930c114f5c1a">VMCALL_UNSET_RDTSC_EXITING</a></div><div class="ttdeci">#define VMCALL_UNSET_RDTSC_EXITING</div><div class="ttdoc">VMCALL to disable rdtsc/rdtscp exiting in primary cpu-based controls.</div><div class="ttdef"><b>Definition</b> Vmcall.h:130</div></div>
<div class="ttc" id="a_vmcall_8h_html_ac8d7501d6f143271e221bb79410c1c8e"><div class="ttname"><a href="_vmcall_8h.html#ac8d7501d6f143271e221bb79410c1c8e">VMCALL_UNSET_RDPMC_EXITING</a></div><div class="ttdeci">#define VMCALL_UNSET_RDPMC_EXITING</div><div class="ttdoc">VMCALL to disable rdpmc exiting in primary cpu-based controls.</div><div class="ttdef"><b>Definition</b> Vmcall.h:142</div></div>
<div class="ttc" id="a_vmcall_8h_html_acaa5481bef551455b84d24e6888a162a"><div class="ttname"><a href="_vmcall_8h.html#acaa5481bef551455b84d24e6888a162a">VMCALL_ENABLE_EXTERNAL_INTERRUPT_EXITING</a></div><div class="ttdeci">#define VMCALL_ENABLE_EXTERNAL_INTERRUPT_EXITING</div><div class="ttdoc">VMCALL to enable external interrupt exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:112</div></div>
<div class="ttc" id="a_vmcall_8h_html_acb8a7542446710304e8de981abb62528"><div class="ttname"><a href="_vmcall_8h.html#acb8a7542446710304e8de981abb62528">VMCALL_DISABLE_SYSCALL_HOOK_EFER</a></div><div class="ttdeci">#define VMCALL_DISABLE_SYSCALL_HOOK_EFER</div><div class="ttdoc">VMCALL to disable syscall hook using EFER SCE bit.</div><div class="ttdef"><b>Definition</b> Vmcall.h:70</div></div>
<div class="ttc" id="a_vmcall_8h_html_adbb237e5c9c3352dbebe59f9bd1f6457"><div class="ttname"><a href="_vmcall_8h.html#adbb237e5c9c3352dbebe59f9bd1f6457">VMCALL_CHANGE_TO_MBEC_SUPPORTED_EPTP</a></div><div class="ttdeci">#define VMCALL_CHANGE_TO_MBEC_SUPPORTED_EPTP</div><div class="ttdoc">VMCALL to change EPTP to an MBEC-supported EPTP.</div><div class="ttdef"><b>Definition</b> Vmcall.h:286</div></div>
<div class="ttc" id="a_vmcall_8h_html_adcc0063dc632ac87771ff6ddb0f77888"><div class="ttname"><a href="_vmcall_8h.html#adcc0063dc632ac87771ff6ddb0f77888">VMCALL_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</a></div><div class="ttdeci">#define VMCALL_DISABLE_MOV_TO_CR_EXITING_ONLY_FOR_CR_EVENTS</div><div class="ttdoc">VMCALL to clear mov 2 cr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> Vmcall.h:268</div></div>
<div class="ttc" id="a_vmcall_8h_html_adda7559b8d2c6fc39e913a3270c87ee6"><div class="ttname"><a href="_vmcall_8h.html#adda7559b8d2c6fc39e913a3270c87ee6">VMCALL_ENABLE_MOV_TO_CONTROL_REGS_EXITING</a></div><div class="ttdeci">#define VMCALL_ENABLE_MOV_TO_CONTROL_REGS_EXITING</div><div class="ttdoc">VMCALL to enable mov to CR exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:255</div></div>
<div class="ttc" id="a_vmcall_8h_html_ade9df4e3f1141974c97a539ef86773a7"><div class="ttname"><a href="_vmcall_8h.html#ade9df4e3f1141974c97a539ef86773a7">VMCALL_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</a></div><div class="ttdeci">#define VMCALL_DISABLE_RDTSC_EXITING_ONLY_FOR_TSC_EVENTS</div><div class="ttdoc">VMCALL to clear rdtsc exiting bit ONLY in the case of disabling the events for !tsc command.</div><div class="ttdef"><b>Definition</b> Vmcall.h:243</div></div>
<div class="ttc" id="a_vmcall_8h_html_ae132a6e82064b05fd1b83d979becf8ae"><div class="ttname"><a href="_vmcall_8h.html#ae132a6e82064b05fd1b83d979becf8ae">VMCALL_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</a></div><div class="ttdeci">#define VMCALL_DISABLE_EXTERNAL_INTERRUPT_EXITING_ONLY_TO_CLEAR_INTERRUPT_COMMANDS</div><div class="ttdoc">VMCALL to disable external interrupt exiting only to clear !interrupt commands.</div><div class="ttdef"><b>Definition</b> Vmcall.h:136</div></div>
<div class="ttc" id="a_vmcall_8h_html_ae621273430ce3a493c7273f90ddd9f0f"><div class="ttname"><a href="_vmcall_8h.html#ae621273430ce3a493c7273f90ddd9f0f">VMCALL_RESET_IO_BITMAP</a></div><div class="ttdeci">#define VMCALL_RESET_IO_BITMAP</div><div class="ttdoc">VMCALL to reset I/O Bitmaps (A &amp; B)</div><div class="ttdef"><b>Definition</b> Vmcall.h:174</div></div>
<div class="ttc" id="a_vmcall_8h_html_ae88058c24e03982fb3b9b268eceb9c39"><div class="ttname"><a href="_vmcall_8h.html#ae88058c24e03982fb3b9b268eceb9c39">VMCALL_UNHOOK_SINGLE_PAGE</a></div><div class="ttdeci">#define VMCALL_UNHOOK_SINGLE_PAGE</div><div class="ttdoc">VMCALL to restore a single EPT entry and invalidate EPT cache.</div><div class="ttdef"><b>Definition</b> Vmcall.h:58</div></div>
<div class="ttc" id="a_vmcall_8h_html_aeacaa8a476a8d6503dbdc38ceb76ad08"><div class="ttname"><a href="_vmcall_8h.html#aeacaa8a476a8d6503dbdc38ceb76ad08">VMCALL_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</a></div><div class="ttdeci">#define VMCALL_DISABLE_MOV_TO_HW_DR_EXITING_ONLY_FOR_DR_EVENTS</div><div class="ttdoc">VMCALL to clear mov 2 hw dr exiting bit ONLY in the case of disabling the events for !...</div><div class="ttdef"><b>Definition</b> Vmcall.h:250</div></div>
<div class="ttc" id="a_vmcall_8h_html_af5e421b53efd853799e3450565d6a16f"><div class="ttname"><a href="_vmcall_8h.html#af5e421b53efd853799e3450565d6a16f">VMCALL_DISABLE_MOV_TO_CR3_EXITING</a></div><div class="ttdeci">#define VMCALL_DISABLE_MOV_TO_CR3_EXITING</div><div class="ttdoc">VMCALL to disable cr3 exiting.</div><div class="ttdef"><b>Definition</b> Vmcall.h:186</div></div>
<div class="ttc" id="a_vmcall_8h_html_affdc952605558fc2311612448745464f"><div class="ttname"><a href="_vmcall_8h.html#affdc952605558fc2311612448745464f">VMCALL_CHANGE_MSR_BITMAP_READ</a></div><div class="ttdeci">#define VMCALL_CHANGE_MSR_BITMAP_READ</div><div class="ttdoc">VMCALL to change MSR Bitmap Read.</div><div class="ttdef"><b>Definition</b> Vmcall.h:76</div></div>
<div class="ttc" id="a_vmx_8c_html_ad9193ed1677033cd08c5d5b7788b15c7"><div class="ttname"><a href="_vmx_8c.html#ad9193ed1677033cd08c5d5b7788b15c7">VmxVmxoff</a></div><div class="ttdeci">VOID VmxVmxoff(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Prepare and execute Vmxoff instruction.</div><div class="ttdef"><b>Definition</b> Vmx.c:1101</div></div>
<div class="ttc" id="a_windows_8h_html_a9102789550b4971083e4fb315b30a984"><div class="ttname"><a href="_windows_8h.html#a9102789550b4971083e4fb315b30a984">STATUS_UNSUCCESSFUL</a></div><div class="ttdeci">#define STATUS_UNSUCCESSFUL</div><div class="ttdef"><b>Definition</b> Windows.h:172</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition</b> BasicTypes.h:130</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html_a04eb96cc99b0458be739bcc9c640e08b"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">_CR3_TYPE::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition</b> BasicTypes.h:133</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ad166851f334095bff309813f73ea394e"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ad166851f334095bff309813f73ea394e">_VIRTUAL_MACHINE_STATE::CoreId</a></div><div class="ttdeci">UINT32 CoreId</div><div class="ttdef"><b>Definition</b> State.h:306</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_e536aab728f7b0abbbf7dc8fdcfcc81b.html">hyperhv</a></li><li class="navelem"><a class="el" href="dir_1ae2c003efa9a319fe8e6b483281e084.html">code</a></li><li class="navelem"><a class="el" href="dir_9ea04b3794d26ea15428fea9629e3977.html">vmm</a></li><li class="navelem"><a class="el" href="dir_36c0bdcd7ec4d5426819138d4c8aba91.html">vmx</a></li><li class="navelem"><a class="el" href="_vmcall_8c.html">Vmcall.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
