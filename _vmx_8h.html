<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/hyperhv/header/vmm/vmx/Vmx.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_vmx_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Vmx.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>VMX Instruction and operation headers.  
<a href="#details">More...</a></p>

<p><a href="_vmx_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hypercalls for Hyper-V.  <a href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:add020230aac46a6da70bec7019457766" id="r_add020230aac46a6da70bec7019457766"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#add020230aac46a6da70bec7019457766">VMCS_SIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="memdesc:add020230aac46a6da70bec7019457766"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMCS Region Size.  <br /></td></tr>
<tr class="separator:add020230aac46a6da70bec7019457766"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2050fcb30b71116f502d40643f35541" id="r_ae2050fcb30b71116f502d40643f35541"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2050fcb30b71116f502d40643f35541">VMXON_SIZE</a>&#160;&#160;&#160;4096</td></tr>
<tr class="memdesc:ae2050fcb30b71116f502d40643f35541"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMXON Region Size.  <br /></td></tr>
<tr class="separator:ae2050fcb30b71116f502d40643f35541"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a158e8b4e19f906a8f4867b17eec1a596" id="r_a158e8b4e19f906a8f4867b17eec1a596"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a158e8b4e19f906a8f4867b17eec1a596">PIN_BASED_VM_EXECUTION_CONTROLS_EXTERNAL_INTERRUPT</a>&#160;&#160;&#160;0x00000001</td></tr>
<tr class="memdesc:a158e8b4e19f906a8f4867b17eec1a596"><td class="mdescLeft">&#160;</td><td class="mdescRight">PIN-Based Execution.  <br /></td></tr>
<tr class="separator:a158e8b4e19f906a8f4867b17eec1a596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2451b4f7835bf9e829b91c5a43a4e8" id="r_abc2451b4f7835bf9e829b91c5a43a4e8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abc2451b4f7835bf9e829b91c5a43a4e8">PIN_BASED_VM_EXECUTION_CONTROLS_NMI_EXITING</a>&#160;&#160;&#160;0x00000008</td></tr>
<tr class="separator:abc2451b4f7835bf9e829b91c5a43a4e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a864408c647028df204a4a0b66faaddbf" id="r_a864408c647028df204a4a0b66faaddbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a864408c647028df204a4a0b66faaddbf">PIN_BASED_VM_EXECUTION_CONTROLS_VIRTUAL_NMI</a>&#160;&#160;&#160;0x00000020</td></tr>
<tr class="separator:a864408c647028df204a4a0b66faaddbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede75c15664ad00acc9066a873396490" id="r_aede75c15664ad00acc9066a873396490"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aede75c15664ad00acc9066a873396490">PIN_BASED_VM_EXECUTION_CONTROLS_ACTIVE_VMX_TIMER</a>&#160;&#160;&#160;0x00000040</td></tr>
<tr class="separator:aede75c15664ad00acc9066a873396490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb8df32693b7174c44768274510558f8" id="r_adb8df32693b7174c44768274510558f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb8df32693b7174c44768274510558f8">PIN_BASED_VM_EXECUTION_CONTROLS_PROCESS_POSTED_INTERRUPTS</a>&#160;&#160;&#160;0x00000080</td></tr>
<tr class="separator:adb8df32693b7174c44768274510558f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd1436c26499ab3fb454feae9958218" id="r_a1dd1436c26499ab3fb454feae9958218"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dd1436c26499ab3fb454feae9958218">CPU_BASED_VIRTUAL_INTR_PENDING</a>&#160;&#160;&#160;0x00000004</td></tr>
<tr class="memdesc:a1dd1436c26499ab3fb454feae9958218"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU-Based Controls.  <br /></td></tr>
<tr class="separator:a1dd1436c26499ab3fb454feae9958218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae87851aa57b7366f1333f4cb071b9455" id="r_ae87851aa57b7366f1333f4cb071b9455"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae87851aa57b7366f1333f4cb071b9455">CPU_BASED_USE_TSC_OFFSETTING</a>&#160;&#160;&#160;0x00000008</td></tr>
<tr class="separator:ae87851aa57b7366f1333f4cb071b9455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60474f038d17a94dab512015da35e481" id="r_a60474f038d17a94dab512015da35e481"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60474f038d17a94dab512015da35e481">CPU_BASED_HLT_EXITING</a>&#160;&#160;&#160;0x00000080</td></tr>
<tr class="separator:a60474f038d17a94dab512015da35e481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa42f9790ac93ed1b973a145c3249c1a0" id="r_aa42f9790ac93ed1b973a145c3249c1a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa42f9790ac93ed1b973a145c3249c1a0">CPU_BASED_INVLPG_EXITING</a>&#160;&#160;&#160;0x00000200</td></tr>
<tr class="separator:aa42f9790ac93ed1b973a145c3249c1a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a611606b027005e0fc3ceafe03f153" id="r_a41a611606b027005e0fc3ceafe03f153"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a41a611606b027005e0fc3ceafe03f153">CPU_BASED_MWAIT_EXITING</a>&#160;&#160;&#160;0x00000400</td></tr>
<tr class="separator:a41a611606b027005e0fc3ceafe03f153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6893e67fb881da687e2ba4ebd61fb133" id="r_a6893e67fb881da687e2ba4ebd61fb133"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6893e67fb881da687e2ba4ebd61fb133">CPU_BASED_RDPMC_EXITING</a>&#160;&#160;&#160;0x00000800</td></tr>
<tr class="separator:a6893e67fb881da687e2ba4ebd61fb133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eab9368296865a5158d46814919e713" id="r_a4eab9368296865a5158d46814919e713"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4eab9368296865a5158d46814919e713">CPU_BASED_RDTSC_EXITING</a>&#160;&#160;&#160;0x00001000</td></tr>
<tr class="separator:a4eab9368296865a5158d46814919e713"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad68bc6fffc74b26e6ebfac8581bcd332" id="r_ad68bc6fffc74b26e6ebfac8581bcd332"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad68bc6fffc74b26e6ebfac8581bcd332">CPU_BASED_CR3_LOAD_EXITING</a>&#160;&#160;&#160;0x00008000</td></tr>
<tr class="separator:ad68bc6fffc74b26e6ebfac8581bcd332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f342066e42fe9b57555f6d8dd4ccd1" id="r_a60f342066e42fe9b57555f6d8dd4ccd1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60f342066e42fe9b57555f6d8dd4ccd1">CPU_BASED_CR3_STORE_EXITING</a>&#160;&#160;&#160;0x00010000</td></tr>
<tr class="separator:a60f342066e42fe9b57555f6d8dd4ccd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa07f4c4a3350a840fc4645a1c196c97d" id="r_aa07f4c4a3350a840fc4645a1c196c97d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa07f4c4a3350a840fc4645a1c196c97d">CPU_BASED_CR8_LOAD_EXITING</a>&#160;&#160;&#160;0x00080000</td></tr>
<tr class="separator:aa07f4c4a3350a840fc4645a1c196c97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3535f7ac7e7cd445f77dfe9fd459140" id="r_af3535f7ac7e7cd445f77dfe9fd459140"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af3535f7ac7e7cd445f77dfe9fd459140">CPU_BASED_CR8_STORE_EXITING</a>&#160;&#160;&#160;0x00100000</td></tr>
<tr class="separator:af3535f7ac7e7cd445f77dfe9fd459140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2f20cc45f49f802d9bf7c949989cc5" id="r_aac2f20cc45f49f802d9bf7c949989cc5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac2f20cc45f49f802d9bf7c949989cc5">CPU_BASED_TPR_SHADOW</a>&#160;&#160;&#160;0x00200000</td></tr>
<tr class="separator:aac2f20cc45f49f802d9bf7c949989cc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7beca6fe5a747c0dd7cc08755295678" id="r_ae7beca6fe5a747c0dd7cc08755295678"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae7beca6fe5a747c0dd7cc08755295678">CPU_BASED_VIRTUAL_NMI_PENDING</a>&#160;&#160;&#160;0x00400000</td></tr>
<tr class="separator:ae7beca6fe5a747c0dd7cc08755295678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd5a5f8f35fdc111abbc6a30987aedc" id="r_a3cd5a5f8f35fdc111abbc6a30987aedc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3cd5a5f8f35fdc111abbc6a30987aedc">CPU_BASED_MOV_DR_EXITING</a>&#160;&#160;&#160;0x00800000</td></tr>
<tr class="separator:a3cd5a5f8f35fdc111abbc6a30987aedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf21c8c27214ceb274c1489c9319920" id="r_a2cf21c8c27214ceb274c1489c9319920"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2cf21c8c27214ceb274c1489c9319920">CPU_BASED_UNCOND_IO_EXITING</a>&#160;&#160;&#160;0x01000000</td></tr>
<tr class="separator:a2cf21c8c27214ceb274c1489c9319920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f15b5f2b70043c3d47d03a742046b37" id="r_a7f15b5f2b70043c3d47d03a742046b37"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7f15b5f2b70043c3d47d03a742046b37">CPU_BASED_ACTIVATE_IO_BITMAP</a>&#160;&#160;&#160;0x02000000</td></tr>
<tr class="separator:a7f15b5f2b70043c3d47d03a742046b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a72b08c32dd84d5f43f140ecf0a4c5e" id="r_a7a72b08c32dd84d5f43f140ecf0a4c5e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a72b08c32dd84d5f43f140ecf0a4c5e">CPU_BASED_MONITOR_TRAP_FLAG</a>&#160;&#160;&#160;0x08000000</td></tr>
<tr class="separator:a7a72b08c32dd84d5f43f140ecf0a4c5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42bb1d6f6f8fa8572ddb3f8df18a701a" id="r_a42bb1d6f6f8fa8572ddb3f8df18a701a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a42bb1d6f6f8fa8572ddb3f8df18a701a">CPU_BASED_ACTIVATE_MSR_BITMAP</a>&#160;&#160;&#160;0x10000000</td></tr>
<tr class="separator:a42bb1d6f6f8fa8572ddb3f8df18a701a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1374882c7e2780bdb82ceb2f43a0820d" id="r_a1374882c7e2780bdb82ceb2f43a0820d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1374882c7e2780bdb82ceb2f43a0820d">CPU_BASED_MONITOR_EXITING</a>&#160;&#160;&#160;0x20000000</td></tr>
<tr class="separator:a1374882c7e2780bdb82ceb2f43a0820d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac906ba4a809205bc5904e9ec052343f1" id="r_ac906ba4a809205bc5904e9ec052343f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac906ba4a809205bc5904e9ec052343f1">CPU_BASED_PAUSE_EXITING</a>&#160;&#160;&#160;0x40000000</td></tr>
<tr class="separator:ac906ba4a809205bc5904e9ec052343f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71f99a8dd4674f9ee97f8e32b35eaeb3" id="r_a71f99a8dd4674f9ee97f8e32b35eaeb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71f99a8dd4674f9ee97f8e32b35eaeb3">CPU_BASED_ACTIVATE_SECONDARY_CONTROLS</a>&#160;&#160;&#160;0x80000000</td></tr>
<tr class="separator:a71f99a8dd4674f9ee97f8e32b35eaeb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa40f5d1a14ed338050356b51f0025153" id="r_aa40f5d1a14ed338050356b51f0025153"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa40f5d1a14ed338050356b51f0025153">CPU_BASED_CTL2_ENABLE_EPT</a>&#160;&#160;&#160;0x2</td></tr>
<tr class="memdesc:aa40f5d1a14ed338050356b51f0025153"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secondary CPU-Based Controls.  <br /></td></tr>
<tr class="separator:aa40f5d1a14ed338050356b51f0025153"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac78db8d29730368dc077dd82da21eb1b" id="r_ac78db8d29730368dc077dd82da21eb1b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac78db8d29730368dc077dd82da21eb1b">CPU_BASED_CTL2_RDTSCP</a>&#160;&#160;&#160;0x8</td></tr>
<tr class="separator:ac78db8d29730368dc077dd82da21eb1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06cc6a733e6b312ad98c4fce6a1725fc" id="r_a06cc6a733e6b312ad98c4fce6a1725fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a06cc6a733e6b312ad98c4fce6a1725fc">CPU_BASED_CTL2_ENABLE_VPID</a>&#160;&#160;&#160;0x20</td></tr>
<tr class="separator:a06cc6a733e6b312ad98c4fce6a1725fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ebbb7e61e133829f6a0c1fa2428c032" id="r_a6ebbb7e61e133829f6a0c1fa2428c032"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ebbb7e61e133829f6a0c1fa2428c032">CPU_BASED_CTL2_UNRESTRICTED_GUEST</a>&#160;&#160;&#160;0x80</td></tr>
<tr class="separator:a6ebbb7e61e133829f6a0c1fa2428c032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fdb7960ebb7fa64d1822113226a22a1" id="r_a3fdb7960ebb7fa64d1822113226a22a1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3fdb7960ebb7fa64d1822113226a22a1">CPU_BASED_CTL2_VIRTUAL_INTERRUPT_DELIVERY</a>&#160;&#160;&#160;0x200</td></tr>
<tr class="separator:a3fdb7960ebb7fa64d1822113226a22a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e94f9d45b269be9ef16c312c018e33" id="r_a85e94f9d45b269be9ef16c312c018e33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85e94f9d45b269be9ef16c312c018e33">CPU_BASED_CTL2_ENABLE_INVPCID</a>&#160;&#160;&#160;0x1000</td></tr>
<tr class="separator:a85e94f9d45b269be9ef16c312c018e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af16f9fa517c3697fd98f842bf089b4df" id="r_af16f9fa517c3697fd98f842bf089b4df"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af16f9fa517c3697fd98f842bf089b4df">CPU_BASED_CTL2_ENABLE_VMFUNC</a>&#160;&#160;&#160;0x2000</td></tr>
<tr class="separator:af16f9fa517c3697fd98f842bf089b4df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835548efc131eb7e819b19001ca40847" id="r_a835548efc131eb7e819b19001ca40847"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a835548efc131eb7e819b19001ca40847">CPU_BASED_CTL2_ENABLE_XSAVE_XRSTORS</a>&#160;&#160;&#160;0x100000</td></tr>
<tr class="separator:a835548efc131eb7e819b19001ca40847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42210f2cb26e1127e8ef20b5b8cf115" id="r_ac42210f2cb26e1127e8ef20b5b8cf115"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac42210f2cb26e1127e8ef20b5b8cf115">VM_EXIT_SAVE_DEBUG_CONTROLS</a>&#160;&#160;&#160;0x00000004</td></tr>
<tr class="memdesc:ac42210f2cb26e1127e8ef20b5b8cf115"><td class="mdescLeft">&#160;</td><td class="mdescRight">VM-exit Control Bits.  <br /></td></tr>
<tr class="separator:ac42210f2cb26e1127e8ef20b5b8cf115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7023237efbd3a07d3187483b52550dcf" id="r_a7023237efbd3a07d3187483b52550dcf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7023237efbd3a07d3187483b52550dcf">VM_EXIT_HOST_ADDR_SPACE_SIZE</a>&#160;&#160;&#160;0x00000200</td></tr>
<tr class="separator:a7023237efbd3a07d3187483b52550dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd336a187ef0ec0d9520dddf8a7f2aa0" id="r_abd336a187ef0ec0d9520dddf8a7f2aa0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abd336a187ef0ec0d9520dddf8a7f2aa0">VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL</a>&#160;&#160;&#160;0x00001000</td></tr>
<tr class="separator:abd336a187ef0ec0d9520dddf8a7f2aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6148ea349dbcbbe50eeae1429664332" id="r_ae6148ea349dbcbbe50eeae1429664332"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6148ea349dbcbbe50eeae1429664332">VM_EXIT_ACK_INTR_ON_EXIT</a>&#160;&#160;&#160;0x00008000</td></tr>
<tr class="separator:ae6148ea349dbcbbe50eeae1429664332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19ce7d9782f2a7c3e9fee9e7c339300e" id="r_a19ce7d9782f2a7c3e9fee9e7c339300e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a19ce7d9782f2a7c3e9fee9e7c339300e">VM_EXIT_SAVE_IA32_PAT</a>&#160;&#160;&#160;0x00040000</td></tr>
<tr class="separator:a19ce7d9782f2a7c3e9fee9e7c339300e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afff390f52c7b350f97a3485b384c669b" id="r_afff390f52c7b350f97a3485b384c669b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afff390f52c7b350f97a3485b384c669b">VM_EXIT_LOAD_IA32_PAT</a>&#160;&#160;&#160;0x00080000</td></tr>
<tr class="separator:afff390f52c7b350f97a3485b384c669b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90a6b8fc528e099c6f0c614d09ad9931" id="r_a90a6b8fc528e099c6f0c614d09ad9931"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a90a6b8fc528e099c6f0c614d09ad9931">VM_EXIT_SAVE_IA32_EFER</a>&#160;&#160;&#160;0x00100000</td></tr>
<tr class="separator:a90a6b8fc528e099c6f0c614d09ad9931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad30ebcdf092fe34e9abf6fb9d41b0157" id="r_ad30ebcdf092fe34e9abf6fb9d41b0157"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad30ebcdf092fe34e9abf6fb9d41b0157">VM_EXIT_LOAD_IA32_EFER</a>&#160;&#160;&#160;0x00200000</td></tr>
<tr class="separator:ad30ebcdf092fe34e9abf6fb9d41b0157"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0abfa1d586d79c2eeb19ea609d79236" id="r_ab0abfa1d586d79c2eeb19ea609d79236"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab0abfa1d586d79c2eeb19ea609d79236">VM_EXIT_SAVE_VMX_PREEMPTION_TIMER</a>&#160;&#160;&#160;0x00400000</td></tr>
<tr class="separator:ab0abfa1d586d79c2eeb19ea609d79236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57df7bf8afcf8788ba0a8fd3d4c43889" id="r_a57df7bf8afcf8788ba0a8fd3d4c43889"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57df7bf8afcf8788ba0a8fd3d4c43889">VM_ENTRY_LOAD_DEBUG_CONTROLS</a>&#160;&#160;&#160;0x00000004</td></tr>
<tr class="memdesc:a57df7bf8afcf8788ba0a8fd3d4c43889"><td class="mdescLeft">&#160;</td><td class="mdescRight">VM-entry Control Bits.  <br /></td></tr>
<tr class="separator:a57df7bf8afcf8788ba0a8fd3d4c43889"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab380f7803e1fa5a6d8c2fe25e72fe4f9" id="r_ab380f7803e1fa5a6d8c2fe25e72fe4f9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab380f7803e1fa5a6d8c2fe25e72fe4f9">VM_ENTRY_IA32E_MODE</a>&#160;&#160;&#160;0x00000200</td></tr>
<tr class="separator:ab380f7803e1fa5a6d8c2fe25e72fe4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5256487ee5c504b1417efab4995ea6" id="r_a1a5256487ee5c504b1417efab4995ea6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1a5256487ee5c504b1417efab4995ea6">VM_ENTRY_SMM</a>&#160;&#160;&#160;0x00000400</td></tr>
<tr class="separator:a1a5256487ee5c504b1417efab4995ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7167e984269bb155ec8d7c8779741d9" id="r_af7167e984269bb155ec8d7c8779741d9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af7167e984269bb155ec8d7c8779741d9">VM_ENTRY_DEACT_DUAL_MONITOR</a>&#160;&#160;&#160;0x00000800</td></tr>
<tr class="separator:af7167e984269bb155ec8d7c8779741d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b92c5aa61fe09b4a1df42a795981b3f" id="r_a1b92c5aa61fe09b4a1df42a795981b3f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b92c5aa61fe09b4a1df42a795981b3f">VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL</a>&#160;&#160;&#160;0x00002000</td></tr>
<tr class="separator:a1b92c5aa61fe09b4a1df42a795981b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada36b6f289f49754165cbbb6091c1eb5" id="r_ada36b6f289f49754165cbbb6091c1eb5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ada36b6f289f49754165cbbb6091c1eb5">VM_ENTRY_LOAD_IA32_PAT</a>&#160;&#160;&#160;0x00004000</td></tr>
<tr class="separator:ada36b6f289f49754165cbbb6091c1eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92eb09bb4e3344efcdb3616970da1cf4" id="r_a92eb09bb4e3344efcdb3616970da1cf4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a92eb09bb4e3344efcdb3616970da1cf4">VM_ENTRY_LOAD_IA32_EFER</a>&#160;&#160;&#160;0x00008000</td></tr>
<tr class="separator:a92eb09bb4e3344efcdb3616970da1cf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad84dbb2175cf41cac55aaa2c1752bcf" id="r_aad84dbb2175cf41cac55aaa2c1752bcf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad84dbb2175cf41cac55aaa2c1752bcf">HYPERV_CPUID_VENDOR_AND_MAX_FUNCTIONS</a>&#160;&#160;&#160;0x40000000</td></tr>
<tr class="memdesc:aad84dbb2175cf41cac55aaa2c1752bcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPUID RCX(s) - Based on Hyper-V.  <br /></td></tr>
<tr class="separator:aad84dbb2175cf41cac55aaa2c1752bcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa085d0743946eb61ab8c5f5e4a700400" id="r_aa085d0743946eb61ab8c5f5e4a700400"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa085d0743946eb61ab8c5f5e4a700400">HYPERV_CPUID_INTERFACE</a>&#160;&#160;&#160;0x40000001</td></tr>
<tr class="separator:aa085d0743946eb61ab8c5f5e4a700400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98fbd42d49fce1098aa1b6907fd20a5c" id="r_a98fbd42d49fce1098aa1b6907fd20a5c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98fbd42d49fce1098aa1b6907fd20a5c">HYPERV_CPUID_VERSION</a>&#160;&#160;&#160;0x40000002</td></tr>
<tr class="separator:a98fbd42d49fce1098aa1b6907fd20a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a3e344a35c993edf2405a79e02f2a80" id="r_a2a3e344a35c993edf2405a79e02f2a80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2a3e344a35c993edf2405a79e02f2a80">HYPERV_CPUID_FEATURES</a>&#160;&#160;&#160;0x40000003</td></tr>
<tr class="separator:a2a3e344a35c993edf2405a79e02f2a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49cced4483477342657360ed13256244" id="r_a49cced4483477342657360ed13256244"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a49cced4483477342657360ed13256244">HYPERV_CPUID_ENLIGHTMENT_INFO</a>&#160;&#160;&#160;0x40000004</td></tr>
<tr class="separator:a49cced4483477342657360ed13256244"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e9525851e20ce72ca856558e88a866" id="r_ac8e9525851e20ce72ca856558e88a866"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac8e9525851e20ce72ca856558e88a866">HYPERV_CPUID_IMPLEMENT_LIMITS</a>&#160;&#160;&#160;0x40000005</td></tr>
<tr class="separator:ac8e9525851e20ce72ca856558e88a866"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf955b30321d11973faeeec0cde3a34b" id="r_aaf955b30321d11973faeeec0cde3a34b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf955b30321d11973faeeec0cde3a34b">HYPERV_HYPERVISOR_PRESENT_BIT</a>&#160;&#160;&#160;0x80000000</td></tr>
<tr class="separator:aaf955b30321d11973faeeec0cde3a34b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88efb28159b58d56c5ce8e01f8c57be7" id="r_a88efb28159b58d56c5ce8e01f8c57be7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a88efb28159b58d56c5ce8e01f8c57be7">HYPERV_CPUID_MIN</a>&#160;&#160;&#160;0x40000005</td></tr>
<tr class="separator:a88efb28159b58d56c5ce8e01f8c57be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c73983a141083dc2ed193ad144e8734" id="r_a0c73983a141083dc2ed193ad144e8734"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0c73983a141083dc2ed193ad144e8734">HYPERV_CPUID_MAX</a>&#160;&#160;&#160;0x4000ffff</td></tr>
<tr class="separator:a0c73983a141083dc2ed193ad144e8734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0326d909e0ef800c6b526d000263f2f1" id="r_a0326d909e0ef800c6b526d000263f2f1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0326d909e0ef800c6b526d000263f2f1">GUEST_INTR_STATE_STI</a>&#160;&#160;&#160;0x00000001</td></tr>
<tr class="memdesc:a0326d909e0ef800c6b526d000263f2f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">GUEST_INTERRUPTIBILITY_INFO flags.  <br /></td></tr>
<tr class="separator:a0326d909e0ef800c6b526d000263f2f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dd07b12db875056b98ac1b19ac2c44a" id="r_a1dd07b12db875056b98ac1b19ac2c44a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1dd07b12db875056b98ac1b19ac2c44a">GUEST_INTR_STATE_MOV_SS</a>&#160;&#160;&#160;0x00000002</td></tr>
<tr class="separator:a1dd07b12db875056b98ac1b19ac2c44a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35cbe566286f3195f33ff6c4d12be6a3" id="r_a35cbe566286f3195f33ff6c4d12be6a3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a35cbe566286f3195f33ff6c4d12be6a3">GUEST_INTR_STATE_SMI</a>&#160;&#160;&#160;0x00000004</td></tr>
<tr class="separator:a35cbe566286f3195f33ff6c4d12be6a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a1ae12aee95e29aab5fd31a3284b205" id="r_a0a1ae12aee95e29aab5fd31a3284b205"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a1ae12aee95e29aab5fd31a3284b205">GUEST_INTR_STATE_NMI</a>&#160;&#160;&#160;0x00000008</td></tr>
<tr class="separator:a0a1ae12aee95e29aab5fd31a3284b205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922c108360321f0bc820c48276fa9a0d" id="r_a922c108360321f0bc820c48276fa9a0d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a922c108360321f0bc820c48276fa9a0d">GUEST_INTR_STATE_ENCLAVE_INTR</a>&#160;&#160;&#160;0x00000010</td></tr>
<tr class="separator:a922c108360321f0bc820c48276fa9a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071decc51768aa896c3f883ed03b37c7" id="r_a071decc51768aa896c3f883ed03b37c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a071decc51768aa896c3f883ed03b37c7">SHADOW_INT_MOV_SS</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="memdesc:a071decc51768aa896c3f883ed03b37c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt shadow states.  <br /></td></tr>
<tr class="separator:a071decc51768aa896c3f883ed03b37c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a8dad6883178199ebdcccbaf91b442d" id="r_a6a8dad6883178199ebdcccbaf91b442d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a8dad6883178199ebdcccbaf91b442d">SHADOW_INT_STI</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:a6a8dad6883178199ebdcccbaf91b442d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f7cb46b6f0d6a27da192097ea21f03" id="r_ad0f7cb46b6f0d6a27da192097ea21f03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad0f7cb46b6f0d6a27da192097ea21f03">VMM_STACK_SIZE</a>&#160;&#160;&#160;0x8000</td></tr>
<tr class="memdesc:ad0f7cb46b6f0d6a27da192097ea21f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack Size.  <br /></td></tr>
<tr class="separator:ad0f7cb46b6f0d6a27da192097ea21f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36b0e66173550aa986ffa83309e245e1" id="r_a36b0e66173550aa986ffa83309e245e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a36b0e66173550aa986ffa83309e245e1">IS_VALID_DEBUG_REGISTER</a>(DebugRegister)&#160;&#160;&#160;    (((DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR0) &amp;&amp; (DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR7)) &amp;&amp; (DebugRegister != 0x00000004 &amp;&amp; DebugRegister != 0x00000005))</td></tr>
<tr class="separator:a36b0e66173550aa986ffa83309e245e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb28f9bd5c8c2e64101be81259d5bc30" id="r_adb28f9bd5c8c2e64101be81259d5bc30"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adb28f9bd5c8c2e64101be81259d5bc30">VMCS_GUEST_DEBUGCTL_HIGH</a>&#160;&#160;&#160;0x00002803</td></tr>
<tr class="separator:adb28f9bd5c8c2e64101be81259d5bc30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a281e645caa36e4bdcd12e6e5a61ab62c" id="r_a281e645caa36e4bdcd12e6e5a61ab62c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a281e645caa36e4bdcd12e6e5a61ab62c">VIRTUAL_PROCESSOR_ID</a>&#160;&#160;&#160;0x00000000</td></tr>
<tr class="separator:a281e645caa36e4bdcd12e6e5a61ab62c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae9a97844066df354446d7fc353745c73" id="r_ae9a97844066df354446d7fc353745c73"><td class="memItemLeft" align="right" valign="top">typedef union <a class="el" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9a97844066df354446d7fc353745c73">HYPERCALL_INPUT_VALUE</a></td></tr>
<tr class="memdesc:ae9a97844066df354446d7fc353745c73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hypercalls for Hyper-V.  <br /></td></tr>
<tr class="separator:ae9a97844066df354446d7fc353745c73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071211894a630f709556fdfcac4940f7" id="r_a071211894a630f709556fdfcac4940f7"><td class="memItemLeft" align="right" valign="top">typedef union <a class="el" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a071211894a630f709556fdfcac4940f7">PHYPERCALL_INPUT_VALUE</a></td></tr>
<tr class="separator:a071211894a630f709556fdfcac4940f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60071359fab58fc0ae405efb1c29e2a4" id="r_a60071359fab58fc0ae405efb1c29e2a4"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dc">_MOV_TO_DEBUG_REG</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a60071359fab58fc0ae405efb1c29e2a4">MOV_TO_DEBUG_REG</a></td></tr>
<tr class="memdesc:a60071359fab58fc0ae405efb1c29e2a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">MOV to debug registers states.  <br /></td></tr>
<tr class="separator:a60071359fab58fc0ae405efb1c29e2a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8d1c98a2b0d46295a5d5aa6a747022e8" id="r_a8d1c98a2b0d46295a5d5aa6a747022e8"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8">HYPERCALL_CODE</a> { <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634">HvSwitchVirtualAddressSpace</a> = 0x0001
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea">HvFlushVirtualAddressSpace</a> = 0x0002
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e">HvFlushVirtualAddressList</a> = 0x0003
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e">HvGetLogicalProcessorRunTime</a> = 0x0004
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b">HvCallNotifyLongSpinWait</a> = 0x0008
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a">HvCallParkedVirtualProcessors</a> = 0x0009
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c">HvCallSyntheticClusterIpi</a> = 0x000B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90">HvCallModifyVtlProtectionMask</a> = 0x000C
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32">HvCallEnablePartitionVtl</a> = 0x000D
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24">HvCallDisablePartitionVtl</a> = 0x000E
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055">HvCallEnableVpVtl</a> = 0x000F
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a">HvCallDisableVpVtl</a> = 0x0010
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576">HvCallVtlCall</a> = 0x0011
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684">HvCallVtlReturn</a> = 0x0012
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a">HvCallFlushVirtualAddressSpaceEx</a> = 0x0013
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870">HvCallFlushVirtualAddressListEx</a> = 0x0014
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa">HvCallSendSyntheticClusterIpiEx</a> = 0x0015
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d">HvCreatePartition</a> = 0x0040
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de">HvInitializePartition</a> = 0x0041
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7">HvFinalizePartition</a> = 0x0042
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372">HvDeletePartition</a> = 0x0043
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab">HvGetPartitionProperty</a> = 0x0044
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2">HvSetPartitionProperty</a> = 0x0045
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7">HvGetPartitionId</a> = 0x0046
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8">HvGetNextChildPartition</a> = 0x0047
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06">HvDepositMemory</a> = 0x0048
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8">HvWithdrawMemory</a> = 0x0049
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01">HvGetMemoryBalance</a> = 0x004A
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da">HvMapGpaPages</a> = 0x004B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8">HvUnmapGpaPages</a> = 0x004C
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af">HvInstallIntercept</a> = 0x004D
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64">HvCreateVp</a> = 0x004E
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd">HvDeleteVp</a> = 0x004F
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21">HvGetVpRegisters</a> = 0x0050
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473">HvSetVpRegisters</a> = 0x0051
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177">HvTranslateVirtualAddress</a> = 0x0052
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929">HvReadGpa</a> = 0x0053
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5">HvWriteGpa</a> = 0x0054
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9">HvClearVirtualInterrupt</a> = 0x0056
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897">HvDeletePort</a> = 0x0058
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b">HvConnectPort</a> = 0x0059
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d">HvGetPortProperty</a> = 0x005A
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9">HvDisconnectPort</a> = 0x005B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32">HvPostMessage</a> = 0x005C
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d">HvSignalEvent</a> = 0x005D
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18">HvSavePartitionState</a> = 0x005E
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09">HvRestorePartitionState</a> = 0x005F
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe">HvInitializeEventLogBufferGroup</a> = 0x0060
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d">HvFinalizeEventLogBufferGroup</a> = 0x0061
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1">HvCreateEventLogBuffer</a> = 0x0062
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2">HvDeleteEventLogBuffer</a> = 0x0063
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313">HvMapEventLogBuffer</a> = 0x0064
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f">HvUnmapEventLogBuffer</a> = 0x0065
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d">HvSetEventLogGroupSources</a> = 0x0066
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0">HvReleaseEventLogBuffer</a> = 0x0067
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb">HvFlushEventLogBuffer</a> = 0x0068
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3">HvPostDebugData</a> = 0x0069
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab">HvRetrieveDebugData</a> = 0x006A
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9">HvResetDebugSession</a> = 0x006B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe">HvMapStatsPage</a> = 0x006C
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0">HvUnmapStatsPage</a> = 0x006D
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614">HvCallMapSparseGpaPages</a> = 0x006E
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76">HvCallSetSystemProperty</a> = 0x006F
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21">HvCallSetPortProperty</a> = 0x0070
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae">HvCallAddLogicalProcessor</a> = 0x0076
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8">HvCallRemoveLogicalProcessor</a> = 0x0077
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845">HvCallQueryNumaDistance</a> = 0x0078
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a">HvCallSetLogicalProcessorProperty</a> = 0x0079
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0">HvCallGetLogicalProcessorProperty</a> = 0x007A
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529">HvCallGetSystemProperty</a> = 0x007B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5">HvCallMapDeviceInterrupt</a> = 0x007C
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f">HvCallUnmapDeviceInterrupt</a> = 0x007D
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c">HvCallRetargetDeviceInterrupt</a> = 0x007E
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27">HvCallMapDevicePages</a> = 0x0080
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d">HvCallUnmapDevicePages</a> = 0x0081
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021">HvCallAttachDevice</a> = 0x0082
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8">HvCallDetachDevice</a> = 0x0083
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac">HvCallNotifyStandbyTransition</a> = 0x0084
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3">HvCallPrepareForSleep</a> = 0x0085
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50">HvCallPrepareForHibernate</a> = 0x0086
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0">HvCallNotifyPartitionEvent</a> = 0x0087
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e">HvCallGetLogicalProcessorRegisters</a> = 0x0088
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859">HvCallSetLogicalProcessorRegisters</a> = 0x0089
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40">HvCallQueryAssotiatedLpsforMca</a> = 0x008A
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f">HvCallNotifyRingEmpty</a> = 0x008B
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb">HvCallInjectSyntheticMachineCheck</a> = 0x008C
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097">HvCallScrubPartition</a> = 0x008D
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504">HvCallCollectLivedump</a> = 0x008E
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b">HvCallDisableHypervisor</a> = 0x008F
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45">HvCallModifySparseGpaPages</a> = 0x0090
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098">HvCallRegisterInterceptResult</a> = 0x0091
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1">HvCallUnregisterInterceptResult</a> = 0x0092
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439">HvCallAssertVirtualInterrupt</a> = 0x0094
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6">HvCallCreatePort</a> = 0x0095
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3">HvCallConnectPort</a> = 0x0096
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12">HvCallGetSpaPageList</a> = 0x0097
, <br />
&#160;&#160;<a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e">HvCallStartVirtualProcessor</a> = 0x009A
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838">HvCallGetVpIndexFromApicId</a> = 0x009A
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de">HvCallFlushGuestPhysicalAddressSpace</a> = 0x00AF
, <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289">HvCallFlushGuestPhysicalAddressList</a> = 0x00B0
<br />
 }</td></tr>
<tr class="memdesc:a8d1c98a2b0d46295a5d5aa6a747022e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hyper-V Hypercalls.  <a href="#a8d1c98a2b0d46295a5d5aa6a747022e8">More...</a><br /></td></tr>
<tr class="separator:a8d1c98a2b0d46295a5d5aa6a747022e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756132f02f43ed5a1b3a25f6bd2c35dc" id="r_a756132f02f43ed5a1b3a25f6bd2c35dc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dc">_MOV_TO_DEBUG_REG</a> { <a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892">AccessToDebugRegister</a> = 0
, <a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90">AccessFromDebugRegister</a> = 1
 }</td></tr>
<tr class="memdesc:a756132f02f43ed5a1b3a25f6bd2c35dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">MOV to debug registers states.  <a href="#a756132f02f43ed5a1b3a25f6bd2c35dc">More...</a><br /></td></tr>
<tr class="separator:a756132f02f43ed5a1b3a25f6bd2c35dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a493c5a273fefd9ceeb520720225f7a47" id="r_a493c5a273fefd9ceeb520720225f7a47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a493c5a273fefd9ceeb520720225f7a47">VmxVmread64</a> (size_t Field, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> FieldValue)</td></tr>
<tr class="memdesc:a493c5a273fefd9ceeb520720225f7a47"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (64-bit)  <br /></td></tr>
<tr class="separator:a493c5a273fefd9ceeb520720225f7a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4a5eb82be7c9c58ea15cb6fd7f001f" id="r_a7a4a5eb82be7c9c58ea15cb6fd7f001f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a4a5eb82be7c9c58ea15cb6fd7f001f">VmxVmread32</a> (size_t Field, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> FieldValue)</td></tr>
<tr class="memdesc:a7a4a5eb82be7c9c58ea15cb6fd7f001f"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (32-bit)  <br /></td></tr>
<tr class="separator:a7a4a5eb82be7c9c58ea15cb6fd7f001f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a01d1262cb49acf2a4e3d52c9143f7" id="r_ae6a01d1262cb49acf2a4e3d52c9143f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6a01d1262cb49acf2a4e3d52c9143f7">VmxVmread16</a> (size_t Field, <a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> FieldValue)</td></tr>
<tr class="memdesc:ae6a01d1262cb49acf2a4e3d52c9143f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (16-bit)  <br /></td></tr>
<tr class="separator:ae6a01d1262cb49acf2a4e3d52c9143f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a030c9345db1d1e6cdf76c3289f5090d9" id="r_a030c9345db1d1e6cdf76c3289f5090d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a030c9345db1d1e6cdf76c3289f5090d9">VmxVmread64P</a> (size_t Field, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *FieldValue)</td></tr>
<tr class="memdesc:a030c9345db1d1e6cdf76c3289f5090d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (64-bit)  <br /></td></tr>
<tr class="separator:a030c9345db1d1e6cdf76c3289f5090d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af411da3719b3f7f9198be1b8bc6c6874" id="r_af411da3719b3f7f9198be1b8bc6c6874"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af411da3719b3f7f9198be1b8bc6c6874">VmxVmread32P</a> (size_t Field, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *FieldValue)</td></tr>
<tr class="memdesc:af411da3719b3f7f9198be1b8bc6c6874"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (32-bit)  <br /></td></tr>
<tr class="separator:af411da3719b3f7f9198be1b8bc6c6874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9a2488785132e5580df49c20fd1443" id="r_a0b9a2488785132e5580df49c20fd1443"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0b9a2488785132e5580df49c20fd1443">VmxVmread16P</a> (size_t Field, <a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *FieldValue)</td></tr>
<tr class="memdesc:a0b9a2488785132e5580df49c20fd1443"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMREAD instruction (16-bit)  <br /></td></tr>
<tr class="separator:a0b9a2488785132e5580df49c20fd1443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b2ff5571ba424d03e622b3802e8e5a" id="r_a14b2ff5571ba424d03e622b3802e8e5a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a14b2ff5571ba424d03e622b3802e8e5a">VmxVmwrite64</a> (size_t Field, <a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> FieldValue)</td></tr>
<tr class="memdesc:a14b2ff5571ba424d03e622b3802e8e5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMWRITE instruction (64-bit)  <br /></td></tr>
<tr class="separator:a14b2ff5571ba424d03e622b3802e8e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefab869ab11279e141c6ff3d2ace3c5f" id="r_aefab869ab11279e141c6ff3d2ace3c5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aefab869ab11279e141c6ff3d2ace3c5f">VmxVmwrite32</a> (size_t Field, <a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> FieldValue)</td></tr>
<tr class="memdesc:aefab869ab11279e141c6ff3d2ace3c5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMWRITE instruction (32-bit)  <br /></td></tr>
<tr class="separator:aefab869ab11279e141c6ff3d2ace3c5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb0f8482f465f2cce15041fe008f559" id="r_a5eb0f8482f465f2cce15041fe008f559"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5eb0f8482f465f2cce15041fe008f559">VmxVmwrite16</a> (size_t Field, <a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> FieldValue)</td></tr>
<tr class="memdesc:a5eb0f8482f465f2cce15041fe008f559"><td class="mdescLeft">&#160;</td><td class="mdescRight">VMX VMWRITE instruction (16-bit)  <br /></td></tr>
<tr class="separator:a5eb0f8482f465f2cce15041fe008f559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099f2c93689489c8a4117c8f6648efc1" id="r_a099f2c93689489c8a4117c8f6648efc1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a099f2c93689489c8a4117c8f6648efc1">VmxVmptrst</a> ()</td></tr>
<tr class="memdesc:a099f2c93689489c8a4117c8f6648efc1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementation of VMPTRST instruction.  <br /></td></tr>
<tr class="separator:a099f2c93689489c8a4117c8f6648efc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78415dd94deee3861f8cdfe695331aa9" id="r_a78415dd94deee3861f8cdfe695331aa9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a78415dd94deee3861f8cdfe695331aa9">VmxVmresume</a> ()</td></tr>
<tr class="memdesc:a78415dd94deee3861f8cdfe695331aa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume VM using VMRESUME instruction.  <br /></td></tr>
<tr class="separator:a78415dd94deee3861f8cdfe695331aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9193ed1677033cd08c5d5b7788b15c7" id="r_ad9193ed1677033cd08c5d5b7788b15c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad9193ed1677033cd08c5d5b7788b15c7">VmxVmxoff</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ad9193ed1677033cd08c5d5b7788b15c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare and execute Vmxoff instruction.  <br /></td></tr>
<tr class="separator:ad9193ed1677033cd08c5d5b7788b15c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbbc35bf970ac6b655e08bc3c0f46905" id="r_abbbc35bf970ac6b655e08bc3c0f46905"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abbbc35bf970ac6b655e08bc3c0f46905">VmxCheckVmxSupport</a> ()</td></tr>
<tr class="memdesc:abbbc35bf970ac6b655e08bc3c0f46905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check whether VMX Feature is supported or not.  <br /></td></tr>
<tr class="separator:abbbc35bf970ac6b655e08bc3c0f46905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8edcdeb74c24f1408eca2daf1ce986a" id="r_ae8edcdeb74c24f1408eca2daf1ce986a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8edcdeb74c24f1408eca2daf1ce986a">VmxInitialize</a> ()</td></tr>
<tr class="memdesc:ae8edcdeb74c24f1408eca2daf1ce986a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the VMX operation.  <br /></td></tr>
<tr class="separator:ae8edcdeb74c24f1408eca2daf1ce986a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a412b9cc437ccd62987c8f5a01e0a3f2d" id="r_a412b9cc437ccd62987c8f5a01e0a3f2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a412b9cc437ccd62987c8f5a01e0a3f2d">VmxPerformVirtualizationOnAllCores</a> ()</td></tr>
<tr class="memdesc:a412b9cc437ccd62987c8f5a01e0a3f2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize essential VMX Operation tasks.  <br /></td></tr>
<tr class="separator:a412b9cc437ccd62987c8f5a01e0a3f2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae683fd4d4ecd99c28292045bc8a65e18" id="r_ae683fd4d4ecd99c28292045bc8a65e18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae683fd4d4ecd99c28292045bc8a65e18">VmxTerminate</a> ()</td></tr>
<tr class="memdesc:ae683fd4d4ecd99c28292045bc8a65e18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Broadcast to terminate VMX on all logical cores.  <br /></td></tr>
<tr class="separator:ae683fd4d4ecd99c28292045bc8a65e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8cf05fd265cf9568bc5f3b1ee57897" id="r_a3f8cf05fd265cf9568bc5f3b1ee57897"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f8cf05fd265cf9568bc5f3b1ee57897">VmxPerformTermination</a> ()</td></tr>
<tr class="memdesc:a3f8cf05fd265cf9568bc5f3b1ee57897"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminate Vmx on all logical cores.  <br /></td></tr>
<tr class="separator:a3f8cf05fd265cf9568bc5f3b1ee57897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac31024ae20ebac7de8789baa1e29ab1d" id="r_ac31024ae20ebac7de8789baa1e29ab1d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac31024ae20ebac7de8789baa1e29ab1d">VmxHandleXsetbv</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:ac31024ae20ebac7de8789baa1e29ab1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling XSETBV Instruction vm-exits.  <br /></td></tr>
<tr class="separator:ac31024ae20ebac7de8789baa1e29ab1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d722cd80873651fe42d3af85b812622" id="r_a7d722cd80873651fe42d3af85b812622"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7d722cd80873651fe42d3af85b812622">VmxHandleVmxPreemptionTimerVmexit</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a7d722cd80873651fe42d3af85b812622"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling VMX Preemption Timer vm-exits.  <br /></td></tr>
<tr class="separator:a7d722cd80873651fe42d3af85b812622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27cfa5f4da41fd687cdcb7e4f0054db6" id="r_a27cfa5f4da41fd687cdcb7e4f0054db6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a27cfa5f4da41fd687cdcb7e4f0054db6">VmxHandleTripleFaults</a> (<a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="memdesc:a27cfa5f4da41fd687cdcb7e4f0054db6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handling triple fault VM-exits.  <br /></td></tr>
<tr class="separator:a27cfa5f4da41fd687cdcb7e4f0054db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7d79ec1775eef01d11b05fd316b7eb7" id="r_ad7d79ec1775eef01d11b05fd316b7eb7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad7d79ec1775eef01d11b05fd316b7eb7">VmxPerformVirtualizationOnSpecificCore</a> ()</td></tr>
<tr class="memdesc:ad7d79ec1775eef01d11b05fd316b7eb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates Vmx regions for all logical cores (Vmxon region and Vmcs region)  <br /></td></tr>
<tr class="separator:ad7d79ec1775eef01d11b05fd316b7eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56536723aab6c8ccb4719ff1eac2c25f" id="r_a56536723aab6c8ccb4719ff1eac2c25f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56536723aab6c8ccb4719ff1eac2c25f">VmxFixCr4AndCr0Bits</a> ()</td></tr>
<tr class="memdesc:a56536723aab6c8ccb4719ff1eac2c25f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fix values for cr0 and cr4 bits.  <br /></td></tr>
<tr class="separator:a56536723aab6c8ccb4719ff1eac2c25f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0820b4fac62ab43454e3bc79642d00a" id="r_aa0820b4fac62ab43454e3bc79642d00a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa0820b4fac62ab43454e3bc79642d00a">VmxLoadVmcs</a> (_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="separator:aa0820b4fac62ab43454e3bc79642d00a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa464d719d6326915cc99171ae800abe7" id="r_aa464d719d6326915cc99171ae800abe7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa464d719d6326915cc99171ae800abe7">VmxClearVmcsState</a> (_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu)</td></tr>
<tr class="separator:aa464d719d6326915cc99171ae800abe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1383bf1b0ee0da71f29e832a1e86144" id="r_ae1383bf1b0ee0da71f29e832a1e86144"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1383bf1b0ee0da71f29e832a1e86144">VmxCheckIsOnVmxRoot</a> ()</td></tr>
<tr class="memdesc:ae1383bf1b0ee0da71f29e832a1e86144"><td class="mdescLeft">&#160;</td><td class="mdescRight">It can deterministically check whether the caller is on vmx-root mode or not.  <br /></td></tr>
<tr class="separator:ae1383bf1b0ee0da71f29e832a1e86144"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af666da6f076709f466795cf1627d5e94" id="r_af666da6f076709f466795cf1627d5e94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af666da6f076709f466795cf1627d5e94">VmxVirtualizeCurrentSystem</a> (PVOID GuestStack)</td></tr>
<tr class="memdesc:af666da6f076709f466795cf1627d5e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize VMX Operation.  <br /></td></tr>
<tr class="separator:af666da6f076709f466795cf1627d5e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3deacf9df5781113357db7b2ee25aa90" id="r_a3deacf9df5781113357db7b2ee25aa90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3deacf9df5781113357db7b2ee25aa90">VmxSetupVmcs</a> (_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *VCpu, _In_ PVOID GuestStack)</td></tr>
<tr class="separator:a3deacf9df5781113357db7b2ee25aa90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1493a49dc1f387ee57f95207869ad3b4" id="r_a1493a49dc1f387ee57f95207869ad3b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1493a49dc1f387ee57f95207869ad3b4">VmxReturnStackPointerForVmxoff</a> ()</td></tr>
<tr class="memdesc:a1493a49dc1f387ee57f95207869ad3b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the RIP of guest (VMCS_GUEST_RIP) in the case of return from VMXOFF.  <br /></td></tr>
<tr class="separator:a1493a49dc1f387ee57f95207869ad3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a121be6f80493612573f2177d8a17424e" id="r_a121be6f80493612573f2177d8a17424e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a121be6f80493612573f2177d8a17424e">VmxReturnInstructionPointerForVmxoff</a> ()</td></tr>
<tr class="memdesc:a121be6f80493612573f2177d8a17424e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the RIP of guest (VMCS_GUEST_RIP) in the case of return from VMXOFF.  <br /></td></tr>
<tr class="separator:a121be6f80493612573f2177d8a17424e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21a5facaf10e8fbeb70dd00942e51ef1" id="r_a21a5facaf10e8fbeb70dd00942e51ef1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21a5facaf10e8fbeb70dd00942e51ef1">VmxGetCurrentExecutionMode</a> ()</td></tr>
<tr class="memdesc:a21a5facaf10e8fbeb70dd00942e51ef1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check current execution mode (vmx-root and non-root)  <br /></td></tr>
<tr class="separator:a21a5facaf10e8fbeb70dd00942e51ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54291454c7d99c90bf5e19a939825634" id="r_a54291454c7d99c90bf5e19a939825634"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a54291454c7d99c90bf5e19a939825634">VmxGetCurrentLaunchState</a> ()</td></tr>
<tr class="memdesc:a54291454c7d99c90bf5e19a939825634"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the VMX is launched or not.  <br /></td></tr>
<tr class="separator:a54291454c7d99c90bf5e19a939825634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84a3bd5efc8ff0858c095e18fe0999da" id="r_a84a3bd5efc8ff0858c095e18fe0999da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a84a3bd5efc8ff0858c095e18fe0999da">VmxCompatibleStrlen</a> (const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *<a class="el" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>)</td></tr>
<tr class="memdesc:a84a3bd5efc8ff0858c095e18fe0999da"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of vmx-root mode compatible strlen  <br /></td></tr>
<tr class="separator:a84a3bd5efc8ff0858c095e18fe0999da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2e419641070da1b794c2c62e691cc3" id="r_a2e2e419641070da1b794c2c62e691cc3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2e2e419641070da1b794c2c62e691cc3">VmxCompatibleWcslen</a> (const wchar_t *<a class="el" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>)</td></tr>
<tr class="memdesc:a2e2e419641070da1b794c2c62e691cc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of vmx-root mode compatible wcslen  <br /></td></tr>
<tr class="separator:a2e2e419641070da1b794c2c62e691cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ec232fccf5297d44af914b19fd9cee" id="r_aa4ec232fccf5297d44af914b19fd9cee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa4ec232fccf5297d44af914b19fd9cee">VmxCompatibleStrcmp</a> (const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Address1, const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Address2, SIZE_T Num, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsStrncmp)</td></tr>
<tr class="memdesc:aa4ec232fccf5297d44af914b19fd9cee"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of vmx-root mode compatible strcmp and strncmp  <br /></td></tr>
<tr class="separator:aa4ec232fccf5297d44af914b19fd9cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57357ebeb98175ca5326f1bfe8490ee4" id="r_a57357ebeb98175ca5326f1bfe8490ee4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a57357ebeb98175ca5326f1bfe8490ee4">VmxCompatibleWcscmp</a> (const wchar_t *Address1, const wchar_t *Address2, SIZE_T Num, <a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsWcsncmp)</td></tr>
<tr class="memdesc:a57357ebeb98175ca5326f1bfe8490ee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of vmx-root mode compatible wcscmp and wcsncmp  <br /></td></tr>
<tr class="separator:a57357ebeb98175ca5326f1bfe8490ee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeb79732cfd7f97a1983c9b3248d69f5" id="r_aaeb79732cfd7f97a1983c9b3248d69f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaeb79732cfd7f97a1983c9b3248d69f5">VmxCompatibleMemcmp</a> (const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Address1, const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *Address2, size_t Count)</td></tr>
<tr class="memdesc:aaeb79732cfd7f97a1983c9b3248d69f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">implementation of vmx-root mode compatible memcmp  <br /></td></tr>
<tr class="separator:aaeb79732cfd7f97a1983c9b3248d69f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>VMX Instruction and operation headers. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-04-11</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7f15b5f2b70043c3d47d03a742046b37" name="a7f15b5f2b70043c3d47d03a742046b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f15b5f2b70043c3d47d03a742046b37">&#9670;&#160;</a></span>CPU_BASED_ACTIVATE_IO_BITMAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_ACTIVATE_IO_BITMAP&#160;&#160;&#160;0x02000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a42bb1d6f6f8fa8572ddb3f8df18a701a" name="a42bb1d6f6f8fa8572ddb3f8df18a701a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42bb1d6f6f8fa8572ddb3f8df18a701a">&#9670;&#160;</a></span>CPU_BASED_ACTIVATE_MSR_BITMAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_ACTIVATE_MSR_BITMAP&#160;&#160;&#160;0x10000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a71f99a8dd4674f9ee97f8e32b35eaeb3" name="a71f99a8dd4674f9ee97f8e32b35eaeb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71f99a8dd4674f9ee97f8e32b35eaeb3">&#9670;&#160;</a></span>CPU_BASED_ACTIVATE_SECONDARY_CONTROLS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_ACTIVATE_SECONDARY_CONTROLS&#160;&#160;&#160;0x80000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad68bc6fffc74b26e6ebfac8581bcd332" name="ad68bc6fffc74b26e6ebfac8581bcd332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad68bc6fffc74b26e6ebfac8581bcd332">&#9670;&#160;</a></span>CPU_BASED_CR3_LOAD_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CR3_LOAD_EXITING&#160;&#160;&#160;0x00008000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a60f342066e42fe9b57555f6d8dd4ccd1" name="a60f342066e42fe9b57555f6d8dd4ccd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60f342066e42fe9b57555f6d8dd4ccd1">&#9670;&#160;</a></span>CPU_BASED_CR3_STORE_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CR3_STORE_EXITING&#160;&#160;&#160;0x00010000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa07f4c4a3350a840fc4645a1c196c97d" name="aa07f4c4a3350a840fc4645a1c196c97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa07f4c4a3350a840fc4645a1c196c97d">&#9670;&#160;</a></span>CPU_BASED_CR8_LOAD_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CR8_LOAD_EXITING&#160;&#160;&#160;0x00080000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af3535f7ac7e7cd445f77dfe9fd459140" name="af3535f7ac7e7cd445f77dfe9fd459140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3535f7ac7e7cd445f77dfe9fd459140">&#9670;&#160;</a></span>CPU_BASED_CR8_STORE_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CR8_STORE_EXITING&#160;&#160;&#160;0x00100000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa40f5d1a14ed338050356b51f0025153" name="aa40f5d1a14ed338050356b51f0025153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa40f5d1a14ed338050356b51f0025153">&#9670;&#160;</a></span>CPU_BASED_CTL2_ENABLE_EPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_ENABLE_EPT&#160;&#160;&#160;0x2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Secondary CPU-Based Controls. </p>

</div>
</div>
<a id="a85e94f9d45b269be9ef16c312c018e33" name="a85e94f9d45b269be9ef16c312c018e33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85e94f9d45b269be9ef16c312c018e33">&#9670;&#160;</a></span>CPU_BASED_CTL2_ENABLE_INVPCID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_ENABLE_INVPCID&#160;&#160;&#160;0x1000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af16f9fa517c3697fd98f842bf089b4df" name="af16f9fa517c3697fd98f842bf089b4df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af16f9fa517c3697fd98f842bf089b4df">&#9670;&#160;</a></span>CPU_BASED_CTL2_ENABLE_VMFUNC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_ENABLE_VMFUNC&#160;&#160;&#160;0x2000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06cc6a733e6b312ad98c4fce6a1725fc" name="a06cc6a733e6b312ad98c4fce6a1725fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06cc6a733e6b312ad98c4fce6a1725fc">&#9670;&#160;</a></span>CPU_BASED_CTL2_ENABLE_VPID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_ENABLE_VPID&#160;&#160;&#160;0x20</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a835548efc131eb7e819b19001ca40847" name="a835548efc131eb7e819b19001ca40847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835548efc131eb7e819b19001ca40847">&#9670;&#160;</a></span>CPU_BASED_CTL2_ENABLE_XSAVE_XRSTORS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_ENABLE_XSAVE_XRSTORS&#160;&#160;&#160;0x100000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac78db8d29730368dc077dd82da21eb1b" name="ac78db8d29730368dc077dd82da21eb1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac78db8d29730368dc077dd82da21eb1b">&#9670;&#160;</a></span>CPU_BASED_CTL2_RDTSCP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_RDTSCP&#160;&#160;&#160;0x8</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6ebbb7e61e133829f6a0c1fa2428c032" name="a6ebbb7e61e133829f6a0c1fa2428c032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ebbb7e61e133829f6a0c1fa2428c032">&#9670;&#160;</a></span>CPU_BASED_CTL2_UNRESTRICTED_GUEST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_UNRESTRICTED_GUEST&#160;&#160;&#160;0x80</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3fdb7960ebb7fa64d1822113226a22a1" name="a3fdb7960ebb7fa64d1822113226a22a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fdb7960ebb7fa64d1822113226a22a1">&#9670;&#160;</a></span>CPU_BASED_CTL2_VIRTUAL_INTERRUPT_DELIVERY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_CTL2_VIRTUAL_INTERRUPT_DELIVERY&#160;&#160;&#160;0x200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a60474f038d17a94dab512015da35e481" name="a60474f038d17a94dab512015da35e481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60474f038d17a94dab512015da35e481">&#9670;&#160;</a></span>CPU_BASED_HLT_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_HLT_EXITING&#160;&#160;&#160;0x00000080</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa42f9790ac93ed1b973a145c3249c1a0" name="aa42f9790ac93ed1b973a145c3249c1a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa42f9790ac93ed1b973a145c3249c1a0">&#9670;&#160;</a></span>CPU_BASED_INVLPG_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_INVLPG_EXITING&#160;&#160;&#160;0x00000200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1374882c7e2780bdb82ceb2f43a0820d" name="a1374882c7e2780bdb82ceb2f43a0820d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1374882c7e2780bdb82ceb2f43a0820d">&#9670;&#160;</a></span>CPU_BASED_MONITOR_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_MONITOR_EXITING&#160;&#160;&#160;0x20000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7a72b08c32dd84d5f43f140ecf0a4c5e" name="a7a72b08c32dd84d5f43f140ecf0a4c5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a72b08c32dd84d5f43f140ecf0a4c5e">&#9670;&#160;</a></span>CPU_BASED_MONITOR_TRAP_FLAG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_MONITOR_TRAP_FLAG&#160;&#160;&#160;0x08000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3cd5a5f8f35fdc111abbc6a30987aedc" name="a3cd5a5f8f35fdc111abbc6a30987aedc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd5a5f8f35fdc111abbc6a30987aedc">&#9670;&#160;</a></span>CPU_BASED_MOV_DR_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_MOV_DR_EXITING&#160;&#160;&#160;0x00800000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a41a611606b027005e0fc3ceafe03f153" name="a41a611606b027005e0fc3ceafe03f153"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a611606b027005e0fc3ceafe03f153">&#9670;&#160;</a></span>CPU_BASED_MWAIT_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_MWAIT_EXITING&#160;&#160;&#160;0x00000400</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac906ba4a809205bc5904e9ec052343f1" name="ac906ba4a809205bc5904e9ec052343f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac906ba4a809205bc5904e9ec052343f1">&#9670;&#160;</a></span>CPU_BASED_PAUSE_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_PAUSE_EXITING&#160;&#160;&#160;0x40000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6893e67fb881da687e2ba4ebd61fb133" name="a6893e67fb881da687e2ba4ebd61fb133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6893e67fb881da687e2ba4ebd61fb133">&#9670;&#160;</a></span>CPU_BASED_RDPMC_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_RDPMC_EXITING&#160;&#160;&#160;0x00000800</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4eab9368296865a5158d46814919e713" name="a4eab9368296865a5158d46814919e713"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eab9368296865a5158d46814919e713">&#9670;&#160;</a></span>CPU_BASED_RDTSC_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_RDTSC_EXITING&#160;&#160;&#160;0x00001000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aac2f20cc45f49f802d9bf7c949989cc5" name="aac2f20cc45f49f802d9bf7c949989cc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac2f20cc45f49f802d9bf7c949989cc5">&#9670;&#160;</a></span>CPU_BASED_TPR_SHADOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_TPR_SHADOW&#160;&#160;&#160;0x00200000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2cf21c8c27214ceb274c1489c9319920" name="a2cf21c8c27214ceb274c1489c9319920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cf21c8c27214ceb274c1489c9319920">&#9670;&#160;</a></span>CPU_BASED_UNCOND_IO_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_UNCOND_IO_EXITING&#160;&#160;&#160;0x01000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae87851aa57b7366f1333f4cb071b9455" name="ae87851aa57b7366f1333f4cb071b9455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae87851aa57b7366f1333f4cb071b9455">&#9670;&#160;</a></span>CPU_BASED_USE_TSC_OFFSETTING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_USE_TSC_OFFSETTING&#160;&#160;&#160;0x00000008</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1dd1436c26499ab3fb454feae9958218" name="a1dd1436c26499ab3fb454feae9958218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd1436c26499ab3fb454feae9958218">&#9670;&#160;</a></span>CPU_BASED_VIRTUAL_INTR_PENDING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_VIRTUAL_INTR_PENDING&#160;&#160;&#160;0x00000004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CPU-Based Controls. </p>

</div>
</div>
<a id="ae7beca6fe5a747c0dd7cc08755295678" name="ae7beca6fe5a747c0dd7cc08755295678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7beca6fe5a747c0dd7cc08755295678">&#9670;&#160;</a></span>CPU_BASED_VIRTUAL_NMI_PENDING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPU_BASED_VIRTUAL_NMI_PENDING&#160;&#160;&#160;0x00400000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a922c108360321f0bc820c48276fa9a0d" name="a922c108360321f0bc820c48276fa9a0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a922c108360321f0bc820c48276fa9a0d">&#9670;&#160;</a></span>GUEST_INTR_STATE_ENCLAVE_INTR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GUEST_INTR_STATE_ENCLAVE_INTR&#160;&#160;&#160;0x00000010</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1dd07b12db875056b98ac1b19ac2c44a" name="a1dd07b12db875056b98ac1b19ac2c44a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dd07b12db875056b98ac1b19ac2c44a">&#9670;&#160;</a></span>GUEST_INTR_STATE_MOV_SS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GUEST_INTR_STATE_MOV_SS&#160;&#160;&#160;0x00000002</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0a1ae12aee95e29aab5fd31a3284b205" name="a0a1ae12aee95e29aab5fd31a3284b205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a1ae12aee95e29aab5fd31a3284b205">&#9670;&#160;</a></span>GUEST_INTR_STATE_NMI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GUEST_INTR_STATE_NMI&#160;&#160;&#160;0x00000008</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a35cbe566286f3195f33ff6c4d12be6a3" name="a35cbe566286f3195f33ff6c4d12be6a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35cbe566286f3195f33ff6c4d12be6a3">&#9670;&#160;</a></span>GUEST_INTR_STATE_SMI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GUEST_INTR_STATE_SMI&#160;&#160;&#160;0x00000004</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0326d909e0ef800c6b526d000263f2f1" name="a0326d909e0ef800c6b526d000263f2f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0326d909e0ef800c6b526d000263f2f1">&#9670;&#160;</a></span>GUEST_INTR_STATE_STI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GUEST_INTR_STATE_STI&#160;&#160;&#160;0x00000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GUEST_INTERRUPTIBILITY_INFO flags. </p>

</div>
</div>
<a id="a49cced4483477342657360ed13256244" name="a49cced4483477342657360ed13256244"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49cced4483477342657360ed13256244">&#9670;&#160;</a></span>HYPERV_CPUID_ENLIGHTMENT_INFO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_ENLIGHTMENT_INFO&#160;&#160;&#160;0x40000004</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2a3e344a35c993edf2405a79e02f2a80" name="a2a3e344a35c993edf2405a79e02f2a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a3e344a35c993edf2405a79e02f2a80">&#9670;&#160;</a></span>HYPERV_CPUID_FEATURES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_FEATURES&#160;&#160;&#160;0x40000003</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac8e9525851e20ce72ca856558e88a866" name="ac8e9525851e20ce72ca856558e88a866"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8e9525851e20ce72ca856558e88a866">&#9670;&#160;</a></span>HYPERV_CPUID_IMPLEMENT_LIMITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_IMPLEMENT_LIMITS&#160;&#160;&#160;0x40000005</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa085d0743946eb61ab8c5f5e4a700400" name="aa085d0743946eb61ab8c5f5e4a700400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa085d0743946eb61ab8c5f5e4a700400">&#9670;&#160;</a></span>HYPERV_CPUID_INTERFACE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_INTERFACE&#160;&#160;&#160;0x40000001</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0c73983a141083dc2ed193ad144e8734" name="a0c73983a141083dc2ed193ad144e8734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c73983a141083dc2ed193ad144e8734">&#9670;&#160;</a></span>HYPERV_CPUID_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_MAX&#160;&#160;&#160;0x4000ffff</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a88efb28159b58d56c5ce8e01f8c57be7" name="a88efb28159b58d56c5ce8e01f8c57be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88efb28159b58d56c5ce8e01f8c57be7">&#9670;&#160;</a></span>HYPERV_CPUID_MIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_MIN&#160;&#160;&#160;0x40000005</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aad84dbb2175cf41cac55aaa2c1752bcf" name="aad84dbb2175cf41cac55aaa2c1752bcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad84dbb2175cf41cac55aaa2c1752bcf">&#9670;&#160;</a></span>HYPERV_CPUID_VENDOR_AND_MAX_FUNCTIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_VENDOR_AND_MAX_FUNCTIONS&#160;&#160;&#160;0x40000000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CPUID RCX(s) - Based on Hyper-V. </p>

</div>
</div>
<a id="a98fbd42d49fce1098aa1b6907fd20a5c" name="a98fbd42d49fce1098aa1b6907fd20a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98fbd42d49fce1098aa1b6907fd20a5c">&#9670;&#160;</a></span>HYPERV_CPUID_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_CPUID_VERSION&#160;&#160;&#160;0x40000002</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaf955b30321d11973faeeec0cde3a34b" name="aaf955b30321d11973faeeec0cde3a34b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf955b30321d11973faeeec0cde3a34b">&#9670;&#160;</a></span>HYPERV_HYPERVISOR_PRESENT_BIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HYPERV_HYPERVISOR_PRESENT_BIT&#160;&#160;&#160;0x80000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a36b0e66173550aa986ffa83309e245e1" name="a36b0e66173550aa986ffa83309e245e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36b0e66173550aa986ffa83309e245e1">&#9670;&#160;</a></span>IS_VALID_DEBUG_REGISTER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IS_VALID_DEBUG_REGISTER</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>DebugRegister</em></span></td><td>)</td>
          <td>&#160;&#160;&#160;    (((DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR0) &amp;&amp; (DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR7)) &amp;&amp; (DebugRegister != 0x00000004 &amp;&amp; DebugRegister != 0x00000005))</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  142</span><span class="preprocessor">#define IS_VALID_DEBUG_REGISTER(DebugRegister) \</span></div>
<div class="line"><span class="lineno">  143</span><span class="preprocessor">    (((DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR0) &amp;&amp; (DebugRegister &lt;= VMX_EXIT_QUALIFICATION_REGISTER_DR7)) &amp;&amp; (DebugRegister != 0x00000004 &amp;&amp; DebugRegister != 0x00000005))</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aede75c15664ad00acc9066a873396490" name="aede75c15664ad00acc9066a873396490"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aede75c15664ad00acc9066a873396490">&#9670;&#160;</a></span>PIN_BASED_VM_EXECUTION_CONTROLS_ACTIVE_VMX_TIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_BASED_VM_EXECUTION_CONTROLS_ACTIVE_VMX_TIMER&#160;&#160;&#160;0x00000040</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a158e8b4e19f906a8f4867b17eec1a596" name="a158e8b4e19f906a8f4867b17eec1a596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a158e8b4e19f906a8f4867b17eec1a596">&#9670;&#160;</a></span>PIN_BASED_VM_EXECUTION_CONTROLS_EXTERNAL_INTERRUPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_BASED_VM_EXECUTION_CONTROLS_EXTERNAL_INTERRUPT&#160;&#160;&#160;0x00000001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PIN-Based Execution. </p>

</div>
</div>
<a id="abc2451b4f7835bf9e829b91c5a43a4e8" name="abc2451b4f7835bf9e829b91c5a43a4e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc2451b4f7835bf9e829b91c5a43a4e8">&#9670;&#160;</a></span>PIN_BASED_VM_EXECUTION_CONTROLS_NMI_EXITING</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_BASED_VM_EXECUTION_CONTROLS_NMI_EXITING&#160;&#160;&#160;0x00000008</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adb8df32693b7174c44768274510558f8" name="adb8df32693b7174c44768274510558f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb8df32693b7174c44768274510558f8">&#9670;&#160;</a></span>PIN_BASED_VM_EXECUTION_CONTROLS_PROCESS_POSTED_INTERRUPTS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_BASED_VM_EXECUTION_CONTROLS_PROCESS_POSTED_INTERRUPTS&#160;&#160;&#160;0x00000080</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a864408c647028df204a4a0b66faaddbf" name="a864408c647028df204a4a0b66faaddbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a864408c647028df204a4a0b66faaddbf">&#9670;&#160;</a></span>PIN_BASED_VM_EXECUTION_CONTROLS_VIRTUAL_NMI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PIN_BASED_VM_EXECUTION_CONTROLS_VIRTUAL_NMI&#160;&#160;&#160;0x00000020</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a071decc51768aa896c3f883ed03b37c7" name="a071decc51768aa896c3f883ed03b37c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071decc51768aa896c3f883ed03b37c7">&#9670;&#160;</a></span>SHADOW_INT_MOV_SS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHADOW_INT_MOV_SS&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt shadow states. </p>

</div>
</div>
<a id="a6a8dad6883178199ebdcccbaf91b442d" name="a6a8dad6883178199ebdcccbaf91b442d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a8dad6883178199ebdcccbaf91b442d">&#9670;&#160;</a></span>SHADOW_INT_STI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHADOW_INT_STI&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a281e645caa36e4bdcd12e6e5a61ab62c" name="a281e645caa36e4bdcd12e6e5a61ab62c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a281e645caa36e4bdcd12e6e5a61ab62c">&#9670;&#160;</a></span>VIRTUAL_PROCESSOR_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VIRTUAL_PROCESSOR_ID&#160;&#160;&#160;0x00000000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af7167e984269bb155ec8d7c8779741d9" name="af7167e984269bb155ec8d7c8779741d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7167e984269bb155ec8d7c8779741d9">&#9670;&#160;</a></span>VM_ENTRY_DEACT_DUAL_MONITOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_DEACT_DUAL_MONITOR&#160;&#160;&#160;0x00000800</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab380f7803e1fa5a6d8c2fe25e72fe4f9" name="ab380f7803e1fa5a6d8c2fe25e72fe4f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab380f7803e1fa5a6d8c2fe25e72fe4f9">&#9670;&#160;</a></span>VM_ENTRY_IA32E_MODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_IA32E_MODE&#160;&#160;&#160;0x00000200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a57df7bf8afcf8788ba0a8fd3d4c43889" name="a57df7bf8afcf8788ba0a8fd3d4c43889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57df7bf8afcf8788ba0a8fd3d4c43889">&#9670;&#160;</a></span>VM_ENTRY_LOAD_DEBUG_CONTROLS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_LOAD_DEBUG_CONTROLS&#160;&#160;&#160;0x00000004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VM-entry Control Bits. </p>

</div>
</div>
<a id="a92eb09bb4e3344efcdb3616970da1cf4" name="a92eb09bb4e3344efcdb3616970da1cf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92eb09bb4e3344efcdb3616970da1cf4">&#9670;&#160;</a></span>VM_ENTRY_LOAD_IA32_EFER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_LOAD_IA32_EFER&#160;&#160;&#160;0x00008000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ada36b6f289f49754165cbbb6091c1eb5" name="ada36b6f289f49754165cbbb6091c1eb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada36b6f289f49754165cbbb6091c1eb5">&#9670;&#160;</a></span>VM_ENTRY_LOAD_IA32_PAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_LOAD_IA32_PAT&#160;&#160;&#160;0x00004000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1b92c5aa61fe09b4a1df42a795981b3f" name="a1b92c5aa61fe09b4a1df42a795981b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b92c5aa61fe09b4a1df42a795981b3f">&#9670;&#160;</a></span>VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_LOAD_IA32_PERF_GLOBAL_CTRL&#160;&#160;&#160;0x00002000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1a5256487ee5c504b1417efab4995ea6" name="a1a5256487ee5c504b1417efab4995ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5256487ee5c504b1417efab4995ea6">&#9670;&#160;</a></span>VM_ENTRY_SMM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_ENTRY_SMM&#160;&#160;&#160;0x00000400</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6148ea349dbcbbe50eeae1429664332" name="ae6148ea349dbcbbe50eeae1429664332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6148ea349dbcbbe50eeae1429664332">&#9670;&#160;</a></span>VM_EXIT_ACK_INTR_ON_EXIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_ACK_INTR_ON_EXIT&#160;&#160;&#160;0x00008000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7023237efbd3a07d3187483b52550dcf" name="a7023237efbd3a07d3187483b52550dcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7023237efbd3a07d3187483b52550dcf">&#9670;&#160;</a></span>VM_EXIT_HOST_ADDR_SPACE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_HOST_ADDR_SPACE_SIZE&#160;&#160;&#160;0x00000200</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad30ebcdf092fe34e9abf6fb9d41b0157" name="ad30ebcdf092fe34e9abf6fb9d41b0157"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad30ebcdf092fe34e9abf6fb9d41b0157">&#9670;&#160;</a></span>VM_EXIT_LOAD_IA32_EFER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_LOAD_IA32_EFER&#160;&#160;&#160;0x00200000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afff390f52c7b350f97a3485b384c669b" name="afff390f52c7b350f97a3485b384c669b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afff390f52c7b350f97a3485b384c669b">&#9670;&#160;</a></span>VM_EXIT_LOAD_IA32_PAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_LOAD_IA32_PAT&#160;&#160;&#160;0x00080000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abd336a187ef0ec0d9520dddf8a7f2aa0" name="abd336a187ef0ec0d9520dddf8a7f2aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd336a187ef0ec0d9520dddf8a7f2aa0">&#9670;&#160;</a></span>VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_LOAD_IA32_PERF_GLOBAL_CTRL&#160;&#160;&#160;0x00001000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac42210f2cb26e1127e8ef20b5b8cf115" name="ac42210f2cb26e1127e8ef20b5b8cf115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac42210f2cb26e1127e8ef20b5b8cf115">&#9670;&#160;</a></span>VM_EXIT_SAVE_DEBUG_CONTROLS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_SAVE_DEBUG_CONTROLS&#160;&#160;&#160;0x00000004</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VM-exit Control Bits. </p>

</div>
</div>
<a id="a90a6b8fc528e099c6f0c614d09ad9931" name="a90a6b8fc528e099c6f0c614d09ad9931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90a6b8fc528e099c6f0c614d09ad9931">&#9670;&#160;</a></span>VM_EXIT_SAVE_IA32_EFER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_SAVE_IA32_EFER&#160;&#160;&#160;0x00100000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a19ce7d9782f2a7c3e9fee9e7c339300e" name="a19ce7d9782f2a7c3e9fee9e7c339300e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19ce7d9782f2a7c3e9fee9e7c339300e">&#9670;&#160;</a></span>VM_EXIT_SAVE_IA32_PAT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_SAVE_IA32_PAT&#160;&#160;&#160;0x00040000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab0abfa1d586d79c2eeb19ea609d79236" name="ab0abfa1d586d79c2eeb19ea609d79236"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0abfa1d586d79c2eeb19ea609d79236">&#9670;&#160;</a></span>VM_EXIT_SAVE_VMX_PREEMPTION_TIMER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VM_EXIT_SAVE_VMX_PREEMPTION_TIMER&#160;&#160;&#160;0x00400000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="adb28f9bd5c8c2e64101be81259d5bc30" name="adb28f9bd5c8c2e64101be81259d5bc30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb28f9bd5c8c2e64101be81259d5bc30">&#9670;&#160;</a></span>VMCS_GUEST_DEBUGCTL_HIGH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMCS_GUEST_DEBUGCTL_HIGH&#160;&#160;&#160;0x00002803</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Guest IA32_DEBUGCTL. </p>

</div>
</div>
<a id="add020230aac46a6da70bec7019457766" name="add020230aac46a6da70bec7019457766"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add020230aac46a6da70bec7019457766">&#9670;&#160;</a></span>VMCS_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMCS_SIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VMCS Region Size. </p>

</div>
</div>
<a id="ad0f7cb46b6f0d6a27da192097ea21f03" name="ad0f7cb46b6f0d6a27da192097ea21f03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0f7cb46b6f0d6a27da192097ea21f03">&#9670;&#160;</a></span>VMM_STACK_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMM_STACK_SIZE&#160;&#160;&#160;0x8000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stack Size. </p>

</div>
</div>
<a id="ae2050fcb30b71116f502d40643f35541" name="ae2050fcb30b71116f502d40643f35541"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2050fcb30b71116f502d40643f35541">&#9670;&#160;</a></span>VMXON_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VMXON_SIZE&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VMXON Region Size. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ae9a97844066df354446d7fc353745c73" name="ae9a97844066df354446d7fc353745c73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a97844066df354446d7fc353745c73">&#9670;&#160;</a></span>HYPERCALL_INPUT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef union <a class="el" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a> <a class="el" href="#ae9a97844066df354446d7fc353745c73">HYPERCALL_INPUT_VALUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hypercalls for Hyper-V. </p>

</div>
</div>
<a id="a60071359fab58fc0ae405efb1c29e2a4" name="a60071359fab58fc0ae405efb1c29e2a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60071359fab58fc0ae405efb1c29e2a4">&#9670;&#160;</a></span>MOV_TO_DEBUG_REG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dc">_MOV_TO_DEBUG_REG</a> <a class="el" href="#a60071359fab58fc0ae405efb1c29e2a4">MOV_TO_DEBUG_REG</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MOV to debug registers states. </p>

</div>
</div>
<a id="a071211894a630f709556fdfcac4940f7" name="a071211894a630f709556fdfcac4940f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071211894a630f709556fdfcac4940f7">&#9670;&#160;</a></span>PHYPERCALL_INPUT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef union <a class="el" href="union___h_y_p_e_r_c_a_l_l___i_n_p_u_t___v_a_l_u_e.html">_HYPERCALL_INPUT_VALUE</a> * <a class="el" href="#a071211894a630f709556fdfcac4940f7">PHYPERCALL_INPUT_VALUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a756132f02f43ed5a1b3a25f6bd2c35dc" name="a756132f02f43ed5a1b3a25f6bd2c35dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a756132f02f43ed5a1b3a25f6bd2c35dc">&#9670;&#160;</a></span>_MOV_TO_DEBUG_REG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a756132f02f43ed5a1b3a25f6bd2c35dc">_MOV_TO_DEBUG_REG</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>MOV to debug registers states. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892" name="a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892"></a>AccessToDebugRegister&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90" name="a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90"></a>AccessFromDebugRegister&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">  298</span>{</div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_enumvalue" href="#a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892">AccessToDebugRegister</a>   = 0,</div>
<div class="line"><span class="lineno">  300</span>    <a class="code hl_enumvalue" href="#a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90">AccessFromDebugRegister</a> = 1,</div>
<div class="line"><span class="lineno">  301</span>} <a class="code hl_typedef" href="#a60071359fab58fc0ae405efb1c29e2a4">MOV_TO_DEBUG_REG</a>;</div>
<div class="ttc" id="a_vmx_8h_html_a60071359fab58fc0ae405efb1c29e2a4"><div class="ttname"><a href="#a60071359fab58fc0ae405efb1c29e2a4">MOV_TO_DEBUG_REG</a></div><div class="ttdeci">enum _MOV_TO_DEBUG_REG MOV_TO_DEBUG_REG</div><div class="ttdoc">MOV to debug registers states.</div></div>
<div class="ttc" id="a_vmx_8h_html_a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90"><div class="ttname"><a href="#a756132f02f43ed5a1b3a25f6bd2c35dcab7475be58f5a2ca574f1989c8bac1d90">AccessFromDebugRegister</a></div><div class="ttdeci">@ AccessFromDebugRegister</div><div class="ttdef"><b>Definition</b> Vmx.h:300</div></div>
<div class="ttc" id="a_vmx_8h_html_a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892"><div class="ttname"><a href="#a756132f02f43ed5a1b3a25f6bd2c35dcae84f0d0c92c9ea90c7f2a10b9ea24892">AccessToDebugRegister</a></div><div class="ttdeci">@ AccessToDebugRegister</div><div class="ttdef"><b>Definition</b> Vmx.h:299</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8d1c98a2b0d46295a5d5aa6a747022e8" name="a8d1c98a2b0d46295a5d5aa6a747022e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8">&#9670;&#160;</a></span>HYPERCALL_CODE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a8d1c98a2b0d46295a5d5aa6a747022e8">HYPERCALL_CODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hyper-V Hypercalls. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634" name="a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634"></a>HvSwitchVirtualAddressSpace&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea" name="a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea"></a>HvFlushVirtualAddressSpace&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e" name="a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e"></a>HvFlushVirtualAddressList&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e" name="a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e"></a>HvGetLogicalProcessorRunTime&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b" name="a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b"></a>HvCallNotifyLongSpinWait&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a" name="a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a"></a>HvCallParkedVirtualProcessors&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c"></a>HvCallSyntheticClusterIpi&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90" name="a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90"></a>HvCallModifyVtlProtectionMask&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32" name="a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32"></a>HvCallEnablePartitionVtl&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24"></a>HvCallDisablePartitionVtl&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055" name="a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055"></a>HvCallEnableVpVtl&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a"></a>HvCallDisableVpVtl&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576" name="a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576"></a>HvCallVtlCall&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684" name="a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684"></a>HvCallVtlReturn&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a" name="a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a"></a>HvCallFlushVirtualAddressSpaceEx&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870" name="a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870"></a>HvCallFlushVirtualAddressListEx&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa" name="a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa"></a>HvCallSendSyntheticClusterIpiEx&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d"></a>HvCreatePartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de" name="a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de"></a>HvInitializePartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7" name="a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7"></a>HvFinalizePartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372" name="a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372"></a>HvDeletePartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab" name="a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab"></a>HvGetPartitionProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2"></a>HvSetPartitionProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7" name="a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7"></a>HvGetPartitionId&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8" name="a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8"></a>HvGetNextChildPartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06" name="a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06"></a>HvDepositMemory&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8" name="a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8"></a>HvWithdrawMemory&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01" name="a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01"></a>HvGetMemoryBalance&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da" name="a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da"></a>HvMapGpaPages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8" name="a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8"></a>HvUnmapGpaPages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af" name="a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af"></a>HvInstallIntercept&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64" name="a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64"></a>HvCreateVp&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd" name="a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd"></a>HvDeleteVp&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21" name="a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21"></a>HvGetVpRegisters&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473" name="a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473"></a>HvSetVpRegisters&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177" name="a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177"></a>HvTranslateVirtualAddress&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929" name="a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929"></a>HvReadGpa&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5" name="a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5"></a>HvWriteGpa&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9" name="a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9"></a>HvClearVirtualInterrupt&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897" name="a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897"></a>HvDeletePort&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b" name="a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b"></a>HvConnectPort&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d" name="a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d"></a>HvGetPortProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9" name="a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9"></a>HvDisconnectPort&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32" name="a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32"></a>HvPostMessage&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d"></a>HvSignalEvent&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18" name="a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18"></a>HvSavePartitionState&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09" name="a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09"></a>HvRestorePartitionState&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe"></a>HvInitializeEventLogBufferGroup&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d" name="a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d"></a>HvFinalizeEventLogBufferGroup&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1" name="a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1"></a>HvCreateEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2"></a>HvDeleteEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313" name="a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313"></a>HvMapEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f"></a>HvUnmapEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d"></a>HvSetEventLogGroupSources&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0" name="a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0"></a>HvReleaseEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb" name="a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb"></a>HvFlushEventLogBuffer&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3" name="a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3"></a>HvPostDebugData&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab" name="a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab"></a>HvRetrieveDebugData&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9" name="a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9"></a>HvResetDebugSession&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe" name="a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe"></a>HvMapStatsPage&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0" name="a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0"></a>HvUnmapStatsPage&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614" name="a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614"></a>HvCallMapSparseGpaPages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76" name="a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76"></a>HvCallSetSystemProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21"></a>HvCallSetPortProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae" name="a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae"></a>HvCallAddLogicalProcessor&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8" name="a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8"></a>HvCallRemoveLogicalProcessor&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845" name="a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845"></a>HvCallQueryNumaDistance&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a"></a>HvCallSetLogicalProcessorProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0" name="a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0"></a>HvCallGetLogicalProcessorProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529" name="a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529"></a>HvCallGetSystemProperty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5" name="a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5"></a>HvCallMapDeviceInterrupt&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f" name="a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f"></a>HvCallUnmapDeviceInterrupt&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c" name="a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c"></a>HvCallRetargetDeviceInterrupt&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27" name="a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27"></a>HvCallMapDevicePages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d" name="a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d"></a>HvCallUnmapDevicePages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021" name="a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021"></a>HvCallAttachDevice&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8" name="a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8"></a>HvCallDetachDevice&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac" name="a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac"></a>HvCallNotifyStandbyTransition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3" name="a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3"></a>HvCallPrepareForSleep&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50" name="a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50"></a>HvCallPrepareForHibernate&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0" name="a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0"></a>HvCallNotifyPartitionEvent&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e" name="a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e"></a>HvCallGetLogicalProcessorRegisters&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859" name="a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859"></a>HvCallSetLogicalProcessorRegisters&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40" name="a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40"></a>HvCallQueryAssotiatedLpsforMca&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f" name="a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f"></a>HvCallNotifyRingEmpty&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb" name="a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb"></a>HvCallInjectSyntheticMachineCheck&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097" name="a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097"></a>HvCallScrubPartition&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504" name="a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504"></a>HvCallCollectLivedump&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b" name="a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b"></a>HvCallDisableHypervisor&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45" name="a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45"></a>HvCallModifySparseGpaPages&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098" name="a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098"></a>HvCallRegisterInterceptResult&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1" name="a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1"></a>HvCallUnregisterInterceptResult&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439" name="a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439"></a>HvCallAssertVirtualInterrupt&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6" name="a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6"></a>HvCallCreatePort&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3" name="a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3"></a>HvCallConnectPort&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12" name="a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12"></a>HvCallGetSpaPageList&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e" name="a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e"></a>HvCallStartVirtualProcessor&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838" name="a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838"></a>HvCallGetVpIndexFromApicId&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de" name="a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de"></a>HvCallFlushGuestPhysicalAddressSpace&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289" name="a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289"></a>HvCallFlushGuestPhysicalAddressList&#160;</td><td class="fielddoc"></td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">  172</span>{</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634">HvSwitchVirtualAddressSpace</a>  = 0x0001,</div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea">HvFlushVirtualAddressSpace</a>   = 0x0002,</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e">HvFlushVirtualAddressList</a>    = 0x0003,</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e">HvGetLogicalProcessorRunTime</a> = 0x0004,</div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">// 0x0005..0x0007 are reserved</span></div>
<div class="line"><span class="lineno">  178</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b">HvCallNotifyLongSpinWait</a>         = 0x0008,</div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a">HvCallParkedVirtualProcessors</a>    = 0x0009,</div>
<div class="line"><span class="lineno">  180</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c">HvCallSyntheticClusterIpi</a>        = 0x000B,</div>
<div class="line"><span class="lineno">  181</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90">HvCallModifyVtlProtectionMask</a>    = 0x000C,</div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32">HvCallEnablePartitionVtl</a>         = 0x000D,</div>
<div class="line"><span class="lineno">  183</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24">HvCallDisablePartitionVtl</a>        = 0x000E,</div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055">HvCallEnableVpVtl</a>                = 0x000F,</div>
<div class="line"><span class="lineno">  185</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a">HvCallDisableVpVtl</a>               = 0x0010,</div>
<div class="line"><span class="lineno">  186</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576">HvCallVtlCall</a>                    = 0x0011,</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684">HvCallVtlReturn</a>                  = 0x0012,</div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a">HvCallFlushVirtualAddressSpaceEx</a> = 0x0013,</div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870">HvCallFlushVirtualAddressListEx</a>  = 0x0014,</div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa">HvCallSendSyntheticClusterIpiEx</a>  = 0x0015,</div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">// 0x0016..0x003F are reserved</span></div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d">HvCreatePartition</a>         = 0x0040,</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de">HvInitializePartition</a>     = 0x0041,</div>
<div class="line"><span class="lineno">  194</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7">HvFinalizePartition</a>       = 0x0042,</div>
<div class="line"><span class="lineno">  195</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372">HvDeletePartition</a>         = 0x0043,</div>
<div class="line"><span class="lineno">  196</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab">HvGetPartitionProperty</a>    = 0x0044,</div>
<div class="line"><span class="lineno">  197</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2">HvSetPartitionProperty</a>    = 0x0045,</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7">HvGetPartitionId</a>          = 0x0046,</div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8">HvGetNextChildPartition</a>   = 0x0047,</div>
<div class="line"><span class="lineno">  200</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06">HvDepositMemory</a>           = 0x0048,</div>
<div class="line"><span class="lineno">  201</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8">HvWithdrawMemory</a>          = 0x0049,</div>
<div class="line"><span class="lineno">  202</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01">HvGetMemoryBalance</a>        = 0x004A,</div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da">HvMapGpaPages</a>             = 0x004B,</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8">HvUnmapGpaPages</a>           = 0x004C,</div>
<div class="line"><span class="lineno">  205</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af">HvInstallIntercept</a>        = 0x004D,</div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64">HvCreateVp</a>                = 0x004E,</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd">HvDeleteVp</a>                = 0x004F,</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21">HvGetVpRegisters</a>          = 0x0050,</div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473">HvSetVpRegisters</a>          = 0x0051,</div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177">HvTranslateVirtualAddress</a> = 0x0052,</div>
<div class="line"><span class="lineno">  211</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929">HvReadGpa</a>                 = 0x0053,</div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5">HvWriteGpa</a>                = 0x0054,</div>
<div class="line"><span class="lineno">  213</span>    <span class="comment">// 0x0055 is deprecated</span></div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9">HvClearVirtualInterrupt</a> = 0x0056,</div>
<div class="line"><span class="lineno">  215</span>    <span class="comment">// 0x0057 is deprecated</span></div>
<div class="line"><span class="lineno">  216</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897">HvDeletePort</a>                    = 0x0058,</div>
<div class="line"><span class="lineno">  217</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b">HvConnectPort</a>                   = 0x0059,</div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d">HvGetPortProperty</a>               = 0x005A,</div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9">HvDisconnectPort</a>                = 0x005B,</div>
<div class="line"><span class="lineno">  220</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32">HvPostMessage</a>                   = 0x005C,</div>
<div class="line"><span class="lineno">  221</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d">HvSignalEvent</a>                   = 0x005D,</div>
<div class="line"><span class="lineno">  222</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18">HvSavePartitionState</a>            = 0x005E,</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09">HvRestorePartitionState</a>         = 0x005F,</div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe">HvInitializeEventLogBufferGroup</a> = 0x0060,</div>
<div class="line"><span class="lineno">  225</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d">HvFinalizeEventLogBufferGroup</a>   = 0x0061,</div>
<div class="line"><span class="lineno">  226</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1">HvCreateEventLogBuffer</a>          = 0x0062,</div>
<div class="line"><span class="lineno">  227</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2">HvDeleteEventLogBuffer</a>          = 0x0063,</div>
<div class="line"><span class="lineno">  228</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313">HvMapEventLogBuffer</a>             = 0x0064,</div>
<div class="line"><span class="lineno">  229</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f">HvUnmapEventLogBuffer</a>           = 0x0065,</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d">HvSetEventLogGroupSources</a>       = 0x0066,</div>
<div class="line"><span class="lineno">  231</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0">HvReleaseEventLogBuffer</a>         = 0x0067,</div>
<div class="line"><span class="lineno">  232</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb">HvFlushEventLogBuffer</a>           = 0x0068,</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3">HvPostDebugData</a>                 = 0x0069,</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab">HvRetrieveDebugData</a>             = 0x006A,</div>
<div class="line"><span class="lineno">  235</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9">HvResetDebugSession</a>             = 0x006B,</div>
<div class="line"><span class="lineno">  236</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe">HvMapStatsPage</a>                  = 0x006C,</div>
<div class="line"><span class="lineno">  237</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0">HvUnmapStatsPage</a>                = 0x006D,</div>
<div class="line"><span class="lineno">  238</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614">HvCallMapSparseGpaPages</a>         = 0x006E,</div>
<div class="line"><span class="lineno">  239</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76">HvCallSetSystemProperty</a>         = 0x006F,</div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21">HvCallSetPortProperty</a>           = 0x0070,</div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">// 0x0071..0x0075 are reserved</span></div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae">HvCallAddLogicalProcessor</a>         = 0x0076,</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8">HvCallRemoveLogicalProcessor</a>      = 0x0077,</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845">HvCallQueryNumaDistance</a>           = 0x0078,</div>
<div class="line"><span class="lineno">  245</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a">HvCallSetLogicalProcessorProperty</a> = 0x0079,</div>
<div class="line"><span class="lineno">  246</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0">HvCallGetLogicalProcessorProperty</a> = 0x007A,</div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529">HvCallGetSystemProperty</a>           = 0x007B,</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5">HvCallMapDeviceInterrupt</a>          = 0x007C,</div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f">HvCallUnmapDeviceInterrupt</a>        = 0x007D,</div>
<div class="line"><span class="lineno">  250</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c">HvCallRetargetDeviceInterrupt</a>     = 0x007E,</div>
<div class="line"><span class="lineno">  251</span>    <span class="comment">// 0x007F is reserved</span></div>
<div class="line"><span class="lineno">  252</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27">HvCallMapDevicePages</a>               = 0x0080,</div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d">HvCallUnmapDevicePages</a>             = 0x0081,</div>
<div class="line"><span class="lineno">  254</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021">HvCallAttachDevice</a>                 = 0x0082,</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8">HvCallDetachDevice</a>                 = 0x0083,</div>
<div class="line"><span class="lineno">  256</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac">HvCallNotifyStandbyTransition</a>      = 0x0084,</div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3">HvCallPrepareForSleep</a>              = 0x0085,</div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50">HvCallPrepareForHibernate</a>          = 0x0086,</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0">HvCallNotifyPartitionEvent</a>         = 0x0087,</div>
<div class="line"><span class="lineno">  260</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e">HvCallGetLogicalProcessorRegisters</a> = 0x0088,</div>
<div class="line"><span class="lineno">  261</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859">HvCallSetLogicalProcessorRegisters</a> = 0x0089,</div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40">HvCallQueryAssotiatedLpsforMca</a>     = 0x008A,</div>
<div class="line"><span class="lineno">  263</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f">HvCallNotifyRingEmpty</a>              = 0x008B,</div>
<div class="line"><span class="lineno">  264</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb">HvCallInjectSyntheticMachineCheck</a>  = 0x008C,</div>
<div class="line"><span class="lineno">  265</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097">HvCallScrubPartition</a>               = 0x008D,</div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504">HvCallCollectLivedump</a>              = 0x008E,</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b">HvCallDisableHypervisor</a>            = 0x008F,</div>
<div class="line"><span class="lineno">  268</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45">HvCallModifySparseGpaPages</a>         = 0x0090,</div>
<div class="line"><span class="lineno">  269</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098">HvCallRegisterInterceptResult</a>      = 0x0091,</div>
<div class="line"><span class="lineno">  270</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1">HvCallUnregisterInterceptResult</a>    = 0x0092,</div>
<div class="line"><span class="lineno">  271</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439">HvCallAssertVirtualInterrupt</a>       = 0x0094,</div>
<div class="line"><span class="lineno">  272</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6">HvCallCreatePort</a>                   = 0x0095,</div>
<div class="line"><span class="lineno">  273</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3">HvCallConnectPort</a>                  = 0x0096,</div>
<div class="line"><span class="lineno">  274</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12">HvCallGetSpaPageList</a>               = 0x0097,</div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// 0x0098 is reserved</span></div>
<div class="line"><span class="lineno">  276</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e">HvCallStartVirtualProcessor</a> = 0x009A,</div>
<div class="line"><span class="lineno">  277</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838">HvCallGetVpIndexFromApicId</a>  = 0x009A,</div>
<div class="line"><span class="lineno">  278</span>    <span class="comment">// 0x009A..0x00AE are reserved</span></div>
<div class="line"><span class="lineno">  279</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de">HvCallFlushGuestPhysicalAddressSpace</a> = 0x00AF,</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_enumvalue" href="#a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289">HvCallFlushGuestPhysicalAddressList</a>  = 0x00B0</div>
<div class="line"><span class="lineno">  281</span>};</div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a00580d559fe629b3a6ec20af07b052f0">HvUnmapStatsPage</a></div><div class="ttdeci">@ HvUnmapStatsPage</div><div class="ttdef"><b>Definition</b> Vmx.h:237</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a03e4e56b0ba47ba391048cafbf80fdb9">HvClearVirtualInterrupt</a></div><div class="ttdeci">@ HvClearVirtualInterrupt</div><div class="ttdef"><b>Definition</b> Vmx.h:214</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a0ab3aadca44c802968182b36975e0ba7">HvGetPartitionId</a></div><div class="ttdeci">@ HvGetPartitionId</div><div class="ttdef"><b>Definition</b> Vmx.h:198</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1102eb3f1826d7282afcad7a0fbb1f7a">HvCallParkedVirtualProcessors</a></div><div class="ttdeci">@ HvCallParkedVirtualProcessors</div><div class="ttdef"><b>Definition</b> Vmx.h:179</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a168bcb04e86c1895f4a80d5fcb4b78d3">HvCallConnectPort</a></div><div class="ttdeci">@ HvCallConnectPort</div><div class="ttdef"><b>Definition</b> Vmx.h:273</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a18827aa4b9d90f60cbd054bc775ff055">HvCallEnableVpVtl</a></div><div class="ttdeci">@ HvCallEnableVpVtl</div><div class="ttdef"><b>Definition</b> Vmx.h:184</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a19d67bf748ff21a8f0ce7aa851b1b6af">HvInstallIntercept</a></div><div class="ttdeci">@ HvInstallIntercept</div><div class="ttdef"><b>Definition</b> Vmx.h:205</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1b1bd56b3cbfa71725f83bf0b9fa52da">HvMapGpaPages</a></div><div class="ttdeci">@ HvMapGpaPages</div><div class="ttdef"><b>Definition</b> Vmx.h:203</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1c50a0b5203fd2be5432921d6c13a634">HvSwitchVirtualAddressSpace</a></div><div class="ttdeci">@ HvSwitchVirtualAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:173</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a1f1ec96538978161b13f81fa2e8f9614">HvCallMapSparseGpaPages</a></div><div class="ttdeci">@ HvCallMapSparseGpaPages</div><div class="ttdef"><b>Definition</b> Vmx.h:238</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a23acc426cf408a90082c638254e332aa">HvCallSendSyntheticClusterIpiEx</a></div><div class="ttdeci">@ HvCallSendSyntheticClusterIpiEx</div><div class="ttdef"><b>Definition</b> Vmx.h:190</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a24c090f9910676a5b8afb795ec5034de">HvInitializePartition</a></div><div class="ttdeci">@ HvInitializePartition</div><div class="ttdef"><b>Definition</b> Vmx.h:193</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2563f922fa81e84960121a5865d6cd50">HvCallPrepareForHibernate</a></div><div class="ttdeci">@ HvCallPrepareForHibernate</div><div class="ttdef"><b>Definition</b> Vmx.h:258</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a29d5e8ec1f7f565c58e4ade784328845">HvCallQueryNumaDistance</a></div><div class="ttdeci">@ HvCallQueryNumaDistance</div><div class="ttdef"><b>Definition</b> Vmx.h:244</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2a4c35a477328556724c0ee04574c684">HvCallVtlReturn</a></div><div class="ttdeci">@ HvCallVtlReturn</div><div class="ttdef"><b>Definition</b> Vmx.h:187</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a2c226f77090a4710e1e26c51283cbc2d">HvFinalizeEventLogBufferGroup</a></div><div class="ttdeci">@ HvFinalizeEventLogBufferGroup</div><div class="ttdef"><b>Definition</b> Vmx.h:225</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a303f9387a86a3834eb5b714d65d0cd32">HvCallEnablePartitionVtl</a></div><div class="ttdeci">@ HvCallEnablePartitionVtl</div><div class="ttdef"><b>Definition</b> Vmx.h:182</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a31c60decfc4ac76239f248ff82328bae">HvCallAddLogicalProcessor</a></div><div class="ttdeci">@ HvCallAddLogicalProcessor</div><div class="ttdef"><b>Definition</b> Vmx.h:242</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a332bc6411c15c83f067de768586d8a27">HvCallMapDevicePages</a></div><div class="ttdeci">@ HvCallMapDevicePages</div><div class="ttdef"><b>Definition</b> Vmx.h:252</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a382e8fd8be18237e3440dc19543406f6">HvCallCreatePort</a></div><div class="ttdeci">@ HvCallCreatePort</div><div class="ttdef"><b>Definition</b> Vmx.h:272</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a38db4047f722c1afcf5689085aae3c06">HvDepositMemory</a></div><div class="ttdeci">@ HvDepositMemory</div><div class="ttdef"><b>Definition</b> Vmx.h:200</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a3a715c6fbd0b9ea9fd31852aae09a59e">HvCallGetLogicalProcessorRegisters</a></div><div class="ttdeci">@ HvCallGetLogicalProcessorRegisters</div><div class="ttdef"><b>Definition</b> Vmx.h:260</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a41a3f21c2741e9d070fd6763017eae76">HvCallSetSystemProperty</a></div><div class="ttdeci">@ HvCallSetSystemProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:239</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a445e7c94a5b70868169b03184b9dd870">HvCallFlushVirtualAddressListEx</a></div><div class="ttdeci">@ HvCallFlushVirtualAddressListEx</div><div class="ttdef"><b>Definition</b> Vmx.h:189</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a47a9317b45c5457854e11de7448fd098">HvCallRegisterInterceptResult</a></div><div class="ttdeci">@ HvCallRegisterInterceptResult</div><div class="ttdef"><b>Definition</b> Vmx.h:269</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c1c3269e4906ba1f72f0387685e25cd">HvDeleteVp</a></div><div class="ttdeci">@ HvDeleteVp</div><div class="ttdef"><b>Definition</b> Vmx.h:207</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4c99257febe19c646b6aa17227e14a18">HvSavePartitionState</a></div><div class="ttdeci">@ HvSavePartitionState</div><div class="ttdef"><b>Definition</b> Vmx.h:222</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4dfa2dd6983264692cf843c129fed929">HvReadGpa</a></div><div class="ttdeci">@ HvReadGpa</div><div class="ttdef"><b>Definition</b> Vmx.h:211</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4ed2bd6da258c5e9ce23b5b2bdfd2e90">HvCallModifyVtlProtectionMask</a></div><div class="ttdeci">@ HvCallModifyVtlProtectionMask</div><div class="ttdef"><b>Definition</b> Vmx.h:181</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a4f54a8538bf7af9ccfadc5e814cbe9ac">HvCallNotifyStandbyTransition</a></div><div class="ttdeci">@ HvCallNotifyStandbyTransition</div><div class="ttdef"><b>Definition</b> Vmx.h:256</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a523efb06c9255773099f980d654d9d12">HvCallGetSpaPageList</a></div><div class="ttdeci">@ HvCallGetSpaPageList</div><div class="ttdef"><b>Definition</b> Vmx.h:274</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a55894960d8391e0865bda0538b947f3e">HvGetLogicalProcessorRunTime</a></div><div class="ttdeci">@ HvGetLogicalProcessorRunTime</div><div class="ttdef"><b>Definition</b> Vmx.h:176</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5633d5a5001f98064345055bc3090efb">HvFlushEventLogBuffer</a></div><div class="ttdeci">@ HvFlushEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:232</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a591b2bfb93e4ccdff2251200d95bbf45">HvCallModifySparseGpaPages</a></div><div class="ttdeci">@ HvCallModifySparseGpaPages</div><div class="ttdef"><b>Definition</b> Vmx.h:268</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a5a153a1a9c1e7101f4fb90e85a3d0897">HvDeletePort</a></div><div class="ttdeci">@ HvDeletePort</div><div class="ttdef"><b>Definition</b> Vmx.h:216</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6209511226a4bb814c7804da0c19ac24">HvCallDisablePartitionVtl</a></div><div class="ttdeci">@ HvCallDisablePartitionVtl</div><div class="ttdef"><b>Definition</b> Vmx.h:183</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a626766da4f16bec12ad5802c8ed3aa7d">HvCallUnmapDevicePages</a></div><div class="ttdeci">@ HvCallUnmapDevicePages</div><div class="ttdef"><b>Definition</b> Vmx.h:253</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6287becfb8813e0ee0158ee491287ed8">HvCallRemoveLogicalProcessor</a></div><div class="ttdeci">@ HvCallRemoveLogicalProcessor</div><div class="ttdef"><b>Definition</b> Vmx.h:243</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a668bd6f124af4f8f9d74e008409c6e5c">HvCallRetargetDeviceInterrupt</a></div><div class="ttdeci">@ HvCallRetargetDeviceInterrupt</div><div class="ttdef"><b>Definition</b> Vmx.h:250</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6874f6fa1365d4b5c15f2e041d686d21">HvCallSetPortProperty</a></div><div class="ttdeci">@ HvCallSetPortProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:240</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6cbe30449ffecaec468ef6c27988259d">HvSetEventLogGroupSources</a></div><div class="ttdeci">@ HvSetEventLogGroupSources</div><div class="ttdef"><b>Definition</b> Vmx.h:230</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6ece279d54ecea15be22f6606858cc3d">HvCreatePartition</a></div><div class="ttdeci">@ HvCreatePartition</div><div class="ttdef"><b>Definition</b> Vmx.h:192</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a6fbe3af6e006f68e6541f7a9ca57f8b2">HvDeleteEventLogBuffer</a></div><div class="ttdeci">@ HvDeleteEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:227</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a70c1d99ae35bd54e182b7d37df81d8ab">HvGetPartitionProperty</a></div><div class="ttdeci">@ HvGetPartitionProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:196</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a71b31efc3a705b988ba9f6de7d120576">HvCallVtlCall</a></div><div class="ttdeci">@ HvCallVtlCall</div><div class="ttdef"><b>Definition</b> Vmx.h:186</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a72beeaba2b0dfd5eba0999428bcac1c3">HvCallPrepareForSleep</a></div><div class="ttdeci">@ HvCallPrepareForSleep</div><div class="ttdef"><b>Definition</b> Vmx.h:257</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a789677b694b3029a03881411493540b8">HvWithdrawMemory</a></div><div class="ttdeci">@ HvWithdrawMemory</div><div class="ttdef"><b>Definition</b> Vmx.h:201</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a79f88599a6e2deb4d5dc2a58a71f40c7">HvFinalizePartition</a></div><div class="ttdeci">@ HvFinalizePartition</div><div class="ttdef"><b>Definition</b> Vmx.h:194</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7c0ceeb0ac0fd8adba0694840a89bbb0">HvCallNotifyPartitionEvent</a></div><div class="ttdeci">@ HvCallNotifyPartitionEvent</div><div class="ttdef"><b>Definition</b> Vmx.h:259</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7e27a30891be16ffb35d4ec1f4093473">HvSetVpRegisters</a></div><div class="ttdeci">@ HvSetVpRegisters</div><div class="ttdef"><b>Definition</b> Vmx.h:209</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a7f9d18d51f96adfb72318c4c4bfb79fe">HvMapStatsPage</a></div><div class="ttdeci">@ HvMapStatsPage</div><div class="ttdef"><b>Definition</b> Vmx.h:236</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8037d10283593e6ff7a2ba8dce45d7b2">HvSetPartitionProperty</a></div><div class="ttdeci">@ HvSetPartitionProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:197</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a81afb9b8d2e25afab56949b044997504">HvCallCollectLivedump</a></div><div class="ttdeci">@ HvCallCollectLivedump</div><div class="ttdef"><b>Definition</b> Vmx.h:266</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a82616dc46d727ec4822f2f4ba6d227d0">HvCallGetLogicalProcessorProperty</a></div><div class="ttdeci">@ HvCallGetLogicalProcessorProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:246</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a834d0704d3c1bb81427842e3183fef32">HvPostMessage</a></div><div class="ttdeci">@ HvPostMessage</div><div class="ttdef"><b>Definition</b> Vmx.h:220</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a84b82cafb87714e8f7a7bb4958137c8e">HvFlushVirtualAddressList</a></div><div class="ttdeci">@ HvFlushVirtualAddressList</div><div class="ttdef"><b>Definition</b> Vmx.h:175</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8761d0f410b2698cbb9b05439b8f1838">HvCallGetVpIndexFromApicId</a></div><div class="ttdeci">@ HvCallGetVpIndexFromApicId</div><div class="ttdef"><b>Definition</b> Vmx.h:277</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8790cc109af1d7f1bd800d8d462ad32c">HvCallSyntheticClusterIpi</a></div><div class="ttdeci">@ HvCallSyntheticClusterIpi</div><div class="ttdef"><b>Definition</b> Vmx.h:180</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a87d86644b7299c3ea2195984a5557097">HvCallScrubPartition</a></div><div class="ttdeci">@ HvCallScrubPartition</div><div class="ttdef"><b>Definition</b> Vmx.h:265</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8a7b48043231ced36f0bc6ec70ba0f7a">HvCallSetLogicalProcessorProperty</a></div><div class="ttdeci">@ HvCallSetLogicalProcessorProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:245</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8cd7501ceaeeac57414b6c52f1f1e59d">HvSignalEvent</a></div><div class="ttdeci">@ HvSignalEvent</div><div class="ttdef"><b>Definition</b> Vmx.h:221</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8d22e8659162d274987b28d4192b5c1f">HvUnmapEventLogBuffer</a></div><div class="ttdeci">@ HvUnmapEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:229</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8e3ac0837e23a3f5b865a5df742b0a4a">HvCallDisableVpVtl</a></div><div class="ttdeci">@ HvCallDisableVpVtl</div><div class="ttdef"><b>Definition</b> Vmx.h:185</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a8f21c41fb39e5bd752617e4447c8cdbe">HvInitializeEventLogBufferGroup</a></div><div class="ttdeci">@ HvInitializeEventLogBufferGroup</div><div class="ttdef"><b>Definition</b> Vmx.h:224</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a91e10371e6151ef0a69a6e7a69f93e64">HvCreateVp</a></div><div class="ttdeci">@ HvCreateVp</div><div class="ttdef"><b>Definition</b> Vmx.h:206</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a94a8507f5e6084be86628e10e2b5c35f">HvCallUnmapDeviceInterrupt</a></div><div class="ttdeci">@ HvCallUnmapDeviceInterrupt</div><div class="ttdef"><b>Definition</b> Vmx.h:249</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8a9c6e5aa4a3b8b78d3733deb6b222017e">HvCallStartVirtualProcessor</a></div><div class="ttdeci">@ HvCallStartVirtualProcessor</div><div class="ttdef"><b>Definition</b> Vmx.h:276</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8aa6d1a7f53e43e63f181e849c3e2a2ee8">HvGetNextChildPartition</a></div><div class="ttdeci">@ HvGetNextChildPartition</div><div class="ttdef"><b>Definition</b> Vmx.h:199</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8aaadcdcb1cb11f199e10d334c8051e4c5">HvCallMapDeviceInterrupt</a></div><div class="ttdeci">@ HvCallMapDeviceInterrupt</div><div class="ttdef"><b>Definition</b> Vmx.h:248</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab32de2d7df8b5ee43cba6ecdc9dd6cd9">HvResetDebugSession</a></div><div class="ttdeci">@ HvResetDebugSession</div><div class="ttdef"><b>Definition</b> Vmx.h:235</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab4cd1450cf3b46fbc8918adabd31adc8">HvCallDetachDevice</a></div><div class="ttdeci">@ HvCallDetachDevice</div><div class="ttdef"><b>Definition</b> Vmx.h:255</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab81af877cd44b581e954a1c3c5f383ab">HvRetrieveDebugData</a></div><div class="ttdeci">@ HvRetrieveDebugData</div><div class="ttdef"><b>Definition</b> Vmx.h:234</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ab9bacf7aab27fc1685e433b9dc9e9372">HvDeletePartition</a></div><div class="ttdeci">@ HvDeletePartition</div><div class="ttdef"><b>Definition</b> Vmx.h:195</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8abbef6bdbb8dba61cfa6c9ad7a0aac2a1">HvCallUnregisterInterceptResult</a></div><div class="ttdeci">@ HvCallUnregisterInterceptResult</div><div class="ttdef"><b>Definition</b> Vmx.h:270</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8abeb613b32f739bfb019f4a275bf1898f">HvCallNotifyRingEmpty</a></div><div class="ttdeci">@ HvCallNotifyRingEmpty</div><div class="ttdef"><b>Definition</b> Vmx.h:263</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8abfd1b9eeb797d0a9e6100d6fa198ff21">HvGetVpRegisters</a></div><div class="ttdeci">@ HvGetVpRegisters</div><div class="ttdef"><b>Definition</b> Vmx.h:208</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac1cd035608c416d32c973be3f09ff6ea">HvFlushVirtualAddressSpace</a></div><div class="ttdeci">@ HvFlushVirtualAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:174</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ac55c1e6c676455512f4e0a37a7961ba9">HvDisconnectPort</a></div><div class="ttdeci">@ HvDisconnectPort</div><div class="ttdef"><b>Definition</b> Vmx.h:219</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8acad16bac106afff53b496788f41ce021">HvCallAttachDevice</a></div><div class="ttdeci">@ HvCallAttachDevice</div><div class="ttdef"><b>Definition</b> Vmx.h:254</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8acbf43e31aaa8577b595f136823be984b">HvCallDisableHypervisor</a></div><div class="ttdeci">@ HvCallDisableHypervisor</div><div class="ttdef"><b>Definition</b> Vmx.h:267</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8acc09b65a3e615ab9dda0465171a477e3">HvPostDebugData</a></div><div class="ttdeci">@ HvPostDebugData</div><div class="ttdef"><b>Definition</b> Vmx.h:233</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8acdf44eaa3b419d9217c32a896cb08b40">HvCallQueryAssotiatedLpsforMca</a></div><div class="ttdeci">@ HvCallQueryAssotiatedLpsforMca</div><div class="ttdef"><b>Definition</b> Vmx.h:262</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ad6ea3c83a17ae4f1591e0bfb7530cb01">HvGetMemoryBalance</a></div><div class="ttdeci">@ HvGetMemoryBalance</div><div class="ttdef"><b>Definition</b> Vmx.h:202</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada1e98f6c2262da6964e5624b2411177">HvTranslateVirtualAddress</a></div><div class="ttdeci">@ HvTranslateVirtualAddress</div><div class="ttdef"><b>Definition</b> Vmx.h:210</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ada7b52859d7cd9886e742cdf33893529">HvCallGetSystemProperty</a></div><div class="ttdeci">@ HvCallGetSystemProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:247</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8adaf2f64557218cb5974476c3ad027da8">HvUnmapGpaPages</a></div><div class="ttdeci">@ HvUnmapGpaPages</div><div class="ttdef"><b>Definition</b> Vmx.h:204</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8adbed84b0ec2f1f1364229205479893c1">HvCreateEventLogBuffer</a></div><div class="ttdeci">@ HvCreateEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:226</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae09d62ca1aa8987f01e67ed9b1e1c48b">HvConnectPort</a></div><div class="ttdeci">@ HvConnectPort</div><div class="ttdef"><b>Definition</b> Vmx.h:217</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae4da7e6fa460f6d4a75403c32b903439">HvCallAssertVirtualInterrupt</a></div><div class="ttdeci">@ HvCallAssertVirtualInterrupt</div><div class="ttdef"><b>Definition</b> Vmx.h:271</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae7f19a2a1a1b56d0c3d7bad87722ac5a">HvCallFlushVirtualAddressSpaceEx</a></div><div class="ttdeci">@ HvCallFlushVirtualAddressSpaceEx</div><div class="ttdef"><b>Definition</b> Vmx.h:188</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae99fc02e41cd045149da62da6fa26859">HvCallSetLogicalProcessorRegisters</a></div><div class="ttdeci">@ HvCallSetLogicalProcessorRegisters</div><div class="ttdef"><b>Definition</b> Vmx.h:261</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8ae9ebf3d882eb467ab64fcaab192ea81d">HvGetPortProperty</a></div><div class="ttdeci">@ HvGetPortProperty</div><div class="ttdef"><b>Definition</b> Vmx.h:218</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8aeb1fb690199d04a5a04a7d3ccbefd8c5">HvWriteGpa</a></div><div class="ttdeci">@ HvWriteGpa</div><div class="ttdef"><b>Definition</b> Vmx.h:212</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8aedc99e31e78d3f2fab9a3bd9e8d5145b">HvCallNotifyLongSpinWait</a></div><div class="ttdeci">@ HvCallNotifyLongSpinWait</div><div class="ttdef"><b>Definition</b> Vmx.h:178</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8af134e3d812bf319c838401a334d915d0">HvReleaseEventLogBuffer</a></div><div class="ttdeci">@ HvReleaseEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:231</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8af4c9307e4515ebebe2452332e211c289">HvCallFlushGuestPhysicalAddressList</a></div><div class="ttdeci">@ HvCallFlushGuestPhysicalAddressList</div><div class="ttdef"><b>Definition</b> Vmx.h:280</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8af961a11d5dc7013664f499de514bb4de">HvCallFlushGuestPhysicalAddressSpace</a></div><div class="ttdeci">@ HvCallFlushGuestPhysicalAddressSpace</div><div class="ttdef"><b>Definition</b> Vmx.h:279</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8afde2fa04bb9ecbc71903cb7fe21c2b09">HvRestorePartitionState</a></div><div class="ttdeci">@ HvRestorePartitionState</div><div class="ttdef"><b>Definition</b> Vmx.h:223</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8afee710ba382229b54ddff73baf5f95eb">HvCallInjectSyntheticMachineCheck</a></div><div class="ttdeci">@ HvCallInjectSyntheticMachineCheck</div><div class="ttdef"><b>Definition</b> Vmx.h:264</div></div>
<div class="ttc" id="a_vmx_8h_html_a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313"><div class="ttname"><a href="#a8d1c98a2b0d46295a5d5aa6a747022e8aff86d591e1df81b87b049bbd26ca3313">HvMapEventLogBuffer</a></div><div class="ttdeci">@ HvMapEventLogBuffer</div><div class="ttdef"><b>Definition</b> Vmx.h:228</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae1383bf1b0ee0da71f29e832a1e86144" name="ae1383bf1b0ee0da71f29e832a1e86144"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1383bf1b0ee0da71f29e832a1e86144">&#9670;&#160;</a></span>VmxCheckIsOnVmxRoot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxCheckIsOnVmxRoot </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It can deterministically check whether the caller is on vmx-root mode or not. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if current operation mode is vmx-root and false if current operation mode is vmx non-root </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  577</span>{</div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VmcsLink = 0;</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>    __try</div>
<div class="line"><span class="lineno">  581</span>    {</div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">if</span> (!__vmx_vmread(VMCS_GUEST_VMCS_LINK_POINTER, &amp;VmcsLink))</div>
<div class="line"><span class="lineno">  583</span>        {</div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">if</span> (VmcsLink != 0)</div>
<div class="line"><span class="lineno">  585</span>            {</div>
<div class="line"><span class="lineno">  586</span>                <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  587</span>            }</div>
<div class="line"><span class="lineno">  588</span>        }</div>
<div class="line"><span class="lineno">  589</span>    }</div>
<div class="line"><span class="lineno">  590</span>    __except (1)</div>
<div class="line"><span class="lineno">  591</span>    {</div>
<div class="line"><span class="lineno">  592</span>    }</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  595</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_aae17ebb9ef7279d026817fb22f8aebe9"><div class="ttname"><a href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></div><div class="ttdeci">unsigned __int64 UINT64</div><div class="ttdef"><b>Definition</b> BasicTypes.h:21</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abbbc35bf970ac6b655e08bc3c0f46905" name="abbbc35bf970ac6b655e08bc3c0f46905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbbc35bf970ac6b655e08bc3c0f46905">&#9670;&#160;</a></span>VmxCheckVmxSupport()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxCheckVmxSupport </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check whether VMX Feature is supported or not. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if vmx is supported or false if it's not supported </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  167</span>{</div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_struct" href="struct___c_p_u_i_d.html">CPUID</a>                         <a class="code hl_variable" href="script__buffer_8hex_8txt.html#aa84ecc082767d1b77a431e100fa7fb5d">Data</a>              = {0};</div>
<div class="line"><span class="lineno">  169</span>    IA32_FEATURE_CONTROL_REGISTER FeatureControlMsr = {0};</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// Gets Processor Info and Feature Bits</span></div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  174</span>    __cpuid((<span class="keywordtype">int</span> *)&amp;<a class="code hl_variable" href="script__buffer_8hex_8txt.html#aa84ecc082767d1b77a431e100fa7fb5d">Data</a>, 1);</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">// Check For VMX Bit CPUID.ECX[5]</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="keywordflow">if</span> (!_bittest((<span class="keyword">const</span> LONG *)&amp;<a class="code hl_variable" href="script__buffer_8hex_8txt.html#aa84ecc082767d1b77a431e100fa7fb5d">Data</a>.ecx, 5))</div>
<div class="line"><span class="lineno">  180</span>    {</div>
<div class="line"><span class="lineno">  181</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  182</span>        <span class="comment">// returns FALSE if vmx is not supported</span></div>
<div class="line"><span class="lineno">  183</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  184</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  185</span>    }</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    FeatureControlMsr.AsUInt = __readmsr(IA32_FEATURE_CONTROL);</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  190</span>    <span class="comment">// Commented because of https://stackoverflow.com/questions/34900224/</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">// and https://github.com/HyperDbg/HyperDbg/issues/24</span></div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">// the problem is when writing to IA32_FEATURE_CONTROL MSR, the lock bit</span></div>
<div class="line"><span class="lineno">  193</span>    <span class="comment">// of this MSR Is not set to 0 on most computers, if the user enabled VT-X</span></div>
<div class="line"><span class="lineno">  194</span>    <span class="comment">// from the BIOS the VMXON will be already set so checking lock bit and</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="comment">// then writing to EnableVmxon again is not meaningful since its already</span></div>
<div class="line"><span class="lineno">  196</span>    <span class="comment">// there</span></div>
<div class="line"><span class="lineno">  197</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// if (FeatureControlMsr.Fields.Lock == 0)</span></div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">// {</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="comment">//     FeatureControlMsr.Fields.Lock        = TRUE;</span></div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">//     FeatureControlMsr.Fields.EnableVmxon = TRUE;</span></div>
<div class="line"><span class="lineno">  204</span>    <span class="comment">//     __writemsr(IA32_FEATURE_CONTROL, FeatureControlMsr.Flags);</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">if</span> (FeatureControlMsr.EnableVmxOutsideSmx == <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>)</div>
<div class="line"><span class="lineno">  208</span>    {</div>
<div class="line"><span class="lineno">  209</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, you should enable vt-x from BIOS&quot;</span>);</div>
<div class="line"><span class="lineno">  210</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  211</span>    }</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  214</span>}</div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a459b19922fecfbb9438dd56b66930d16"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a></div><div class="ttdeci">#define LogError(format,...)</div><div class="ttdoc">Log in the case of error.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:113</div></div>
<div class="ttc" id="ascript__buffer_8hex_8txt_html_aa84ecc082767d1b77a431e100fa7fb5d"><div class="ttname"><a href="script__buffer_8hex_8txt.html#aa84ecc082767d1b77a431e100fa7fb5d">Data</a></div><div class="ttdeci">Start of Optional Data</div><div class="ttdef"><b>Definition</b> script_buffer.hex.txt:8</div></div>
<div class="ttc" id="astruct___c_p_u_i_d_html"><div class="ttname"><a href="struct___c_p_u_i_d.html">_CPUID</a></div><div class="ttdoc">CPUID Registers.</div><div class="ttdef"><b>Definition</b> Common.h:236</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa464d719d6326915cc99171ae800abe7" name="aa464d719d6326915cc99171ae800abe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa464d719d6326915cc99171ae800abe7">&#9670;&#160;</a></span>VmxClearVmcsState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxClearVmcsState </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaeb79732cfd7f97a1983c9b3248d69f5" name="aaeb79732cfd7f97a1983c9b3248d69f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeb79732cfd7f97a1983c9b3248d69f5">&#9670;&#160;</a></span>VmxCompatibleMemcmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a> VmxCompatibleMemcmp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Count</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of vmx-root mode compatible memcmp </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Count</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>INT32 0x2 indicates error, otherwise the same result as memcmp in string.h </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1749</span>{</div>
<div class="line"><span class="lineno"> 1750</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>     C1 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>, C2 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>;</div>
<div class="line"><span class="lineno"> 1751</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>    Result = 0;</div>
<div class="line"><span class="lineno"> 1752</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   AlignedAddress1, AlignedAddress2;</div>
<div class="line"><span class="lineno"> 1753</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> GuestCr3;</div>
<div class="line"><span class="lineno"> 1754</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> OriginalCr3;</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>    AlignedAddress1 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1);</div>
<div class="line"><span class="lineno"> 1757</span>    AlignedAddress2 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2);</div>
<div class="line"><span class="lineno"> 1758</span> </div>
<div class="line"><span class="lineno"> 1759</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1760</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno"> 1761</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1762</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno"> 1763</span> </div>
<div class="line"><span class="lineno"> 1764</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1765</span>    <span class="comment">// Move to new cr3</span></div>
<div class="line"><span class="lineno"> 1766</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1767</span>    OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = __readcr3();</div>
<div class="line"><span class="lineno"> 1768</span>    __writecr3(GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1770</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1771</span>    <span class="comment">// First check</span></div>
<div class="line"><span class="lineno"> 1772</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1773</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress1, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)) || !<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress2, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1774</span>    {</div>
<div class="line"><span class="lineno"> 1775</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1776</span>        <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1777</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1778</span> </div>
<div class="line"><span class="lineno"> 1779</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1780</span>        <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1781</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1782</span>        __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1783</span>        <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1784</span>    }</div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span>    <span class="keywordflow">while</span> (Count-- &gt; 0 &amp;&amp; !Result)</div>
<div class="line"><span class="lineno"> 1787</span>    {</div>
<div class="line"><span class="lineno"> 1788</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1789</span><span class="comment">        C1 = *Address1;</span></div>
<div class="line"><span class="lineno"> 1790</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1791</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1, &amp;C1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>));</div>
<div class="line"><span class="lineno"> 1792</span> </div>
<div class="line"><span class="lineno"> 1793</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1794</span><span class="comment">        C2 = *Address2;</span></div>
<div class="line"><span class="lineno"> 1795</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1796</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2, &amp;C2, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>));</div>
<div class="line"><span class="lineno"> 1797</span> </div>
<div class="line"><span class="lineno"> 1798</span>        Address1++;</div>
<div class="line"><span class="lineno"> 1799</span>        Address2++;</div>
<div class="line"><span class="lineno"> 1800</span> </div>
<div class="line"><span class="lineno"> 1801</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1802</span>        {</div>
<div class="line"><span class="lineno"> 1803</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1804</span>            {</div>
<div class="line"><span class="lineno"> 1805</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1806</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1807</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1810</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1811</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1812</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1813</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1814</span>            }</div>
<div class="line"><span class="lineno"> 1815</span>        }</div>
<div class="line"><span class="lineno"> 1816</span> </div>
<div class="line"><span class="lineno"> 1817</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1818</span>        {</div>
<div class="line"><span class="lineno"> 1819</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1820</span>            {</div>
<div class="line"><span class="lineno"> 1821</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1822</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1823</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1824</span> </div>
<div class="line"><span class="lineno"> 1825</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1826</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1827</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1828</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1829</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1830</span>            }</div>
<div class="line"><span class="lineno"> 1831</span>        }</div>
<div class="line"><span class="lineno"> 1832</span> </div>
<div class="line"><span class="lineno"> 1833</span>        Result = C1 - C2;</div>
<div class="line"><span class="lineno"> 1834</span>    }</div>
<div class="line"><span class="lineno"> 1835</span> </div>
<div class="line"><span class="lineno"> 1836</span>    <span class="keywordflow">if</span> (Result &lt; 0)</div>
<div class="line"><span class="lineno"> 1837</span>    {</div>
<div class="line"><span class="lineno"> 1838</span>        Result = -1;</div>
<div class="line"><span class="lineno"> 1839</span>    }</div>
<div class="line"><span class="lineno"> 1840</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Result &gt; 0)</div>
<div class="line"><span class="lineno"> 1841</span>    {</div>
<div class="line"><span class="lineno"> 1842</span>        Result = 1;</div>
<div class="line"><span class="lineno"> 1843</span>    }</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1846</span>    <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1847</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1848</span>    __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1849</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1850</span>}</div>
<div class="ttc" id="a_address_check_8c_html_aec71cec56c29db61a23b2997ee8e2059"><div class="ttname"><a href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a></div><div class="ttdeci">BOOLEAN CheckAccessValidityAndSafety(UINT64 TargetAddress, UINT32 Size)</div><div class="ttdoc">Check the safety to access the memory.</div><div class="ttdef"><b>Definition</b> AddressCheck.c:156</div></div>
<div class="ttc" id="a_basic_types_8h_html_a1137216524060afd426c34677fed058b"><div class="ttname"><a href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a></div><div class="ttdeci">signed int INT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:44</div></div>
<div class="ttc" id="a_basic_types_8h_html_a32ab457827837bf5ac123dd0fd8326ae"><div class="ttname"><a href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a></div><div class="ttdeci">#define NULL_ZERO</div><div class="ttdef"><b>Definition</b> BasicTypes.h:51</div></div>
<div class="ttc" id="a_basic_types_8h_html_aebb9e13210d88d43e32e735ada43a425"><div class="ttname"><a href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a></div><div class="ttdeci">char CHAR</div><div class="ttdef"><b>Definition</b> BasicTypes.h:31</div></div>
<div class="ttc" id="a_layout_8c_html_af74e610cf3ad5dd8c972f536f2809429"><div class="ttname"><a href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a></div><div class="ttdeci">CR3_TYPE LayoutGetCurrentProcessCr3()</div><div class="ttdoc">Get cr3 of the target running process.</div><div class="ttdef"><b>Definition</b> Layout.c:55</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_ac3c23d5644111a6be18ca274f448e9ff"><div class="ttname"><a href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN MemoryMapperReadMemorySafe(UINT64 VaAddressToRead, PVOID BufferToSaveMemory, SIZE_T SizeToRead)</div><div class="ttdoc">Read memory safely by mapping the buffer (It's a wrapper)</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:1101</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_a7d467c1d283fdfa1f2081ba1e0d01b6e"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a></div><div class="ttdeci">#define PAGE_SIZE</div><div class="ttdoc">Size of each page (4096 bytes)</div><div class="ttdef"><b>Definition</b> common.h:69</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_aa02188de52b66a3aa5e1aecc6bd963ae"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a></div><div class="ttdeci">#define PAGE_ALIGN(Va)</div><div class="ttdoc">Aligning a page.</div><div class="ttdef"><b>Definition</b> common.h:75</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html">_CR3_TYPE</a></div><div class="ttdoc">CR3 Structure.</div><div class="ttdef"><b>Definition</b> BasicTypes.h:130</div></div>
<div class="ttc" id="astruct___c_r3___t_y_p_e_html_a04eb96cc99b0458be739bcc9c640e08b"><div class="ttname"><a href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">_CR3_TYPE::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition</b> BasicTypes.h:133</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4ec232fccf5297d44af914b19fd9cee" name="aa4ec232fccf5297d44af914b19fd9cee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ec232fccf5297d44af914b19fd9cee">&#9670;&#160;</a></span>VmxCompatibleStrcmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a> VmxCompatibleStrcmp </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SIZE_T</td>          <td class="paramname"><span class="paramname"><em>Num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsStrncmp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of vmx-root mode compatible strcmp and strncmp </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Num</td><td>param IsStrncmp</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>INT32 0x2 indicates error, otherwise the same result as strcmp in string.h </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1476</span>{</div>
<div class="line"><span class="lineno"> 1477</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>     C1 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>, C2 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>;</div>
<div class="line"><span class="lineno"> 1478</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>    Result = 0;</div>
<div class="line"><span class="lineno"> 1479</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   Count  = 0;</div>
<div class="line"><span class="lineno"> 1480</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   AlignedAddress1, AlignedAddress2;</div>
<div class="line"><span class="lineno"> 1481</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> GuestCr3;</div>
<div class="line"><span class="lineno"> 1482</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> OriginalCr3;</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>    AlignedAddress1 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1);</div>
<div class="line"><span class="lineno"> 1485</span>    AlignedAddress2 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2);</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1488</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno"> 1489</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1490</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1493</span>    <span class="comment">// Move to new cr3</span></div>
<div class="line"><span class="lineno"> 1494</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1495</span>    OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = __readcr3();</div>
<div class="line"><span class="lineno"> 1496</span>    __writecr3(GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1497</span> </div>
<div class="line"><span class="lineno"> 1498</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1499</span>    <span class="comment">// First check</span></div>
<div class="line"><span class="lineno"> 1500</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)) || !<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress2, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)))</div>
<div class="line"><span class="lineno"> 1502</span>    {</div>
<div class="line"><span class="lineno"> 1503</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1504</span>        <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1505</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1507</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1508</span>        <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1509</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1510</span>        __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1512</span>    }</div>
<div class="line"><span class="lineno"> 1513</span> </div>
<div class="line"><span class="lineno"> 1514</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1515</span>    {</div>
<div class="line"><span class="lineno"> 1516</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1517</span>        <span class="comment">// Check to see if we have byte number constraints</span></div>
<div class="line"><span class="lineno"> 1518</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1519</span>        <span class="keywordflow">if</span> (IsStrncmp)</div>
<div class="line"><span class="lineno"> 1520</span>        {</div>
<div class="line"><span class="lineno"> 1521</span>            <span class="keywordflow">if</span> (Count == Num)</div>
<div class="line"><span class="lineno"> 1522</span>            {</div>
<div class="line"><span class="lineno"> 1523</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1524</span>                <span class="comment">// Maximum number of bytes reached</span></div>
<div class="line"><span class="lineno"> 1525</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1526</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1527</span>            }</div>
<div class="line"><span class="lineno"> 1528</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1529</span>            {</div>
<div class="line"><span class="lineno"> 1530</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1531</span>                <span class="comment">// Maximum number of bytes not reached</span></div>
<div class="line"><span class="lineno"> 1532</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1533</span>                Count++;</div>
<div class="line"><span class="lineno"> 1534</span>            }</div>
<div class="line"><span class="lineno"> 1535</span>        }</div>
<div class="line"><span class="lineno"> 1536</span> </div>
<div class="line"><span class="lineno"> 1537</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1538</span><span class="comment">        C1 = *Address1;</span></div>
<div class="line"><span class="lineno"> 1539</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1540</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1, &amp;C1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>));</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1543</span><span class="comment">        C2 = *Address2;</span></div>
<div class="line"><span class="lineno"> 1544</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1545</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2, &amp;C2, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>));</div>
<div class="line"><span class="lineno"> 1546</span> </div>
<div class="line"><span class="lineno"> 1547</span>        Address1++;</div>
<div class="line"><span class="lineno"> 1548</span>        Address2++;</div>
<div class="line"><span class="lineno"> 1549</span> </div>
<div class="line"><span class="lineno"> 1550</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1551</span>        {</div>
<div class="line"><span class="lineno"> 1552</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)))</div>
<div class="line"><span class="lineno"> 1553</span>            {</div>
<div class="line"><span class="lineno"> 1554</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1555</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1556</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1559</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1560</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1561</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1562</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1563</span>            }</div>
<div class="line"><span class="lineno"> 1564</span>        }</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1567</span>        {</div>
<div class="line"><span class="lineno"> 1568</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)))</div>
<div class="line"><span class="lineno"> 1569</span>            {</div>
<div class="line"><span class="lineno"> 1570</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1571</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1572</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1575</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1576</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1577</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1578</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1579</span>            }</div>
<div class="line"><span class="lineno"> 1580</span>        }</div>
<div class="line"><span class="lineno"> 1581</span>        Result = C1 - C2;</div>
<div class="line"><span class="lineno"> 1582</span>    } <span class="keywordflow">while</span> (!Result &amp;&amp; C2);</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>    <span class="keywordflow">if</span> (Result &lt; 0)</div>
<div class="line"><span class="lineno"> 1585</span>    {</div>
<div class="line"><span class="lineno"> 1586</span>        Result = -1;</div>
<div class="line"><span class="lineno"> 1587</span>    }</div>
<div class="line"><span class="lineno"> 1588</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Result &gt; 0)</div>
<div class="line"><span class="lineno"> 1589</span>    {</div>
<div class="line"><span class="lineno"> 1590</span>        Result = 1;</div>
<div class="line"><span class="lineno"> 1591</span>    }</div>
<div class="line"><span class="lineno"> 1592</span> </div>
<div class="line"><span class="lineno"> 1593</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1594</span>    <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1595</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1596</span>    __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1597</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1598</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84a3bd5efc8ff0858c095e18fe0999da" name="a84a3bd5efc8ff0858c095e18fe0999da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84a3bd5efc8ff0858c095e18fe0999da">&#9670;&#160;</a></span>VmxCompatibleStrlen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> VmxCompatibleStrlen </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> *</td>          <td class="paramname"><span class="paramname"><em>S</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of vmx-root mode compatible strlen </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT32 If 0x0 indicates an error, otherwise length of the string </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1291</span>{</div>
<div class="line"><span class="lineno"> 1292</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>     Temp  = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>;</div>
<div class="line"><span class="lineno"> 1293</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   Count = 0;</div>
<div class="line"><span class="lineno"> 1294</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   AlignedAddress;</div>
<div class="line"><span class="lineno"> 1295</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> GuestCr3;</div>
<div class="line"><span class="lineno"> 1296</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> OriginalCr3;</div>
<div class="line"><span class="lineno"> 1297</span> </div>
<div class="line"><span class="lineno"> 1298</span>    AlignedAddress = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>);</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1301</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1303</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno"> 1304</span> </div>
<div class="line"><span class="lineno"> 1305</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1306</span>    <span class="comment">// Move to new cr3</span></div>
<div class="line"><span class="lineno"> 1307</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1308</span>    OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = __readcr3();</div>
<div class="line"><span class="lineno"> 1309</span>    __writecr3(GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1312</span>    <span class="comment">// First check</span></div>
<div class="line"><span class="lineno"> 1313</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1314</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)))</div>
<div class="line"><span class="lineno"> 1315</span>    {</div>
<div class="line"><span class="lineno"> 1316</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1317</span>        <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1318</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1321</span>        <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1322</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1323</span>        __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1324</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1325</span>    }</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>    <span class="keywordflow">while</span> (<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno"> 1328</span>    {</div>
<div class="line"><span class="lineno"> 1329</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="comment">        Temp = *S;</span></div>
<div class="line"><span class="lineno"> 1331</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1332</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>, &amp;Temp, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>));</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span>        <span class="keywordflow">if</span> (Temp != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line"><span class="lineno"> 1335</span>        {</div>
<div class="line"><span class="lineno"> 1336</span>            Count++;</div>
<div class="line"><span class="lineno"> 1337</span>            <a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>++;</div>
<div class="line"><span class="lineno"> 1338</span>        }</div>
<div class="line"><span class="lineno"> 1339</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1340</span>        {</div>
<div class="line"><span class="lineno"> 1341</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1342</span>            <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1343</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1344</span>            __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1345</span>            <span class="keywordflow">return</span> Count;</div>
<div class="line"><span class="lineno"> 1346</span>        }</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a> &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1349</span>        {</div>
<div class="line"><span class="lineno"> 1350</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>)))</div>
<div class="line"><span class="lineno"> 1351</span>            {</div>
<div class="line"><span class="lineno"> 1352</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1353</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1354</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1357</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1358</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1359</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1360</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1361</span>            }</div>
<div class="line"><span class="lineno"> 1362</span>        }</div>
<div class="line"><span class="lineno"> 1363</span>    }</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1366</span>    <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1367</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1368</span>    __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1369</span>}</div>
<div class="ttc" id="a_grammar_8txt_html_a53a9333e37e4d5b1b7a474958bfa419f"><div class="ttname"><a href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a></div><div class="ttdeci">ThreeOpFunc1 interlocked_compare_exchange ThreeOpFunc2 event_inject_error_code memcpy TwoOpFunc1 ed eb eq interlocked_exchange interlocked_exchange_add TwoOpFunc2 spinlock_lock_custom_wait event_inject OneOpFunc1 poi db dd dw dq neg hi low not check_address disassemble_len disassemble_len32 disassemble_len64 interlocked_increment interlocked_decrement reference physical_to_virtual virtual_to_physical OneOpFunc2 print formats event_enable event_disable event_clear test_statement spinlock_lock spinlock_unlock event_sc OneOpFunc3 strlen TwoOpFunc3 strcmp ThreeOpFunc3 memcmp strncmp ThreeOpFunc4 wcsncmp OneOpFunc4 wcslen TwoOpFunc4 wcscmp ZeroOpFunc1 pause flush event_trace_step event_trace_step_in event_trace_step_out event_trace_instrumentation_step event_trace_instrumentation_step_in VarArgFunc1 printf OperatorsTwoOperand or xor and asr asl add sub mul div mod gt lt egt elt equal neq OperatorsOneOperand inc dec reference dereference SemantiRules start_of_if jmp jz jnz jmp_to_end_and_jzcompleted end_of_if start_of_while end_of_while vargstart mov start_of_do_while start_of_do_while_commands end_of_do_while start_of_for for_inc_dec start_of_for_ommands end_of_if ignore_lvalue push pop call ret Registers rax eax ax ah al rcx ecx cx ch cl rdx edx dx dh dl rbx ebx bx bh bl rsp esp sp spl rbp ebp bp bpl rsi esi si sil rdi edi di dil r8 r8d r8w r8h r8l r9 r9d r9w r9h r9l r10 r10d r10w r10h r10l r11 r11d r11w r11h r11l r12 r12d r12w r12h r12l r13 r13d r13w r13h r13l r14 r14d r14w r14h r14l r15 r15d r15w r15h r15l ds es fs gs cs ss rflags eflags flags cf pf af zf sf tf if df of iopl nt rf vm ac vif vip id rip eip ip idtr ldtr gdtr tr cr0 cr2 cr3 cr4 cr8 dr0 dr1 dr2 dr3 dr6 dr7 PseudoRegisters pid tid pname core proc thread peb teb ip buffer context event_tag event_id event_stage date time S STATEMENT S S</div><div class="ttdef"><b>Definition</b> Grammar.txt:51</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a57357ebeb98175ca5326f1bfe8490ee4" name="a57357ebeb98175ca5326f1bfe8490ee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57357ebeb98175ca5326f1bfe8490ee4">&#9670;&#160;</a></span>VmxCompatibleWcscmp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a> VmxCompatibleWcscmp </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>Address2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SIZE_T</td>          <td class="paramname"><span class="paramname"><em>Num</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></td>          <td class="paramname"><span class="paramname"><em>IsWcsncmp</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of vmx-root mode compatible wcscmp and wcsncmp </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Address1</td><td></td></tr>
    <tr><td class="paramname">Address2</td><td></td></tr>
    <tr><td class="paramname">Num</td><td></td></tr>
    <tr><td class="paramname">IsWcsncmp</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>INT32 0x2 indicates error, otherwise the same result as wcscmp in string.h </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1614</span>{</div>
<div class="line"><span class="lineno"> 1615</span>    <span class="keywordtype">wchar_t</span>  C1 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>, C2 = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>;</div>
<div class="line"><span class="lineno"> 1616</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a1137216524060afd426c34677fed058b">INT32</a>    Result = 0;</div>
<div class="line"><span class="lineno"> 1617</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   Count  = 0;</div>
<div class="line"><span class="lineno"> 1618</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   AlignedAddress1, AlignedAddress2;</div>
<div class="line"><span class="lineno"> 1619</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> GuestCr3;</div>
<div class="line"><span class="lineno"> 1620</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> OriginalCr3;</div>
<div class="line"><span class="lineno"> 1621</span> </div>
<div class="line"><span class="lineno"> 1622</span>    AlignedAddress1 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1);</div>
<div class="line"><span class="lineno"> 1623</span>    AlignedAddress2 = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2);</div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1626</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno"> 1627</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1628</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1631</span>    <span class="comment">// Move to new cr3</span></div>
<div class="line"><span class="lineno"> 1632</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1633</span>    OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = __readcr3();</div>
<div class="line"><span class="lineno"> 1634</span>    __writecr3(GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1635</span> </div>
<div class="line"><span class="lineno"> 1636</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1637</span>    <span class="comment">// First check</span></div>
<div class="line"><span class="lineno"> 1638</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1639</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress1, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)) || !<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress2, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1640</span>    {</div>
<div class="line"><span class="lineno"> 1641</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1642</span>        <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1643</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1646</span>        <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1647</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1648</span>        __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1649</span>        <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1650</span>    }</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1652</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno"> 1653</span>    {</div>
<div class="line"><span class="lineno"> 1654</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1655</span>        <span class="comment">// Check to see if we have byte number constraints</span></div>
<div class="line"><span class="lineno"> 1656</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1657</span>        <span class="keywordflow">if</span> (IsWcsncmp)</div>
<div class="line"><span class="lineno"> 1658</span>        {</div>
<div class="line"><span class="lineno"> 1659</span>            <span class="keywordflow">if</span> (Count == Num)</div>
<div class="line"><span class="lineno"> 1660</span>            {</div>
<div class="line"><span class="lineno"> 1661</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1662</span>                <span class="comment">// Maximum number of bytes reached</span></div>
<div class="line"><span class="lineno"> 1663</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1664</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1665</span>            }</div>
<div class="line"><span class="lineno"> 1666</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1667</span>            {</div>
<div class="line"><span class="lineno"> 1668</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1669</span>                <span class="comment">// Maximum number of bytes not reached</span></div>
<div class="line"><span class="lineno"> 1670</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1671</span>                Count++;</div>
<div class="line"><span class="lineno"> 1672</span>            }</div>
<div class="line"><span class="lineno"> 1673</span>        }</div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="comment">        C1 = *Address1;</span></div>
<div class="line"><span class="lineno"> 1677</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1678</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address1, &amp;C1, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>));</div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1681</span><span class="comment">        C2 = *Address2;</span></div>
<div class="line"><span class="lineno"> 1682</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1683</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)Address2, &amp;C2, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>));</div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>        Address1++;</div>
<div class="line"><span class="lineno"> 1686</span>        Address2++;</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1689</span>        {</div>
<div class="line"><span class="lineno"> 1690</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress1, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1691</span>            {</div>
<div class="line"><span class="lineno"> 1692</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1693</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1694</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1697</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1698</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1699</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1700</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1701</span>            }</div>
<div class="line"><span class="lineno"> 1702</span>        }</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2 &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1705</span>        {</div>
<div class="line"><span class="lineno"> 1706</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)AlignedAddress2, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1707</span>            {</div>
<div class="line"><span class="lineno"> 1708</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1709</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1710</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1713</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1714</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1715</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1716</span>                <span class="keywordflow">return</span> 0x2;</div>
<div class="line"><span class="lineno"> 1717</span>            }</div>
<div class="line"><span class="lineno"> 1718</span>        }</div>
<div class="line"><span class="lineno"> 1719</span> </div>
<div class="line"><span class="lineno"> 1720</span>        Result = C1 - C2;</div>
<div class="line"><span class="lineno"> 1721</span>    } <span class="keywordflow">while</span> (!Result &amp;&amp; C2);</div>
<div class="line"><span class="lineno"> 1722</span> </div>
<div class="line"><span class="lineno"> 1723</span>    <span class="keywordflow">if</span> (Result &lt; 0)</div>
<div class="line"><span class="lineno"> 1724</span>    {</div>
<div class="line"><span class="lineno"> 1725</span>        Result = -1;</div>
<div class="line"><span class="lineno"> 1726</span>    }</div>
<div class="line"><span class="lineno"> 1727</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Result &gt; 0)</div>
<div class="line"><span class="lineno"> 1728</span>    {</div>
<div class="line"><span class="lineno"> 1729</span>        Result = 1;</div>
<div class="line"><span class="lineno"> 1730</span>    }</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1733</span>    <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1734</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1735</span>    __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1736</span>    <span class="keywordflow">return</span> Result;</div>
<div class="line"><span class="lineno"> 1737</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e2e419641070da1b794c2c62e691cc3" name="a2e2e419641070da1b794c2c62e691cc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2e419641070da1b794c2c62e691cc3">&#9670;&#160;</a></span>VmxCompatibleWcslen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> VmxCompatibleWcslen </td>
          <td>(</td>
          <td class="paramtype">const wchar_t *</td>          <td class="paramname"><span class="paramname"><em>S</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>implementation of vmx-root mode compatible wcslen </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">S</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UINT32 If 0x0 indicates an error, otherwise length of the string </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1380</span>{</div>
<div class="line"><span class="lineno"> 1381</span>    <span class="keywordtype">wchar_t</span>  Temp  = <a class="code hl_define" href="_basic_types_8h.html#a32ab457827837bf5ac123dd0fd8326ae">NULL_ZERO</a>;</div>
<div class="line"><span class="lineno"> 1382</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>   Count = 0;</div>
<div class="line"><span class="lineno"> 1383</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>   AlignedAddress;</div>
<div class="line"><span class="lineno"> 1384</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> GuestCr3;</div>
<div class="line"><span class="lineno"> 1385</span>    <a class="code hl_struct" href="struct___c_r3___t_y_p_e.html">CR3_TYPE</a> OriginalCr3;</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>    AlignedAddress = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>);</div>
<div class="line"><span class="lineno"> 1388</span> </div>
<div class="line"><span class="lineno"> 1389</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1390</span>    <span class="comment">// Find the current process cr3</span></div>
<div class="line"><span class="lineno"> 1391</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1392</span>    GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = <a class="code hl_function" href="_layout_8c.html#af74e610cf3ad5dd8c972f536f2809429">LayoutGetCurrentProcessCr3</a>().<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>;</div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1395</span>    <span class="comment">// Move to new cr3</span></div>
<div class="line"><span class="lineno"> 1396</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1397</span>    OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a> = __readcr3();</div>
<div class="line"><span class="lineno"> 1398</span>    __writecr3(GuestCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>    AlignedAddress = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa02188de52b66a3aa5e1aecc6bd963ae">PAGE_ALIGN</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>);</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1403</span>    <span class="comment">// First check</span></div>
<div class="line"><span class="lineno"> 1404</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1405</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>(AlignedAddress, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1406</span>    {</div>
<div class="line"><span class="lineno"> 1407</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1408</span>        <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1409</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1412</span>        <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1413</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1414</span>        __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1415</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1416</span>    }</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>    <span class="keywordflow">while</span> (<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno"> 1419</span>    {</div>
<div class="line"><span class="lineno"> 1420</span>        <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1421</span><span class="comment">        Temp = *S;</span></div>
<div class="line"><span class="lineno"> 1422</span><span class="comment">        */</span></div>
<div class="line"><span class="lineno"> 1423</span>        <a class="code hl_function" href="_memory_mapper_8c.html#ac3c23d5644111a6be18ca274f448e9ff">MemoryMapperReadMemorySafe</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>, &amp;Temp, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>));</div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">if</span> (Temp != <span class="stringliteral">&#39;\0\0&#39;</span>)</div>
<div class="line"><span class="lineno"> 1426</span>        {</div>
<div class="line"><span class="lineno"> 1427</span>            Count++;</div>
<div class="line"><span class="lineno"> 1428</span>            <a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>++;</div>
<div class="line"><span class="lineno"> 1429</span>        }</div>
<div class="line"><span class="lineno"> 1430</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1431</span>        {</div>
<div class="line"><span class="lineno"> 1432</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1433</span>            <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1434</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1435</span>            __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1436</span>            <span class="keywordflow">return</span> Count;</div>
<div class="line"><span class="lineno"> 1437</span>        }</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>        <span class="keywordflow">if</span> (!((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a> &amp; (<a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a7d467c1d283fdfa1f2081ba1e0d01b6e">PAGE_SIZE</a> - 1)))</div>
<div class="line"><span class="lineno"> 1440</span>        {</div>
<div class="line"><span class="lineno"> 1441</span>            <span class="keywordflow">if</span> (!<a class="code hl_function" href="_address_check_8c.html#aec71cec56c29db61a23b2997ee8e2059">CheckAccessValidityAndSafety</a>((<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)<a class="code hl_variable" href="_grammar_8txt.html#a53a9333e37e4d5b1b7a474958bfa419f">S</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>)))</div>
<div class="line"><span class="lineno"> 1442</span>            {</div>
<div class="line"><span class="lineno"> 1443</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1444</span>                <span class="comment">// Error</span></div>
<div class="line"><span class="lineno"> 1445</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1448</span>                <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1449</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1450</span>                __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1451</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1452</span>            }</div>
<div class="line"><span class="lineno"> 1453</span>        }</div>
<div class="line"><span class="lineno"> 1454</span>    }</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1457</span>    <span class="comment">// Move back to original cr3</span></div>
<div class="line"><span class="lineno"> 1458</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1459</span>    __writecr3(OriginalCr3.<a class="code hl_variable" href="struct___c_r3___t_y_p_e.html#a04eb96cc99b0458be739bcc9c640e08b">Flags</a>);</div>
<div class="line"><span class="lineno"> 1460</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56536723aab6c8ccb4719ff1eac2c25f" name="a56536723aab6c8ccb4719ff1eac2c25f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56536723aab6c8ccb4719ff1eac2c25f">&#9670;&#160;</a></span>VmxFixCr4AndCr0Bits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxFixCr4AndCr0Bits </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fix values for cr0 and cr4 bits. </p>
<p>The Cr4 And Cr0 Bits During VMX Operation Preventing Them From Any Change (<a href="https://revers.engineering/day-2-entering-vmx-operation/">https://revers.engineering/day-2-entering-vmx-operation/</a>)</p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  542</span>{</div>
<div class="line"><span class="lineno">  543</span>    <a class="code hl_union" href="union___c_r___f_i_x_e_d.html">CR_FIXED</a> CrFixed = {0};</div>
<div class="line"><span class="lineno">  544</span>    CR4      Cr4     = {0};</div>
<div class="line"><span class="lineno">  545</span>    CR0      Cr0     = {0};</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="comment">// Fix Cr0</span></div>
<div class="line"><span class="lineno">  549</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  550</span>    CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a234b22477a295b0e57092544d0f02a62">Flags</a> = __readmsr(IA32_VMX_CR0_FIXED0);</div>
<div class="line"><span class="lineno">  551</span>    Cr0.AsUInt    = __readcr0();</div>
<div class="line"><span class="lineno">  552</span>    Cr0.AsUInt |= CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a194a85deeb996c763887291de0d6c239">Fields</a>.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a1295d83d7e48f5a6a180fea7978619a6">Low</a>;</div>
<div class="line"><span class="lineno">  553</span>    CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a234b22477a295b0e57092544d0f02a62">Flags</a> = __readmsr(IA32_VMX_CR0_FIXED1);</div>
<div class="line"><span class="lineno">  554</span>    Cr0.AsUInt &amp;= CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a194a85deeb996c763887291de0d6c239">Fields</a>.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a1295d83d7e48f5a6a180fea7978619a6">Low</a>;</div>
<div class="line"><span class="lineno">  555</span>    __writecr0(Cr0.AsUInt);</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">// Fix Cr4</span></div>
<div class="line"><span class="lineno">  559</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  560</span>    CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a234b22477a295b0e57092544d0f02a62">Flags</a> = __readmsr(IA32_VMX_CR4_FIXED0);</div>
<div class="line"><span class="lineno">  561</span>    Cr4.AsUInt    = __readcr4();</div>
<div class="line"><span class="lineno">  562</span>    Cr4.AsUInt |= CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a194a85deeb996c763887291de0d6c239">Fields</a>.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a1295d83d7e48f5a6a180fea7978619a6">Low</a>;</div>
<div class="line"><span class="lineno">  563</span>    CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a234b22477a295b0e57092544d0f02a62">Flags</a> = __readmsr(IA32_VMX_CR4_FIXED1);</div>
<div class="line"><span class="lineno">  564</span>    Cr4.AsUInt &amp;= CrFixed.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a194a85deeb996c763887291de0d6c239">Fields</a>.<a class="code hl_variable" href="union___c_r___f_i_x_e_d.html#a1295d83d7e48f5a6a180fea7978619a6">Low</a>;</div>
<div class="line"><span class="lineno">  565</span>    __writecr4(Cr4.AsUInt);</div>
<div class="line"><span class="lineno">  566</span>}</div>
<div class="ttc" id="aunion___c_r___f_i_x_e_d_html"><div class="ttname"><a href="union___c_r___f_i_x_e_d.html">_CR_FIXED</a></div><div class="ttdef"><b>Definition</b> Common.h:244</div></div>
<div class="ttc" id="aunion___c_r___f_i_x_e_d_html_a1295d83d7e48f5a6a180fea7978619a6"><div class="ttname"><a href="union___c_r___f_i_x_e_d.html#a1295d83d7e48f5a6a180fea7978619a6">_CR_FIXED::Low</a></div><div class="ttdeci">unsigned long Low</div><div class="ttdef"><b>Definition</b> Common.h:249</div></div>
<div class="ttc" id="aunion___c_r___f_i_x_e_d_html_a194a85deeb996c763887291de0d6c239"><div class="ttname"><a href="union___c_r___f_i_x_e_d.html#a194a85deeb996c763887291de0d6c239">_CR_FIXED::Fields</a></div><div class="ttdeci">struct _CR_FIXED::@0 Fields</div></div>
<div class="ttc" id="aunion___c_r___f_i_x_e_d_html_a234b22477a295b0e57092544d0f02a62"><div class="ttname"><a href="union___c_r___f_i_x_e_d.html#a234b22477a295b0e57092544d0f02a62">_CR_FIXED::Flags</a></div><div class="ttdeci">UINT64 Flags</div><div class="ttdef"><b>Definition</b> Common.h:245</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21a5facaf10e8fbeb70dd00942e51ef1" name="a21a5facaf10e8fbeb70dd00942e51ef1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a5facaf10e8fbeb70dd00942e51ef1">&#9670;&#160;</a></span>VmxGetCurrentExecutionMode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxGetCurrentExecutionMode </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check current execution mode (vmx-root and non-root) </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if the execution is on vmx-root, otherwise false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  223</span>{</div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>)</div>
<div class="line"><span class="lineno">  225</span>    {</div>
<div class="line"><span class="lineno">  226</span>        <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                   CurrentCore    = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * CurrentVmState = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore];</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">return</span> CurrentVmState-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac3a540948c9dbdb00cce2ef4beb6aa20">IsOnVmxRootMode</a> ? <a class="code hl_enumvalue" href="_data_types_8h.html#aa3d274ecfb8f42a16c4827d872241fc4a6ad497a95ab270156d4acfb3b1106104">VmxExecutionModeRoot</a> : <a class="code hl_enumvalue" href="_data_types_8h.html#aa3d274ecfb8f42a16c4827d872241fc4a4766e6886433f4096309a4643a4b2572">VmxExecutionModeNonRoot</a>;</div>
<div class="line"><span class="lineno">  230</span>    }</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  232</span>    {</div>
<div class="line"><span class="lineno">  233</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span>        <span class="comment">// The structure for guest state is not initialized, thus, we&#39;re in VMX non-root</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="_data_types_8h.html#aa3d274ecfb8f42a16c4827d872241fc4a4766e6886433f4096309a4643a4b2572">VmxExecutionModeNonRoot</a>;</div>
<div class="line"><span class="lineno">  237</span>    }</div>
<div class="line"><span class="lineno">  238</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_data_types_8h_html_aa3d274ecfb8f42a16c4827d872241fc4a4766e6886433f4096309a4643a4b2572"><div class="ttname"><a href="_data_types_8h.html#aa3d274ecfb8f42a16c4827d872241fc4a4766e6886433f4096309a4643a4b2572">VmxExecutionModeNonRoot</a></div><div class="ttdeci">@ VmxExecutionModeNonRoot</div><div class="ttdef"><b>Definition</b> DataTypes.h:82</div></div>
<div class="ttc" id="a_data_types_8h_html_aa3d274ecfb8f42a16c4827d872241fc4a6ad497a95ab270156d4acfb3b1106104"><div class="ttname"><a href="_data_types_8h.html#aa3d274ecfb8f42a16c4827d872241fc4a6ad497a95ab270156d4acfb3b1106104">VmxExecutionModeRoot</a></div><div class="ttdeci">@ VmxExecutionModeRoot</div><div class="ttdef"><b>Definition</b> DataTypes.h:83</div></div>
<div class="ttc" id="a_global_variables_8h_html_a04bac1f4beef0dcf1ce1a4d9ce72ea76"><div class="ttname"><a href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a></div><div class="ttdeci">VIRTUAL_MACHINE_STATE * g_GuestState</div><div class="ttdoc">Save the state and variables related to virtualization on each to logical core.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:38</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">_VIRTUAL_MACHINE_STATE</a></div><div class="ttdoc">The status of each core after and before VMX.</div><div class="ttdef"><b>Definition</b> State.h:290</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ac3a540948c9dbdb00cce2ef4beb6aa20"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ac3a540948c9dbdb00cce2ef4beb6aa20">_VIRTUAL_MACHINE_STATE::IsOnVmxRootMode</a></div><div class="ttdeci">BOOLEAN IsOnVmxRootMode</div><div class="ttdef"><b>Definition</b> State.h:291</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a54291454c7d99c90bf5e19a939825634" name="a54291454c7d99c90bf5e19a939825634"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54291454c7d99c90bf5e19a939825634">&#9670;&#160;</a></span>VmxGetCurrentLaunchState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxGetCurrentLaunchState </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the VMX is launched or not. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if it's launched, otherwise false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  247</span>{</div>
<div class="line"><span class="lineno">  248</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                   CurrentCore    = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * CurrentVmState = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore];</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordflow">return</span> CurrentVmState-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aaacba0883eec22779a564fb93aea73fd">HasLaunched</a>;</div>
<div class="line"><span class="lineno">  252</span>}</div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aaacba0883eec22779a564fb93aea73fd"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aaacba0883eec22779a564fb93aea73fd">_VIRTUAL_MACHINE_STATE::HasLaunched</a></div><div class="ttdeci">BOOLEAN HasLaunched</div><div class="ttdef"><b>Definition</b> State.h:293</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a27cfa5f4da41fd687cdcb7e4f0054db6" name="a27cfa5f4da41fd687cdcb7e4f0054db6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27cfa5f4da41fd687cdcb7e4f0054db6">&#9670;&#160;</a></span>VmxHandleTripleFaults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxHandleTripleFaults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling triple fault VM-exits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, triple fault error occurred!&quot;</span>);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   55</span>    <span class="comment">// This error cannot be recovered, produce debug results</span></div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_function" href="hyperhv_2code_2common_2_common_8c.html#a9ddd380f0a0e4d2f8b316a119f8d929b">CommonWriteDebugInformation</a>(VCpu);</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   60</span>    <span class="comment">// We won&#39;t further continue after this error</span></div>
<div class="line"><span class="lineno">   61</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   62</span>    DbgBreakPoint();</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="ahyperhv_2code_2common_2_common_8c_html_a9ddd380f0a0e4d2f8b316a119f8d929b"><div class="ttname"><a href="hyperhv_2code_2common_2_common_8c.html#a9ddd380f0a0e4d2f8b316a119f8d929b">CommonWriteDebugInformation</a></div><div class="ttdeci">VOID CommonWriteDebugInformation(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Produce debug information from unrecoverable bugs.</div><div class="ttdef"><b>Definition</b> Common.c:149</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d722cd80873651fe42d3af85b812622" name="a7d722cd80873651fe42d3af85b812622"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d722cd80873651fe42d3af85b812622">&#9670;&#160;</a></span>VmxHandleVmxPreemptionTimerVmexit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxHandleVmxPreemptionTimerVmexit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling VMX Preemption Timer vm-exits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Why vm-exit for VMX preemption timer happened?&quot;</span>);</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="comment">// Not increase the RIP by default</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">   40</span>    <a class="code hl_function" href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a>(VCpu);</div>
<div class="line"><span class="lineno">   41</span>}</div>
<div class="ttc" id="a_hv_8c_html_a384185281b4d93ce4a401d66848d9049"><div class="ttname"><a href="_hv_8c.html#a384185281b4d93ce4a401d66848d9049">HvSuppressRipIncrement</a></div><div class="ttdeci">VOID HvSuppressRipIncrement(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Suppress the incrementation of RIP.</div><div class="ttdef"><b>Definition</b> Hv.c:324</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac31024ae20ebac7de8789baa1e29ab1d" name="ac31024ae20ebac7de8789baa1e29ab1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac31024ae20ebac7de8789baa1e29ab1d">&#9670;&#160;</a></span>VmxHandleXsetbv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxHandleXsetbv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handling XSETBV Instruction vm-exits. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{</div>
<div class="line"><span class="lineno">   23</span>    _xsetbv(VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">rcx</a> &amp; 0xffffffff, VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#aec9eaf1f15df1582b6f00119516a8e08">rdx</a> &lt;&lt; 32 | VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">Regs</a>-&gt;<a class="code hl_variable" href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">rax</a>);</div>
<div class="line"><span class="lineno">   24</span>}</div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aae00ab92fdce5f90e65edb3bd10ae696"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aae00ab92fdce5f90e65edb3bd10ae696">_VIRTUAL_MACHINE_STATE::Regs</a></div><div class="ttdeci">GUEST_REGS * Regs</div><div class="ttdef"><b>Definition</b> State.h:305</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a346ed6ae20503154a9a8031491706b3e"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a346ed6ae20503154a9a8031491706b3e">GUEST_REGS::rax</a></div><div class="ttdeci">UINT64 rax</div><div class="ttdef"><b>Definition</b> BasicTypes.h:75</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_a9a9133a328f13d405c31df928307e9fd"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#a9a9133a328f13d405c31df928307e9fd">GUEST_REGS::rcx</a></div><div class="ttdeci">UINT64 rcx</div><div class="ttdef"><b>Definition</b> BasicTypes.h:76</div></div>
<div class="ttc" id="astruct_g_u_e_s_t___r_e_g_s_html_aec9eaf1f15df1582b6f00119516a8e08"><div class="ttname"><a href="struct_g_u_e_s_t___r_e_g_s.html#aec9eaf1f15df1582b6f00119516a8e08">GUEST_REGS::rdx</a></div><div class="ttdeci">UINT64 rdx</div><div class="ttdef"><b>Definition</b> BasicTypes.h:77</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8edcdeb74c24f1408eca2daf1ce986a" name="ae8edcdeb74c24f1408eca2daf1ce986a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8edcdeb74c24f1408eca2daf1ce986a">&#9670;&#160;</a></span>VmxInitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxInitialize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the VMX operation. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if vmx initialized successfully </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  261</span>{</div>
<div class="line"><span class="lineno">  262</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> ProcessorsCount;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">// ****** Start Virtualizing Current System ******</span></div>
<div class="line"><span class="lineno">  266</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  269</span>    <span class="comment">// Initiating EPTP and VMX</span></div>
<div class="line"><span class="lineno">  270</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_8c.html#a412b9cc437ccd62987c8f5a01e0a3f2d">VmxPerformVirtualizationOnAllCores</a>())</div>
<div class="line"><span class="lineno">  272</span>    {</div>
<div class="line"><span class="lineno">  273</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  274</span>        <span class="comment">// there was error somewhere in initializing</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  277</span>    }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>    ProcessorsCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ProcessorID = 0; ProcessorID &lt; ProcessorsCount; ProcessorID++)</div>
<div class="line"><span class="lineno">  282</span>    {</div>
<div class="line"><span class="lineno">  283</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  284</span>        <span class="comment">// *** Launching VM for Test (in the all logical processor) ***</span></div>
<div class="line"><span class="lineno">  285</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>        <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * GuestState = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[ProcessorID];</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  290</span>        <span class="comment">// Allocating VMM Stack</span></div>
<div class="line"><span class="lineno">  291</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#aa52d4fb46038fa50963bca46df2bba20">VmxAllocateVmmStack</a>(GuestState))</div>
<div class="line"><span class="lineno">  293</span>        {</div>
<div class="line"><span class="lineno">  294</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  295</span>            <span class="comment">// Some error in allocating Vmm Stack</span></div>
<div class="line"><span class="lineno">  296</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  297</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  298</span>        }</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  301</span>        <span class="comment">// Allocating MSR Bit</span></div>
<div class="line"><span class="lineno">  302</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  303</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#a6b5ac1b2515912b3097922be01ed264a">VmxAllocateMsrBitmap</a>(GuestState))</div>
<div class="line"><span class="lineno">  304</span>        {</div>
<div class="line"><span class="lineno">  305</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  306</span>            <span class="comment">// Some error in allocating Msr Bitmaps</span></div>
<div class="line"><span class="lineno">  307</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  308</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  309</span>        }</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  312</span>        <span class="comment">// Allocating I/O Bit</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#a5ecb9af59c8b9652916b17716448d188">VmxAllocateIoBitmaps</a>(GuestState))</div>
<div class="line"><span class="lineno">  315</span>        {</div>
<div class="line"><span class="lineno">  316</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  317</span>            <span class="comment">// Some error in allocating I/O Bitmaps</span></div>
<div class="line"><span class="lineno">  318</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  319</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  320</span>        }</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span><span class="preprocessor">#if USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  325</span>        <span class="comment">// Allocating Host IDT</span></div>
<div class="line"><span class="lineno">  326</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  327</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#a04f29f1f6f56059cfa0d7bbe8dad10b9">VmxAllocateHostIdt</a>(GuestState))</div>
<div class="line"><span class="lineno">  328</span>        {</div>
<div class="line"><span class="lineno">  329</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  330</span>            <span class="comment">// Some error in allocating Host IDT</span></div>
<div class="line"><span class="lineno">  331</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  332</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  333</span>        }</div>
<div class="line"><span class="lineno">  334</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span><span class="preprocessor">#if USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  339</span>        <span class="comment">// Allocating Host GDT</span></div>
<div class="line"><span class="lineno">  340</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#abb8feca5c79686469f0eb5f9dc82d548">VmxAllocateHostGdt</a>(GuestState))</div>
<div class="line"><span class="lineno">  342</span>        {</div>
<div class="line"><span class="lineno">  343</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  344</span>            <span class="comment">// Some error in allocating Host GDT</span></div>
<div class="line"><span class="lineno">  345</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  346</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  347</span>        }</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">// Allocating Host TSS</span></div>
<div class="line"><span class="lineno">  351</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#aff29b1b936f30878282c0b6744702347">VmxAllocateHostTss</a>(GuestState))</div>
<div class="line"><span class="lineno">  353</span>        {</div>
<div class="line"><span class="lineno">  354</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  355</span>            <span class="comment">// Some error in allocating Host TSS</span></div>
<div class="line"><span class="lineno">  356</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  357</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  358</span>        }</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span><span class="preprocessor">#if USE_INTERRUPT_STACK_TABLE == TRUE</span></div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  365</span>        <span class="comment">// Allocating Host Interrupt Stack</span></div>
<div class="line"><span class="lineno">  366</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  367</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#a7a1491d5ccd6b3c8feb3289a070b9a2b">VmxAllocateHostInterruptStack</a>(GuestState))</div>
<div class="line"><span class="lineno">  368</span>        {</div>
<div class="line"><span class="lineno">  369</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  370</span>            <span class="comment">// Some error in allocating Interrupt Stack</span></div>
<div class="line"><span class="lineno">  371</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  372</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  373</span>        }</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span><span class="preprocessor">#endif </span><span class="comment">// USE_INTERRUPT_STACK_TABLE == TRUE</span></div>
<div class="line"><span class="lineno">  376</span>    }</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  379</span>    <span class="comment">// Create a bitmap of the MSRs that cause #GP</span></div>
<div class="line"><span class="lineno">  380</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  381</span>    <a class="code hl_variable" href="_global_variables_8h.html#a9e6472532ed800987ac4fe7240b2d51c">g_MsrBitmapInvalidMsrs</a> = <a class="code hl_function" href="_vmx_regions_8c.html#a5cefd3b5b3b98c661acad573794aa917">VmxAllocateInvalidMsrBimap</a>();</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a9e6472532ed800987ac4fe7240b2d51c">g_MsrBitmapInvalidMsrs</a> == NULL)</div>
<div class="line"><span class="lineno">  384</span>    {</div>
<div class="line"><span class="lineno">  385</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  386</span>    }</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">// As we want to support more than 32 processor (64 logical-core)</span></div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// we let windows execute our routine for us</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  392</span>    KeGenericCallDpc(<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a67111af34ae8884c33e13dec23046119">DpcRoutineInitializeGuest</a>, 0x0);</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">// Check if everything is ok then return true otherwise false</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  397</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="_inline_asm_8h.html#a0fd87b88c03b3c10883f0ad70239bf6c">AsmVmxVmcall</a>(<a class="code hl_define" href="_vmcall_8h.html#a7b45a0cbafe7472996868357b52f1265">VMCALL_TEST</a>, 0x22, 0x333, 0x4444) == STATUS_SUCCESS)</div>
<div class="line"><span class="lineno">  398</span>    {</div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  400</span>    }</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  402</span>    {</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  404</span>    }</div>
<div class="line"><span class="lineno">  405</span>}</div>
<div class="ttc" id="a_global_variables_8h_html_a9e6472532ed800987ac4fe7240b2d51c"><div class="ttname"><a href="_global_variables_8h.html#a9e6472532ed800987ac4fe7240b2d51c">g_MsrBitmapInvalidMsrs</a></div><div class="ttdeci">UINT64 * g_MsrBitmapInvalidMsrs</div><div class="ttdoc">Bitmap of MSRs that cause #GP.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:107</div></div>
<div class="ttc" id="a_inline_asm_8h_html_a0fd87b88c03b3c10883f0ad70239bf6c"><div class="ttname"><a href="_inline_asm_8h.html#a0fd87b88c03b3c10883f0ad70239bf6c">AsmVmxVmcall</a></div><div class="ttdeci">NTSTATUS AsmVmxVmcall(unsigned long long VmcallNumber, unsigned long long OptionalParam1, unsigned long long OptionalParam2, long long OptionalParam3)</div><div class="ttdoc">Request Vmcall.</div></div>
<div class="ttc" id="a_vmcall_8h_html_a7b45a0cbafe7472996868357b52f1265"><div class="ttname"><a href="_vmcall_8h.html#a7b45a0cbafe7472996868357b52f1265">VMCALL_TEST</a></div><div class="ttdeci">#define VMCALL_TEST</div><div class="ttdoc">VMCALL to test hypervisor.</div><div class="ttdef"><b>Definition</b> Vmcall.h:22</div></div>
<div class="ttc" id="a_vmx_8c_html_a412b9cc437ccd62987c8f5a01e0a3f2d"><div class="ttname"><a href="_vmx_8c.html#a412b9cc437ccd62987c8f5a01e0a3f2d">VmxPerformVirtualizationOnAllCores</a></div><div class="ttdeci">BOOLEAN VmxPerformVirtualizationOnAllCores()</div><div class="ttdoc">Initialize essential VMX Operation tasks.</div><div class="ttdef"><b>Definition</b> Vmx.c:413</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a04f29f1f6f56059cfa0d7bbe8dad10b9"><div class="ttname"><a href="_vmx_regions_8c.html#a04f29f1f6f56059cfa0d7bbe8dad10b9">VmxAllocateHostIdt</a></div><div class="ttdeci">BOOLEAN VmxAllocateHostIdt(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for host IDT.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:297</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a5cefd3b5b3b98c661acad573794aa917"><div class="ttname"><a href="_vmx_regions_8c.html#a5cefd3b5b3b98c661acad573794aa917">VmxAllocateInvalidMsrBimap</a></div><div class="ttdeci">UINT64 * VmxAllocateInvalidMsrBimap()</div><div class="ttdoc">Allocates a buffer and tests for the MSRs that cause #GP.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:264</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a5ecb9af59c8b9652916b17716448d188"><div class="ttname"><a href="_vmx_regions_8c.html#a5ecb9af59c8b9652916b17716448d188">VmxAllocateIoBitmaps</a></div><div class="ttdeci">BOOLEAN VmxAllocateIoBitmaps(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for I/O Bitmap.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:221</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a6b5ac1b2515912b3097922be01ed264a"><div class="ttname"><a href="_vmx_regions_8c.html#a6b5ac1b2515912b3097922be01ed264a">VmxAllocateMsrBitmap</a></div><div class="ttdeci">BOOLEAN VmxAllocateMsrBitmap(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for Msr Bitmap.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:192</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a7a1491d5ccd6b3c8feb3289a070b9a2b"><div class="ttname"><a href="_vmx_regions_8c.html#a7a1491d5ccd6b3c8feb3289a070b9a2b">VmxAllocateHostInterruptStack</a></div><div class="ttdeci">BOOLEAN VmxAllocateHostInterruptStack(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for host interrupt stack.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:394</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_aa52d4fb46038fa50963bca46df2bba20"><div class="ttname"><a href="_vmx_regions_8c.html#aa52d4fb46038fa50963bca46df2bba20">VmxAllocateVmmStack</a></div><div class="ttdeci">BOOLEAN VmxAllocateVmmStack(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate VMM Stack.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:167</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_abb8feca5c79686469f0eb5f9dc82d548"><div class="ttname"><a href="_vmx_regions_8c.html#abb8feca5c79686469f0eb5f9dc82d548">VmxAllocateHostGdt</a></div><div class="ttdeci">BOOLEAN VmxAllocateHostGdt(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for host GDT.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:332</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_aff29b1b936f30878282c0b6744702347"><div class="ttname"><a href="_vmx_regions_8c.html#aff29b1b936f30878282c0b6744702347">VmxAllocateHostTss</a></div><div class="ttdeci">BOOLEAN VmxAllocateHostTss(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate a buffer for host TSS.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:367</div></div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a67111af34ae8884c33e13dec23046119"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a67111af34ae8884c33e13dec23046119">DpcRoutineInitializeGuest</a></div><div class="ttdeci">VOID DpcRoutineInitializeGuest(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">The broadcast function which initialize the guest.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:1714</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0820b4fac62ab43454e3bc79642d00a" name="aa0820b4fac62ab43454e3bc79642d00a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0820b4fac62ab43454e3bc79642d00a">&#9670;&#160;</a></span>VmxLoadVmcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxLoadVmcs </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3f8cf05fd265cf9568bc5f3b1ee57897" name="a3f8cf05fd265cf9568bc5f3b1ee57897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f8cf05fd265cf9568bc5f3b1ee57897">&#9670;&#160;</a></span>VmxPerformTermination()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxPerformTermination </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminate Vmx on all logical cores. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1201</span>{</div>
<div class="line"><span class="lineno"> 1202</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> ProcessorsCount;</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Terminating VMX...\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1207</span>    <span class="comment">// Get number of processors</span></div>
<div class="line"><span class="lineno"> 1208</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1209</span>    ProcessorsCount = KeQueryActiveProcessorCount(0);</div>
<div class="line"><span class="lineno"> 1210</span> </div>
<div class="line"><span class="lineno"> 1211</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1212</span>    <span class="comment">// ******* Terminating Vmx *******</span></div>
<div class="line"><span class="lineno"> 1213</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1216</span>    <span class="comment">// Unhide (disable and de-allocate) transparent-mode</span></div>
<div class="line"><span class="lineno"> 1217</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1218</span>    <a class="code hl_function" href="_transparency_8c.html#ad9e44c31c77493eb876ea4002c8f55a7">TransparentUnhideDebugger</a>();</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment">// Remove All the hooks if any</span></div>
<div class="line"><span class="lineno"> 1222</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1223</span>    <a class="code hl_function" href="_ept_hook_8c.html#ac8845ca75f3b4c267d3542d20621f547">EptHookUnHookAll</a>();</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1226</span>    <span class="comment">// Restore the state of execution trap hooks</span></div>
<div class="line"><span class="lineno"> 1227</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1228</span>    <a class="code hl_function" href="_exec_trap_8c.html#af6305fef8652aa0c6b3035abe039078d">ExecTrapUninitialize</a>();</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1231</span>    <span class="comment">// Broadcast to terminate Vmx</span></div>
<div class="line"><span class="lineno"> 1232</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1233</span>    KeGenericCallDpc(<a class="code hl_function" href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a05844bdebfe78c424be8f44ecd65b48e">DpcRoutineTerminateGuest</a>, 0x0);</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1236</span>    <span class="comment">// ****** De-allocatee global variables ******</span></div>
<div class="line"><span class="lineno"> 1237</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1240</span>    <span class="comment">// Free the buffer related to MSRs that cause #GP</span></div>
<div class="line"><span class="lineno"> 1241</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1242</span>    <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>(<a class="code hl_variable" href="_global_variables_8h.html#a9e6472532ed800987ac4fe7240b2d51c">g_MsrBitmapInvalidMsrs</a>);</div>
<div class="line"><span class="lineno"> 1243</span>    <a class="code hl_variable" href="_global_variables_8h.html#a9e6472532ed800987ac4fe7240b2d51c">g_MsrBitmapInvalidMsrs</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1246</span>    <span class="comment">// Free Identity Page Table</span></div>
<div class="line"><span class="lineno"> 1247</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1248</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; ProcessorsCount; i++)</div>
<div class="line"><span class="lineno"> 1249</span>    {</div>
<div class="line"><span class="lineno"> 1250</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[i].EptPageTable != NULL)</div>
<div class="line"><span class="lineno"> 1251</span>        {</div>
<div class="line"><span class="lineno"> 1252</span>            MmFreeContiguousMemory(<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[i].EptPageTable);</div>
<div class="line"><span class="lineno"> 1253</span>        }</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>        <a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[i].<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a1146a24bffa5a804261021a69cf0a00d">EptPageTable</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno"> 1256</span>    }</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">// Free EptState</span></div>
<div class="line"><span class="lineno"> 1260</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1261</span>    <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>(<a class="code hl_variable" href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a>);</div>
<div class="line"><span class="lineno"> 1262</span>    <a class="code hl_variable" href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1265</span>    <span class="comment">// Free the Pool manager</span></div>
<div class="line"><span class="lineno"> 1266</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1267</span>    <a class="code hl_function" href="_pool_manager_8c.html#ac159e1f3a096c5e9da7aaff001987237">PoolManagerUninitialize</a>();</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1270</span>    <span class="comment">// Uninitialize memory mapper</span></div>
<div class="line"><span class="lineno"> 1271</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1272</span>    <a class="code hl_function" href="_memory_mapper_8c.html#a4c1a12a407bc281cb9f03db67b203913">MemoryMapperUninitialize</a>();</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1275</span>    <span class="comment">// Free g_GuestState</span></div>
<div class="line"><span class="lineno"> 1276</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1277</span>    <a class="code hl_function" href="_global_variable_management_8c.html#abe0a55c40aade44eb9ed8852d627fd91">GlobalGuestStateFreeMemory</a>();</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;VMX operation turned off successfully&quot;</span>);</div>
<div class="line"><span class="lineno"> 1280</span>}</div>
<div class="ttc" id="a_ept_hook_8c_html_ac8845ca75f3b4c267d3542d20621f547"><div class="ttname"><a href="_ept_hook_8c.html#ac8845ca75f3b4c267d3542d20621f547">EptHookUnHookAll</a></div><div class="ttdeci">VOID EptHookUnHookAll()</div><div class="ttdoc">Remove all hooks from the hooked pages list and invalidate TLB @detailsShould be called from Vmx Non-...</div><div class="ttdef"><b>Definition</b> EptHook.c:2431</div></div>
<div class="ttc" id="a_exec_trap_8c_html_af6305fef8652aa0c6b3035abe039078d"><div class="ttname"><a href="_exec_trap_8c.html#af6305fef8652aa0c6b3035abe039078d">ExecTrapUninitialize</a></div><div class="ttdeci">VOID ExecTrapUninitialize()</div><div class="ttdoc">Uinitialize the needed structure for the reversing machine.</div><div class="ttdef"><b>Definition</b> ExecTrap.c:605</div></div>
<div class="ttc" id="a_global_variable_management_8c_html_abe0a55c40aade44eb9ed8852d627fd91"><div class="ttname"><a href="_global_variable_management_8c.html#abe0a55c40aade44eb9ed8852d627fd91">GlobalGuestStateFreeMemory</a></div><div class="ttdeci">VOID GlobalGuestStateFreeMemory(VOID)</div><div class="ttdoc">Free guest state memory.</div><div class="ttdef"><b>Definition</b> GlobalVariableManagement.c:52</div></div>
<div class="ttc" id="a_global_variables_8h_html_a302f00c62e7ad092a9f44a3aa7452d99"><div class="ttname"><a href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a></div><div class="ttdeci">EPT_STATE * g_EptState</div><div class="ttdoc">Save the state and variables related to EPT.</div><div class="ttdef"><b>Definition</b> GlobalVariables.h:50</div></div>
<div class="ttc" id="a_hyper_dbg_hyper_log_intrinsics_8h_html_a108126279e46f4d46d25abe24da43fdc"><div class="ttname"><a href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a></div><div class="ttdeci">#define LogDebugInfo(format,...)</div><div class="ttdoc">Log, initialize boot information and debug information.</div><div class="ttdef"><b>Definition</b> HyperDbgHyperLogIntrinsics.h:155</div></div>
<div class="ttc" id="a_mem_8c_html_a8ad365cfb6c54c3d6fdd745e6b4666f1"><div class="ttname"><a href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a></div><div class="ttdeci">VOID PlatformMemFreePool(PVOID BufferAddress)</div><div class="ttdoc">Free (dellocate) a non-paged buffer.</div><div class="ttdef"><b>Definition</b> Mem.c:86</div></div>
<div class="ttc" id="a_memory_mapper_8c_html_a4c1a12a407bc281cb9f03db67b203913"><div class="ttname"><a href="_memory_mapper_8c.html#a4c1a12a407bc281cb9f03db67b203913">MemoryMapperUninitialize</a></div><div class="ttdeci">VOID MemoryMapperUninitialize()</div><div class="ttdoc">uninitialize the Memory Mapper</div><div class="ttdef"><b>Definition</b> MemoryMapper.c:716</div></div>
<div class="ttc" id="a_pool_manager_8c_html_ac159e1f3a096c5e9da7aaff001987237"><div class="ttname"><a href="_pool_manager_8c.html#ac159e1f3a096c5e9da7aaff001987237">PoolManagerUninitialize</a></div><div class="ttdeci">VOID PoolManagerUninitialize()</div><div class="ttdoc">Uninitialize the pool manager (free the buffers, etc.)</div><div class="ttdef"><b>Definition</b> PoolManager.c:87</div></div>
<div class="ttc" id="a_transparency_8c_html_ad9e44c31c77493eb876ea4002c8f55a7"><div class="ttname"><a href="_transparency_8c.html#ad9e44c31c77493eb876ea4002c8f55a7">TransparentUnhideDebugger</a></div><div class="ttdeci">NTSTATUS TransparentUnhideDebugger()</div><div class="ttdoc">Deactivate transparent-mode.</div><div class="ttdef"><b>Definition</b> Transparency.c:425</div></div>
<div class="ttc" id="ahyperhv_2code_2broadcast_2_dpc_routines_8c_html_a05844bdebfe78c424be8f44ecd65b48e"><div class="ttname"><a href="hyperhv_2code_2broadcast_2_dpc_routines_8c.html#a05844bdebfe78c424be8f44ecd65b48e">DpcRoutineTerminateGuest</a></div><div class="ttdeci">VOID DpcRoutineTerminateGuest(KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)</div><div class="ttdoc">The broadcast function which terminate the guest.</div><div class="ttdef"><b>Definition</b> DpcRoutines.c:1745</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a1146a24bffa5a804261021a69cf0a00d"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a1146a24bffa5a804261021a69cf0a00d">_VIRTUAL_MACHINE_STATE::EptPageTable</a></div><div class="ttdeci">PVMM_EPT_PAGE_TABLE EptPageTable</div><div class="ttdef"><b>Definition</b> State.h:342</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a412b9cc437ccd62987c8f5a01e0a3f2d" name="a412b9cc437ccd62987c8f5a01e0a3f2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a412b9cc437ccd62987c8f5a01e0a3f2d">&#9670;&#160;</a></span>VmxPerformVirtualizationOnAllCores()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxPerformVirtualizationOnAllCores </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize essential VMX Operation tasks. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if vmx is successfully initialized </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  414</span>{</div>
<div class="line"><span class="lineno">  415</span>    PAGED_CODE();</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_8c.html#abbbc35bf970ac6b655e08bc3c0f46905">VmxCheckVmxSupport</a>())</div>
<div class="line"><span class="lineno">  418</span>    {</div>
<div class="line"><span class="lineno">  419</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, VMX is not supported in this machine&quot;</span>);</div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  424</span>    <span class="comment">// Allocate global variable to hold Ept State</span></div>
<div class="line"><span class="lineno">  425</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  426</span>    <a class="code hl_variable" href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a> = <a class="code hl_function" href="_mem_8c.html#a9bd46383a9f12e1a8a1b59c1658d1bc8">PlatformMemAllocateZeroedNonPagedPool</a>(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="struct___e_p_t___s_t_a_t_e.html">EPT_STATE</a>));</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a>)</div>
<div class="line"><span class="lineno">  429</span>    {</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, insufficient memory&quot;</span>);</div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  432</span>    }</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  435</span>    <span class="comment">// Initialize the list of hooked pages detail</span></div>
<div class="line"><span class="lineno">  436</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  437</span>    <a class="code hl_function" href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a>(&amp;<a class="code hl_variable" href="_global_variables_8h.html#a302f00c62e7ad092a9f44a3aa7452d99">g_EptState</a>-&gt;<a class="code hl_variable" href="struct___e_p_t___s_t_a_t_e.html#a2503c5862b1bb2b779e2185b4097aa15">HookedPagesList</a>);</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  440</span>    <span class="comment">// Check whether EPT is supported or not</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_ept_8c.html#a97b510b8377ffb1d091b45b39b2e7604">EptCheckFeatures</a>())</div>
<div class="line"><span class="lineno">  443</span>    {</div>
<div class="line"><span class="lineno">  444</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, your processor doesn&#39;t support all EPT features&quot;</span>);</div>
<div class="line"><span class="lineno">  445</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  446</span>    }</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  448</span>    {</div>
<div class="line"><span class="lineno">  449</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  450</span>        <span class="comment">// Our processor supports EPT, now let&#39;s build MTRR</span></div>
<div class="line"><span class="lineno">  451</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  452</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Your processor supports all EPT features&quot;</span>);</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  455</span>        <span class="comment">// Build MTRR Map</span></div>
<div class="line"><span class="lineno">  456</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="_ept_8c.html#a931ddfa17fef9db7f6d923790952ac20">EptBuildMtrrMap</a>())</div>
<div class="line"><span class="lineno">  458</span>        {</div>
<div class="line"><span class="lineno">  459</span>            <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, could not build MTRR memory map&quot;</span>);</div>
<div class="line"><span class="lineno">  460</span>            <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  461</span>        }</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;MTRR memory map built successfully&quot;</span>);</div>
<div class="line"><span class="lineno">  464</span>    }</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">// Initialize Pool Manager</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_pool_manager_8c.html#a8c4426c380bebca34fd7b6d10722ee8e">PoolManagerInitialize</a>())</div>
<div class="line"><span class="lineno">  470</span>    {</div>
<div class="line"><span class="lineno">  471</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, could not initialize pool manager&quot;</span>);</div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  473</span>    }</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_ept_8c.html#a36ddbfbf1a082ef76d7f41dc35fea75d">EptLogicalProcessorInitialize</a>())</div>
<div class="line"><span class="lineno">  476</span>    {</div>
<div class="line"><span class="lineno">  477</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  478</span>        <span class="comment">// There were some errors in EptLogicalProcessorInitialize</span></div>
<div class="line"><span class="lineno">  479</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  480</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  481</span>    }</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">// Broadcast to run vmx-specific task to virtualize cores</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_function" href="_broadcast_8c.html#a755e84fc0bacd87bd8044f52d1adc7a5">BroadcastVmxVirtualizationAllCores</a>();</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="comment">// Everything is ok, let&#39;s return true</span></div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  492</span>}</div>
<div class="ttc" id="a_broadcast_8c_html_a755e84fc0bacd87bd8044f52d1adc7a5"><div class="ttname"><a href="_broadcast_8c.html#a755e84fc0bacd87bd8044f52d1adc7a5">BroadcastVmxVirtualizationAllCores</a></div><div class="ttdeci">VOID BroadcastVmxVirtualizationAllCores()</div><div class="ttdoc">routines to broadcast virtualization and vmx initialization on all cores</div><div class="ttdef"><b>Definition</b> Broadcast.c:21</div></div>
<div class="ttc" id="a_ept_8c_html_a36ddbfbf1a082ef76d7f41dc35fea75d"><div class="ttname"><a href="_ept_8c.html#a36ddbfbf1a082ef76d7f41dc35fea75d">EptLogicalProcessorInitialize</a></div><div class="ttdeci">BOOLEAN EptLogicalProcessorInitialize(VOID)</div><div class="ttdoc">Initialize EPT for an individual logical processor.</div><div class="ttdef"><b>Definition</b> Ept.c:759</div></div>
<div class="ttc" id="a_ept_8c_html_a931ddfa17fef9db7f6d923790952ac20"><div class="ttname"><a href="_ept_8c.html#a931ddfa17fef9db7f6d923790952ac20">EptBuildMtrrMap</a></div><div class="ttdeci">BOOLEAN EptBuildMtrrMap(VOID)</div><div class="ttdoc">Build MTRR Map of current physical addresses.</div><div class="ttdef"><b>Definition</b> Ept.c:156</div></div>
<div class="ttc" id="a_ept_8c_html_a97b510b8377ffb1d091b45b39b2e7604"><div class="ttname"><a href="_ept_8c.html#a97b510b8377ffb1d091b45b39b2e7604">EptCheckFeatures</a></div><div class="ttdeci">BOOLEAN EptCheckFeatures(VOID)</div><div class="ttdoc">Check whether EPT features are present or not.</div><div class="ttdef"><b>Definition</b> Ept.c:22</div></div>
<div class="ttc" id="a_mem_8c_html_a9bd46383a9f12e1a8a1b59c1658d1bc8"><div class="ttname"><a href="_mem_8c.html#a9bd46383a9f12e1a8a1b59c1658d1bc8">PlatformMemAllocateZeroedNonPagedPool</a></div><div class="ttdeci">PVOID PlatformMemAllocateZeroedNonPagedPool(SIZE_T NumberOfBytes)</div><div class="ttdoc">Allocate a non-paged buffer (zeroed)</div><div class="ttdef"><b>Definition</b> Mem.c:69</div></div>
<div class="ttc" id="a_pool_manager_8c_html_a8c4426c380bebca34fd7b6d10722ee8e"><div class="ttname"><a href="_pool_manager_8c.html#a8c4426c380bebca34fd7b6d10722ee8e">PoolManagerInitialize</a></div><div class="ttdeci">BOOLEAN PoolManagerInitialize()</div><div class="ttdoc">Initializes the pool manager.</div><div class="ttdef"><b>Definition</b> PoolManager.c:53</div></div>
<div class="ttc" id="a_vmx_8c_html_abbbc35bf970ac6b655e08bc3c0f46905"><div class="ttname"><a href="_vmx_8c.html#abbbc35bf970ac6b655e08bc3c0f46905">VmxCheckVmxSupport</a></div><div class="ttdeci">BOOLEAN VmxCheckVmxSupport()</div><div class="ttdoc">Check whether VMX Feature is supported or not.</div><div class="ttdef"><b>Definition</b> Vmx.c:166</div></div>
<div class="ttc" id="a_windows_8h_html_ad211c1678754ed394322f51a9e909c4a"><div class="ttname"><a href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a></div><div class="ttdeci">FORCEINLINE VOID InitializeListHead(_Out_ PLIST_ENTRY ListHead)</div><div class="ttdef"><b>Definition</b> Windows.h:41</div></div>
<div class="ttc" id="astruct___e_p_t___s_t_a_t_e_html"><div class="ttname"><a href="struct___e_p_t___s_t_a_t_e.html">_EPT_STATE</a></div><div class="ttdoc">Main structure for saving the state of EPT among the project.</div><div class="ttdef"><b>Definition</b> Ept.h:117</div></div>
<div class="ttc" id="astruct___e_p_t___s_t_a_t_e_html_a2503c5862b1bb2b779e2185b4097aa15"><div class="ttname"><a href="struct___e_p_t___s_t_a_t_e.html#a2503c5862b1bb2b779e2185b4097aa15">_EPT_STATE::HookedPagesList</a></div><div class="ttdeci">LIST_ENTRY HookedPagesList</div><div class="ttdef"><b>Definition</b> Ept.h:118</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7d79ec1775eef01d11b05fd316b7eb7" name="ad7d79ec1775eef01d11b05fd316b7eb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7d79ec1775eef01d11b05fd316b7eb7">&#9670;&#160;</a></span>VmxPerformVirtualizationOnSpecificCore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxPerformVirtualizationOnSpecificCore </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates Vmx regions for all logical cores (Vmxon region and Vmcs region) </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  501</span>{</div>
<div class="line"><span class="lineno">  502</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                   CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  503</span>    <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * VCpu        = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore];</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Allocating vmx regions for logical core %d&quot;</span>, CurrentCore);</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="comment">// Enabling VMX Operation</span></div>
<div class="line"><span class="lineno">  509</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  510</span>    <a class="code hl_function" href="_inline_asm_8h.html#a141567e2e7a4abc1106cccca5d365af3">AsmEnableVmxOperation</a>();</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="comment">// Fix Cr4 and Cr0 bits during VMX operation</span></div>
<div class="line"><span class="lineno">  514</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  515</span>    <a class="code hl_function" href="_vmx_8c.html#a56536723aab6c8ccb4719ff1eac2c25f">VmxFixCr4AndCr0Bits</a>();</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;VMX-Operation enabled successfully&quot;</span>);</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#a5689a509a4e8dc00802c736a89b08126">VmxAllocateVmxonRegion</a>(VCpu))</div>
<div class="line"><span class="lineno">  520</span>    {</div>
<div class="line"><span class="lineno">  521</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, allocating memory for vmxon region was not successful&quot;</span>);</div>
<div class="line"><span class="lineno">  522</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  523</span>    }</div>
<div class="line"><span class="lineno">  524</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_regions_8c.html#aee5a298244f8ad894335caff42a79d16">VmxAllocateVmcsRegion</a>(VCpu))</div>
<div class="line"><span class="lineno">  525</span>    {</div>
<div class="line"><span class="lineno">  526</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, allocating memory for vmcs region was not successful&quot;</span>);</div>
<div class="line"><span class="lineno">  527</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  528</span>    }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  531</span>}</div>
<div class="ttc" id="a_inline_asm_8h_html_a141567e2e7a4abc1106cccca5d365af3"><div class="ttname"><a href="_inline_asm_8h.html#a141567e2e7a4abc1106cccca5d365af3">AsmEnableVmxOperation</a></div><div class="ttdeci">void AsmEnableVmxOperation()</div><div class="ttdoc">Enable VMX Operation.</div></div>
<div class="ttc" id="a_vmx_8c_html_a56536723aab6c8ccb4719ff1eac2c25f"><div class="ttname"><a href="_vmx_8c.html#a56536723aab6c8ccb4719ff1eac2c25f">VmxFixCr4AndCr0Bits</a></div><div class="ttdeci">VOID VmxFixCr4AndCr0Bits()</div><div class="ttdoc">Fix values for cr0 and cr4 bits.</div><div class="ttdef"><b>Definition</b> Vmx.c:541</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_a5689a509a4e8dc00802c736a89b08126"><div class="ttname"><a href="_vmx_regions_8c.html#a5689a509a4e8dc00802c736a89b08126">VmxAllocateVmxonRegion</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN VmxAllocateVmxonRegion(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocates Vmxon region and set the Revision ID based on IA32_VMX_BASIC_MSR.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:23</div></div>
<div class="ttc" id="a_vmx_regions_8c_html_aee5a298244f8ad894335caff42a79d16"><div class="ttname"><a href="_vmx_regions_8c.html#aee5a298244f8ad894335caff42a79d16">VmxAllocateVmcsRegion</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN VmxAllocateVmcsRegion(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Allocate Vmcs region and set the Revision ID based on IA32_VMX_BASIC_MSR.</div><div class="ttdef"><b>Definition</b> VmxRegions.c:103</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a121be6f80493612573f2177d8a17424e" name="a121be6f80493612573f2177d8a17424e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a121be6f80493612573f2177d8a17424e">&#9670;&#160;</a></span>VmxReturnInstructionPointerForVmxoff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VmxReturnInstructionPointerForVmxoff </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the RIP of guest (VMCS_GUEST_RIP) in the case of return from VMXOFF. </p>
<dl class="section return"><dt>Returns</dt><dd>UINT64 Returns the instruction pointer, to change in the case of Vmxoff </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1190</span>{</div>
<div class="line"><span class="lineno"> 1191</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[KeGetCurrentProcessorNumberEx(NULL)].<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">VmxoffState</a>.<a class="code hl_variable" href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#a4f2e88d445f5ece493b3d201e3b6f19f">GuestRip</a>;</div>
<div class="line"><span class="lineno"> 1192</span>}</div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_abe260607315f60c0e4676113b125d4a4"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">_VIRTUAL_MACHINE_STATE::VmxoffState</a></div><div class="ttdeci">VMX_VMXOFF_STATE VmxoffState</div><div class="ttdef"><b>Definition</b> State.h:328</div></div>
<div class="ttc" id="astruct___v_m_x___v_m_x_o_f_f___s_t_a_t_e_html_a4f2e88d445f5ece493b3d201e3b6f19f"><div class="ttname"><a href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#a4f2e88d445f5ece493b3d201e3b6f19f">_VMX_VMXOFF_STATE::GuestRip</a></div><div class="ttdeci">UINT64 GuestRip</div><div class="ttdef"><b>Definition</b> State.h:153</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1493a49dc1f387ee57f95207869ad3b4" name="a1493a49dc1f387ee57f95207869ad3b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1493a49dc1f387ee57f95207869ad3b4">&#9670;&#160;</a></span>VmxReturnStackPointerForVmxoff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> VmxReturnStackPointerForVmxoff </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the RIP of guest (VMCS_GUEST_RIP) in the case of return from VMXOFF. </p>
<dl class="section return"><dt>Returns</dt><dd>UINT64 Returns the stack pointer, to change in the case of Vmxoff </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1179</span>{</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[KeGetCurrentProcessorNumberEx(NULL)].<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">VmxoffState</a>.<a class="code hl_variable" href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#ac920a356627a6c44d5255bc5611238da">GuestRsp</a>;</div>
<div class="line"><span class="lineno"> 1181</span>}</div>
<div class="ttc" id="astruct___v_m_x___v_m_x_o_f_f___s_t_a_t_e_html_ac920a356627a6c44d5255bc5611238da"><div class="ttname"><a href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#ac920a356627a6c44d5255bc5611238da">_VMX_VMXOFF_STATE::GuestRsp</a></div><div class="ttdeci">UINT64 GuestRsp</div><div class="ttdef"><b>Definition</b> State.h:154</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3deacf9df5781113357db7b2ee25aa90" name="a3deacf9df5781113357db7b2ee25aa90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3deacf9df5781113357db7b2ee25aa90">&#9670;&#160;</a></span>VmxSetupVmcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxSetupVmcs </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ PVOID</td>          <td class="paramname"><span class="paramname"><em>GuestStack</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae683fd4d4ecd99c28292045bc8a65e18" name="ae683fd4d4ecd99c28292045bc8a65e18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae683fd4d4ecd99c28292045bc8a65e18">&#9670;&#160;</a></span>VmxTerminate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxTerminate </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Broadcast to terminate VMX on all logical cores. </p>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN Returns true if vmxoff successfully executed in vmcall or otherwise returns false </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  700</span>{</div>
<div class="line"><span class="lineno">  701</span>    NTSTATUS                Status      = STATUS_SUCCESS;</div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                   CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * VCpu        = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore];</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">// Execute Vmcall to to turn off vmx from Vmx root mode</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  708</span>    Status = <a class="code hl_function" href="_inline_asm_8h.html#a0fd87b88c03b3c10883f0ad70239bf6c">AsmVmxVmcall</a>(<a class="code hl_define" href="_vmcall_8h.html#a589357d083b5353f74c07972e1448924">VMCALL_VMXOFF</a>, <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>, <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>, <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>);</div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>    <span class="keywordflow">if</span> (Status == STATUS_SUCCESS)</div>
<div class="line"><span class="lineno">  711</span>    {</div>
<div class="line"><span class="lineno">  712</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;VMX terminated on logical core %d\n&quot;</span>, CurrentCore);</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  715</span>        <span class="comment">// Free the destination memory</span></div>
<div class="line"><span class="lineno">  716</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  717</span>        MmFreeContiguousMemory((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a1890e7a832ea68482839c0f8e6aa1bb7">VmxonRegionVirtualAddress</a>);</div>
<div class="line"><span class="lineno">  718</span>        MmFreeContiguousMemory((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aea5d9809e4e4b9f3e271045ef459f66d">VmcsRegionVirtualAddress</a>);</div>
<div class="line"><span class="lineno">  719</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a853f222f05d48aa4e74c882556ab25f8">VmmStack</a>);</div>
<div class="line"><span class="lineno">  720</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a7ca0fe2d6633bddddfc4839bd2ad393c">MsrBitmapVirtualAddress</a>);</div>
<div class="line"><span class="lineno">  721</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#adc08fd36ed7c5088b430d9d46de38772">IoBitmapVirtualAddressA</a>);</div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a42bb99b3abac8271d5f430862b86fa12">IoBitmapVirtualAddressB</a>);</div>
<div class="line"><span class="lineno">  723</span><span class="preprocessor">#if USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  724</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ab4beb042a650c2931cec8a68b3cefa0d">HostIdt</a>);</div>
<div class="line"><span class="lineno">  725</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span><span class="preprocessor">#if USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  728</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a404fc089534c814811ce8ac2cbbd00f3">HostGdt</a>);</div>
<div class="line"><span class="lineno">  729</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aa09186472fc63716e39dbf870e5f2f09">HostTss</a>);</div>
<div class="line"><span class="lineno">  730</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span><span class="preprocessor">#if USE_INTERRUPT_STACK_TABLE == TRUE</span></div>
<div class="line"><span class="lineno">  733</span>        <a class="code hl_function" href="_mem_8c.html#a8ad365cfb6c54c3d6fdd745e6b4666f1">PlatformMemFreePool</a>((PVOID)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a2058f46d31d1589bd7267c17e375a0be">HostInterruptStack</a>);</div>
<div class="line"><span class="lineno">  734</span><span class="preprocessor">#endif </span><span class="comment">// USE_INTERRUPT_STACK_TABLE == FALSE</span></div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  737</span>    }</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  740</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a8a9df53f35cb95dddbe3c564259e01ad"><div class="ttname"><a href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a></div><div class="ttdeci">#define NULL64_ZERO</div><div class="ttdef"><b>Definition</b> BasicTypes.h:52</div></div>
<div class="ttc" id="a_vmcall_8h_html_a589357d083b5353f74c07972e1448924"><div class="ttname"><a href="_vmcall_8h.html#a589357d083b5353f74c07972e1448924">VMCALL_VMXOFF</a></div><div class="ttdeci">#define VMCALL_VMXOFF</div><div class="ttdoc">VMCALL to Call VMXOFF to turn off the hypervisor.</div><div class="ttdef"><b>Definition</b> Vmcall.h:28</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a1890e7a832ea68482839c0f8e6aa1bb7"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a1890e7a832ea68482839c0f8e6aa1bb7">_VIRTUAL_MACHINE_STATE::VmxonRegionVirtualAddress</a></div><div class="ttdeci">UINT64 VmxonRegionVirtualAddress</div><div class="ttdef"><b>Definition</b> State.h:311</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a2058f46d31d1589bd7267c17e375a0be"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a2058f46d31d1589bd7267c17e375a0be">_VIRTUAL_MACHINE_STATE::HostInterruptStack</a></div><div class="ttdeci">UINT64 HostInterruptStack</div><div class="ttdef"><b>Definition</b> State.h:336</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a404fc089534c814811ce8ac2cbbd00f3"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a404fc089534c814811ce8ac2cbbd00f3">_VIRTUAL_MACHINE_STATE::HostGdt</a></div><div class="ttdeci">UINT64 HostGdt</div><div class="ttdef"><b>Definition</b> State.h:334</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a42bb99b3abac8271d5f430862b86fa12"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a42bb99b3abac8271d5f430862b86fa12">_VIRTUAL_MACHINE_STATE::IoBitmapVirtualAddressB</a></div><div class="ttdeci">UINT64 IoBitmapVirtualAddressB</div><div class="ttdef"><b>Definition</b> State.h:319</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a7ca0fe2d6633bddddfc4839bd2ad393c"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a7ca0fe2d6633bddddfc4839bd2ad393c">_VIRTUAL_MACHINE_STATE::MsrBitmapVirtualAddress</a></div><div class="ttdeci">UINT64 MsrBitmapVirtualAddress</div><div class="ttdef"><b>Definition</b> State.h:315</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_a853f222f05d48aa4e74c882556ab25f8"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a853f222f05d48aa4e74c882556ab25f8">_VIRTUAL_MACHINE_STATE::VmmStack</a></div><div class="ttdeci">UINT64 VmmStack</div><div class="ttdef"><b>Definition</b> State.h:314</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aa09186472fc63716e39dbf870e5f2f09"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aa09186472fc63716e39dbf870e5f2f09">_VIRTUAL_MACHINE_STATE::HostTss</a></div><div class="ttdeci">UINT64 HostTss</div><div class="ttdef"><b>Definition</b> State.h:335</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_ab4beb042a650c2931cec8a68b3cefa0d"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#ab4beb042a650c2931cec8a68b3cefa0d">_VIRTUAL_MACHINE_STATE::HostIdt</a></div><div class="ttdeci">UINT64 HostIdt</div><div class="ttdef"><b>Definition</b> State.h:333</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_adc08fd36ed7c5088b430d9d46de38772"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#adc08fd36ed7c5088b430d9d46de38772">_VIRTUAL_MACHINE_STATE::IoBitmapVirtualAddressA</a></div><div class="ttdeci">UINT64 IoBitmapVirtualAddressA</div><div class="ttdef"><b>Definition</b> State.h:317</div></div>
<div class="ttc" id="astruct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e_html_aea5d9809e4e4b9f3e271045ef459f66d"><div class="ttname"><a href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aea5d9809e4e4b9f3e271045ef459f66d">_VIRTUAL_MACHINE_STATE::VmcsRegionVirtualAddress</a></div><div class="ttdeci">UINT64 VmcsRegionVirtualAddress</div><div class="ttdef"><b>Definition</b> State.h:313</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af666da6f076709f466795cf1627d5e94" name="af666da6f076709f466795cf1627d5e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af666da6f076709f466795cf1627d5e94">&#9670;&#160;</a></span>VmxVirtualizeCurrentSystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> VmxVirtualizeCurrentSystem </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>GuestStack</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize VMX Operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">GuestStack</td><td>Guest stack for the this core (VMCS_GUEST_RSP) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>BOOLEAN This function won't return true as when Vmlaunch is executed the rest of the function never executes but returning FALSE is an indication of error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  606</span>{</div>
<div class="line"><span class="lineno">  607</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>                  ErrorCode   = 0;</div>
<div class="line"><span class="lineno">  608</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                   CurrentCore = KeGetCurrentProcessorNumberEx(NULL);</div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_struct" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html">VIRTUAL_MACHINE_STATE</a> * VCpu        = &amp;<a class="code hl_variable" href="_global_variables_8h.html#a04bac1f4beef0dcf1ce1a4d9ce72ea76">g_GuestState</a>[CurrentCore];</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Virtualizing current system (logical core : 0x%x)&quot;</span>, CurrentCore);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span><span class="preprocessor">#if USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="comment">// Prepare Host IDT</span></div>
<div class="line"><span class="lineno">  617</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  618</span>    <a class="code hl_function" href="_idt_emulation_8c.html#a5e5ee99f7a684ef8f4bf4290e17f53d0">IdtEmulationPrepareHostIdt</a>(VCpu);</div>
<div class="line"><span class="lineno">  619</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_IDT_AS_HOST_IDT == FALSE</span></div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span><span class="preprocessor">#if USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  624</span>    <span class="comment">// Prepare Host GDT and TSS</span></div>
<div class="line"><span class="lineno">  625</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  626</span>    <a class="code hl_function" href="_segmentation_8c.html#aba289a3ba2c099af67fe0d3ba12e7c63">SegmentPrepareHostGdt</a>((SEGMENT_DESCRIPTOR_32 *)<a class="code hl_function" href="_inline_asm_8h.html#a96667e63238aa74a0a2bbc63d6e02ca3">AsmGetGdtBase</a>(),</div>
<div class="line"><span class="lineno">  627</span>                          <a class="code hl_function" href="_inline_asm_8h.html#a3205fb84e901444e860d9b8140c81c86">AsmGetGdtLimit</a>(),</div>
<div class="line"><span class="lineno">  628</span>                          <a class="code hl_function" href="_inline_asm_8h.html#a14941c0b49cf64161c8e1d6d98c4e472">AsmGetTr</a>(),</div>
<div class="line"><span class="lineno">  629</span>                          VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a2058f46d31d1589bd7267c17e375a0be">HostInterruptStack</a>,</div>
<div class="line"><span class="lineno">  630</span>                          (SEGMENT_DESCRIPTOR_32 *)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#a404fc089534c814811ce8ac2cbbd00f3">HostGdt</a>,</div>
<div class="line"><span class="lineno">  631</span>                          (TASK_STATE_SEGMENT_64 *)VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aa09186472fc63716e39dbf870e5f2f09">HostTss</a>);</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span><span class="preprocessor">#endif </span><span class="comment">// USE_DEFAULT_OS_GDT_AS_HOST_GDT == FALSE</span></div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  636</span>    <span class="comment">// Clear the VMCS State</span></div>
<div class="line"><span class="lineno">  637</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_8c.html#a40b4c16e2a106d27460f4a5dc8c76d70">VmxClearVmcsState</a>(VCpu))</div>
<div class="line"><span class="lineno">  639</span>    {</div>
<div class="line"><span class="lineno">  640</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, failed to clear vmcs&quot;</span>);</div>
<div class="line"><span class="lineno">  641</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  642</span>    }</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  645</span>    <span class="comment">// Load VMCS (Set the Current VMCS)</span></div>
<div class="line"><span class="lineno">  646</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="_vmx_8c.html#a5d502eb714f3e5b8a9a405674190d1ca">VmxLoadVmcs</a>(VCpu))</div>
<div class="line"><span class="lineno">  648</span>    {</div>
<div class="line"><span class="lineno">  649</span>        <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, failed to load vmcs&quot;</span>);</div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  651</span>    }</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Setting up VMCS for current logical core&quot;</span>);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>    <a class="code hl_function" href="_vmx_8c.html#ab410d0d271e13e18eb97f0870de4380d">VmxSetupVmcs</a>(VCpu, GuestStack);</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;Executing VMLAUNCH on logical core %d&quot;</span>, CurrentCore);</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">// Setting the state to indicate current core is currently virtualized</span></div>
<div class="line"><span class="lineno">  661</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aaacba0883eec22779a564fb93aea73fd">HasLaunched</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>    __vmx_vmlaunch();</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  668</span>    <span class="comment">// ******** if Vmlaunch succeed will never be here ! ********</span></div>
<div class="line"><span class="lineno">  669</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  672</span>    <span class="comment">// If failed, then indicate that current core is not currently virtualized</span></div>
<div class="line"><span class="lineno">  673</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  674</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aaacba0883eec22779a564fb93aea73fd">HasLaunched</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  677</span>    <span class="comment">// Read error code firstly</span></div>
<div class="line"><span class="lineno">  678</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  679</span>    __vmx_vmread(VMCS_VM_INSTRUCTION_ERROR, &amp;ErrorCode);</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, unable to execute VMLAUNCH, status : 0x%llx&quot;</span>, ErrorCode);</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  684</span>    <span class="comment">// Then Execute Vmxoff</span></div>
<div class="line"><span class="lineno">  685</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  686</span>    __vmx_off();</div>
<div class="line"><span class="lineno">  687</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err, VMXOFF Executed Successfully but it was because of an error&quot;</span>);</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  690</span>}</div>
<div class="ttc" id="a_idt_emulation_8c_html_a5e5ee99f7a684ef8f4bf4290e17f53d0"><div class="ttname"><a href="_idt_emulation_8c.html#a5e5ee99f7a684ef8f4bf4290e17f53d0">IdtEmulationPrepareHostIdt</a></div><div class="ttdeci">VOID IdtEmulationPrepareHostIdt(_Inout_ VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Prepare Host IDT.</div><div class="ttdef"><b>Definition</b> IdtEmulation.c:67</div></div>
<div class="ttc" id="a_inline_asm_8h_html_a14941c0b49cf64161c8e1d6d98c4e472"><div class="ttname"><a href="_inline_asm_8h.html#a14941c0b49cf64161c8e1d6d98c4e472">AsmGetTr</a></div><div class="ttdeci">unsigned short AsmGetTr()</div><div class="ttdoc">Get TR Register.</div></div>
<div class="ttc" id="a_inline_asm_8h_html_a3205fb84e901444e860d9b8140c81c86"><div class="ttname"><a href="_inline_asm_8h.html#a3205fb84e901444e860d9b8140c81c86">AsmGetGdtLimit</a></div><div class="ttdeci">unsigned short AsmGetGdtLimit()</div><div class="ttdoc">Get GDT Limit.</div></div>
<div class="ttc" id="a_inline_asm_8h_html_a96667e63238aa74a0a2bbc63d6e02ca3"><div class="ttname"><a href="_inline_asm_8h.html#a96667e63238aa74a0a2bbc63d6e02ca3">AsmGetGdtBase</a></div><div class="ttdeci">unsigned long long AsmGetGdtBase()</div><div class="ttdoc">get GDT base</div></div>
<div class="ttc" id="a_segmentation_8c_html_aba289a3ba2c099af67fe0d3ba12e7c63"><div class="ttname"><a href="_segmentation_8c.html#aba289a3ba2c099af67fe0d3ba12e7c63">SegmentPrepareHostGdt</a></div><div class="ttdeci">VOID SegmentPrepareHostGdt(SEGMENT_DESCRIPTOR_32 *OsGdtBase, UINT16 OsGdtLimit, UINT16 TrSelector, UINT64 HostStack, SEGMENT_DESCRIPTOR_32 *AllocatedHostGdt, TASK_STATE_SEGMENT_64 *AllocatedHostTss)</div><div class="ttdoc">Initialize the host GDT.</div><div class="ttdef"><b>Definition</b> Segmentation.c:95</div></div>
<div class="ttc" id="a_vmx_8c_html_a40b4c16e2a106d27460f4a5dc8c76d70"><div class="ttname"><a href="_vmx_8c.html#a40b4c16e2a106d27460f4a5dc8c76d70">VmxClearVmcsState</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN VmxClearVmcsState(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Clearing Vmcs status using vmclear instruction.</div><div class="ttdef"><b>Definition</b> Vmx.c:766</div></div>
<div class="ttc" id="a_vmx_8c_html_a5d502eb714f3e5b8a9a405674190d1ca"><div class="ttname"><a href="_vmx_8c.html#a5d502eb714f3e5b8a9a405674190d1ca">VmxLoadVmcs</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN VmxLoadVmcs(VIRTUAL_MACHINE_STATE *VCpu)</div><div class="ttdoc">Implementation of VMPTRLD instruction.</div><div class="ttdef"><b>Definition</b> Vmx.c:798</div></div>
<div class="ttc" id="a_vmx_8c_html_ab410d0d271e13e18eb97f0870de4380d"><div class="ttname"><a href="_vmx_8c.html#ab410d0d271e13e18eb97f0870de4380d">VmxSetupVmcs</a></div><div class="ttdeci">_Use_decl_annotations_ BOOLEAN VmxSetupVmcs(VIRTUAL_MACHINE_STATE *VCpu, PVOID GuestStack)</div><div class="ttdoc">Create and Configure a Vmcs Layout.</div><div class="ttdef"><b>Definition</b> Vmx.c:820</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a099f2c93689489c8a4117c8f6648efc1" name="a099f2c93689489c8a4117c8f6648efc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099f2c93689489c8a4117c8f6648efc1">&#9670;&#160;</a></span>VmxVmptrst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxVmptrst </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementation of VMPTRST instruction. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  749</span>{</div>
<div class="line"><span class="lineno">  750</span>    PHYSICAL_ADDRESS VmcsPhysicalAddr;</div>
<div class="line"><span class="lineno">  751</span>    VmcsPhysicalAddr.QuadPart = 0;</div>
<div class="line"><span class="lineno">  752</span>    __vmx_vmptrst((<span class="keywordtype">unsigned</span> __int64 *)&amp;VmcsPhysicalAddr);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a108126279e46f4d46d25abe24da43fdc">LogDebugInfo</a>(<span class="stringliteral">&quot;VMPTRST result : %llx&quot;</span>, VmcsPhysicalAddr);</div>
<div class="line"><span class="lineno">  755</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6a01d1262cb49acf2a4e3d52c9143f7" name="ae6a01d1262cb49acf2a4e3d52c9143f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a01d1262cb49acf2a4e3d52c9143f7">&#9670;&#160;</a></span>VmxVmread16()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread16 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (16-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   56</span>{</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetField = 0ull;</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    TargetField = FieldValue;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)TargetField);</div>
<div class="line"><span class="lineno">   62</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b9a2488785132e5580df49c20fd1443" name="a0b9a2488785132e5580df49c20fd1443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b9a2488785132e5580df49c20fd1443">&#9670;&#160;</a></span>VmxVmread16P()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread16P </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a> *</td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (16-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  106</span>{</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetField = 0ull;</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    TargetField = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)FieldValue;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)TargetField);</div>
<div class="line"><span class="lineno">  112</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a4a5eb82be7c9c58ea15cb6fd7f001f" name="a7a4a5eb82be7c9c58ea15cb6fd7f001f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4a5eb82be7c9c58ea15cb6fd7f001f">&#9670;&#160;</a></span>VmxVmread32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread32 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (32-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   38</span>{</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetField = 0ull;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    TargetField = FieldValue;</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)TargetField);</div>
<div class="line"><span class="lineno">   44</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af411da3719b3f7f9198be1b8bc6c6874" name="af411da3719b3f7f9198be1b8bc6c6874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af411da3719b3f7f9198be1b8bc6c6874">&#9670;&#160;</a></span>VmxVmread32P()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread32P </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a> *</td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (32-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   88</span>{</div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetField = 0ull;</div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    TargetField = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)FieldValue;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)TargetField);</div>
<div class="line"><span class="lineno">   94</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a493c5a273fefd9ceeb520720225f7a47" name="a493c5a273fefd9ceeb520720225f7a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a493c5a273fefd9ceeb520720225f7a47">&#9670;&#160;</a></span>VmxVmread64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread64 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (64-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   24</span>{</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)FieldValue);</div>
<div class="line"><span class="lineno">   26</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a030c9345db1d1e6cdf76c3289f5090d9" name="a030c9345db1d1e6cdf76c3289f5090d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a030c9345db1d1e6cdf76c3289f5090d9">&#9670;&#160;</a></span>VmxVmread64P()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmread64P </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> *</td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMREAD instruction (64-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   74</span>{</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">return</span> __vmx_vmread((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span> *)FieldValue);</div>
<div class="line"><span class="lineno">   76</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a78415dd94deee3861f8cdfe695331aa9" name="a78415dd94deee3861f8cdfe695331aa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78415dd94deee3861f8cdfe695331aa9">&#9670;&#160;</a></span>VmxVmresume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxVmresume </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume VM using VMRESUME instruction. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1021</span>{</div>
<div class="line"><span class="lineno"> 1022</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ErrorCode = 0;</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>    __vmx_vmresume();</div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1027</span>    <span class="comment">// if VMRESUME succeed will never be here !</span></div>
<div class="line"><span class="lineno"> 1028</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span>    __vmx_vmread(VMCS_VM_INSTRUCTION_ERROR, &amp;ErrorCode);</div>
<div class="line"><span class="lineno"> 1031</span>    __vmx_off();</div>
<div class="line"><span class="lineno"> 1032</span> </div>
<div class="line"><span class="lineno"> 1033</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1034</span>    <span class="comment">// It&#39;s such a bad error because we don&#39;t where to go !</span></div>
<div class="line"><span class="lineno"> 1035</span>    <span class="comment">// prefer to break</span></div>
<div class="line"><span class="lineno"> 1036</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1037</span>    <a class="code hl_define" href="_hyper_dbg_hyper_log_intrinsics_8h.html#a459b19922fecfbb9438dd56b66930d16">LogError</a>(<span class="stringliteral">&quot;Err,  in executing VMRESUME , status : 0x%llx&quot;</span>, ErrorCode);</div>
<div class="line"><span class="lineno"> 1038</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5eb0f8482f465f2cce15041fe008f559" name="a5eb0f8482f465f2cce15041fe008f559"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb0f8482f465f2cce15041fe008f559">&#9670;&#160;</a></span>VmxVmwrite16()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmwrite16 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#a09f1a1fb2293e33483cc8d44aefb1eb1">UINT16</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMWRITE instruction (16-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  154</span>{</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetValue = <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>;</div>
<div class="line"><span class="lineno">  156</span>    TargetValue        = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)FieldValue;</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">return</span> __vmx_vmwrite((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span>)TargetValue);</div>
<div class="line"><span class="lineno">  158</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aefab869ab11279e141c6ff3d2ace3c5f" name="aefab869ab11279e141c6ff3d2ace3c5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefab869ab11279e141c6ff3d2ace3c5f">&#9670;&#160;</a></span>VmxVmwrite32()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmwrite32 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMWRITE instruction (32-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  138</span>{</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> TargetValue = <a class="code hl_define" href="_basic_types_8h.html#a8a9df53f35cb95dddbe3c564259e01ad">NULL64_ZERO</a>;</div>
<div class="line"><span class="lineno">  140</span>    TargetValue        = (<a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a>)FieldValue;</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">return</span> __vmx_vmwrite((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span>)TargetValue);</div>
<div class="line"><span class="lineno">  142</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14b2ff5571ba424d03e622b3802e8e5a" name="a14b2ff5571ba424d03e622b3802e8e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b2ff5571ba424d03e622b3802e8e5a">&#9670;&#160;</a></span>VmxVmwrite64()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> VmxVmwrite64 </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>Field</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a></td>          <td class="paramname"><span class="paramname"><em>FieldValue</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>VMX VMWRITE instruction (64-bit) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Field</td><td></td></tr>
    <tr><td class="paramname">FieldValue</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>UCHAR </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  124</span>{</div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">return</span> __vmx_vmwrite((<span class="keywordtype">size_t</span>)Field, (<span class="keywordtype">size_t</span>)FieldValue);</div>
<div class="line"><span class="lineno">  126</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9193ed1677033cd08c5d5b7788b15c7" name="ad9193ed1677033cd08c5d5b7788b15c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9193ed1677033cd08c5d5b7788b15c7">&#9670;&#160;</a></span>VmxVmxoff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> VmxVmxoff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="hyperhv_2header_2common_2_state_8h.html#ac81d4d9bd1e8dd24918e667b56b67b7e">VIRTUAL_MACHINE_STATE</a> *</td>          <td class="paramname"><span class="paramname"><em>VCpu</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare and execute Vmxoff instruction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">VCpu</td><td>The virtual processor's state</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno"> 1102</span>{</div>
<div class="line"><span class="lineno"> 1103</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GuestRSP              = 0; <span class="comment">// Save a pointer to guest rsp for times that we want to return to previous guest stateS</span></div>
<div class="line"><span class="lineno"> 1104</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GuestRIP              = 0; <span class="comment">// Save a pointer to guest rip for times that we want to return to previous guest state</span></div>
<div class="line"><span class="lineno"> 1105</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> GuestCr3              = 0;</div>
<div class="line"><span class="lineno"> 1106</span>    <a class="code hl_typedef" href="_basic_types_8h.html#aae17ebb9ef7279d026817fb22f8aebe9">UINT64</a> ExitInstructionLength = 0;</div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1109</span>    <span class="comment">// According to SimpleVisor :</span></div>
<div class="line"><span class="lineno"> 1110</span>    <span class="comment">//      Our callback routine may have interrupted an arbitrary user process,</span></div>
<div class="line"><span class="lineno"> 1111</span>    <span class="comment">//      and therefore not a thread running with a system-wide page directory.</span></div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment">//      Therefore if we return back to the original caller after turning off</span></div>
<div class="line"><span class="lineno"> 1113</span>    <span class="comment">//      VMX, it will keep our current &quot;host&quot; CR3 value which we set on entry</span></div>
<div class="line"><span class="lineno"> 1114</span>    <span class="comment">//      to the PML4 of the SYSTEM process. We want to return back with the</span></div>
<div class="line"><span class="lineno"> 1115</span>    <span class="comment">//      correct value of the &quot;guest&quot; CR3, so that the currently executing</span></div>
<div class="line"><span class="lineno"> 1116</span>    <span class="comment">//      process continues to run with its expected address space mappings.</span></div>
<div class="line"><span class="lineno"> 1117</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1118</span> </div>
<div class="line"><span class="lineno"> 1119</span>    __vmx_vmread(VMCS_GUEST_CR3, &amp;GuestCr3);</div>
<div class="line"><span class="lineno"> 1120</span>    __writecr3(GuestCr3);</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1123</span>    <span class="comment">// Read guest rsp and rip</span></div>
<div class="line"><span class="lineno"> 1124</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1125</span>    __vmx_vmread(VMCS_GUEST_RIP, &amp;GuestRIP);</div>
<div class="line"><span class="lineno"> 1126</span>    __vmx_vmread(VMCS_GUEST_RSP, &amp;GuestRSP);</div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">// Read instruction length</span></div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1131</span>    __vmx_vmread(VMCS_VMEXIT_INSTRUCTION_LENGTH, &amp;ExitInstructionLength);</div>
<div class="line"><span class="lineno"> 1132</span>    GuestRIP += ExitInstructionLength;</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1135</span>    <span class="comment">// Set the previous register states</span></div>
<div class="line"><span class="lineno"> 1136</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1137</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">VmxoffState</a>.<a class="code hl_variable" href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#a4f2e88d445f5ece493b3d201e3b6f19f">GuestRip</a> = GuestRIP;</div>
<div class="line"><span class="lineno"> 1138</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">VmxoffState</a>.<a class="code hl_variable" href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#ac920a356627a6c44d5255bc5611238da">GuestRsp</a> = GuestRSP;</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1141</span>    <span class="comment">// Notify the Vmexit handler that VMX already turned off</span></div>
<div class="line"><span class="lineno"> 1142</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1143</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#abe260607315f60c0e4676113b125d4a4">VmxoffState</a>.<a class="code hl_variable" href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#ad5fb82af1c2574681bf6199e3ff85cc4">IsVmxoffExecuted</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno"> 1144</span> </div>
<div class="line"><span class="lineno"> 1145</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1146</span>    <span class="comment">// Restore the previous FS, GS , GDTR and IDTR register as patchguard might find the modified</span></div>
<div class="line"><span class="lineno"> 1147</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1148</span>    <a class="code hl_function" href="_hv_8c.html#a011d070043f596f715b8a1deee31786c">HvRestoreRegisters</a>();</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1151</span>    <span class="comment">// Before using vmxoff, you first need to use vmclear on any VMCSes that you want to be able to use again.</span></div>
<div class="line"><span class="lineno"> 1152</span>    <span class="comment">// See sections 24.1 and 24.11 of the SDM.</span></div>
<div class="line"><span class="lineno"> 1153</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1154</span>    <a class="code hl_function" href="_vmx_8c.html#a40b4c16e2a106d27460f4a5dc8c76d70">VmxClearVmcsState</a>(VCpu);</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1157</span>    <span class="comment">// Execute Vmxoff</span></div>
<div class="line"><span class="lineno"> 1158</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1159</span>    __vmx_off();</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1162</span>    <span class="comment">// Indicate the current core is not currently virtualized</span></div>
<div class="line"><span class="lineno"> 1163</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1164</span>    VCpu-&gt;<a class="code hl_variable" href="struct___v_i_r_t_u_a_l___m_a_c_h_i_n_e___s_t_a_t_e.html#aaacba0883eec22779a564fb93aea73fd">HasLaunched</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1167</span>    <span class="comment">// Now that VMX is OFF, we have to unset vmx-enable bit on cr4</span></div>
<div class="line"><span class="lineno"> 1168</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1169</span>    __writecr4(__readcr4() &amp; (~<a class="code hl_define" href="hyperhv_2header_2common_2_common_8h.html#a8352c2d920c1435e681c21a07c06b28c">X86_CR4_VMXE</a>));</div>
<div class="line"><span class="lineno"> 1170</span>}</div>
<div class="ttc" id="a_hv_8c_html_a011d070043f596f715b8a1deee31786c"><div class="ttname"><a href="_hv_8c.html#a011d070043f596f715b8a1deee31786c">HvRestoreRegisters</a></div><div class="ttdeci">VOID HvRestoreRegisters()</div><div class="ttdoc">Reset GDTR/IDTR and other old when you do vmxoff as the patchguard will detect them left modified.</div><div class="ttdef"><b>Definition</b> Hv.c:463</div></div>
<div class="ttc" id="ahyperhv_2header_2common_2_common_8h_html_a8352c2d920c1435e681c21a07c06b28c"><div class="ttname"><a href="hyperhv_2header_2common_2_common_8h.html#a8352c2d920c1435e681c21a07c06b28c">X86_CR4_VMXE</a></div><div class="ttdeci">#define X86_CR4_VMXE</div><div class="ttdef"><b>Definition</b> Common.h:83</div></div>
<div class="ttc" id="astruct___v_m_x___v_m_x_o_f_f___s_t_a_t_e_html_ad5fb82af1c2574681bf6199e3ff85cc4"><div class="ttname"><a href="struct___v_m_x___v_m_x_o_f_f___s_t_a_t_e.html#ad5fb82af1c2574681bf6199e3ff85cc4">_VMX_VMXOFF_STATE::IsVmxoffExecuted</a></div><div class="ttdeci">BOOLEAN IsVmxoffExecuted</div><div class="ttdef"><b>Definition</b> State.h:152</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_e536aab728f7b0abbbf7dc8fdcfcc81b.html">hyperhv</a></li><li class="navelem"><a class="el" href="dir_c1e9402aa68d313bf3c169dd8660abb3.html">header</a></li><li class="navelem"><a class="el" href="dir_ece7518ea148b2aa6f397c230ea62e67.html">vmm</a></li><li class="navelem"><a class="el" href="dir_ebb8705cd9fef630d769095c42f148fb.html">vmx</a></li><li class="navelem"><a class="el" href="_vmx_8h.html">Vmx.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
