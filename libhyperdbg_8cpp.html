<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HyperDbg Debugger: hyperdbg/libhyperdbg/code/app/libhyperdbg.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HyperDbg Debugger
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('libhyperdbg_8cpp.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">libhyperdbg.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Main interface to connect applications to driver.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;pch.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:adea213287dea87ed62f9d014189aaa92" id="r_adea213287dea87ed62f9d014189aaa92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adea213287dea87ed62f9d014189aaa92">SetTextMessageCallback</a> (PVOID Handler)</td></tr>
<tr class="memdesc:adea213287dea87ed62f9d014189aaa92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the function callback that will be called if any message needs to be shown.  <br /></td></tr>
<tr class="separator:adea213287dea87ed62f9d014189aaa92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82812124ed5123611bf8b4129fc00f64" id="r_a82812124ed5123611bf8b4129fc00f64"><td class="memItemLeft" align="right" valign="top">PVOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a82812124ed5123611bf8b4129fc00f64">SetTextMessageCallbackUsingSharedBuffer</a> (PVOID Handler)</td></tr>
<tr class="memdesc:a82812124ed5123611bf8b4129fc00f64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the function callback that will be called if any message needs to be shown.  <br /></td></tr>
<tr class="separator:a82812124ed5123611bf8b4129fc00f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46134b8e86522c242ebbd8956543d74e" id="r_a46134b8e86522c242ebbd8956543d74e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a46134b8e86522c242ebbd8956543d74e">UnsetTextMessageCallback</a> ()</td></tr>
<tr class="memdesc:a46134b8e86522c242ebbd8956543d74e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unset the function callback that will be called if any message needs to be shown.  <br /></td></tr>
<tr class="separator:a46134b8e86522c242ebbd8956543d74e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21c3c06b34d716c4680695c2b28127da" id="r_a21c3c06b34d716c4680695c2b28127da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a> (const char *Fmt,...)</td></tr>
<tr class="memdesc:a21c3c06b34d716c4680695c2b28127da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Show messages.  <br /></td></tr>
<tr class="separator:a21c3c06b34d716c4680695c2b28127da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ebe288fadd8160b2ea2bd8b6d20967" id="r_a45ebe288fadd8160b2ea2bd8b6d20967"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a45ebe288fadd8160b2ea2bd8b6d20967">ReadIrpBasedBuffer</a> ()</td></tr>
<tr class="memdesc:a45ebe288fadd8160b2ea2bd8b6d20967"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read kernel buffers using IRP Pending.  <br /></td></tr>
<tr class="separator:a45ebe288fadd8160b2ea2bd8b6d20967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0564d081cfcdf97817d77dc998e81034" id="r_a0564d081cfcdf97817d77dc998e81034"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0564d081cfcdf97817d77dc998e81034">IrpBasedBufferThread</a> (void *data)</td></tr>
<tr class="memdesc:a0564d081cfcdf97817d77dc998e81034"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a thread for pending buffers.  <br /></td></tr>
<tr class="separator:a0564d081cfcdf97817d77dc998e81034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cef4cc0f007a28e4beade864f78e763" id="r_a1cef4cc0f007a28e4beade864f78e763"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1cef4cc0f007a28e4beade864f78e763">HyperDbgInstallVmmDriver</a> ()</td></tr>
<tr class="memdesc:a1cef4cc0f007a28e4beade864f78e763"><td class="mdescLeft">&#160;</td><td class="mdescRight">Install VMM driver.  <br /></td></tr>
<tr class="separator:a1cef4cc0f007a28e4beade864f78e763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a076b77cb955663d5957d786e6bd179ad" id="r_a076b77cb955663d5957d786e6bd179ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a076b77cb955663d5957d786e6bd179ad">HyperDbgStopDriver</a> (LPCTSTR DriverName)</td></tr>
<tr class="memdesc:a076b77cb955663d5957d786e6bd179ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the driver.  <br /></td></tr>
<tr class="separator:a076b77cb955663d5957d786e6bd179ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c5be1f8ed8e8e6884792490f264e3bd" id="r_a6c5be1f8ed8e8e6884792490f264e3bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c5be1f8ed8e8e6884792490f264e3bd">HyperDbgStopVmmDriver</a> ()</td></tr>
<tr class="memdesc:a6c5be1f8ed8e8e6884792490f264e3bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop VMM driver.  <br /></td></tr>
<tr class="separator:a6c5be1f8ed8e8e6884792490f264e3bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec70e1b0cf0dce947939a73f8ea9d8d3" id="r_aec70e1b0cf0dce947939a73f8ea9d8d3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec70e1b0cf0dce947939a73f8ea9d8d3">HyperDbgUninstallDriver</a> (LPCTSTR DriverName)</td></tr>
<tr class="memdesc:aec70e1b0cf0dce947939a73f8ea9d8d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the driver.  <br /></td></tr>
<tr class="separator:aec70e1b0cf0dce947939a73f8ea9d8d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f783a8762aa3e4b3d9653f567d083a2" id="r_a3f783a8762aa3e4b3d9653f567d083a2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f783a8762aa3e4b3d9653f567d083a2">HyperDbgUninstallVmmDriver</a> ()</td></tr>
<tr class="memdesc:a3f783a8762aa3e4b3d9653f567d083a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the VMM driver.  <br /></td></tr>
<tr class="separator:a3f783a8762aa3e4b3d9653f567d083a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1aff055b72a15573f5a4aa70b7f65ec" id="r_af1aff055b72a15573f5a4aa70b7f65ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1aff055b72a15573f5a4aa70b7f65ec">HyperDbgCreateHandleFromVmmModule</a> ()</td></tr>
<tr class="memdesc:af1aff055b72a15573f5a4aa70b7f65ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create handle from VMM module.  <br /></td></tr>
<tr class="separator:af1aff055b72a15573f5a4aa70b7f65ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c0644abe90016bbc866042655b31c32" id="r_a2c0644abe90016bbc866042655b31c32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c0644abe90016bbc866042655b31c32">HyperDbgUnloadVmm</a> ()</td></tr>
<tr class="memdesc:a2c0644abe90016bbc866042655b31c32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unload VMM driver.  <br /></td></tr>
<tr class="separator:a2c0644abe90016bbc866042655b31c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2efd19669f6d645dd2af0e2356a1b0e" id="r_af2efd19669f6d645dd2af0e2356a1b0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af2efd19669f6d645dd2af0e2356a1b0e">HyperDbgLoadVmmModule</a> ()</td></tr>
<tr class="memdesc:af2efd19669f6d645dd2af0e2356a1b0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">load vmm module  <br /></td></tr>
<tr class="separator:af2efd19669f6d645dd2af0e2356a1b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a04aaf680ede15f5e7ba51ab9f157bfff" id="r_a04aaf680ede15f5e7ba51ab9f157bfff"><td class="memItemLeft" align="right" valign="top">HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a></td></tr>
<tr class="memdesc:a04aaf680ede15f5e7ba51ab9f157bfff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the global handle of device which is used to send the request to the kernel by IOCTL, this handle is not used for IRP Pending of message tracing this handle is used in KD VMM.  <br /></td></tr>
<tr class="separator:a04aaf680ede15f5e7ba51ab9f157bfff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f9f07302a64745af9aa15c1defbc798" id="r_a3f9f07302a64745af9aa15c1defbc798"><td class="memItemLeft" align="right" valign="top">HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a></td></tr>
<tr class="memdesc:a3f9f07302a64745af9aa15c1defbc798"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle to show that if the debugger is loaded successfully.  <br /></td></tr>
<tr class="separator:a3f9f07302a64745af9aa15c1defbc798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d91f14ab8002a6eeab08d76588ae92" id="r_a34d91f14ab8002a6eeab08d76588ae92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a34d91f14ab8002a6eeab08d76588ae92">g_IsVmxOffProcessStart</a></td></tr>
<tr class="memdesc:a34d91f14ab8002a6eeab08d76588ae92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shows whether the vmxoff process start or not.  <br /></td></tr>
<tr class="separator:a34d91f14ab8002a6eeab08d76588ae92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9ddd7ca0c6eabaedb612ceba470aa29" id="r_aa9ddd7ca0c6eabaedb612ceba470aa29"><td class="memItemLeft" align="right" valign="top">PVOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a></td></tr>
<tr class="memdesc:aa9ddd7ca0c6eabaedb612ceba470aa29"><td class="mdescLeft">&#160;</td><td class="mdescRight">The handler for ShowMessages function this is because the user might choose not to use printf and instead use his/her handler for showing messages.  <br /></td></tr>
<tr class="separator:aa9ddd7ca0c6eabaedb612ceba470aa29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ae3a9dabd3dba9c5d7b8fd8729261ef" id="r_a7ae3a9dabd3dba9c5d7b8fd8729261ef"><td class="memItemLeft" align="right" valign="top">PVOID&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a></td></tr>
<tr class="memdesc:a7ae3a9dabd3dba9c5d7b8fd8729261ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">The shared buffer for the handler of ShowMessages function.  <br /></td></tr>
<tr class="separator:a7ae3a9dabd3dba9c5d7b8fd8729261ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a510d8eeb6d2c6c99faa91682232ec257" id="r_a510d8eeb6d2c6c99faa91682232ec257"><td class="memItemLeft" align="right" valign="top">TCHAR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a> [MAX_PATH]</td></tr>
<tr class="memdesc:a510d8eeb6d2c6c99faa91682232ec257"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the location driver to install it.  <br /></td></tr>
<tr class="separator:a510d8eeb6d2c6c99faa91682232ec257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac55333cf9f0ea48c98b88541e7bd951" id="r_aac55333cf9f0ea48c98b88541e7bd951"><td class="memItemLeft" align="right" valign="top">TCHAR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a> [MAX_PATH]</td></tr>
<tr class="memdesc:aac55333cf9f0ea48c98b88541e7bd951"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the name of the driver to install it.  <br /></td></tr>
<tr class="separator:aac55333cf9f0ea48c98b88541e7bd951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe302f8d26342968e3daac90ce1384c1" id="r_abe302f8d26342968e3daac90ce1384c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe302f8d26342968e3daac90ce1384c1">g_UseCustomDriverLocation</a></td></tr>
<tr class="memdesc:abe302f8d26342968e3daac90ce1384c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the user wants to use a custom driver location or not.  <br /></td></tr>
<tr class="separator:abe302f8d26342968e3daac90ce1384c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5295702ad37c6640bf9d2df3091f9417" id="r_a5295702ad37c6640bf9d2df3091f9417"><td class="memItemLeft" align="right" valign="top">LIST_ENTRY&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5295702ad37c6640bf9d2df3091f9417">g_EventTrace</a></td></tr>
<tr class="memdesc:a5295702ad37c6640bf9d2df3091f9417"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds a list of events in kernel and the state of events and the commands to show the state of each command (disabled/enabled)  <br /></td></tr>
<tr class="separator:a5295702ad37c6640bf9d2df3091f9417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9102adae8f4c5bb1d077a2b72f725c" id="r_a3d9102adae8f4c5bb1d077a2b72f725c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d9102adae8f4c5bb1d077a2b72f725c">g_LogOpened</a></td></tr>
<tr class="memdesc:a3d9102adae8f4c5bb1d077a2b72f725c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shows whether the '.logopen' command is executed and the log file is open or not.  <br /></td></tr>
<tr class="separator:a3d9102adae8f4c5bb1d077a2b72f725c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4758ea6e4b2b001288af3b22ff11795" id="r_ac4758ea6e4b2b001288af3b22ff11795"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a></td></tr>
<tr class="memdesc:ac4758ea6e4b2b001288af3b22ff11795"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shows whether the pause command or CTRL+C or CTRL+Break is executed or not.  <br /></td></tr>
<tr class="separator:ac4758ea6e4b2b001288af3b22ff11795"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6712815a46bbfaf04ac69c5f336d371" id="r_aa6712815a46bbfaf04ac69c5f336d371"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa6712815a46bbfaf04ac69c5f336d371">g_IsConnectedToRemoteDebugger</a></td></tr>
<tr class="memdesc:aa6712815a46bbfaf04ac69c5f336d371"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shows whether the current system is a guest (debuggee) and a remote debugger is connected to this system.  <br /></td></tr>
<tr class="separator:aa6712815a46bbfaf04ac69c5f336d371"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dd113ea332d12de4597426dc75efd7a" id="r_a4dd113ea332d12de4597426dc75efd7a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4dd113ea332d12de4597426dc75efd7a">g_OutputSourcesInitialized</a></td></tr>
<tr class="memdesc:a4dd113ea332d12de4597426dc75efd7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">it shows whether the debugger started using output sources or not or in other words, is g_OutputSources initialized with a variable or it is empty  <br /></td></tr>
<tr class="separator:a4dd113ea332d12de4597426dc75efd7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d4f30d5bc446a5c0dacc0b77b902db" id="r_a07d4f30d5bc446a5c0dacc0b77b902db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a07d4f30d5bc446a5c0dacc0b77b902db">g_IsSerialConnectedToRemoteDebugger</a></td></tr>
<tr class="memdesc:a07d4f30d5bc446a5c0dacc0b77b902db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shows if the debugger was connected to remote debugger (A remote host)  <br /></td></tr>
<tr class="separator:a07d4f30d5bc446a5c0dacc0b77b902db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5df196001f0c415fbb0601caabc9804" id="r_ad5df196001f0c415fbb0601caabc9804"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad5df196001f0c415fbb0601caabc9804">g_IsDebuggerModulesLoaded</a></td></tr>
<tr class="memdesc:ad5df196001f0c415fbb0601caabc9804"><td class="mdescLeft">&#160;</td><td class="mdescRight">this variable is used to indicate that modules are loaded so we make sure to later use a trace of loading in 'unload' command (used in Debugger VMM)  <br /></td></tr>
<tr class="separator:ad5df196001f0c415fbb0601caabc9804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a209ec7bc7822ce1f94848c31d87cdd" id="r_a0a209ec7bc7822ce1f94848c31d87cdd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0a209ec7bc7822ce1f94848c31d87cdd">g_IsReversingMachineModulesLoaded</a></td></tr>
<tr class="separator:a0a209ec7bc7822ce1f94848c31d87cdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd85daad5afd0daf8ce46b7200a89276" id="r_acd85daad5afd0daf8ce46b7200a89276"><td class="memItemLeft" align="right" valign="top">LIST_ENTRY&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acd85daad5afd0daf8ce46b7200a89276">g_OutputSources</a></td></tr>
<tr class="memdesc:acd85daad5afd0daf8ce46b7200a89276"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds a list of output sources created by output command.  <br /></td></tr>
<tr class="separator:acd85daad5afd0daf8ce46b7200a89276"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Main interface to connect applications to driver. </p>
<dl class="section author"><dt>Author</dt><dd>Sina Karvandi (<a href="#" onclick="location.href='mai'+'lto:'+'sin'+'a@'+'hyp'+'er'+'dbg'+'.o'+'rg'; return false;">sina@<span class="obfuscator">.nosp@m.</span>hype<span class="obfuscator">.nosp@m.</span>rdbg.<span class="obfuscator">.nosp@m.</span>org</a>)</dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.1 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-04-11</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>This project is released under the GNU Public License v3. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="af1aff055b72a15573f5a4aa70b7f65ec" name="af1aff055b72a15573f5a4aa70b7f65ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1aff055b72a15573f5a4aa70b7f65ec">&#9670;&#160;</a></span>HyperDbgCreateHandleFromVmmModule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgCreateHandleFromVmmModule </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create handle from VMM module. </p>
<dl class="section return"><dt>Returns</dt><dd>INT return zero if it was successful or non-zero if there was error </dd></dl>
<p>lpSecurityAttirbutes</p>
<p>lpTemplateFile</p>
<div class="fragment"><div class="line"><span class="lineno">  617</span>{</div>
<div class="line"><span class="lineno">  618</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> ErrorNum;</div>
<div class="line"><span class="lineno">  619</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> ThreadId;</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a>)</div>
<div class="line"><span class="lineno">  622</span>    {</div>
<div class="line"><span class="lineno">  623</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;handle of the driver found, if you use &#39;load&#39; before, please &quot;</span></div>
<div class="line"><span class="lineno">  624</span>                     <span class="stringliteral">&quot;unload it using &#39;unload&#39;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  629</span>    <span class="comment">// Make sure that this variable is false, because it might be set to</span></div>
<div class="line"><span class="lineno">  630</span>    <span class="comment">// true as the result of a previous load</span></div>
<div class="line"><span class="lineno">  631</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  632</span>    <a class="code hl_variable" href="#a34d91f14ab8002a6eeab08d76588ae92">g_IsVmxOffProcessStart</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  635</span>    <span class="comment">// Init entering vmx</span></div>
<div class="line"><span class="lineno">  636</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  637</span>    <a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a> = CreateFileA(</div>
<div class="line"><span class="lineno">  638</span>        <span class="stringliteral">&quot;\\\\.\\HyperDbgDebuggerDevice&quot;</span>,</div>
<div class="line"><span class="lineno">  639</span>        GENERIC_READ | GENERIC_WRITE,</div>
<div class="line"><span class="lineno">  640</span>        FILE_SHARE_READ | FILE_SHARE_WRITE,</div>
<div class="line"><span class="lineno">  641</span>        NULL, </div>
<div class="line"><span class="lineno">  642</span>        OPEN_EXISTING,</div>
<div class="line"><span class="lineno">  643</span>        FILE_ATTRIBUTE_NORMAL | FILE_FLAG_OVERLAPPED,</div>
<div class="line"><span class="lineno">  644</span>        NULL); </div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a> == INVALID_HANDLE_VALUE)</div>
<div class="line"><span class="lineno">  647</span>    {</div>
<div class="line"><span class="lineno">  648</span>        ErrorNum = GetLastError();</div>
<div class="line"><span class="lineno">  649</span>        <span class="keywordflow">if</span> (ErrorNum == ERROR_ACCESS_DENIED)</div>
<div class="line"><span class="lineno">  650</span>        {</div>
<div class="line"><span class="lineno">  651</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, access denied\nare you sure you have administrator &quot;</span></div>
<div class="line"><span class="lineno">  652</span>                         <span class="stringliteral">&quot;rights?\n&quot;</span>);</div>
<div class="line"><span class="lineno">  653</span>        }</div>
<div class="line"><span class="lineno">  654</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ErrorNum == ERROR_GEN_FAILURE)</div>
<div class="line"><span class="lineno">  655</span>        {</div>
<div class="line"><span class="lineno">  656</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, a device attached to the system is not functioning\n&quot;</span></div>
<div class="line"><span class="lineno">  657</span>                         <span class="stringliteral">&quot;vmx feature might be disabled from BIOS or VBS/HVCI is active\n&quot;</span>);</div>
<div class="line"><span class="lineno">  658</span>        }</div>
<div class="line"><span class="lineno">  659</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  660</span>        {</div>
<div class="line"><span class="lineno">  661</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, CreateFile failed (%x)\n&quot;</span>, ErrorNum);</div>
<div class="line"><span class="lineno">  662</span>        }</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>        <a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  665</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  666</span>    }</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  669</span>    <span class="comment">// Initialize the list of events</span></div>
<div class="line"><span class="lineno">  670</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  671</span>    <a class="code hl_function" href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a>(&amp;<a class="code hl_variable" href="#a5295702ad37c6640bf9d2df3091f9417">g_EventTrace</a>);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span><span class="preprocessor">#if !UseDbgPrintInsteadOfUsermodeMessageTracking</span></div>
<div class="line"><span class="lineno">  674</span>    HANDLE Thread = CreateThread(NULL, 0, <a class="code hl_function" href="#a0564d081cfcdf97817d77dc998e81034">IrpBasedBufferThread</a>, NULL, 0, &amp;ThreadId);</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>    <span class="comment">// if (Thread)</span></div>
<div class="line"><span class="lineno">  677</span>    <span class="comment">// {</span></div>
<div class="line"><span class="lineno">  678</span>    <span class="comment">// ShowMessages(&quot;thread Created successfully\n&quot;);</span></div>
<div class="line"><span class="lineno">  679</span>    <span class="comment">// }</span></div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  684</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:54</div></div>
<div class="ttc" id="a_basic_types_8h_html_ad342ac907eb044443153a22f964bf0af"><div class="ttname"><a href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a></div><div class="ttdeci">unsigned long DWORD</div><div class="ttdef"><b>Definition</b> BasicTypes.h:22</div></div>
<div class="ttc" id="a_windows_8h_html_ad211c1678754ed394322f51a9e909c4a"><div class="ttname"><a href="_windows_8h.html#ad211c1678754ed394322f51a9e909c4a">InitializeListHead</a></div><div class="ttdeci">FORCEINLINE VOID InitializeListHead(_Out_ PLIST_ENTRY ListHead)</div><div class="ttdef"><b>Definition</b> Windows.h:41</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a04aaf680ede15f5e7ba51ab9f157bfff"><div class="ttname"><a href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a></div><div class="ttdeci">HANDLE g_DeviceHandle</div><div class="ttdoc">Holds the global handle of device which is used to send the request to the kernel by IOCTL,...</div><div class="ttdef"><b>Definition</b> globals.h:471</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a0564d081cfcdf97817d77dc998e81034"><div class="ttname"><a href="#a0564d081cfcdf97817d77dc998e81034">IrpBasedBufferThread</a></div><div class="ttdeci">DWORD WINAPI IrpBasedBufferThread(void *data)</div><div class="ttdoc">Create a thread for pending buffers.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:483</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a21c3c06b34d716c4680695c2b28127da"><div class="ttname"><a href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a></div><div class="ttdeci">VOID ShowMessages(const char *Fmt,...)</div><div class="ttdoc">Show messages.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:96</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a34d91f14ab8002a6eeab08d76588ae92"><div class="ttname"><a href="#a34d91f14ab8002a6eeab08d76588ae92">g_IsVmxOffProcessStart</a></div><div class="ttdeci">BOOLEAN g_IsVmxOffProcessStart</div><div class="ttdoc">Shows whether the vmxoff process start or not.</div><div class="ttdef"><b>Definition</b> globals.h:462</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a5295702ad37c6640bf9d2df3091f9417"><div class="ttname"><a href="#a5295702ad37c6640bf9d2df3091f9417">g_EventTrace</a></div><div class="ttdeci">LIST_ENTRY g_EventTrace</div><div class="ttdoc">Holds a list of events in kernel and the state of events and the commands to show the state of each c...</div><div class="ttdef"><b>Definition</b> globals.h:400</div></div>
<div class="ttc" id="anamespacetest-case-generator_html_a9a4eff80432bb93d2796381610dd86c3"><div class="ttname"><a href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">test-case-generator.NULL</a></div><div class="ttdeci">NULL()</div><div class="ttdef"><b>Definition</b> test-case-generator.py:530</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cef4cc0f007a28e4beade864f78e763" name="a1cef4cc0f007a28e4beade864f78e763"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cef4cc0f007a28e4beade864f78e763">&#9670;&#160;</a></span>HyperDbgInstallVmmDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgInstallVmmDriver </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Install VMM driver. </p>
<dl class="section return"><dt>Returns</dt><dd>INT return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  503</span>{</div>
<div class="line"><span class="lineno">  504</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  505</span>    <span class="comment">// The driver is not started yet so let us the install driver</span></div>
<div class="line"><span class="lineno">  506</span>    <span class="comment">// First setup full path to driver name</span></div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  510</span>    <span class="comment">// If the user has not specified a custom driver location, then we</span></div>
<div class="line"><span class="lineno">  511</span>    <span class="comment">// need to find the driver in the same directory as the executable</span></div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#abe302f8d26342968e3daac90ce1384c1">g_UseCustomDriverLocation</a>)</div>
<div class="line"><span class="lineno">  514</span>    {</div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="install_8cpp.html#a2677c6448b6c4c96f84306bde7a44607">SetupPathForFileName</a>(<a class="code hl_define" href="_definition_8h.html#a6a28fc6917ae85ea1f339805bf76bf73">KERNEL_DEBUGGER_DRIVER_NAME_AND_EXTENSION</a>, <a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>), <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>))</div>
<div class="line"><span class="lineno">  516</span>        {</div>
<div class="line"><span class="lineno">  517</span>            <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  518</span>        }</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  521</span>        <span class="comment">// Use default driver name</span></div>
<div class="line"><span class="lineno">  522</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  523</span>        strcpy_s(<a class="code hl_variable" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a>, <a class="code hl_define" href="_definition_8h.html#a0b4e97e1618a44ec00a4421fa7ee84cc">KERNEL_DEBUGGER_DRIVER_NAME</a>);</div>
<div class="line"><span class="lineno">  524</span>    }</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="install_8cpp.html#af0036492327d14b9ab062516f179a5e0">ManageDriver</a>(<a class="code hl_variable" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a>, <a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>, <a class="code hl_define" href="install_8h.html#aa378ee498aed65ff64444bb86c60a86c">DRIVER_FUNC_INSTALL</a>))</div>
<div class="line"><span class="lineno">  527</span>    {</div>
<div class="line"><span class="lineno">  528</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;unable to install VMM driver\n&quot;</span>);</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  531</span>        <span class="comment">// Error - remove driver</span></div>
<div class="line"><span class="lineno">  532</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  533</span>        <a class="code hl_function" href="install_8cpp.html#af0036492327d14b9ab062516f179a5e0">ManageDriver</a>(<a class="code hl_variable" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a>, <a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>, <a class="code hl_define" href="install_8h.html#a59f927de3a1d0e607fc731b2875e8257">DRIVER_FUNC_REMOVE</a>);</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  536</span>    }</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  539</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition</b> BasicTypes.h:55</div></div>
<div class="ttc" id="a_definition_8h_html_a0b4e97e1618a44ec00a4421fa7ee84cc"><div class="ttname"><a href="_definition_8h.html#a0b4e97e1618a44ec00a4421fa7ee84cc">KERNEL_DEBUGGER_DRIVER_NAME</a></div><div class="ttdeci">#define KERNEL_DEBUGGER_DRIVER_NAME</div><div class="ttdoc">name of HyperDbg's debugger driver</div><div class="ttdef"><b>Definition</b> Definition.h:40</div></div>
<div class="ttc" id="a_definition_8h_html_a6a28fc6917ae85ea1f339805bf76bf73"><div class="ttname"><a href="_definition_8h.html#a6a28fc6917ae85ea1f339805bf76bf73">KERNEL_DEBUGGER_DRIVER_NAME_AND_EXTENSION</a></div><div class="ttdeci">#define KERNEL_DEBUGGER_DRIVER_NAME_AND_EXTENSION</div><div class="ttdoc">name of HyperDbg's debugger driver + extension</div><div class="ttdef"><b>Definition</b> Definition.h:46</div></div>
<div class="ttc" id="ainstall_8cpp_html_a2677c6448b6c4c96f84306bde7a44607"><div class="ttname"><a href="install_8cpp.html#a2677c6448b6c4c96f84306bde7a44607">SetupPathForFileName</a></div><div class="ttdeci">BOOLEAN SetupPathForFileName(const CHAR *FileName, _Inout_updates_bytes_all_(BufferLength) PCHAR FileLocation, ULONG BufferLength, BOOLEAN CheckFileExists)</div><div class="ttdoc">Setup file name.</div><div class="ttdef"><b>Definition</b> install.cpp:440</div></div>
<div class="ttc" id="ainstall_8cpp_html_af0036492327d14b9ab062516f179a5e0"><div class="ttname"><a href="install_8cpp.html#af0036492327d14b9ab062516f179a5e0">ManageDriver</a></div><div class="ttdeci">BOOLEAN ManageDriver(LPCTSTR DriverName, LPCTSTR ServiceName, UINT16 Function)</div><div class="ttdoc">Manage Driver.</div><div class="ttdef"><b>Definition</b> install.cpp:121</div></div>
<div class="ttc" id="ainstall_8h_html_a59f927de3a1d0e607fc731b2875e8257"><div class="ttname"><a href="install_8h.html#a59f927de3a1d0e607fc731b2875e8257">DRIVER_FUNC_REMOVE</a></div><div class="ttdeci">#define DRIVER_FUNC_REMOVE</div><div class="ttdef"><b>Definition</b> install.h:36</div></div>
<div class="ttc" id="ainstall_8h_html_aa378ee498aed65ff64444bb86c60a86c"><div class="ttname"><a href="install_8h.html#aa378ee498aed65ff64444bb86c60a86c">DRIVER_FUNC_INSTALL</a></div><div class="ttdeci">#define DRIVER_FUNC_INSTALL</div><div class="ttdef"><b>Definition</b> install.h:34</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a510d8eeb6d2c6c99faa91682232ec257"><div class="ttname"><a href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a></div><div class="ttdeci">TCHAR g_DriverLocation[MAX_PATH]</div><div class="ttdoc">Holds the location driver to install it.</div><div class="ttdef"><b>Definition</b> globals.h:423</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_aac55333cf9f0ea48c98b88541e7bd951"><div class="ttname"><a href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a></div><div class="ttdeci">TCHAR g_DriverName[MAX_PATH]</div><div class="ttdoc">Holds the name of the driver to install it.</div><div class="ttdef"><b>Definition</b> globals.h:429</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_abe302f8d26342968e3daac90ce1384c1"><div class="ttname"><a href="#abe302f8d26342968e3daac90ce1384c1">g_UseCustomDriverLocation</a></div><div class="ttdeci">BOOLEAN g_UseCustomDriverLocation</div><div class="ttdoc">Whether the user wants to use a custom driver location or not.</div><div class="ttdef"><b>Definition</b> globals.h:435</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af2efd19669f6d645dd2af0e2356a1b0e" name="af2efd19669f6d645dd2af0e2356a1b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2efd19669f6d645dd2af0e2356a1b0e">&#9670;&#160;</a></span>HyperDbgLoadVmmModule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgLoadVmmModule </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>load vmm module </p>
<dl class="section return"><dt>Returns</dt><dd>int return zero if it was successful or non-zero if there </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  799</span>{</div>
<div class="line"><span class="lineno">  800</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>   Status;</div>
<div class="line"><span class="lineno">  801</span>    HANDLE hToken;</div>
<div class="line"><span class="lineno">  802</span>    <span class="keywordtype">char</span>   CpuId[13] = {0};</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment">// Enable Debug privilege</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  807</span>    Status = OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES, &amp;hToken);</div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">if</span> (!Status)</div>
<div class="line"><span class="lineno">  809</span>    {</div>
<div class="line"><span class="lineno">  810</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, OpenProcessToken failed (%x)\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    Status = <a class="code hl_function" href="common_8cpp.html#a957d3b6eecf8d3715c4f6c578c1b6e05">SetPrivilege</a>(hToken, SE_DEBUG_NAME, <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">if</span> (!Status)</div>
<div class="line"><span class="lineno">  816</span>    {</div>
<div class="line"><span class="lineno">  817</span>        CloseHandle(hToken);</div>
<div class="line"><span class="lineno">  818</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  819</span>    }</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  822</span>    <span class="comment">// Read the vendor string</span></div>
<div class="line"><span class="lineno">  823</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  824</span>    <a class="code hl_function" href="cpu_8cpp.html#ab6e227359d99eed65a71cad638468129">CpuReadVendorString</a>(CpuId);</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;current processor vendor is : %s\n&quot;</span>, CpuId);</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>    <span class="keywordflow">if</span> (strcmp(CpuId, <span class="stringliteral">&quot;GenuineIntel&quot;</span>) == 0)</div>
<div class="line"><span class="lineno">  829</span>    {</div>
<div class="line"><span class="lineno">  830</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;virtualization technology is vt-x\n&quot;</span>);</div>
<div class="line"><span class="lineno">  831</span>    }</div>
<div class="line"><span class="lineno">  832</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  833</span>    {</div>
<div class="line"><span class="lineno">  834</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;this program is not designed to run in a non-VT-x &quot;</span></div>
<div class="line"><span class="lineno">  835</span>                     <span class="stringliteral">&quot;environment !\n&quot;</span>);</div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  837</span>    }</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="common_8cpp.html#a3850533e5498dc9ea006fc4f728059fb">VmxSupportDetection</a>())</div>
<div class="line"><span class="lineno">  840</span>    {</div>
<div class="line"><span class="lineno">  841</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;vmx operation is supported by your processor\n&quot;</span>);</div>
<div class="line"><span class="lineno">  842</span>    }</div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  844</span>    {</div>
<div class="line"><span class="lineno">  845</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;vmx operation is not supported by your processor\n&quot;</span>);</div>
<div class="line"><span class="lineno">  846</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  847</span>    }</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  850</span>    <span class="comment">// Create event to show if the hypervisor is loaded or not</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_variable" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a> = CreateEvent(NULL, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, NULL);</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="#af1aff055b72a15573f5a4aa70b7f65ec">HyperDbgCreateHandleFromVmmModule</a>() == 1)</div>
<div class="line"><span class="lineno">  855</span>    {</div>
<div class="line"><span class="lineno">  856</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  857</span>        <span class="comment">// No need to handle anymore</span></div>
<div class="line"><span class="lineno">  858</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  859</span>        CloseHandle(<a class="code hl_variable" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a>);</div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  861</span>    }</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  864</span>    <span class="comment">// Vmm module (Hypervisor) is loaded</span></div>
<div class="line"><span class="lineno">  865</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  868</span>    <span class="comment">// We wait for the first message from the kernel debugger to continue</span></div>
<div class="line"><span class="lineno">  869</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  870</span>    WaitForSingleObject(</div>
<div class="line"><span class="lineno">  871</span>        <a class="code hl_variable" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a>,</div>
<div class="line"><span class="lineno">  872</span>        INFINITE);</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  875</span>    <span class="comment">// No need to handle anymore</span></div>
<div class="line"><span class="lineno">  876</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  877</span>    CloseHandle(<a class="code hl_variable" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a>);</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  880</span>    <span class="comment">// If we reach here so the module are loaded</span></div>
<div class="line"><span class="lineno">  881</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  882</span>    <a class="code hl_variable" href="#ad5df196001f0c415fbb0601caabc9804">g_IsDebuggerModulesLoaded</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;vmm module is running...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  887</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_a050c65e107f0c828f856a231f4b4e788"><div class="ttname"><a href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a></div><div class="ttdeci">int BOOL</div><div class="ttdef"><b>Definition</b> BasicTypes.h:23</div></div>
<div class="ttc" id="acommon_8cpp_html_a3850533e5498dc9ea006fc4f728059fb"><div class="ttname"><a href="common_8cpp.html#a3850533e5498dc9ea006fc4f728059fb">VmxSupportDetection</a></div><div class="ttdeci">BOOLEAN VmxSupportDetection()</div><div class="ttdoc">Detect whether the VMX is supported or not.</div><div class="ttdef"><b>Definition</b> common.cpp:505</div></div>
<div class="ttc" id="acommon_8cpp_html_a957d3b6eecf8d3715c4f6c578c1b6e05"><div class="ttname"><a href="common_8cpp.html#a957d3b6eecf8d3715c4f6c578c1b6e05">SetPrivilege</a></div><div class="ttdeci">BOOL SetPrivilege(HANDLE Token, LPCTSTR Privilege, BOOL EnablePrivilege)</div><div class="ttdoc">SetPrivilege enables/disables process token privilege.</div><div class="ttdef"><b>Definition</b> common.cpp:522</div></div>
<div class="ttc" id="acpu_8cpp_html_ab6e227359d99eed65a71cad638468129"><div class="ttname"><a href="cpu_8cpp.html#ab6e227359d99eed65a71cad638468129">CpuReadVendorString</a></div><div class="ttdeci">VOID CpuReadVendorString(CHAR *Result)</div><div class="ttdoc">Reads the CPU vendor string.</div><div class="ttdef"><b>Definition</b> cpu.cpp:249</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a3f9f07302a64745af9aa15c1defbc798"><div class="ttname"><a href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a></div><div class="ttdeci">HANDLE g_IsDriverLoadedSuccessfully</div><div class="ttdoc">Handle to show that if the debugger is loaded successfully.</div><div class="ttdef"><b>Definition</b> globals.h:130</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_ad5df196001f0c415fbb0601caabc9804"><div class="ttname"><a href="#ad5df196001f0c415fbb0601caabc9804">g_IsDebuggerModulesLoaded</a></div><div class="ttdeci">BOOLEAN g_IsDebuggerModulesLoaded</div><div class="ttdoc">this variable is used to indicate that modules are loaded so we make sure to later use a trace of loa...</div><div class="ttdef"><b>Definition</b> globals.h:356</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_af1aff055b72a15573f5a4aa70b7f65ec"><div class="ttname"><a href="#af1aff055b72a15573f5a4aa70b7f65ec">HyperDbgCreateHandleFromVmmModule</a></div><div class="ttdeci">INT HyperDbgCreateHandleFromVmmModule()</div><div class="ttdoc">Create handle from VMM module.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:616</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a076b77cb955663d5957d786e6bd179ad" name="a076b77cb955663d5957d786e6bd179ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a076b77cb955663d5957d786e6bd179ad">&#9670;&#160;</a></span>HyperDbgStopDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HyperDbgStopDriver </td>
          <td>(</td>
          <td class="paramtype">LPCTSTR</td>          <td class="paramname"><span class="paramname"><em>DriverName</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the driver. </p>
<dl class="section return"><dt>Returns</dt><dd>int return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  549</span>{</div>
<div class="line"><span class="lineno">  550</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">// Unload the driver if loaded</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>[0] != (TCHAR)0 &amp;&amp; <a class="code hl_function" href="install_8cpp.html#af0036492327d14b9ab062516f179a5e0">ManageDriver</a>(DriverName, <a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>, <a class="code hl_define" href="install_8h.html#a2579a48e0600578aa994e2bda343e294">DRIVER_FUNC_STOP</a>))</div>
<div class="line"><span class="lineno">  554</span>    {</div>
<div class="line"><span class="lineno">  555</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  556</span>    }</div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  558</span>    {</div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  560</span>    }</div>
<div class="line"><span class="lineno">  561</span>}</div>
<div class="ttc" id="ainstall_8h_html_a2579a48e0600578aa994e2bda343e294"><div class="ttname"><a href="install_8h.html#a2579a48e0600578aa994e2bda343e294">DRIVER_FUNC_STOP</a></div><div class="ttdeci">#define DRIVER_FUNC_STOP</div><div class="ttdef"><b>Definition</b> install.h:35</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c5be1f8ed8e8e6884792490f264e3bd" name="a6c5be1f8ed8e8e6884792490f264e3bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c5be1f8ed8e8e6884792490f264e3bd">&#9670;&#160;</a></span>HyperDbgStopVmmDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgStopVmmDriver </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop VMM driver. </p>
<dl class="section return"><dt>Returns</dt><dd>INT return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  571</span>{</div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#a076b77cb955663d5957d786e6bd179ad">HyperDbgStopDriver</a>(<a class="code hl_variable" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a>);</div>
<div class="line"><span class="lineno">  573</span>}</div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a076b77cb955663d5957d786e6bd179ad"><div class="ttname"><a href="#a076b77cb955663d5957d786e6bd179ad">HyperDbgStopDriver</a></div><div class="ttdeci">int HyperDbgStopDriver(LPCTSTR DriverName)</div><div class="ttdoc">Stop the driver.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:548</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aec70e1b0cf0dce947939a73f8ea9d8d3" name="aec70e1b0cf0dce947939a73f8ea9d8d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec70e1b0cf0dce947939a73f8ea9d8d3">&#9670;&#160;</a></span>HyperDbgUninstallDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int HyperDbgUninstallDriver </td>
          <td>(</td>
          <td class="paramtype">LPCTSTR</td>          <td class="paramname"><span class="paramname"><em>DriverName</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the driver. </p>
<dl class="section return"><dt>Returns</dt><dd>int return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  583</span>{</div>
<div class="line"><span class="lineno">  584</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  585</span>    <span class="comment">// Unload the driver if loaded.  Ignore any errors</span></div>
<div class="line"><span class="lineno">  586</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  587</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>[0] != (TCHAR)0 &amp;&amp; <a class="code hl_function" href="install_8cpp.html#af0036492327d14b9ab062516f179a5e0">ManageDriver</a>(DriverName, <a class="code hl_variable" href="#a510d8eeb6d2c6c99faa91682232ec257">g_DriverLocation</a>, <a class="code hl_define" href="install_8h.html#a59f927de3a1d0e607fc731b2875e8257">DRIVER_FUNC_REMOVE</a>))</div>
<div class="line"><span class="lineno">  588</span>    {</div>
<div class="line"><span class="lineno">  589</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  590</span>    }</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  592</span>    {</div>
<div class="line"><span class="lineno">  593</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  594</span>    }</div>
<div class="line"><span class="lineno">  595</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f783a8762aa3e4b3d9653f567d083a2" name="a3f783a8762aa3e4b3d9653f567d083a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f783a8762aa3e4b3d9653f567d083a2">&#9670;&#160;</a></span>HyperDbgUninstallVmmDriver()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgUninstallVmmDriver </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the VMM driver. </p>
<dl class="section return"><dt>Returns</dt><dd>INT return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  605</span>{</div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="#aec70e1b0cf0dce947939a73f8ea9d8d3">HyperDbgUninstallDriver</a>(<a class="code hl_variable" href="#aac55333cf9f0ea48c98b88541e7bd951">g_DriverName</a>);</div>
<div class="line"><span class="lineno">  607</span>}</div>
<div class="ttc" id="alibhyperdbg_8cpp_html_aec70e1b0cf0dce947939a73f8ea9d8d3"><div class="ttname"><a href="#aec70e1b0cf0dce947939a73f8ea9d8d3">HyperDbgUninstallDriver</a></div><div class="ttdeci">int HyperDbgUninstallDriver(LPCTSTR DriverName)</div><div class="ttdoc">Remove the driver.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:582</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c0644abe90016bbc866042655b31c32" name="a2c0644abe90016bbc866042655b31c32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c0644abe90016bbc866042655b31c32">&#9670;&#160;</a></span>HyperDbgUnloadVmm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a392e62da233ed3e2f7c3fd4f487a3896">INT</a> HyperDbgUnloadVmm </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unload VMM driver. </p>
<dl class="section return"><dt>Returns</dt><dd>INT return zero if it was successful or non-zero if there was error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  694</span>{</div>
<div class="line"><span class="lineno">  695</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a> Status;</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>    <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a14c16a9f19d50a44bfde8e8a3029c5d1">AssertShowMessageReturnStmt</a>(<a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a>, <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#aa984b32130ec28ae1dbb70f604463dd0">ASSERT_MESSAGE_DRIVER_NOT_LOADED</a>, <a class="code hl_define" href="libhyperdbg_2header_2_common_8h.html#a8e6f4c525de44eba74843648747ec73b">AssertReturnOne</a>);</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;start terminating...\n&quot;</span>);</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  702</span>    <span class="comment">// Uninitialize the user debugger if it&#39;s initialized</span></div>
<div class="line"><span class="lineno">  703</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_function" href="_ud_8c.html#a7c8e27ff0bdd3e135b4e39c7cf7b5805">UdUninitializeUserDebugger</a>();</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="comment">// Send IOCTL to mark complete all IRP Pending</span></div>
<div class="line"><span class="lineno">  708</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  709</span>    Status = DeviceIoControl(<a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a>,      <span class="comment">// Handle to device</span></div>
<div class="line"><span class="lineno">  710</span>                             <a class="code hl_define" href="_ioctls_8h.html#a74e9d0c3605d1f407b4f4e08316a9f4b">IOCTL_TERMINATE_VMX</a>, <span class="comment">// IO Control Code (IOCTL)</span></div>
<div class="line"><span class="lineno">  711</span>                             NULL,                <span class="comment">// Input Buffer to driver.</span></div>
<div class="line"><span class="lineno">  712</span>                             0,                   <span class="comment">// Length of input buffer in bytes. (x 2 is bcuz</span></div>
<div class="line"><span class="lineno">  713</span>                                                  <span class="comment">// as the driver is x64 and has 64 bit values)</span></div>
<div class="line"><span class="lineno">  714</span>                             NULL,                <span class="comment">// Output Buffer from driver.</span></div>
<div class="line"><span class="lineno">  715</span>                             0,                   <span class="comment">// Length of output buffer in bytes.</span></div>
<div class="line"><span class="lineno">  716</span>                             NULL,                <span class="comment">// Bytes placed in buffer.</span></div>
<div class="line"><span class="lineno">  717</span>                             NULL                 <span class="comment">// synchronous call</span></div>
<div class="line"><span class="lineno">  718</span>    );</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  721</span>    <span class="comment">// wait to make sure we don&#39;t use an invalid handle in another Ioctl</span></div>
<div class="line"><span class="lineno">  722</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">if</span> (!Status)</div>
<div class="line"><span class="lineno">  724</span>    {</div>
<div class="line"><span class="lineno">  725</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;ioctl failed with code 0x%x\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  726</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  727</span>    }</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  730</span>    <span class="comment">// Send IOCTL to mark complete all IRP Pending</span></div>
<div class="line"><span class="lineno">  731</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  732</span>    Status = DeviceIoControl(</div>
<div class="line"><span class="lineno">  733</span>        <a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a>,                                      <span class="comment">// Handle to device</span></div>
<div class="line"><span class="lineno">  734</span>        <a class="code hl_define" href="_ioctls_8h.html#a58a948845b8edb96050374a542b9244d">IOCTL_RETURN_IRP_PENDING_PACKETS_AND_DISALLOW_IOCTL</a>, <span class="comment">// IO</span></div>
<div class="line"><span class="lineno">  735</span>                                                             <span class="comment">// Control</span></div>
<div class="line"><span class="lineno">  736</span>                                                             <span class="comment">// code</span></div>
<div class="line"><span class="lineno">  737</span>        NULL,                                                <span class="comment">// Input Buffer to driver.</span></div>
<div class="line"><span class="lineno">  738</span>        0,                                                   <span class="comment">// Length of input buffer in bytes. (x 2 is bcuz as the</span></div>
<div class="line"><span class="lineno">  739</span>                                                             <span class="comment">// driver is x64 and has 64 bit values)</span></div>
<div class="line"><span class="lineno">  740</span>        NULL,                                                <span class="comment">// Output Buffer from driver.</span></div>
<div class="line"><span class="lineno">  741</span>        0,                                                   <span class="comment">// Length of output buffer in bytes.</span></div>
<div class="line"><span class="lineno">  742</span>        NULL,                                                <span class="comment">// Bytes placed in buffer.</span></div>
<div class="line"><span class="lineno">  743</span>        NULL                                                 <span class="comment">// synchronous call</span></div>
<div class="line"><span class="lineno">  744</span>    );</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="comment">// wait to make sure we don&#39;t use an invalid handle in another Ioctl</span></div>
<div class="line"><span class="lineno">  748</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  749</span>    <span class="keywordflow">if</span> (!Status)</div>
<div class="line"><span class="lineno">  750</span>    {</div>
<div class="line"><span class="lineno">  751</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;ioctl failed with code 0x%x\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  752</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  753</span>    }</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">// Indicate that the finish process start or not</span></div>
<div class="line"><span class="lineno">  757</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_variable" href="#a34d91f14ab8002a6eeab08d76588ae92">g_IsVmxOffProcessStart</a> = <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    Sleep(1000); <span class="comment">// Wait so next thread can return from IRP Pending</span></div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  763</span>    <span class="comment">// Send IRP_MJ_CLOSE to driver to terminate Vmxs</span></div>
<div class="line"><span class="lineno">  764</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  765</span>    <span class="keywordflow">if</span> (!CloseHandle(<a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a>))</div>
<div class="line"><span class="lineno">  766</span>    {</div>
<div class="line"><span class="lineno">  767</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, closing handle 0x%x\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  768</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  769</span>    };</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  772</span>    <span class="comment">// Null the handle to indicate that the driver&#39;s device is not ready</span></div>
<div class="line"><span class="lineno">  773</span>    <span class="comment">// to use</span></div>
<div class="line"><span class="lineno">  774</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  775</span>    <a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  778</span>    <span class="comment">// Debugger module is not loaded anymore</span></div>
<div class="line"><span class="lineno">  779</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  780</span>    <a class="code hl_variable" href="#ad5df196001f0c415fbb0601caabc9804">g_IsDebuggerModulesLoaded</a> = <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  783</span>    <span class="comment">// Check if we found an already built symbol table</span></div>
<div class="line"><span class="lineno">  784</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  785</span>    <a class="code hl_function" href="symbol_8cpp.html#af524ccff25966d357e7ba0010ff2940f">SymbolDeleteSymTable</a>();</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;you&#39;re not on HyperDbg&#39;s hypervisor anymore!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  790</span>}</div>
<div class="ttc" id="a_ioctls_8h_html_a58a948845b8edb96050374a542b9244d"><div class="ttname"><a href="_ioctls_8h.html#a58a948845b8edb96050374a542b9244d">IOCTL_RETURN_IRP_PENDING_PACKETS_AND_DISALLOW_IOCTL</a></div><div class="ttdeci">#define IOCTL_RETURN_IRP_PENDING_PACKETS_AND_DISALLOW_IOCTL</div><div class="ttdoc">ioctl, irp pending mechanism for reading from message tracing buffers</div><div class="ttdef"><b>Definition</b> Ioctls.h:71</div></div>
<div class="ttc" id="a_ioctls_8h_html_a74e9d0c3605d1f407b4f4e08316a9f4b"><div class="ttname"><a href="_ioctls_8h.html#a74e9d0c3605d1f407b4f4e08316a9f4b">IOCTL_TERMINATE_VMX</a></div><div class="ttdeci">#define IOCTL_TERMINATE_VMX</div><div class="ttdoc">ioctl, to terminate vmx and exit form debugger</div><div class="ttdef"><b>Definition</b> Ioctls.h:78</div></div>
<div class="ttc" id="a_ud_8c_html_a7c8e27ff0bdd3e135b4e39c7cf7b5805"><div class="ttname"><a href="_ud_8c.html#a7c8e27ff0bdd3e135b4e39c7cf7b5805">UdUninitializeUserDebugger</a></div><div class="ttdeci">VOID UdUninitializeUserDebugger()</div><div class="ttdoc">uninitialize user debugger</div><div class="ttdef"><b>Definition</b> Ud.c:77</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_a14c16a9f19d50a44bfde8e8a3029c5d1"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#a14c16a9f19d50a44bfde8e8a3029c5d1">AssertShowMessageReturnStmt</a></div><div class="ttdeci">#define AssertShowMessageReturnStmt(expr, message, rc)</div><div class="ttdef"><b>Definition</b> common.h:51</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_a8e6f4c525de44eba74843648747ec73b"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#a8e6f4c525de44eba74843648747ec73b">AssertReturnOne</a></div><div class="ttdeci">#define AssertReturnOne</div><div class="ttdef"><b>Definition</b> common.h:23</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_common_8h_html_aa984b32130ec28ae1dbb70f604463dd0"><div class="ttname"><a href="libhyperdbg_2header_2_common_8h.html#aa984b32130ec28ae1dbb70f604463dd0">ASSERT_MESSAGE_DRIVER_NOT_LOADED</a></div><div class="ttdeci">#define ASSERT_MESSAGE_DRIVER_NOT_LOADED</div><div class="ttdef"><b>Definition</b> common.h:25</div></div>
<div class="ttc" id="asymbol_8cpp_html_af524ccff25966d357e7ba0010ff2940f"><div class="ttname"><a href="symbol_8cpp.html#af524ccff25966d357e7ba0010ff2940f">SymbolDeleteSymTable</a></div><div class="ttdeci">BOOLEAN SymbolDeleteSymTable()</div><div class="ttdoc">Delete and free structures and variables related to the symbols.</div><div class="ttdef"><b>Definition</b> symbol.cpp:433</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0564d081cfcdf97817d77dc998e81034" name="a0564d081cfcdf97817d77dc998e81034"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0564d081cfcdf97817d77dc998e81034">&#9670;&#160;</a></span>IrpBasedBufferThread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a> WINAPI IrpBasedBufferThread </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>data</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a thread for pending buffers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DWORD Device Handle </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  484</span>{</div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  486</span>    <span class="comment">// Do stuff.  This will be the first function called on the new</span></div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">// thread. When this function returns, the thread goes away.  See</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">// MSDN for more details. Test Irp Based Notifications</span></div>
<div class="line"><span class="lineno">  489</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_function" href="#a45ebe288fadd8160b2ea2bd8b6d20967">ReadIrpBasedBuffer</a>();</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  493</span>}</div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a45ebe288fadd8160b2ea2bd8b6d20967"><div class="ttname"><a href="#a45ebe288fadd8160b2ea2bd8b6d20967">ReadIrpBasedBuffer</a></div><div class="ttdeci">VOID ReadIrpBasedBuffer()</div><div class="ttdoc">Read kernel buffers using IRP Pending.</div><div class="ttdef"><b>Definition</b> libhyperdbg.cpp:170</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a45ebe288fadd8160b2ea2bd8b6d20967" name="a45ebe288fadd8160b2ea2bd8b6d20967"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45ebe288fadd8160b2ea2bd8b6d20967">&#9670;&#160;</a></span>ReadIrpBasedBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ReadIrpBasedBuffer </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read kernel buffers using IRP Pending. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Device</td><td>Driver handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<p>lpSecurityAttirbutes</p>
<p>lpTemplateFile</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span>{</div>
<div class="line"><span class="lineno">  172</span>    <a class="code hl_typedef" href="_basic_types_8h.html#a050c65e107f0c828f856a231f4b4e788">BOOL</a>                   Status;</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_typedef" href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>                  ReturnedLength;</div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_struct" href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html">REGISTER_NOTIFY_BUFFER</a> RegisterEvent;</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>                 OperationCode;</div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_typedef" href="_basic_types_8h.html#ad342ac907eb044443153a22f964bf0af">DWORD</a>                  ErrorNum;</div>
<div class="line"><span class="lineno">  177</span>    HANDLE                 Handle;</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    RegisterEvent.<a class="code hl_variable" href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html#a0be90ffe07b5e70e32a2971852f29c8f">hEvent</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  180</span>    RegisterEvent.<a class="code hl_variable" href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html#a05acd472c7bdb5b620ec76b2ece28dd0">Type</a>   = <a class="code hl_enumvalue" href="_data_types_8h.html#a7df81690e4c6ed5fbbb74547c998e4b6a557243d0c993fb8d9b81a0a0db183c2e">IRP_BASED</a>;</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  183</span>    <span class="comment">// Create another handle to be used in for reading kernel messages,</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">// it is because I noticed that if I use a same handle for IRP Pending</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="comment">// and other IOCTLs then if I complete that IOCTL then both of the current</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment">// IOCTL and the Pending IRP are completed and return to user mode,</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="comment">// even if it&#39;s odd but that what happens, so this way we can solve it</span></div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">// if you know why this problem happens, then contact me !</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  190</span>    Handle = CreateFileA(</div>
<div class="line"><span class="lineno">  191</span>        <span class="stringliteral">&quot;\\\\.\\HyperDbgDebuggerDevice&quot;</span>,</div>
<div class="line"><span class="lineno">  192</span>        GENERIC_READ | GENERIC_WRITE,</div>
<div class="line"><span class="lineno">  193</span>        FILE_SHARE_READ | FILE_SHARE_WRITE,</div>
<div class="line"><span class="lineno">  194</span>        NULL, </div>
<div class="line"><span class="lineno">  195</span>        OPEN_EXISTING,</div>
<div class="line"><span class="lineno">  196</span>        FILE_ATTRIBUTE_NORMAL | FILE_FLAG_OVERLAPPED,</div>
<div class="line"><span class="lineno">  197</span>        NULL); </div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (Handle == INVALID_HANDLE_VALUE)</div>
<div class="line"><span class="lineno">  200</span>    {</div>
<div class="line"><span class="lineno">  201</span>        ErrorNum = GetLastError();</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">if</span> (ErrorNum == ERROR_ACCESS_DENIED)</div>
<div class="line"><span class="lineno">  204</span>        {</div>
<div class="line"><span class="lineno">  205</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, access denied\nare you sure you have administrator &quot;</span></div>
<div class="line"><span class="lineno">  206</span>                         <span class="stringliteral">&quot;rights?\n&quot;</span>);</div>
<div class="line"><span class="lineno">  207</span>        }</div>
<div class="line"><span class="lineno">  208</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ErrorNum == ERROR_GEN_FAILURE)</div>
<div class="line"><span class="lineno">  209</span>        {</div>
<div class="line"><span class="lineno">  210</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, a device attached to the system is not functioning\n&quot;</span></div>
<div class="line"><span class="lineno">  211</span>                         <span class="stringliteral">&quot;vmx feature might be disabled from BIOS or VBS/HVCI is active\n&quot;</span>);</div>
<div class="line"><span class="lineno">  212</span>        }</div>
<div class="line"><span class="lineno">  213</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  214</span>        {</div>
<div class="line"><span class="lineno">  215</span>            <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, CreateFile failed with (%x)\n&quot;</span>, ErrorNum);</div>
<div class="line"><span class="lineno">  216</span>        }</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_variable" href="#a04aaf680ede15f5e7ba51ab9f157bfff">g_DeviceHandle</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  219</span>        Handle         = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  225</span>    <span class="comment">// allocate buffer for transferring messages</span></div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordtype">char</span> * OutputBuffer = (<span class="keywordtype">char</span> *)malloc(<a class="code hl_define" href="_constants_8h.html#a4e12a0c1a102bb323458f19d591379e5">UsermodeBufferSize</a>);</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">try</span></div>
<div class="line"><span class="lineno">  230</span>    {</div>
<div class="line"><span class="lineno">  231</span>        <span class="keywordflow">while</span> (<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)</div>
<div class="line"><span class="lineno">  232</span>        {</div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a34d91f14ab8002a6eeab08d76588ae92">g_IsVmxOffProcessStart</a>)</div>
<div class="line"><span class="lineno">  234</span>            {</div>
<div class="line"><span class="lineno">  235</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>                <span class="comment">// Clear the buffer</span></div>
<div class="line"><span class="lineno">  237</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  238</span>                ZeroMemory(OutputBuffer, <a class="code hl_define" href="_constants_8h.html#a4e12a0c1a102bb323458f19d591379e5">UsermodeBufferSize</a>);</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>                Sleep(<a class="code hl_define" href="_definition_8h.html#ae587705d649b149ca423cf686550d197">DefaultSpeedOfReadingKernelMessages</a>); <span class="comment">// we&#39;re not trying to eat all of the CPU ;)</span></div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>                Status = DeviceIoControl(</div>
<div class="line"><span class="lineno">  243</span>                    Handle,                    <span class="comment">// Handle to device</span></div>
<div class="line"><span class="lineno">  244</span>                    <a class="code hl_define" href="_ioctls_8h.html#ace90f6cc998458c046a38d7231989484">IOCTL_REGISTER_EVENT</a>,      <span class="comment">// IO Control Code (IOCTL)</span></div>
<div class="line"><span class="lineno">  245</span>                    &amp;RegisterEvent,            <span class="comment">// Input Buffer to driver.</span></div>
<div class="line"><span class="lineno">  246</span>                    <a class="code hl_define" href="include_2_s_d_k_2_headers_2_events_8h.html#a45b28ed4e4baa5ca1d2b986967ce8e18">SIZEOF_REGISTER_EVENT</a> * 2, <span class="comment">// Length of input buffer in bytes. (x 2 is bcuz as the</span></div>
<div class="line"><span class="lineno">  247</span>                                               <span class="comment">// driver is x64 and has 64 bit values)</span></div>
<div class="line"><span class="lineno">  248</span>                    OutputBuffer,              <span class="comment">// Output Buffer from driver.</span></div>
<div class="line"><span class="lineno">  249</span>                    <a class="code hl_define" href="_constants_8h.html#a4e12a0c1a102bb323458f19d591379e5">UsermodeBufferSize</a>,        <span class="comment">// Length of output buffer in bytes.</span></div>
<div class="line"><span class="lineno">  250</span>                    &amp;ReturnedLength,           <span class="comment">// Bytes placed in buffer.</span></div>
<div class="line"><span class="lineno">  251</span>                    NULL                       <span class="comment">// synchronous call</span></div>
<div class="line"><span class="lineno">  252</span>                );</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">if</span> (!Status)</div>
<div class="line"><span class="lineno">  255</span>                {</div>
<div class="line"><span class="lineno">  256</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  257</span>                    <span class="comment">// Error occurred for second time, and we show the error message</span></div>
<div class="line"><span class="lineno">  258</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>                    <span class="comment">// ShowMessages(&quot;ioctl failed with code 0x%x\n&quot;, GetLastError());</span></div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  262</span>                    <span class="comment">// if we reach here, the packet is probably failed, it might</span></div>
<div class="line"><span class="lineno">  263</span>                    <span class="comment">// be because of using flush command</span></div>
<div class="line"><span class="lineno">  264</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  265</span>                    <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  266</span>                }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  269</span>                <span class="comment">// Compute the received buffer&#39;s operation code</span></div>
<div class="line"><span class="lineno">  270</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>                OperationCode = 0;</div>
<div class="line"><span class="lineno">  272</span>                memcpy(&amp;OperationCode, OutputBuffer, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>                <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">        ShowMessages(&quot;Returned Length : 0x%x \n&quot;, ReturnedLength);</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">        ShowMessages(&quot;Operation Code : 0x%x \n&quot;, OperationCode);</span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">                */</span></div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>                <span class="keywordflow">switch</span> (OperationCode)</div>
<div class="line"><span class="lineno">  280</span>                {</div>
<div class="line"><span class="lineno">  281</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#adb2ff9235a26370285f86dd92ca438e5">OPERATION_LOG_NON_IMMEDIATE_MESSAGE</a>:</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a>)</div>
<div class="line"><span class="lineno">  284</span>                    {</div>
<div class="line"><span class="lineno">  285</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  286</span>                        <span class="comment">// means that the user asserts a CTRL+C or CTRL+BREAK Signal</span></div>
<div class="line"><span class="lineno">  287</span>                        <span class="comment">// we shouldn&#39;t show or save anything in this case</span></div>
<div class="line"><span class="lineno">  288</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  289</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  290</span>                    }</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>                    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%s&quot;</span>, OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  295</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#ab45eded32abb2bdaa322ec7f102adf71">OPERATION_LOG_INFO_MESSAGE</a>:</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a>)</div>
<div class="line"><span class="lineno">  298</span>                    {</div>
<div class="line"><span class="lineno">  299</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  300</span>                        <span class="comment">// means that the user asserts a CTRL+C or CTRL+BREAK Signal</span></div>
<div class="line"><span class="lineno">  301</span>                        <span class="comment">// we shouldn&#39;t show or save anything in this case</span></div>
<div class="line"><span class="lineno">  302</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  303</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  304</span>                    }</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>                    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%s&quot;</span>, OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  309</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a45f712ca02a53ef234a252d979cbea84">OPERATION_LOG_ERROR_MESSAGE</a>:</div>
<div class="line"><span class="lineno">  310</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a>)</div>
<div class="line"><span class="lineno">  311</span>                    {</div>
<div class="line"><span class="lineno">  312</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  313</span>                        <span class="comment">// means that the user asserts a CTRL+C or CTRL+BREAK Signal</span></div>
<div class="line"><span class="lineno">  314</span>                        <span class="comment">// we shouldn&#39;t show or save anything in this case</span></div>
<div class="line"><span class="lineno">  315</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  316</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  317</span>                    }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>                    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%s&quot;</span>, OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  322</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a7fe504aedb9b121cc73989a01396de8d">OPERATION_LOG_WARNING_MESSAGE</a>:</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a>)</div>
<div class="line"><span class="lineno">  325</span>                    {</div>
<div class="line"><span class="lineno">  326</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  327</span>                        <span class="comment">// means that the user asserts a CTRL+C or CTRL+BREAK Signal</span></div>
<div class="line"><span class="lineno">  328</span>                        <span class="comment">// we shouldn&#39;t show or save anything in this case</span></div>
<div class="line"><span class="lineno">  329</span>                        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  330</span>                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  331</span>                    }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>                    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%s&quot;</span>, OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#af1ce4ec6df0b72bf72e7a1b72825fc30">OPERATION_COMMAND_FROM_DEBUGGER_CLOSE_AND_UNLOAD_VMM</a>:</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#a628100cfab9e08107027ad304327fd37">KdCloseConnection</a>();</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a1835665c21bb2e6f4733a2b8cf750a66">OPERATION_DEBUGGEE_USER_INPUT</a>:</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#a96e9806024f1d3f2a137c3940954ec4a">KdHandleUserInputInDebuggee</a>((<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_s_e_r___i_n_p_u_t___p_a_c_k_e_t.html">DEBUGGEE_USER_INPUT_PACKET</a> *)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)));</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a7fe7df604d81f1b46afe1d44e2e2c38c">OPERATION_DEBUGGEE_REGISTER_EVENT</a>:</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#a3094d7fd63949b1a53ca42a69a88c412">KdRegisterEventInDebuggee</a>(</div>
<div class="line"><span class="lineno">  352</span>                        (<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l.html">PDEBUGGER_GENERAL_EVENT_DETAIL</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)),</div>
<div class="line"><span class="lineno">  353</span>                        ReturnedLength);</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a6761361aea99545180b79961a0840e28">OPERATION_DEBUGGEE_ADD_ACTION_TO_EVENT</a>:</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#aee94a30ff44688198e8a43e55dbb90f1">KdAddActionToEventInDebuggee</a>(</div>
<div class="line"><span class="lineno">  360</span>                        (<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___a_c_t_i_o_n.html">PDEBUGGER_GENERAL_ACTION</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)),</div>
<div class="line"><span class="lineno">  361</span>                        ReturnedLength);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#acb988d1979e04bb62dcff3603ef0c9a8">OPERATION_DEBUGGEE_CLEAR_EVENTS</a>:</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#a3b3c1a4783e48dbccbca7aa158a09486">KdSendModifyEventInDebuggee</a>(</div>
<div class="line"><span class="lineno">  368</span>                        (<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___m_o_d_i_f_y___e_v_e_n_t_s.html">PDEBUGGER_MODIFY_EVENTS</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)),</div>
<div class="line"><span class="lineno">  369</span>                        <a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#ac643a240390d97e6ce94643e817f3c38">OPERATION_DEBUGGEE_CLEAR_EVENTS_WITHOUT_NOTIFYING_DEBUGGER</a>:</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#a3b3c1a4783e48dbccbca7aa158a09486">KdSendModifyEventInDebuggee</a>(</div>
<div class="line"><span class="lineno">  376</span>                        (<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_r___m_o_d_i_f_y___e_v_e_n_t_s.html">PDEBUGGER_MODIFY_EVENTS</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)),</div>
<div class="line"><span class="lineno">  377</span>                        <a class="code hl_define" href="_basic_types_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a9f661f43a2301721d3ce5d0956095a86">OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</a>:</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  384</span>                    <span class="comment">// Indicate that driver (Hypervisor) is loaded successfully</span></div>
<div class="line"><span class="lineno">  385</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  386</span>                    SetEvent(<a class="code hl_variable" href="#a3f9f07302a64745af9aa15c1defbc798">g_IsDriverLoadedSuccessfully</a>);</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a413d8699d9a0868289ccdc01acdd4c4d">OPERATION_HYPERVISOR_DRIVER_END_OF_IRPS</a>:</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  393</span>                    <span class="comment">// End of receiving messages (IRPs), nothing to do</span></div>
<div class="line"><span class="lineno">  394</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  395</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a4d8383c3da73f73402b1249d47d724a2">OPERATION_COMMAND_FROM_DEBUGGER_RELOAD_SYMBOL</a>:</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  400</span>                    <span class="comment">// Pause debugger after getting the results</span></div>
<div class="line"><span class="lineno">  401</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  402</span>                    <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#ab2a8ea0be4cc5d4a9d8eba5dd71c94be">KdReloadSymbolsInDebuggee</a>(<a class="code hl_define" href="_basic_types_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>,</div>
<div class="line"><span class="lineno">  403</span>                                              ((<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___s_y_m_b_o_l___r_e_q_u_e_s_t___p_a_c_k_e_t.html">PDEBUGGEE_SYMBOL_REQUEST_PACKET</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)))-&gt;ProcessId);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>                <span class="keywordflow">case</span> <a class="code hl_define" href="_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a>:</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  410</span>                    <span class="comment">// handle pausing packet from user debugger</span></div>
<div class="line"><span class="lineno">  411</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  412</span>                    <a class="code hl_function" href="user-listening_8cpp.html#ababfc7aac28c2ab9a43c85bca8ce61af">UdHandleUserDebuggerPausing</a>(</div>
<div class="line"><span class="lineno">  413</span>                        (<a class="code hl_struct" href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">PDEBUGGEE_UD_PAUSED_PACKET</a>)(OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>)));</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>                <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  420</span>                    <span class="comment">// Check if there are available output sources</span></div>
<div class="line"><span class="lineno">  421</span>                    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>                    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a4dd113ea332d12de4597426dc75efd7a">g_OutputSourcesInitialized</a> || !<a class="code hl_function" href="forwarding_8cpp.html#aaefb1436070d1736e201244354af5dfc">ForwardingCheckAndPerformEventForwarding</a>(OperationCode,</div>
<div class="line"><span class="lineno">  423</span>                                                                                                 OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>),</div>
<div class="line"><span class="lineno">  424</span>                                                                                                 ReturnedLength - <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>) - 1))</div>
<div class="line"><span class="lineno">  425</span>                    {</div>
<div class="line"><span class="lineno">  426</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a>)</div>
<div class="line"><span class="lineno">  427</span>                        {</div>
<div class="line"><span class="lineno">  428</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  429</span>                            <span class="comment">// means that the user asserts a CTRL+C or CTRL+BREAK Signal</span></div>
<div class="line"><span class="lineno">  430</span>                            <span class="comment">// we shouldn&#39;t show or save anything in this case</span></div>
<div class="line"><span class="lineno">  431</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  432</span>                            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  433</span>                        }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>                        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;%s&quot;</span>, OutputBuffer + <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a>));</div>
<div class="line"><span class="lineno">  436</span>                    }</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  439</span>                }</div>
<div class="line"><span class="lineno">  440</span>            }</div>
<div class="line"><span class="lineno">  441</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  442</span>            {</div>
<div class="line"><span class="lineno">  443</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  444</span>                <span class="comment">// the thread should not work anymore</span></div>
<div class="line"><span class="lineno">  445</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  446</span>                free(OutputBuffer);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  449</span>                <span class="comment">// closeHandle</span></div>
<div class="line"><span class="lineno">  450</span>                <span class="comment">//</span></div>
<div class="line"><span class="lineno">  451</span>                <span class="keywordflow">if</span> (!CloseHandle(Handle))</div>
<div class="line"><span class="lineno">  452</span>                {</div>
<div class="line"><span class="lineno">  453</span>                    <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, closing handle 0x%x\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  454</span>                }</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  457</span>            }</div>
<div class="line"><span class="lineno">  458</span>        }</div>
<div class="line"><span class="lineno">  459</span>    }</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;)</div>
<div class="line"><span class="lineno">  461</span>    {</div>
<div class="line"><span class="lineno">  462</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, exception occurred in creating handle or parsing buffer\n&quot;</span>);</div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    free(OutputBuffer);</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="comment">// closeHandle</span></div>
<div class="line"><span class="lineno">  469</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">if</span> (!CloseHandle(Handle))</div>
<div class="line"><span class="lineno">  471</span>    {</div>
<div class="line"><span class="lineno">  472</span>        <a class="code hl_function" href="#a21c3c06b34d716c4680695c2b28127da">ShowMessages</a>(<span class="stringliteral">&quot;err, closing handle 0x%x\n&quot;</span>, GetLastError());</div>
<div class="line"><span class="lineno">  473</span>    };</div>
<div class="line"><span class="lineno">  474</span>}</div>
<div class="ttc" id="a_basic_types_8h_html_ae1e6edbbc26d6fbc71a90190d0266018"><div class="ttname"><a href="_basic_types_8h.html#ae1e6edbbc26d6fbc71a90190d0266018">UINT32</a></div><div class="ttdeci">unsigned int UINT32</div><div class="ttdef"><b>Definition</b> BasicTypes.h:48</div></div>
<div class="ttc" id="a_basic_types_8h_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="_basic_types_8h.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition</b> BasicTypes.h:37</div></div>
<div class="ttc" id="a_constants_8h_html_a1835665c21bb2e6f4733a2b8cf750a66"><div class="ttname"><a href="_constants_8h.html#a1835665c21bb2e6f4733a2b8cf750a66">OPERATION_DEBUGGEE_USER_INPUT</a></div><div class="ttdeci">#define OPERATION_DEBUGGEE_USER_INPUT</div><div class="ttdef"><b>Definition</b> Constants.h:374</div></div>
<div class="ttc" id="a_constants_8h_html_a413d8699d9a0868289ccdc01acdd4c4d"><div class="ttname"><a href="_constants_8h.html#a413d8699d9a0868289ccdc01acdd4c4d">OPERATION_HYPERVISOR_DRIVER_END_OF_IRPS</a></div><div class="ttdeci">#define OPERATION_HYPERVISOR_DRIVER_END_OF_IRPS</div><div class="ttdef"><b>Definition</b> Constants.h:382</div></div>
<div class="ttc" id="a_constants_8h_html_a45f712ca02a53ef234a252d979cbea84"><div class="ttname"><a href="_constants_8h.html#a45f712ca02a53ef234a252d979cbea84">OPERATION_LOG_ERROR_MESSAGE</a></div><div class="ttdeci">#define OPERATION_LOG_ERROR_MESSAGE</div><div class="ttdef"><b>Definition</b> Constants.h:368</div></div>
<div class="ttc" id="a_constants_8h_html_a4d8383c3da73f73402b1249d47d724a2"><div class="ttname"><a href="_constants_8h.html#a4d8383c3da73f73402b1249d47d724a2">OPERATION_COMMAND_FROM_DEBUGGER_RELOAD_SYMBOL</a></div><div class="ttdeci">#define OPERATION_COMMAND_FROM_DEBUGGER_RELOAD_SYMBOL</div><div class="ttdef"><b>Definition</b> Constants.h:384</div></div>
<div class="ttc" id="a_constants_8h_html_a4e12a0c1a102bb323458f19d591379e5"><div class="ttname"><a href="_constants_8h.html#a4e12a0c1a102bb323458f19d591379e5">UsermodeBufferSize</a></div><div class="ttdeci">#define UsermodeBufferSize</div><div class="ttdoc">size of user-mode buffer</div><div class="ttdef"><b>Definition</b> Constants.h:187</div></div>
<div class="ttc" id="a_constants_8h_html_a6761361aea99545180b79961a0840e28"><div class="ttname"><a href="_constants_8h.html#a6761361aea99545180b79961a0840e28">OPERATION_DEBUGGEE_ADD_ACTION_TO_EVENT</a></div><div class="ttdeci">#define OPERATION_DEBUGGEE_ADD_ACTION_TO_EVENT</div><div class="ttdef"><b>Definition</b> Constants.h:376</div></div>
<div class="ttc" id="a_constants_8h_html_a7d47482024b99d93c486dabbdbfca6d2"><div class="ttname"><a href="_constants_8h.html#a7d47482024b99d93c486dabbdbfca6d2">OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</a></div><div class="ttdeci">#define OPERATION_NOTIFICATION_FROM_USER_DEBUGGER_PAUSE</div><div class="ttdef"><b>Definition</b> Constants.h:387</div></div>
<div class="ttc" id="a_constants_8h_html_a7fe504aedb9b121cc73989a01396de8d"><div class="ttname"><a href="_constants_8h.html#a7fe504aedb9b121cc73989a01396de8d">OPERATION_LOG_WARNING_MESSAGE</a></div><div class="ttdeci">#define OPERATION_LOG_WARNING_MESSAGE</div><div class="ttdef"><b>Definition</b> Constants.h:367</div></div>
<div class="ttc" id="a_constants_8h_html_a7fe7df604d81f1b46afe1d44e2e2c38c"><div class="ttname"><a href="_constants_8h.html#a7fe7df604d81f1b46afe1d44e2e2c38c">OPERATION_DEBUGGEE_REGISTER_EVENT</a></div><div class="ttdeci">#define OPERATION_DEBUGGEE_REGISTER_EVENT</div><div class="ttdef"><b>Definition</b> Constants.h:375</div></div>
<div class="ttc" id="a_constants_8h_html_a9f661f43a2301721d3ce5d0956095a86"><div class="ttname"><a href="_constants_8h.html#a9f661f43a2301721d3ce5d0956095a86">OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</a></div><div class="ttdeci">#define OPERATION_HYPERVISOR_DRIVER_IS_SUCCESSFULLY_LOADED</div><div class="ttdef"><b>Definition</b> Constants.h:380</div></div>
<div class="ttc" id="a_constants_8h_html_ab45eded32abb2bdaa322ec7f102adf71"><div class="ttname"><a href="_constants_8h.html#ab45eded32abb2bdaa322ec7f102adf71">OPERATION_LOG_INFO_MESSAGE</a></div><div class="ttdeci">#define OPERATION_LOG_INFO_MESSAGE</div><div class="ttdoc">Message logs id that comes from kernel-mode to user-mode.</div><div class="ttdef"><b>Definition</b> Constants.h:366</div></div>
<div class="ttc" id="a_constants_8h_html_ac643a240390d97e6ce94643e817f3c38"><div class="ttname"><a href="_constants_8h.html#ac643a240390d97e6ce94643e817f3c38">OPERATION_DEBUGGEE_CLEAR_EVENTS_WITHOUT_NOTIFYING_DEBUGGER</a></div><div class="ttdeci">#define OPERATION_DEBUGGEE_CLEAR_EVENTS_WITHOUT_NOTIFYING_DEBUGGER</div><div class="ttdef"><b>Definition</b> Constants.h:379</div></div>
<div class="ttc" id="a_constants_8h_html_acb988d1979e04bb62dcff3603ef0c9a8"><div class="ttname"><a href="_constants_8h.html#acb988d1979e04bb62dcff3603ef0c9a8">OPERATION_DEBUGGEE_CLEAR_EVENTS</a></div><div class="ttdeci">#define OPERATION_DEBUGGEE_CLEAR_EVENTS</div><div class="ttdef"><b>Definition</b> Constants.h:378</div></div>
<div class="ttc" id="a_constants_8h_html_adb2ff9235a26370285f86dd92ca438e5"><div class="ttname"><a href="_constants_8h.html#adb2ff9235a26370285f86dd92ca438e5">OPERATION_LOG_NON_IMMEDIATE_MESSAGE</a></div><div class="ttdeci">#define OPERATION_LOG_NON_IMMEDIATE_MESSAGE</div><div class="ttdef"><b>Definition</b> Constants.h:369</div></div>
<div class="ttc" id="a_constants_8h_html_af1ce4ec6df0b72bf72e7a1b72825fc30"><div class="ttname"><a href="_constants_8h.html#af1ce4ec6df0b72bf72e7a1b72825fc30">OPERATION_COMMAND_FROM_DEBUGGER_CLOSE_AND_UNLOAD_VMM</a></div><div class="ttdeci">#define OPERATION_COMMAND_FROM_DEBUGGER_CLOSE_AND_UNLOAD_VMM</div><div class="ttdef"><b>Definition</b> Constants.h:372</div></div>
<div class="ttc" id="a_data_types_8h_html_a7df81690e4c6ed5fbbb74547c998e4b6a557243d0c993fb8d9b81a0a0db183c2e"><div class="ttname"><a href="_data_types_8h.html#a7df81690e4c6ed5fbbb74547c998e4b6a557243d0c993fb8d9b81a0a0db183c2e">IRP_BASED</a></div><div class="ttdeci">@ IRP_BASED</div><div class="ttdef"><b>Definition</b> DataTypes.h:255</div></div>
<div class="ttc" id="a_definition_8h_html_ae587705d649b149ca423cf686550d197"><div class="ttname"><a href="_definition_8h.html#ae587705d649b149ca423cf686550d197">DefaultSpeedOfReadingKernelMessages</a></div><div class="ttdeci">#define DefaultSpeedOfReadingKernelMessages</div><div class="ttdoc">The speed delay for showing messages from kernel-mode to user-mode in VMI-mode, using a lower value c...</div><div class="ttdef"><b>Definition</b> Definition.h:72</div></div>
<div class="ttc" id="a_ioctls_8h_html_ace90f6cc998458c046a38d7231989484"><div class="ttname"><a href="_ioctls_8h.html#ace90f6cc998458c046a38d7231989484">IOCTL_REGISTER_EVENT</a></div><div class="ttdeci">#define IOCTL_REGISTER_EVENT</div><div class="ttdoc">ioctl, register a new event</div><div class="ttdef"><b>Definition</b> Ioctls.h:64</div></div>
<div class="ttc" id="aforwarding_8cpp_html_aaefb1436070d1736e201244354af5dfc"><div class="ttname"><a href="forwarding_8cpp.html#aaefb1436070d1736e201244354af5dfc">ForwardingCheckAndPerformEventForwarding</a></div><div class="ttdeci">BOOLEAN ForwardingCheckAndPerformEventForwarding(UINT32 OperationCode, CHAR *Message, UINT32 MessageLength)</div><div class="ttdoc">Check and send the event result to the corresponding sources.</div><div class="ttdef"><b>Definition</b> forwarding.cpp:439</div></div>
<div class="ttc" id="ainclude_2_s_d_k_2_headers_2_events_8h_html_a45b28ed4e4baa5ca1d2b986967ce8e18"><div class="ttname"><a href="include_2_s_d_k_2_headers_2_events_8h.html#a45b28ed4e4baa5ca1d2b986967ce8e18">SIZEOF_REGISTER_EVENT</a></div><div class="ttdeci">#define SIZEOF_REGISTER_EVENT</div><div class="ttdef"><b>Definition</b> Events.h:429</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_a3094d7fd63949b1a53ca42a69a88c412"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#a3094d7fd63949b1a53ca42a69a88c412">KdRegisterEventInDebuggee</a></div><div class="ttdeci">BOOLEAN KdRegisterEventInDebuggee(PDEBUGGER_GENERAL_EVENT_DETAIL EventRegBuffer, UINT32 Length)</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_a3b3c1a4783e48dbccbca7aa158a09486"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#a3b3c1a4783e48dbccbca7aa158a09486">KdSendModifyEventInDebuggee</a></div><div class="ttdeci">BOOLEAN KdSendModifyEventInDebuggee(PDEBUGGER_MODIFY_EVENTS ModifyEvent, BOOLEAN SendTheResultBackToDebugger)</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_a628100cfab9e08107027ad304327fd37"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#a628100cfab9e08107027ad304327fd37">KdCloseConnection</a></div><div class="ttdeci">BOOLEAN KdCloseConnection()</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_a96e9806024f1d3f2a137c3940954ec4a"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#a96e9806024f1d3f2a137c3940954ec4a">KdHandleUserInputInDebuggee</a></div><div class="ttdeci">VOID KdHandleUserInputInDebuggee(DEBUGGEE_USER_INPUT_PACKET *Descriptor)</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_ab2a8ea0be4cc5d4a9d8eba5dd71c94be"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#ab2a8ea0be4cc5d4a9d8eba5dd71c94be">KdReloadSymbolsInDebuggee</a></div><div class="ttdeci">BOOLEAN KdReloadSymbolsInDebuggee(BOOLEAN PauseDebuggee, UINT32 UserProcessId)</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_aee94a30ff44688198e8a43e55dbb90f1"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#aee94a30ff44688198e8a43e55dbb90f1">KdAddActionToEventInDebuggee</a></div><div class="ttdeci">BOOLEAN KdAddActionToEventInDebuggee(PDEBUGGER_GENERAL_ACTION ActionAddingBuffer, UINT32 Length)</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a4dd113ea332d12de4597426dc75efd7a"><div class="ttname"><a href="#a4dd113ea332d12de4597426dc75efd7a">g_OutputSourcesInitialized</a></div><div class="ttdeci">BOOLEAN g_OutputSourcesInitialized</div><div class="ttdoc">it shows whether the debugger started using output sources or not or in other words,...</div><div class="ttdef"><b>Definition</b> globals.h:408</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_ac4758ea6e4b2b001288af3b22ff11795"><div class="ttname"><a href="#ac4758ea6e4b2b001288af3b22ff11795">g_BreakPrintingOutput</a></div><div class="ttdeci">BOOLEAN g_BreakPrintingOutput</div><div class="ttdoc">Shows whether the pause command or CTRL+C or CTRL+Break is executed or not.</div><div class="ttdef"><b>Definition</b> globals.h:499</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___s_y_m_b_o_l___r_e_q_u_e_s_t___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___s_y_m_b_o_l___r_e_q_u_e_s_t___p_a_c_k_e_t.html">_DEBUGGEE_SYMBOL_REQUEST_PACKET</a></div><div class="ttdoc">The structure of .sym reload packet in HyperDbg.</div><div class="ttdef"><b>Definition</b> RequestStructures.h:1047</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_d___p_a_u_s_e_d___p_a_c_k_e_t.html">_DEBUGGEE_UD_PAUSED_PACKET</a></div><div class="ttdoc">The structure of pausing packet in uHyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:229</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_e___u_s_e_r___i_n_p_u_t___p_a_c_k_e_t_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_e___u_s_e_r___i_n_p_u_t___p_a_c_k_e_t.html">_DEBUGGEE_USER_INPUT_PACKET</a></div><div class="ttdoc">The structure of user-input packet in HyperDbg.</div><div class="ttdef"><b>Definition</b> DataTypes.h:140</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___a_c_t_i_o_n_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___a_c_t_i_o_n.html">_DEBUGGER_GENERAL_ACTION</a></div><div class="ttdoc">Each event can have multiple actions.</div><div class="ttdef"><b>Definition</b> Events.h:406</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___g_e_n_e_r_a_l___e_v_e_n_t___d_e_t_a_i_l.html">_DEBUGGER_GENERAL_EVENT_DETAIL</a></div><div class="ttdoc">Each command is like the following struct, it also used for tracing works in user mode and sending it...</div><div class="ttdef"><b>Definition</b> Events.h:350</div></div>
<div class="ttc" id="astruct___d_e_b_u_g_g_e_r___m_o_d_i_f_y___e_v_e_n_t_s_html"><div class="ttname"><a href="struct___d_e_b_u_g_g_e_r___m_o_d_i_f_y___e_v_e_n_t_s.html">_DEBUGGER_MODIFY_EVENTS</a></div><div class="ttdoc">request for modifying events (enable/disable/clear)</div><div class="ttdef"><b>Definition</b> Events.h:242</div></div>
<div class="ttc" id="astruct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r_html"><div class="ttname"><a href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html">_REGISTER_NOTIFY_BUFFER</a></div><div class="ttdoc">Used to register event for transferring buffer between user-to-kernel.</div><div class="ttdef"><b>Definition</b> DataTypes.h:279</div></div>
<div class="ttc" id="astruct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r_html_a05acd472c7bdb5b620ec76b2ece28dd0"><div class="ttname"><a href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html#a05acd472c7bdb5b620ec76b2ece28dd0">_REGISTER_NOTIFY_BUFFER::Type</a></div><div class="ttdeci">NOTIFY_TYPE Type</div><div class="ttdef"><b>Definition</b> DataTypes.h:280</div></div>
<div class="ttc" id="astruct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r_html_a0be90ffe07b5e70e32a2971852f29c8f"><div class="ttname"><a href="struct___r_e_g_i_s_t_e_r___n_o_t_i_f_y___b_u_f_f_e_r.html#a0be90ffe07b5e70e32a2971852f29c8f">_REGISTER_NOTIFY_BUFFER::hEvent</a></div><div class="ttdeci">HANDLE hEvent</div><div class="ttdef"><b>Definition</b> DataTypes.h:281</div></div>
<div class="ttc" id="auser-listening_8cpp_html_ababfc7aac28c2ab9a43c85bca8ce61af"><div class="ttname"><a href="user-listening_8cpp.html#ababfc7aac28c2ab9a43c85bca8ce61af">UdHandleUserDebuggerPausing</a></div><div class="ttdeci">VOID UdHandleUserDebuggerPausing(PDEBUGGEE_UD_PAUSED_PACKET PausePacket)</div><div class="ttdoc">Handle pause packets from user debugger.</div><div class="ttdef"><b>Definition</b> user-listening.cpp:29</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adea213287dea87ed62f9d014189aaa92" name="adea213287dea87ed62f9d014189aaa92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adea213287dea87ed62f9d014189aaa92">&#9670;&#160;</a></span>SetTextMessageCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> SetTextMessageCallback </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Handler</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the function callback that will be called if any message needs to be shown. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Handler</td><td>Function that handles the messages </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a> = Handler;</div>
<div class="line"><span class="lineno">   48</span>}</div>
<div class="ttc" id="alibhyperdbg_8cpp_html_aa9ddd7ca0c6eabaedb612ceba470aa29"><div class="ttname"><a href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a></div><div class="ttdeci">PVOID g_MessageHandler</div><div class="ttdoc">The handler for ShowMessages function this is because the user might choose not to use printf and ins...</div><div class="ttdef"><b>Definition</b> globals.h:450</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82812124ed5123611bf8b4129fc00f64" name="a82812124ed5123611bf8b4129fc00f64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82812124ed5123611bf8b4129fc00f64">&#9670;&#160;</a></span>SetTextMessageCallbackUsingSharedBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PVOID SetTextMessageCallbackUsingSharedBuffer </td>
          <td>(</td>
          <td class="paramtype">PVOID</td>          <td class="paramname"><span class="paramname"><em>Handler</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the function callback that will be called if any message needs to be shown. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Handler</td><td>Function that handles the messages </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PVOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   59</span>{</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a>             = Handler;</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a> = malloc(<a class="code hl_define" href="_constants_8h.html#a557424f6d2420b81a5bd72b346664631">COMMUNICATION_BUFFER_SIZE</a> + <a class="code hl_define" href="_constants_8h.html#a0c9efc30a3f2181d7f0be5e69501b2ca">TCP_END_OF_BUFFER_CHARS_COUNT</a>);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a>)</div>
<div class="line"><span class="lineno">   64</span>    {</div>
<div class="line"><span class="lineno">   65</span>        <a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">   67</span>    }</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    RtlZeroMemory(<a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a>, <a class="code hl_define" href="_constants_8h.html#a557424f6d2420b81a5bd72b346664631">COMMUNICATION_BUFFER_SIZE</a> + <a class="code hl_define" href="_constants_8h.html#a0c9efc30a3f2181d7f0be5e69501b2ca">TCP_END_OF_BUFFER_CHARS_COUNT</a>);</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a>;</div>
<div class="line"><span class="lineno">   72</span>}</div>
<div class="ttc" id="a_constants_8h_html_a0c9efc30a3f2181d7f0be5e69501b2ca"><div class="ttname"><a href="_constants_8h.html#a0c9efc30a3f2181d7f0be5e69501b2ca">TCP_END_OF_BUFFER_CHARS_COUNT</a></div><div class="ttdeci">#define TCP_END_OF_BUFFER_CHARS_COUNT</div><div class="ttdoc">count of characters for tcp end of buffer</div><div class="ttdef"><b>Definition</b> Constants.h:440</div></div>
<div class="ttc" id="a_constants_8h_html_a557424f6d2420b81a5bd72b346664631"><div class="ttname"><a href="_constants_8h.html#a557424f6d2420b81a5bd72b346664631">COMMUNICATION_BUFFER_SIZE</a></div><div class="ttdeci">#define COMMUNICATION_BUFFER_SIZE</div><div class="ttdoc">Packet size for TCP connections.</div><div class="ttdef"><b>Definition</b> Constants.h:330</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a7ae3a9dabd3dba9c5d7b8fd8729261ef"><div class="ttname"><a href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a></div><div class="ttdeci">PVOID g_MessageHandlerSharedBuffer</div><div class="ttdoc">The shared buffer for the handler of ShowMessages function.</div><div class="ttdef"><b>Definition</b> globals.h:456</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a21c3c06b34d716c4680695c2b28127da" name="a21c3c06b34d716c4680695c2b28127da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21c3c06b34d716c4680695c2b28127da">&#9670;&#160;</a></span>ShowMessages()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> ShowMessages </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>Fmt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>...</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Show messages. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Fmt</td><td>format string message </td></tr>
    <tr><td class="paramname">...</td><td>arguments </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   97</span>{</div>
<div class="line"><span class="lineno">   98</span>    va_list ArgList;</div>
<div class="line"><span class="lineno">   99</span>    va_list Args;</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordtype">char</span>    TempMessage[<a class="code hl_define" href="_constants_8h.html#a557424f6d2420b81a5bd72b346664631">COMMUNICATION_BUFFER_SIZE</a> + <a class="code hl_define" href="_constants_8h.html#a0c9efc30a3f2181d7f0be5e69501b2ca">TCP_END_OF_BUFFER_CHARS_COUNT</a>] = {0};</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a> == NULL &amp;&amp; !<a class="code hl_variable" href="#aa6712815a46bbfaf04ac69c5f336d371">g_IsConnectedToRemoteDebugger</a> &amp;&amp; !<a class="code hl_variable" href="#a07d4f30d5bc446a5c0dacc0b77b902db">g_IsSerialConnectedToRemoteDebugger</a>)</div>
<div class="line"><span class="lineno">  103</span>    {</div>
<div class="line"><span class="lineno">  104</span>        va_start(Args, Fmt);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>        vprintf(Fmt, Args);</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>        va_end(Args);</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="#a3d9102adae8f4c5bb1d077a2b72f725c">g_LogOpened</a>)</div>
<div class="line"><span class="lineno">  111</span>        {</div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  113</span>        }</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    va_start(ArgList, Fmt);</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordtype">int</span> SprintfResult = vsprintf_s(TempMessage, Fmt, ArgList);</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    va_end(ArgList);</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (SprintfResult != -1)</div>
<div class="line"><span class="lineno">  123</span>    {</div>
<div class="line"><span class="lineno">  124</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa6712815a46bbfaf04ac69c5f336d371">g_IsConnectedToRemoteDebugger</a>)</div>
<div class="line"><span class="lineno">  125</span>        {</div>
<div class="line"><span class="lineno">  126</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  127</span>            <span class="comment">// vsprintf_s and vswprintf_s return the number of characters written,</span></div>
<div class="line"><span class="lineno">  128</span>            <span class="comment">// not including the terminating null character, or a negative value</span></div>
<div class="line"><span class="lineno">  129</span>            <span class="comment">// if an output error occurs.</span></div>
<div class="line"><span class="lineno">  130</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  131</span>            <a class="code hl_function" href="remote-connection_8cpp.html#aee6d8e479206be351a4a1e0a1e2e86b9">RemoteConnectionSendResultsToHost</a>(TempMessage, SprintfResult);</div>
<div class="line"><span class="lineno">  132</span>        }</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a07d4f30d5bc446a5c0dacc0b77b902db">g_IsSerialConnectedToRemoteDebugger</a>)</div>
<div class="line"><span class="lineno">  134</span>        {</div>
<div class="line"><span class="lineno">  135</span>            <a class="code hl_function" href="libhyperdbg_2header_2_kd_8h.html#ab37ce278a2768aed31b250d60ca70f45">KdSendUsermodePrints</a>(TempMessage, SprintfResult);</div>
<div class="line"><span class="lineno">  136</span>        }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a3d9102adae8f4c5bb1d077a2b72f725c">g_LogOpened</a>)</div>
<div class="line"><span class="lineno">  139</span>        {</div>
<div class="line"><span class="lineno">  140</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  141</span>            <span class="comment">// .logopen command executed</span></div>
<div class="line"><span class="lineno">  142</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  143</span>            <a class="code hl_function" href="logopen_8cpp.html#aa117e25b8d4fcb30878383e1c6dd6404">LogopenSaveToFile</a>(TempMessage);</div>
<div class="line"><span class="lineno">  144</span>        }</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a> != NULL)</div>
<div class="line"><span class="lineno">  146</span>        {</div>
<div class="line"><span class="lineno">  147</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  148</span>            <span class="comment">// There is another handler</span></div>
<div class="line"><span class="lineno">  149</span>            <span class="comment">//</span></div>
<div class="line"><span class="lineno">  150</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a> == NULL)</div>
<div class="line"><span class="lineno">  151</span>            {</div>
<div class="line"><span class="lineno">  152</span>                ((<a class="code hl_typedef" href="_data_types_8h.html#a216ccb2fc5a66b97a4add40d0632ed72">SendMessageWithParamCallback</a>)<a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a>)(TempMessage);</div>
<div class="line"><span class="lineno">  153</span>            }</div>
<div class="line"><span class="lineno">  154</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  155</span>            {</div>
<div class="line"><span class="lineno">  156</span>                memcpy(<a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a>, TempMessage, strlen(TempMessage) + 1);</div>
<div class="line"><span class="lineno">  157</span>                ((<a class="code hl_typedef" href="_data_types_8h.html#a161156699c9078c486b9145583e2a31e">SendMessageWWithSharedBufferCallback</a>)<a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a>)();</div>
<div class="line"><span class="lineno">  158</span>            }</div>
<div class="line"><span class="lineno">  159</span>        }</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span>}</div>
<div class="ttc" id="a_data_types_8h_html_a161156699c9078c486b9145583e2a31e"><div class="ttname"><a href="_data_types_8h.html#a161156699c9078c486b9145583e2a31e">SendMessageWWithSharedBufferCallback</a></div><div class="ttdeci">int(* SendMessageWWithSharedBufferCallback)()</div><div class="ttdoc">Callback type that can be used to be used as a custom ShowMessages function (using shared buffer)</div><div class="ttdef"><b>Definition</b> DataTypes.h:129</div></div>
<div class="ttc" id="a_data_types_8h_html_a216ccb2fc5a66b97a4add40d0632ed72"><div class="ttname"><a href="_data_types_8h.html#a216ccb2fc5a66b97a4add40d0632ed72">SendMessageWithParamCallback</a></div><div class="ttdeci">int(* SendMessageWithParamCallback)(const char *Text)</div><div class="ttdoc">Callback type that can be used to be used as a custom ShowMessages function (by passing message as a ...</div><div class="ttdef"><b>Definition</b> DataTypes.h:122</div></div>
<div class="ttc" id="alibhyperdbg_2header_2_kd_8h_html_ab37ce278a2768aed31b250d60ca70f45"><div class="ttname"><a href="libhyperdbg_2header_2_kd_8h.html#ab37ce278a2768aed31b250d60ca70f45">KdSendUsermodePrints</a></div><div class="ttdeci">VOID KdSendUsermodePrints(CHAR *Input, UINT32 Length)</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a07d4f30d5bc446a5c0dacc0b77b902db"><div class="ttname"><a href="#a07d4f30d5bc446a5c0dacc0b77b902db">g_IsSerialConnectedToRemoteDebugger</a></div><div class="ttdeci">BOOLEAN g_IsSerialConnectedToRemoteDebugger</div><div class="ttdoc">Shows if the debugger was connected to remote debugger (A remote host)</div><div class="ttdef"><b>Definition</b> rev.cpp:20</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_a3d9102adae8f4c5bb1d077a2b72f725c"><div class="ttname"><a href="#a3d9102adae8f4c5bb1d077a2b72f725c">g_LogOpened</a></div><div class="ttdeci">BOOLEAN g_LogOpened</div><div class="ttdoc">Shows whether the '.logopen' command is executed and the log file is open or not.</div><div class="ttdef"><b>Definition</b> globals.h:478</div></div>
<div class="ttc" id="alibhyperdbg_8cpp_html_aa6712815a46bbfaf04ac69c5f336d371"><div class="ttname"><a href="#aa6712815a46bbfaf04ac69c5f336d371">g_IsConnectedToRemoteDebugger</a></div><div class="ttdeci">BOOLEAN g_IsConnectedToRemoteDebugger</div><div class="ttdoc">Shows whether the current system is a guest (debuggee) and a remote debugger is connected to this sys...</div><div class="ttdef"><b>Definition</b> globals.h:81</div></div>
<div class="ttc" id="alogopen_8cpp_html_aa117e25b8d4fcb30878383e1c6dd6404"><div class="ttname"><a href="logopen_8cpp.html#aa117e25b8d4fcb30878383e1c6dd6404">LogopenSaveToFile</a></div><div class="ttdeci">VOID LogopenSaveToFile(const char *Text)</div><div class="ttdoc">Append text to the file object.</div><div class="ttdef"><b>Definition</b> logopen.cpp:119</div></div>
<div class="ttc" id="aremote-connection_8cpp_html_aee6d8e479206be351a4a1e0a1e2e86b9"><div class="ttname"><a href="remote-connection_8cpp.html#aee6d8e479206be351a4a1e0a1e2e86b9">RemoteConnectionSendResultsToHost</a></div><div class="ttdeci">int RemoteConnectionSendResultsToHost(const char *sendbuf, int len)</div><div class="ttdoc">Send the results of executing a command from deubggee (server, guest) to the debugger (client,...</div><div class="ttdef"><b>Definition</b> remote-connection.cpp:481</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a46134b8e86522c242ebbd8956543d74e" name="a46134b8e86522c242ebbd8956543d74e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46134b8e86522c242ebbd8956543d74e">&#9670;&#160;</a></span>UnsetTextMessageCallback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a> UnsetTextMessageCallback </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Unset the function callback that will be called if any message needs to be shown. </p>
<dl class="section return"><dt>Returns</dt><dd>VOID </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   82</span>{</div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_variable" href="#aa9ddd7ca0c6eabaedb612ceba470aa29">g_MessageHandler</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">   84</span>    free(<a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a>);</div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_variable" href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">g_MessageHandlerSharedBuffer</a> = <a class="code hl_function" href="namespacetest-case-generator.html#a9a4eff80432bb93d2796381610dd86c3">NULL</a>;</div>
<div class="line"><span class="lineno">   86</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ac4758ea6e4b2b001288af3b22ff11795" name="ac4758ea6e4b2b001288af3b22ff11795"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4758ea6e4b2b001288af3b22ff11795">&#9670;&#160;</a></span>g_BreakPrintingOutput</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_BreakPrintingOutput</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shows whether the pause command or CTRL+C or CTRL+Break is executed or not. </p>

</div>
</div>
<a id="a04aaf680ede15f5e7ba51ab9f157bfff" name="a04aaf680ede15f5e7ba51ab9f157bfff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04aaf680ede15f5e7ba51ab9f157bfff">&#9670;&#160;</a></span>g_DeviceHandle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE g_DeviceHandle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the global handle of device which is used to send the request to the kernel by IOCTL, this handle is not used for IRP Pending of message tracing this handle is used in KD VMM. </p>

</div>
</div>
<a id="a510d8eeb6d2c6c99faa91682232ec257" name="a510d8eeb6d2c6c99faa91682232ec257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a510d8eeb6d2c6c99faa91682232ec257">&#9670;&#160;</a></span>g_DriverLocation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TCHAR g_DriverLocation[MAX_PATH]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the location driver to install it. </p>
<div class="fragment"><div class="line"><span class="lineno">  423</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac55333cf9f0ea48c98b88541e7bd951" name="aac55333cf9f0ea48c98b88541e7bd951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac55333cf9f0ea48c98b88541e7bd951">&#9670;&#160;</a></span>g_DriverName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TCHAR g_DriverName[MAX_PATH]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the name of the driver to install it. </p>
<div class="fragment"><div class="line"><span class="lineno">  429</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5295702ad37c6640bf9d2df3091f9417" name="a5295702ad37c6640bf9d2df3091f9417"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5295702ad37c6640bf9d2df3091f9417">&#9670;&#160;</a></span>g_EventTrace</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LIST_ENTRY g_EventTrace</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds a list of events in kernel and the state of events and the commands to show the state of each command (disabled/enabled) </p>
<p>this list is not have any relation with the things that HyperDbg holds for each event in the kernel </p>
<div class="fragment"><div class="line"><span class="lineno">  400</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6712815a46bbfaf04ac69c5f336d371" name="aa6712815a46bbfaf04ac69c5f336d371"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6712815a46bbfaf04ac69c5f336d371">&#9670;&#160;</a></span>g_IsConnectedToRemoteDebugger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_IsConnectedToRemoteDebugger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shows whether the current system is a guest (debuggee) and a remote debugger is connected to this system. </p>

</div>
</div>
<a id="ad5df196001f0c415fbb0601caabc9804" name="ad5df196001f0c415fbb0601caabc9804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5df196001f0c415fbb0601caabc9804">&#9670;&#160;</a></span>g_IsDebuggerModulesLoaded</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_IsDebuggerModulesLoaded</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>this variable is used to indicate that modules are loaded so we make sure to later use a trace of loading in 'unload' command (used in Debugger VMM) </p>

</div>
</div>
<a id="a3f9f07302a64745af9aa15c1defbc798" name="a3f9f07302a64745af9aa15c1defbc798"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f9f07302a64745af9aa15c1defbc798">&#9670;&#160;</a></span>g_IsDriverLoadedSuccessfully</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE g_IsDriverLoadedSuccessfully</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle to show that if the debugger is loaded successfully. </p>

</div>
</div>
<a id="a0a209ec7bc7822ce1f94848c31d87cdd" name="a0a209ec7bc7822ce1f94848c31d87cdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a209ec7bc7822ce1f94848c31d87cdd">&#9670;&#160;</a></span>g_IsReversingMachineModulesLoaded</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_IsReversingMachineModulesLoaded</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a07d4f30d5bc446a5c0dacc0b77b902db" name="a07d4f30d5bc446a5c0dacc0b77b902db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07d4f30d5bc446a5c0dacc0b77b902db">&#9670;&#160;</a></span>g_IsSerialConnectedToRemoteDebugger</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_IsSerialConnectedToRemoteDebugger</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shows if the debugger was connected to remote debugger (A remote host) </p>

</div>
</div>
<a id="a34d91f14ab8002a6eeab08d76588ae92" name="a34d91f14ab8002a6eeab08d76588ae92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34d91f14ab8002a6eeab08d76588ae92">&#9670;&#160;</a></span>g_IsVmxOffProcessStart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_IsVmxOffProcessStart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shows whether the vmxoff process start or not. </p>

</div>
</div>
<a id="a3d9102adae8f4c5bb1d077a2b72f725c" name="a3d9102adae8f4c5bb1d077a2b72f725c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d9102adae8f4c5bb1d077a2b72f725c">&#9670;&#160;</a></span>g_LogOpened</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_LogOpened</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Shows whether the '.logopen' command is executed and the log file is open or not. </p>

</div>
</div>
<a id="aa9ddd7ca0c6eabaedb612ceba470aa29" name="aa9ddd7ca0c6eabaedb612ceba470aa29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9ddd7ca0c6eabaedb612ceba470aa29">&#9670;&#160;</a></span>g_MessageHandler</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PVOID g_MessageHandler</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The handler for ShowMessages function this is because the user might choose not to use printf and instead use his/her handler for showing messages. </p>

</div>
</div>
<a id="a7ae3a9dabd3dba9c5d7b8fd8729261ef" name="a7ae3a9dabd3dba9c5d7b8fd8729261ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ae3a9dabd3dba9c5d7b8fd8729261ef">&#9670;&#160;</a></span>g_MessageHandlerSharedBuffer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PVOID g_MessageHandlerSharedBuffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The shared buffer for the handler of ShowMessages function. </p>

</div>
</div>
<a id="acd85daad5afd0daf8ce46b7200a89276" name="acd85daad5afd0daf8ce46b7200a89276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd85daad5afd0daf8ce46b7200a89276">&#9670;&#160;</a></span>g_OutputSources</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LIST_ENTRY g_OutputSources</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds a list of output sources created by output command. </p>
<p>user-mode events and output sources are two separate things in HyperDbg </p>
<div class="fragment"><div class="line"><span class="lineno">  417</span>{0};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4dd113ea332d12de4597426dc75efd7a" name="a4dd113ea332d12de4597426dc75efd7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4dd113ea332d12de4597426dc75efd7a">&#9670;&#160;</a></span>g_OutputSourcesInitialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_OutputSourcesInitialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>it shows whether the debugger started using output sources or not or in other words, is g_OutputSources initialized with a variable or it is empty </p>

</div>
</div>
<a id="abe302f8d26342968e3daac90ce1384c1" name="abe302f8d26342968e3daac90ce1384c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe302f8d26342968e3daac90ce1384c1">&#9670;&#160;</a></span>g_UseCustomDriverLocation</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_basic_types_8h.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> g_UseCustomDriverLocation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the user wants to use a custom driver location or not. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53a6cdbae347618e9ee76d4be5c6ea96.html">hyperdbg</a></li><li class="navelem"><a class="el" href="dir_f4ef4eff33e6a1cda62ebd5e6c69c48d.html">libhyperdbg</a></li><li class="navelem"><a class="el" href="dir_d972732588c05990cedf8f8931a88bef.html">code</a></li><li class="navelem"><a class="el" href="dir_e8d66a40469d868cd15a0d498fc827bc.html">app</a></li><li class="navelem"><a class="el" href="libhyperdbg_8cpp.html">libhyperdbg.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
